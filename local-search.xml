<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>超级 Rui 的 2025 的半年度总结</title>
    <link href="/life/2025-halfyear-report/"/>
    <url>/life/2025-halfyear-report/</url>
    
    <content type="html"><![CDATA[<p>第六篇总结，写在一整年的牛马生活之后，距离上一篇总结过去了身心非常痛苦的半年（本该写在七月底，不过拖延症还是拖到了八月）。</p><span id="more"></span><p>痛苦的来源大概可以理解为理想和现实的无情的差异，应然和实然的巨大鸿沟，一时半会打得自己措手不及。不过这半年的末尾，想通了很多事，也有一些具体的操作路径了，之后或许会开始向好。</p><p>此外，某天突然想问自己为什么要写总结。倒是没有一个明确的答案，不过作为一个记性差的人来说，总结可以是一个有趣的头脑工具。</p><!-- more --><h1><strong>具体来说</strong></h1><h2 id="生活"><strong>生活</strong></h2><p>不得不再次提起我的沙发，在沙发上度过了很多回家精力恢复的时光，简直是买到的性价比最高的物件，带来的幸福感真的不可估量。</p><p>这一年都在批量采购雪糕，最近盛夏，雪糕自由十分快乐的，带有甜味的东西真的可以很好的抚慰心情。此外上半年也采购了多个榴莲，多箱荔枝，尤其是荔枝这个东西，因为去年欠收，时隔一年才再次饱餐一顿。</p><p>此外第一次在下班后去了海边，还记得当时选择这家公司的原因之一也是觉得有下班去海边的可能，却一直没有实现。真正实现的时候，觉得很惬意美好，但发现对于我来说并不是一个必须项。</p><p>上半年生活上的一大变化是买了车。由于不是每日通勤，所以车这个东西不论价格几何都是奢侈品，因为日均使用成本极高。但是最终还是买了，用于任何一个非 14 号线地铁站的出行。不得不说真的是可以扩展一些移动的边界，去难以去到的地方见不那么容易见到的人。此外，我有一种感觉，在有车之后，人的主体性会变强一些，至少在“我要去”“我能去”这方面少了一些被动，多了一些主观能动性。目前也是会给好友们安利车的使用价值。</p><h2 id="人际关系">人际关系</h2><p>上半年喊了高中同学，博士学弟们，工友们来家里打牌，准备了酒水饮料食物。相对来说局里的人际关系都还不错，作为组局者还是小有开心感。个人感觉很多人如果不被喊出来，他们自己也很难出门社交，其实大家关系都还不错，有机会能让大家多见见挺好。</p><p>这半年在自己的社交圈外认识了一个媒体朋友，起因是看到她在公众号的科技文章文笔自然舒适，便认识了一下，相处几次感觉还挺投缘，也了解到了很多新领域的信息（机器人、新媒体）。此外由于多少有些年龄段和领域的不同，可以看到一个不一样的做事逻辑，同时也能看到一个人身上很多闪光的品性（坚定快速出来创业，作为一个小年龄的女生我觉得很了不起），也很值得学习。</p><p>发现和明洋哥的见面基本上也固定成了半年一度，有一个稳定的见面关系实属难得，每次和他聊天都能认识到自己认知上的一些缺陷，且得到一些他的不是建议的建议（他会给出他的观察再给一个他的看法，以增加论据为主，并不会强行修改你的逻辑），快乐。</p><p>上半年的一件大事是 fyc 结婚，来了好多高中同学，算是一次规模不小的小聚吧。记得这些年每次和他说话基本上都是在说“你怎么还不结婚”，也算是某种圆满了。不过这次婚礼也让我更加意识到了一件早已意识但却没有认真的事，即“可能和很多朋友关系都疏远了”。回想大学生活，一个人从北方来到最南方，物理上和高中同学们隔开了很多距离，大家都在北京上海，我在遥远的岭南。常看到大家相约出去玩，但是自己觉得不管去哪里都有高昂的路费，对于一个大学生来说好像有些难以负担，所以也没有和大家见太多面。一般只有一年一度的寒假见面，也很难见到所有的人。这次婚礼，我才惊讶发现，即使是 fyc，也是十年以上没见了（比我想像中的久远太多）。但是其实距离也只是我拿出来的某种幌子，客观的距离因素的确存在，但是主观上的我可能有更多的问题。自己一向比较被动，距离存在时，自己没有主动经营朋友关系，在大家都忙碌奔前程的背景下，的确会越走越远，直到再见面只能谈旧时回忆，而难以诉说未来。（自己又是一个记性十分差的人，又会陷入一份尴尬之中）。不过总之，日后还是要主动一些。不过的确有一些主动的行为，比如今年荔枝很不错，给朋友们寄出了头岔的荔枝，看到大家喜欢我也很开心。</p><p>此外上半年有一个友情之上的朋友 xuan 老师吧，不过感觉还是没想清楚自己想要啥，潦草收尾。</p><h2 id="健康"><strong>健康</strong></h2><p>由于天气过于炎热，实在不想再受高温骑车的苦，于是卖掉了自行车，买了一辆小电驴，所以无法提供每日运动量了。不过相应的，楼下开了健身房，办了年卡，还是月均能去个四五次。</p><p>但是，总是有个但是。上半年的健康状况极其糟糕，五月份一直咳嗽有痰，六月份胸闷胸痛去了很多次心内，七月份焦虑症躯体化呼吸性碱中毒还去了急诊，并去了康宁诊断（不过医生说比较轻微抑郁没啥事）。值得提一下的是这个呼吸性碱中毒，或者过度通气综合征，严重时全身无法动弹，着实吓了自己一跳。不过也了解了原理，就是身体不适脑子以为缺氧便大口呼吸，导致体内二氧化碳浓度过低打破平衡。解决方案就是套一个袋子呼吸，或者有意识的调整呼吸节奏，戴口罩或捂住口鼻呼吸即可。这次急诊的经历多少让我对胸痛这件事有了一点心理把握，并不是器质性损害，所以并不用过于担心。</p><p>有趣的是我去急诊的时候，zxc 陪我做了检查，结果第二天他又身体不适，我陪他做了很多眼科的检查。他聊起了美国医疗的不便利，也聊起了他这大半年的不顺所带来的焦虑抑郁，让我看到大家似乎都在或多或少在为自己的身体和精神作斗争。</p><p>又一次次的又深刻意识到健康的重要性，它远远排在任何事之前。</p><h2 id="工作"><strong>工作</strong></h2><p>工作是这半年对身心带来极大负面影响的重要因素。虽然总可以说人的心态是问题最终的投影器，但是不能总是这样对自己苛责。环境的问题和自己的问题要分开来看。</p><ul><li>公司的阴暗面<ul><li>大领导乱搞男女关系，受害者甚至都涉及到了自己的好朋友，过于震惊。</li><li>无脑的管理，拍脑袋的项目动辄千万经费烂尾，领导首肯的方案效果不好要下面一线背锅降薪，形式主义的加班工位拍照。</li></ul></li><li>大企业游戏规则的学习（或许大部分公司都这样）<ul><li>不是一件事正确、高效、有价值就能做成的，中间有太多不可控因素，首当其冲的就是关键位置的掌握资源的人。只有这件事的利益符合这些人的利益的时候，不论事的客观对错，这件事就能成。对于底层牛马来说，几乎没有对事情的推动力。</li><li>更进一步来说，如果一件事对所有人都有利，但是对整体结果有害的话，它也一定会发生，因为关心整体结果的人和负责整体结果的人和推动中间过程的人是完全不一样的人。</li><li>专注持续做一个有积累的方向十分难，限制条件过于多。组织文化不允许一件两个月没有产出的事情出现。导致事情很难做宽，或者做深，造成时间浪费。</li><li>上半年没有评上高潜，硬条件被筛（去年被领导打了低绩效），认清了一套人才选拔服从性测试的规则。以及认识到了人才定义在厂内外的区别，和个人意志在复杂系统中的脆弱性。</li><li>虽然意识到这套游戏规则未必适合自己，但当下还是要尽量打好手上的牌。</li></ul></li><li>领导相处<ul><li>最为一个没有手握资源的人，最好的职场工作方式就是闭嘴并听从领导的安排，在此之外尽量不要有自己的观点，千万不可以在一些关键方面表现的比领导强，如果一定要表现出能力，那么需要表现出更强的对领导的服从性，否则会被按死，什么都没法做。</li><li>打工的本质就是工具人属性，大领导买你的时间来做事，但是小领导用你来提供情绪价值。这个情绪价值或为你的能力给他带来的经济价值，或为你的服从给他带来的心理价值。</li><li>保守且自卑的领导会在你的技术上进行打压，把你按倒在琐事上；野心勃勃且自私的领导会在你的规划上进行打压，把你按倒在工具人上。两者有时是相通的。博士 title 在这里是一个极大的负资产，尤其是在你的领导没有的时候。</li></ul></li></ul><h2 id="阅读">阅读</h2><ul><li>“稍后再看”的阅读模式有一点爆炸，残存的文章有一点吃力。不过近期发现了浏览器模式+豆包AI超级好用，软文阅读效率 Max。</li><li>我把书分为几类：文学、功利认知（大道理）、功利知识（历史科技），这几类一般都是同时在看（各一本），但是目前很多都是打开半本没有读完（《估值原理》《毛选1》《地下室手记》《卡拉马佐夫兄弟》《人类群星闪耀时》）</li><li>读完了《纳瓦尔宝典》，大道理之书，已经忘记在讲什么了。</li><li>读完了《菊与刀》，读过的第一本人类学相关的书，原来人类学是研究某些人类为什么会是这样习性的学科。</li><li>读书笔记该整理一下了，忘性很大，过些日子再放出来。</li></ul><h2 id="观影和视频"><strong>观影和视频</strong></h2><p>和阅读相似，观影也能看到很多生活之外的事物，使人不会陷入到物理世界所提供的微小牢笼。</p><ul><li>《凡人修仙传》持续追番！</li><li>《大明王朝 1566》，职场复刻，让人不相信“上面本意是好的，只是下面执行坏了”这句话。</li><li>《罗马》有点有趣，感觉即使是罗马帝国也是一班草台班子。不过让人看到了“站队”和“分散下注”和“集中下注”的不同后果。</li><li>《白莲花度假村》有钱人的阴暗面，感觉是想要体验的生活。</li><li>开始看《实习医生格蕾》，时间检验奖！对医疗剧有着热爱。</li></ul><h2 id="项目"><strong>项目</strong></h2><p>依旧一个都没做。 自己想做的事其实蛮多，但是真正动手很少，或许真的需要时间检验一下到底哪个才是自己的真正想要。此外现在绝大部分方向过于内卷，谋定而后动且立足于小事或更为合理。</p><p>虽然，但是。自己也在努力扩圈，扩大生活的感受域。一个不懂生活的人必定不懂需求，感知能力会下降，那么一定不会构建好的产品。（现在没法主导产品是有毒环境的问题，迟早会构建自己的产品。）</p><p>今年病痛过多，尤其是心理。也在思考是否可以用自己的能力（专业+性格）来帮助有相似症状的大家进行一些缓解。但还没深思，或许又是虚假的喜欢。</p><h2 id="金钱与消费"><strong>金钱与消费</strong></h2><ul><li>买车是一笔超大奢侈消费、保险也是一个很大的开销。不过这笔开销超值，私人空间++。</li><li>逐渐领悟花钱买时间精力的精髓：扫地机器人、家政阿姨、打车/专车。</li><li>社交时的请客买单（花不了几个钱，无所谓纠结），但是真的可以和很多人见面。</li><li>需要断舍离一波杂物了！东西太多了！</li></ul><h2 id="摄影"><strong>摄影</strong></h2><p>fyc 婚礼进行了大量的拍立得宝丽来拍摄，可能是今年唯一的正式摄影。</p><h2 id="东游西逛"><strong>东游西逛</strong></h2><p>除了 fyc 结婚去太原，哪也没去。虽然没远门但是还是切实意识到人需要出门，持续在小地方会闭塞视野，把不重要的小事在内心看的很大。</p><h1><strong>认知方面</strong></h1><ul><li>情绪控制很重要，能避免很多不必要的麻烦，且把自己藏到一个可以保护到自己的位置。上半年有多次没有处理好情绪的场景。</li><li>不要过多分享自己的看法。自己思绪比较敏感，总能很清楚地观察到别人的行为和想法并看到背后的恶意以及逻辑，算是一种洞察力。但是这并不是一件需要说出来的事，自己了解即可，别招来灾祸。</li><li>接上条，要学会闭嘴，如果不清楚什么能说什么不能说，那么就都别说。但是涉及到自身的关键利益上，不能软弱，要说出来。此外需要注意的是，同一件事不同的表达也会带来不同的结果，要过脑子。</li><li>做事先不提，要先学会做人。对自己是这样，将来选择同路人也是这样。</li><li>再次强调精力管理，不能总是 exploration 而不太 exploitation。<ul><li>即使是 exploration 也需要有策略，有落地，不能让探索浮于表面，需要让探索真正帮到别人。</li></ul></li><li>上次写了需要多跳出自己的思维框架，自己未必是对的，（世界和他人）凭什么要按照你的逻辑来？但是一次次的反馈发现，事实上自己总是对的（或者大差不差），一般都可以获得时间检验。所以要相信自己，持续输出。在强烈的客观背景调研串联后，别人不认可更多是因为别人的认知局限以及背后的私心。</li><li>大部份人是不希望别人更好的，有时候自己也会有这样的想法。但是自己有能力意识到并把控自己的想法，别人未必有。</li><li>利益不相关是很关系好很重要的前提，兄弟反目都很常见，更别说同事了。</li><li>只有自己才能拯救自己，任何事。别人可以加油鼓励，但是最终只能靠自己爬出来。</li><li>Tit for tat 策略非常好使，应该贯彻落实。学会及时止损，少推测他人态度，简单评判，不要耗费精力。买单离场、愿赌服输这件事过于重要。</li><li>环境有毒是会极大影响人的心力的，调节心态很重要，要允许任何事情发生，不怕事不后悔。恐惧是很多糟糕结果的来源，要相信自己人生的容错性。不怕事的技术路径个人认为是认真做事对自己对他人负责，有一点像《实习医生格蕾》里面的情节“为什么要在一个已经看起来死掉的病人上花那么多时间？为了在他们家人面前说一句‘我们已经尽全部努力了’”。当你知道你改变不了什么且尽力的时候，就会坦然。</li><li>混圈子这件事过于不适合自己，很难去和领导称兄道弟溜须拍马，也不喜欢什么领导球局。更偏好一些深度的点对点的交流，平等开放的交流。</li><li>人要选择适合自己的游戏，逃离有毒的圈子。</li></ul><h1><strong>番外篇：一些碎碎念 Blah Blah</strong></h1><ul><li>前些天，开车回到学校有一种感觉，当时之道是寻常。学校苟了很久，也被学校的师长保护的很好，真正出来社会才知道一切的不容易。</li><li>知道了师姐要来坪山任教，有一种家人来了的感觉哈哈哈哈。</li><li>看到表弟的房子，女朋友，稳定生活，感觉有点羡慕。评估了一下在深圳拥有这一切成本过高，有些感慨。虽然内心知道表弟这一切不是我想要的，但是心里狠狠羡慕。</li><li>来 3yc 这件事，是福不是祸是祸躲不过，虽然一直嘴上说如果去 hw 就好了，的确从很多方面来看是的。但是从人的社会化角度来看，3yc 这一年给人带来的认知成长（痛苦）是巨大的。一向认为痛苦守恒，晚痛不如早痛。</li></ul><h1><strong>总结展望</strong></h1><h2 id="一些收获"><strong>一些收获</strong></h2><p>痛苦带来的东西就是我的收获，或许是无谓的痛苦，但着实塑造了人。对事物的运行逻辑更加清晰了一些，认清了很多人和事，火眼金睛更雪亮了一些。</p><h2 id="一些遗憾"><strong>一些遗憾</strong></h2><ul><li>没有很好的处理一些和 xuan 老师的关系。</li></ul><h2 id="立起新的-Flag"><strong>立起新的 Flag</strong></h2><ul><li>每个工作日吃两个鸡蛋。这件事坚持了一段时间，但是断了，但是又捡起来了！希望望能继续。</li><li>多邻国日语上次还剩14章，目前还剩一章，其实一直没能坚持一天两节，目前来看八月底能搞定。但是其实最初学日语也没什么目的性，学完多邻国可以学学日语歌（最初的目的）。<ul><li>细化一下！要学会三首日语歌《残酷天使的行动纲领》《Butter-fly》《直到世界尽头》</li></ul></li><li>进行一些互联网输出的工作，包括但不限于知乎发文、公众号发文、小红书持续发帖等。</li><li>把头显的使用捡起来！</li><li>日均十分钟的运动量加五分钟的拉伸量！</li><li>每两周至少进行一次社交活动。</li><li>进行一些断舍离，出掉或丢掉，仅留高频率高质量物品。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>年终总结</tag>
      
      <tag>生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超级 Rui 的 2024 年度总结</title>
    <link href="/life/2024-year-report/"/>
    <url>/life/2024-year-report/</url>
    
    <content type="html"><![CDATA[<p>2024 年末总结，时间过得真快。</p><span id="more"></span><h1>写在最最前</h1><p>第五篇总结，写在半年的牛马生活之后，农历新年前。总算放假，可以安静认真的回想一下过去的这一半年。</p><h1>具体来说</h1><h2 id="生活">生活</h2><p>我对“生活”二字的定义为，可以以一种“不以时间消耗、精力消耗、产出数目这些维度最优化导向做事的状态”。工作之后生活占比急剧下降，一方面是残余时间比例的下降，另一方面是精力剩余的下降，“卖掉生活讨生活”这件事具像化了。意识到这件事还是花了一些时间的，但是其实在细节上早有体现。比如说肥牛蔬菜鸡蛋大满足泡面中必备的肥牛早已没有存货，懒得开火也已经很久了。又比如说烧开水这件事也由更方便的买瓶装水代替。再比如影视作品的消费频次也远远下降了。取而代之的是较晚的下班时间，以及瘫在沙发上的我。不得不说，沙发真的是我的精神港湾，是骑车回家后一定第一个到达的 checkpoint，瘫坐的确能洗去不少疲惫。</p><h2 id="健康">健康</h2><p>平平无奇的久坐打工人，能感受到持续的身体精神疲惫。不过总的来说倒是没生病，还长胖了几斤，也算可以。上下班骑自行车还是多少保证了一些每日运动量，也算是一种强行续命的选择。</p><p>但是细化到较窄的范围，头发似乎更稀疏了，视力似乎也略有下降，脊柱也能感受到一丝疲倦，胃口似乎也有所降低。只能说需要注意的地方还很多，运动急需再拉回日程，这半年似乎也只是打了三四场球，也再无稍微激烈的运动了。</p><h2 id="工作">工作</h2><p>相比于上次记录，已经更加深度地融入了工作当中。工作内容也经历了一次变化，也是由于自己对方向有着判断，所以主动推动了一波转换。相比于对工作内容、具体技术的好恶，我更在意的是这个工作内容未来的潜在价值，这方面来说还是对当下的方向比较满意的。同事氛围很好，也有了一些日常交流较多的友人，至少在做事方面不是孤独的。</p><p>但是也意识到“工作”又不仅仅只是“做工”这一件事，还有很多很多复杂的限制条件，包括管理上、心理上、人际关系上等等。“专注高效地集中在最值得做的有价值的核心矛盾问题下，用系统的方式进行推动和改进”是一个非常理想的状态，一个几乎不可能实现的美好愿望，甚至一个“值得做的问题”都很难说真实存在。此时此刻就体现出了读博士的奢侈，可以无忧无虑地专注于一个学术重要抽象问题进行分析，在繁杂的社会工作中难得有这样的机会。在当前状态下，尽快无条件接受核心限制条件（游戏规则），再进行推进才是阻力最小的优化方式。</p><h2 id="项目">项目</h2><p>一个都没做。之前方法论有问题。和主业相关的有趣尝试才是应该进行的项目。这半年倒是有一些方向，但是又由于主业过重，没有精力做一个具体的安排。</p><h2 id="金钱与消费">金钱与消费</h2><p>回到了想买啥就买啥的状态，但是对金钱性价比这件事还是有些许偏执。精力性价比这件事已经意识到，也在消费观上逐渐向此方针接近。总的来说物欲极度减少，还是不错的。</p><h2 id="读书">读书</h2><p>最近逐渐意识到使用“稍后再看”的阅读模式十分合理，定期统一的信息筛选在信息爆炸的当下是一种非常高效的行为。现在每周会抽取一定时间来阅读积攒起来的公众号、博客、文章，统一整理收藏，算是比较舒适的一种化零碎为整的方式。</p><p>这半年看书了！首先是开始重读高中语文课本了，自认为语文学的不是很好，当时有很多东西也不理解，现在再读会发现对很多描述、道理有了更清晰的认识。此外也看了一些闲书，《追风筝的人》、《跨越鸿沟》、《色彩》等，还算是又捡回来读书这个习惯，并且也获得了一些愉悦。在工作生活中其实也越来越遇到一些问题，所以也尝试从书中寻找一些答案和情绪价值。买了一套《毛泽东选集》才刚刚开始看，毛主席的语言表达能力和对问题的清晰认知着实震撼，需要学习。</p><h2 id="观影和视频">观影和视频</h2><ul><li>食贫道的一系列纪录片，看了不少，用于下饭。其实有很多日常难以注意到的视角，或者说难以花成本去探索的地方，都被其以讲故事的方式展示了出来。可以看到一位 up 主的人文素养和情怀吧。</li><li>《凡人修仙传》有点有趣，也是一个大网文。先在 B 站刷完了现有的动漫，又去看了一些小说，最后弃掉了。动漫其实颇有有点，对于配角、小人物的人物形象塑造十分饱满，并不是只有一瞬的刻画，而是有故事线、有白描，引人入胜。此外后期的特效制作也很棒，估计之后会追番了。</li><li>《大明王朝 1566》，最近刚刚开始在 b 站看解说版。似乎是中国历史上评分最高的电视剧，想看看为什么他有如此高的赞誉吧。</li></ul><h2 id="摄影">摄影</h2><p>上次就说到，上半年没有怎么认真拍片子，下半年其实更是几乎一张都没拍（除了出门玩的时候）。工作对于生活的侵入真的是非常的难以想象。没拍的原因或许主要是出门少了，对于我这种偏爱扫街看细节的人来说，基本上没有出片的机会了。其实强制性地出出门，克服一下精神上的惰性，才能捡回一些这方面的多巴胺吧。日后应该要定一些出门玩耍拍照的目标了。</p><h2 id="东游西逛">东游西逛</h2><p>去了越南胡志明和富国岛。胡志明还蛮有趣，法式风情和郊区的乱七八糟混为一体，感觉中式东南亚式法式都有混杂，有趣。富国岛非常好看，旅行安排没有太合理，但是在最后一天看到了绝美的海，惊叹。</p><p><video src="IMG_5057.mp4" position= "absolute" width="100%" height="100%" controls="controls"></video></p><h1>认知方面</h1><ul><li>人是很难搞清楚自己的，但是人是需要在认识自己的路上走下去的。“未经审视的生活是不值得过的”。</li><li>精力有限，要做减法。</li><li>宏观微观两手都要抓，两手都要硬。要有做好微观的能力，也要有看见宏观的意识，否则眼高手低，人就废了。</li><li>要有自己的圈子（工作生活中），或称为内阁。</li><li>要有自己的定位（工作中），即核心竞争力在哪方面体现。</li><li>需要多跳出自己的思维框架，你未必是对的，（世界和他人）凭什么要按照你的逻辑来？</li><li>包容心！包容心！包容心！不要自诩对事物的不同逻辑都可以理解，但是在心态上却又居高临下地审视。</li><li>经历塑造人，每个人都有自己的性格底色，指导他的行为方式，多观察、少做评价。</li></ul><h1>番外篇：一些碎碎念 Blah Blah</h1><ul><li>当发现自己的沙发可以放倒的那一刹那，爽了几个量级。</li><li>热红酒还是蛮好喝的，就是准备的时候有点麻烦。</li><li>佩姐老火锅没有之前好吃了。</li><li>海底捞真的是一家大家都很喜欢的、认为是一个开心时失落时可以度过一点时间的地方。</li><li>好吃的实在是太难找了。</li><li>在家里招待朋友还是快乐的。</li><li>回学校找老师有一种真正意义上回家的轻松快乐的感觉，老板是真的关心学生们。</li><li>放下一些事直到波澜不惊还是需要很多时间的。</li></ul><h1>总结展望</h1><h2 id="一些收获">一些收获</h2><p>牛马生活有些挫折，有些观察，有些认识。打磨自己的过程还是痛并快乐的。</p><h2 id="一些遗憾">一些遗憾</h2><p>没什么遗憾。</p><h2 id="立起新的-Flag">立起新的 Flag</h2><p>细化了一些，发现宏大的愿望真的难以实现。</p><ul><li>每个工作日吃两个鸡蛋。</li><li>年中把多邻国日语搞定！还剩 14 章，每章约 22 节，日均 2+ 节即可。每周可以休息一天。</li><li>少说一点“好累啊”，少些负面暗示。</li><li>把《阿西莫夫自传》看完，太厚了一直没看完。</li><li>每天在骑车之外，至少保证十分钟的强度运动时间。</li><li>把头显和 3D 信息的展示连接串流过程搞清楚。</li><li>每个月出一趟门散散心，或每两个月去一趟远一点的地方。</li><li>更新一下衣库，建立一下简单的风格库，不要像现在一样太杂乱了。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>年终总结</tag>
      
      <tag>生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MBTI 及荣格八维心理类型</title>
    <link href="/interesting-stuff/mbti-jung/"/>
    <url>/interesting-stuff/mbti-jung/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>想学习整理一下 MBTI 以及荣格的八维心理类型很久了，理论知识较为繁琐，此处仅划重点。</p><span id="more"></span><div class="note note-primary">            <p>不管是 MBTI 还是荣格的八维心理类型，操作上都是给人进行打标签分类。这种分类在快速分析人的性格特点上有一定的帮助，但是需要注意，人的性格是复杂多变的，不应该被简单的标签所束缚。</p>          </div><p>此处进行学习的主要目的是划定一个锚，了解较为重要的维度，以达到近邻匹配快速识人的目的。</p><ul><li><a href="#mbti">MBTI</a><ul><li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li><li><a href="#%E5%90%AB%E4%B9%89%E8%A7%A3%E9%87%8A">含义解释</a></li><li><a href="#%E5%BF%AB%E9%80%9F%E5%88%86%E8%BE%A8">快速分辨</a></li></ul></li><li><a href="#%E8%8D%A3%E6%A0%BC%E7%9A%84%E5%85%AB%E7%BB%B4%E5%BF%83%E7%90%86%E7%B1%BB%E5%9E%8B">荣格的八维心理类型</a><ul><li><a href="#%E7%AE%80%E4%BB%8B-1">简介</a></li><li><a href="#%E5%90%AB%E4%B9%89%E8%A7%A3%E9%87%8A-1">含义解释</a></li></ul></li><li><a href="#%E7%94%A8%E6%B3%95%E5%BB%BA%E8%AE%AE">用法建议</a></li><li><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE">参考文献</a></li></ul><h1>MBTI</h1><h2 id="简介">简介</h2><p>MBTI 全称是 Myers-Briggs Type Indicator，是基于荣格的心理类型理论而发展起来的一种心理测试方法。由于对 MBTI 较为了解，此处仅简单介绍。</p><p>MBTI 一共有四个维度，每个维度有两种选择互相对立，共有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>4</mn></msup><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">2^4 = 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span> 种类型，对号入座即可。</p><ul><li>E/I: Extraversion 外向/Introversion 内向</li><li>S/N: Sensing 实感/Intuition 直觉</li><li>T/F: Thinking 思考/Feeling 情感</li><li>J/P: Judging 判断/Perceiving 感知</li></ul><h2 id="含义解释">含义解释</h2><p>对每一个维度说人话，可以理解为：</p><ul><li>E/I: 心理能量获取时，专注在外部世界还是内部世界？</li><li>S/N: 认知过程中，信息摄入和理解上，更依赖具象信息还是抽象信息？</li><li>T/F: 认知过程中，决策和判断时，更倾向于依赖逻辑还是情感？</li><li>J/P: 生活态度上，更条理还是随性？</li></ul><p>此外现在流行的 16Personalities 也是基于 MBTI 的一种测试方法，为每一个类型赋予了一个名字，并给予了对应的<a href="https://www.16personalities.com/personality-types">卡通形象</a>。此外，角色形象还有其对应的颜色颜色，如蓝色（SJ）、黄色（SP）、绿色（NF）、紫色（NT）。</p><h2 id="快速分辨">快速分辨</h2><p>注意！下方可能有刻板印象！</p><ul><li><strong>E/I</strong>: 内向外向较好判断，外向的人在社交场合中更活跃，内向的人则更喜欢独处。<ul><li>社交达人 v.s. 社恐</li><li>E 可能更喜欢社交，见人恢复能量，存在感强。</li><li>I 可能更擅长独处，见人消耗能量，存在感弱。</li></ul></li><li><strong>S/N</strong>: 通过对话细节来判断，喜欢讲述具体事物的人更可能是 S，而喜欢讲述抽象概念的人更可能是 N。<ul><li>一根筋 v.s. 想太多</li><li>S 更加关注细节，现实主义，对他人想法不太感兴趣，喜欢谈论实际的东西。</li><li>N 更加关注抽象概念，理想主义，容易体会他人想法，喜欢谈论虚的东西。</li></ul></li><li><strong>T/F</strong>: 通过决策方式来判断，更倾向于逻辑的人更可能是 T，而更倾向于情感的人更可能是 F。<ul><li>事不关己 v.s. 共情泛滥</li><li>T 较少在意他人情绪，就事论事，较难被煽动。</li><li>F 较为关注他人情绪，容易被感情左右，较容易被煽动。</li></ul></li><li><strong>J/P</strong>: 通过生活态度来判断，更喜欢计划和条理的人更可能是 J，而更喜欢随性的人更可能是 P。<ul><li>卷王奋斗 v.s. 随时开摆</li><li>J 更加遵守计划规则，思维有序，更容易有整洁的桌面。</li><li>P 人生态度较为随性，思维跳跃，更容易有混乱的桌面。</li></ul></li></ul><h1>荣格的八维心理类型</h1><h2 id="简介-2">简介</h2><p>在 MBTI 这么火的背景下，为什么还要提荣格的八维心理类型呢？MBTI 有一个问题，是使用简单的二分法来对人进行分类，总会出现一些左右横跳的现象。此外，有时候 MBTI 中虽然只相差一位，但是性格差异却很大。此时可能需要从更深层的逻辑出发来理解人的性格。（需要注意的是，虽然 MBTI 是从荣格八维的基础上衍生而来的，但是两者并没有一个严格意义的准确与高下之分。）</p><p>具体来说，在荣格的八维心理类型中：</p><ul><li>有四个主导功能：实感 S、直觉 N、思考 T、情感 F</li><li>每个功能有两种态度：外倾 e 和内倾 i</li><li>对于组合而来的八种类型，荣格认为每个人都有一个主导功能，一个辅助功能，一个第三功能，一个第四功能（相对弱势），这四种功能称为阳面功能。</li><li>第一功能与第四功能对立；第二功能与第三功能对立</li><li>荣格首先更侧重 MBTI 中的 NS 和 TF 两个维度，且不同于 MBTI 中的非此即彼，荣格以优势和劣势的方式来描述。</li><li>后四位的功能此处暂时不做详细介绍。</li></ul><div style="width:50%;margin:auto"><img src="/interesting-stuff/mbti-jung/Cognitive_Functions.svg" class="" title="十六型人格的主导功能"></div><p>上图为 MBTI 的荣格八维主导功能对应关系，可以看到，每一个 MBTI 都有其对应的主导功能。</p><h2 id="含义解释-2">含义解释</h2><p>四个主导功能及说人话解释（个人理解）：</p><ul><li>Si/Se：对事物的感知<ul><li>Si 吸收经验，规避风险，坚守传统规则（经验主义）</li><li>Se 参与体验，头脑清醒，追求享乐刺激（随机应变，运动健将）</li></ul></li><li>Ni/Ne：对事物变化的预感<ul><li>Ni 力图从精神世界发现多种可能性，靠意象演绎（先知）</li><li>Ne 力求从客观世界发现多种可能性，对环境归纳（三分钟热度）</li></ul></li><li>Ti/Te：对事物的判断推理<ul><li>Ti 思考外界信息，验证自己思想，偏哲学（逻辑怪）</li><li>Te 基于客观资料，认识客观世界，偏科学（卷王）</li></ul></li><li>Fi/Fe：对事物的情感<ul><li>Fi 深藏情感，气质忧郁，寻求保持隐蔽（自恋情绪化偏爱）</li><li>Fe 情感外露，爱好交际，寻求与外界和谐（大爱无疆）</li></ul></li></ul><p>举个例子，</p><ul><li>一个 intj 可能有以下的八维排序 Ni-Te-Fi-Se，以直觉为主导，思考为辅助，情感为第三，实感为第四。</li><li>一个 entp 可能有以下的八维排序 Ne-Ti-Fe-Si，以直觉为主导，思考为辅助，情感为第三，实感为第四。</li><li>两者功能顺序相同，但是态度不同。</li></ul><p>具体的 MBTI 与荣格的八维心理类型的对应关系可以参考下图：</p><div style="width:50%;margin:auto"><img src="/interesting-stuff/mbti-jung/mbti-jung.png" class="" title="与十六型人格的对应关系"></div><h1>用法建议</h1><p>此处为个人看法，仅供参考：</p><ul><li>MBTI 用来快速识人<ul><li>MBTI 提供了一个很好的聚类结果，可以快速判断一个人的性格特点。可以预设和一个人相处方式的初始值。</li><li>需要注意的是，由于仅二元分类，而人是多元的，切勿迷信标签。</li></ul></li><li>荣格的八维心理类型用来剖析自己<ul><li>了解自己的行为逻辑，可以更好的发挥自己的优势</li></ul></li></ul><h1>参考文献</h1><ul><li><a href="https://zh.wikipedia.org/zh-hans/%E9%82%81%E7%88%BE%E6%96%AF-%E5%B8%83%E9%87%8C%E6%A0%BC%E6%96%AF%E6%80%A7%E6%A0%BC%E5%88%86%E9%A1%9E%E6%B3%95">迈尔斯-布里格斯性格分类法</a></li><li><a href="https://wiki.mbalib.com/wiki/%E8%8D%A3%E6%A0%BC%E7%9A%84%E5%BF%83%E7%90%86%E7%B1%BB%E5%9E%8B%E7%90%86%E8%AE%BA">荣格的心理类型理论</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>interesting-stuff</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mbti</tag>
      
      <tag>jung</tag>
      
      <tag>psychology</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超级 Rui 的 2024 半年度总结</title>
    <link href="/life/2024-halfyear-report/"/>
    <url>/life/2024-halfyear-report/</url>
    
    <content type="html"><![CDATA[<p>迟到了一个月的 2024 年中总结，本来应当写在七月底的。</p><span id="more"></span><h1>写在最最前</h1><p>第四篇总结，写在学业结束与工作开始之际。本来七月底就该写完的，但是由于新入职的事情外加一些拖延，直接拖到了现在。仔细想想，不管是生活状态还是心理状态，这半年似乎也有着较多变化。</p><h1>具体来说</h1><h2 id="学业">学业</h2><p>博士答辩完之后，拖拖延延在三四月交完了大动干戈的修改版博士论文，也顺利在七月份拿到了毕业证书，这一过程只能说内心毫无波澜。</p><p>论文提交完之后，老板看我空闲，又拉我做起了某 AI4Science 方向的调研，直面我之前物理知识的生疏。不过相对来说，自己似乎还是喜欢调研的，胜过实操，可能也源于自己的街溜子性格。总之这个小项目似乎也在既定的离校时间前有了一个小结，至此也算是完成了自己的博士生涯。</p><h2 id="生活">生活</h2><p>纯粹为了工作考虑，搬到了郊区，距离市中心一个多小时的地铁。其实更喜欢大隐隐于市，而不是真的去郊区。郊区唯一的好处可能在于房租便宜，一个人住三室两卫，有了自己的书房和杂物间。</p><p>租了空房，买了心心念念的大沙发，懒人沙发，大电视，升降桌等快乐物品，算是开始追求一些之前没条件追求的快乐生活。虽然是一个 E 人，但是由于比较懒得出门，宅家时间很多。不得不说，大客厅和大沙发是真的舒适快乐，自己回家就可以瘫，独居快乐度 MAX。同样也尝试了几次喊大家来玩，体会到了大屋子的乐趣。如果真的都博士毕业了还要去住宿舍，省下几千块，回到屋子里看着孤零零天花板，估计又会思考人生了。</p><p>Anyway，读博是为了生活，工作也是为了生活，这也是自己逐渐明白的事情。</p><h2 id="健康">健康</h2><p>仍断断续续运动，时刻被懒惰战胜。认真地思考了一下，需要认真掌控一下运动安排了，似乎这是少数可以真正被自己完全掌控的事情。</p><p>前些日子又扁桃体发炎了，记不清是第几次了，迟早给他割了。是第一次独居生病，再一次意识到健康的重要性，尤其是烧的一塌糊涂的时候，会认真觉得一切身外之物都不重要，所有的烦心事都抛在脑后了，能感觉到的只有自己的身体。</p><h2 id="工作">工作</h2><p>半年前对自己的未来还一无所知，现在也算是尘埃落定。HW 和 BYD 二选一最后选择了 BYD，是一个大家听起来不太正常的选择，尤其对一个人工智能背景的博士生来说。</p><p>缘起还是和老板聊天，最开始我是无脑想去 HW 的，他说对我来说 HW 未必好，BYD 未必不好，于是我就开始思考。找两边部门的人聊了几次，觉得 BYD 这边的饼香一些，自己博士期间的工作似乎也有用武之地，而且看起来有不是螺丝钉的可能性。并且科室在做智驾中无比重要的一环，考虑到是核心业务，于是就选择了 BYD。决定之后，心态变得很稳，产生了对未来工作上大展拳脚的期待。</p><p>七月底入职，至今已经一个月，内心五味杂陈。根本原因是理想和现实的差距，刚入职几天，科室分拆、科室改名业务调整、领导换人，一切都变得不一样。别说之前的大饼了，现在科室的主营业务和我在的整个算法组都没什么关系了，肉眼可见的边缘化。万幸的是，现在的组长、同事、带教导师都很不错，虽然能看到大家身上的压力，但看到更多的是大家也都在这个环境中尽力为小组和科室做一些长远打算，十分幸运能进入这样的氛围。这一个月也在不断的了解科室的业务和能力，也定位了一些缺陷和优势，也基本确定了中短期的有一定意义的工作内容，看看自己能做到什么程度吧。</p><p>其实近几日有些后悔没有选择 HW 的那一份 offer，因为不管是管理能力和工作环境，那边应该都是断层更好的。尤其是近期对业务有了一定理解之后，觉得在 HW 做业务似乎有着更好的上升空间。此外，BYD 的工作环境实在是太差了，新装修的楼里面有毒有机物还超标，所以自己选择带着防毒面具上班，成为了那个最事儿逼的应届生（狗命要紧）。当然，如果去了 HW 的话，可能也会在后悔为什么没有去 BYD，只能说得不到的总是更好的，人更愿意美化自己没有走的那一条路。可能这个问题的终极答案是，我生性自由散漫不太适合上班哈哈，每天硬性打卡这件事使人痛苦。Anyway，买定离手，愿赌服输，做好自己。</p><h2 id="项目">项目</h2><p>脑洞项目又开始脑洞了，主业之外一条毫不相干的长路是有必要走的。然而精力有限，做之前还是要把目标定清楚。希望在下次总结的时候能有一些进展。</p><h2 id="金钱与消费">金钱与消费</h2><p>当前可能是人生金钱低谷，但是对现金流有预期，也没什么压力。似乎回到了读博时候想买啥就买啥的状态。预期在体验上的支出会增多，在添置物品上的支出会控制。</p><h2 id="读书">读书</h2><p>这半年没怎么读书，需要改进。</p><h2 id="观影和视频">观影和视频</h2><p>独居之后疯狂刷剧，尤其是著名的日剧。似乎日剧非常喜欢对一个职业进行深刻的描写，从工作内容，到人物心理都有着完整的刻画。甚至对一些非常冷门的职业也有着记录，比如《非正常死亡》中的法医，比如《半泽直树》中的银行职员。能看到每一个角色对自己生活、工作的热爱，这一点深深打动了我。</p><p>印象最深刻的可能还是《白色巨塔》这部剧，看完只能用震撼来形容，尤其是最后一集，对于医生的职业精神有着深刻的描写。看到主角最后一刻还是回归了自己内心的时候，深深的被感动了。当然也引发了我对健康和成就的思考，没有健康、一切都是空中楼阁。如果要因为其他的事，对自己的健康今日割五城，明日割十城，最后失去了自己，再多的成就和地位似乎也是空的。当然如果追逐的是意义以及更大的贡献，两者的权衡似乎又值得讨论了。</p><h2 id="摄影">摄影</h2><p>上次说到不管是从分享快乐还是从严肃成长方面，摄影都可以更系统性的做起来。但是这半年其实没有怎么认真拍片子，思考了一下似乎是兴致单薄了。去到陌生的地方仍会有无穷的拍摄欲望，但是回到生活的城市，兴致明显下降。</p><p>我向来喜欢找外部原因，我把这件事归结于身边的风景实在是太丑了，很难专门去周围拍一组片子。与之相反的是，我仍旧喜欢用手机记录，万幸，依旧不认真地非系统性地持续拍了下来。</p><h2 id="东游西逛">东游西逛</h2><p>又去了东京，喜欢东京。非常喜欢这种大城市漂泊的渺小感，之前在纽约伦敦也有同样的感觉。又喜欢作为旅行者在社会地位上居高临下的审视，喜爱深入作为旁观者角色。</p><h2 id="感情">感情</h2><p>上半年分手了，分手那天双方花了一个下午认真的说清楚了所有的问题。似乎是一种很好的分手方式，控制了遗憾且散的明明白白。</p><p>虽然会有惋惜，但是自己开始意识到一些“喜欢”和“合适”的 dilemma。少年仍需修炼吧。</p><h1>认知方面</h1><p>此处不搞什么分类了，想到什么就随便写写。</p><ul><li>清晰的目标函数是一切事情的基础。</li><li>人的精力是有限的，要把宝贵的精力放到重要的事情上。如果精力过剩，那就去寻找宝贵有趣的事情。如果精力不足，那就强身健体且评估事件。</li><li>合理利用拖延是一个很重要的能力，直观上来讲，不拖延的话根本不会知道哪些事情是真正重要的，很多无关轻重的事会披着“重要”的外衣来占据你的精力。</li><li>如果是为了那些名头的话，那么健康就是重中之重；如果是为了价值和意义，那么健康就是做事的地基。无论如何，要保持健康。</li></ul><h1>番外篇：一些碎碎念 Blah Blah</h1><ul><li>我的房子和沙发，猫享受的时间都比我多！</li><li>当初的来到郊区离海近，开车一脚油门去躺的构想，因为没车以及懒惰要无限期推迟了吧。</li><li>Z9GT 真的帅，但是好贵。</li><li>意识到如果一直在这里工作，也是买不起这里最好的车的。</li><li>独居吃饭真的是大问题。</li><li>虽然做技术专业对口，但是写码开发等方面，似乎相比于硕士来说，并不是我的长处。在这里大家都做的是相同的事情，可能要想想如何扬长避短了。</li></ul><h1>总结展望</h1><h2 id="一些收获">一些收获</h2><p>开始成为社畜，牛马身份不失为一大收获。</p><h2 id="一些遗憾">一些遗憾</h2><ul><li>还是和老辰分开了，人与人之间的恩断义绝令人遗憾。</li></ul><h2 id="立起新的-Flag">立起新的 Flag</h2><p>细化了一些</p><ul><li>增肥到 140 并身材管理！</li><li>在这份布满荆棘的工作中做成一些事，就是目前短中长期三个目标。</li><li>把手头在看的几本书读完，然后把没看的金融投资方面的书也读完。</li><li>争取今年把多邻国日语搞定！</li><li>希望能开始做起来脑洞项目。</li><li>割掉扁桃体。</li><li>希望能做一本影集出来。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>年终总结</tag>
      
      <tag>生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BEVFormer</title>
    <link href="/autonomous-driving/bevformer/"/>
    <url>/autonomous-driving/bevformer/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>BEV (Bird’s Eye View) 是自动驾驶领域中常见的一种视角，其将车辆周围的环境投影到一个俯视的平面上，以便更好地理解车辆周围的环境。本文通过对 BEVFormer 的学习，来理解 BEV 如何构建及如何使用。</p><p>仅阅读论文可能难以对该方法有全面的认识，之后需要对代码进行阅读以及理解。</p><span id="more"></span><!-- <div class="note note-primary">            <p>Decoder 本质上做的事情：读入 encoder 的输出，输入 “BEGIN”，逐项输出一系列概率向量并指向一个字符。</p>          </div> --><h1>为什么要使用 BEV？</h1><p>BEV 全称是 Bird’s Eye View（鸟瞰视角），实现方法是把原本摄像头 2D 的视角通过算法校正和改变，形成基于上帝视角的俯视图。从本质上来说，BEV算法就是将传感器输入转换到统一的俯视角度下进行处理，是一种特征融合的方法。</p><div style="width:100%;margin:auto"><img src="/autonomous-driving/bevformer/bev.jpeg" class="" title="BEV 示例"></div><p>使用 BEV 有着以下几个优势：</p><ul><li>第一，BEV 视角下的物体，不会出现图像视角下的尺度（scale）和遮挡（occlusion）问题。由于视觉的透视效应，物理世界物体在 2D 图像中很容易受到其他物体遮挡，2D感知只能感知可见的目标，而在BEV空间内，算法可以基于先验知识，对被遮挡的区域进行预测。</li><li>第二，将不同视角在BEV下进行统一表达，能极大方便后续规划和控制任务。主流规划和控制算法，不论上游传感器信息来自什么视角，经过融合之后，都会转换到以自车为中心坐标系中（Vehicle Coordinate System，VCS），对 VCS 来说，最适合的其实就是 BEV 视角，也就是 BEV 感知结果输出的空间是规划和控制任务的标准输入。</li><li>第三，BEV 能够给系统带来巨大的提升。摄像头感知算法工作在 2D 空间，而雷达感知算法工作在 3D 空间，在对 2D 与 3D 几何关系融合过程中，会丢失大量的原始信息，采用 BEV 感知系统中，摄像头、激光雷达、毫米波雷达感知均在 BEV 空间中进行，融合过程提前。BEV还可以引入过去时间片段中的数据，实现时序融合，最终使感知效果更加稳定、准确。</li><li>第四，BEV能够实现端到端优化。感知任务中的识别、跟踪和预测本质是一个串行系统，系统上游误差会传递在下游误差，在 BEV 空间内，感知和预测都在同一个空间进行，可以通过神经网络做到端到端的优化，输出“并行”结果，而整个感知网络可以以数据驱动方式来自学习，实现快速迭代。</li></ul><h1>BEVFormer 架构</h1><div style="width:100%;margin:auto"><img src="/autonomous-driving/bevformer/illustration.png" class="" title="一个示意图"></div><p>BEVFormer 是一个基于 transformer 的模型，用于处理 BEV 空间的感知任务。如图所示，考虑到了空间 Spatial Attention 和时间 Temporal Attention，以及不同传感器的融合。</p><h2 id="模型结构">模型结构</h2><div style="width:100%;margin:auto"><img src="/autonomous-driving/bevformer/architecture.png" class="" title="模型结构"></div><h2 id="特征提取">特征提取</h2><ul><li>模型整体的输入为一个六维的张量：（batch size，连续帧数，每帧图像数，图像高度，图像宽度，通道数）</li><li>Backbone + Neck （ResNet-101-DCN + FPN）提取环视图像的多尺度特征<ul><li>输入为单帧的张量：（batch size，每帧图像数，图像高度，图像宽度，通道数）</li><li>对于 nuSences 数据集来说，每帧图像数为 6。</li><li>输出为：（batch size，每帧图像数，通道数，特征高度/64，特征宽度/64）</li></ul></li></ul><h2 id="Encoder-结构">Encoder 结构</h2><p>首先使用的是一个 Encoder 结构的 Transformer 模型，包括 Temporal Self-Attention 模块和 Spatial Cross-Attention 模块，完成环视图像特征向 BEV 特征的建模。两个模块中都运用到了多尺度的可变形注意力模块（Deformable Attention）用于将全局注意力变为局部注意力，用于减少训练时间。该思想来源于 Deformable DETR。之后再使用 Eecoder 结构来进行下游任务。</p><h3 id="Temporal-Self-Attention-模块">Temporal Self-Attention 模块</h3><p>通过当前时刻的 BEV Query <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 和上一时刻的 BEV 特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">B_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> ，首先对上一时刻的 BEV 特征进行对齐，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>B</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">B_{t-1}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0583em;vertical-align:-0.3064em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3064em;"><span></span></span></span></span></span></span></span></span></span> 是经过对齐后的 BEV 特征。对齐的过程是通过车辆的运动信息进行的，使得相同网格的特征对应到相同的真实世界位置，但是由于物体在真实世界中的运动是不确定的，因此需要通过 Temporal Self-Attention (TSA) 模块来建模特征之间的时序关系。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">TSA</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>Q</mi><mi>p</mi></msub><mo separator="true">,</mo><mrow><mo fence="true">{</mo><mi>Q</mi><mo separator="true">,</mo><msubsup><mi>B</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo fence="true">}</mo></mrow><mo fence="true">)</mo></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>V</mi><mo>∈</mo><mrow><mo fence="true">{</mo><mi>Q</mi><mo separator="true">,</mo><msubsup><mi>B</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo fence="true">}</mo></mrow></mrow></munder><mi mathvariant="normal">DeformAttn</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>Q</mi><mi>p</mi></msub><mo separator="true">,</mo><mi>p</mi><mo separator="true">,</mo><mi>V</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\operatorname{TSA}\left(Q_p,\left\{Q, B_{t-1}^{\prime}\right\}\right)=\sum_{V \in\left\{Q, B_{t-1}^{\prime}\right\}} \operatorname{DeformAttn}\left(Q_p, p, V\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mop"><span class="mord mathrm">TSA</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3053em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.866em;vertical-align:-1.816em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.6365em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="mrel mtight">∈</span><span class="minner mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top:0.075em;"><span class="mtight">{</span></span><span class="mord mathnormal mtight">Q</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7416em;"><span style="top:-2.1885em;margin-left:-0.0502em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.371em;"><span></span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top:0.075em;"><span class="mtight">}</span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.816em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm">DeformAttn</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">Q_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 指 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p=(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> 处的 BEV Query。不同于普通的可变形注意力，时序自注意力中的偏移（offset）<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">\Delta p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">Δ</span><span class="mord mathnormal">p</span></span></span></span> 是由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>B</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">B_{t-1}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0583em;vertical-align:-0.3064em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3064em;"><span></span></span></span></span></span></span></span></span></span> 的拼接预测的。特别地，对于每个序列的第一个样本，时序自注意力将退化为一个没有时序信息的自注意力，其中我们将 BEV 特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">{</mo><mi>Q</mi><mo separator="true">,</mo><msubsup><mi>B</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\left\{Q, B_{t-1}^{\prime}\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3064em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span> 替换为重复的 BEV 查询 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>Q</mi><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{Q, Q\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">}</span></span></span></span>。最后输出的 BEV Query 是对两个 BEV Query 的平均。</p><!-- ```txt各个参数的 shape 情况 1. value: (2，40000，8，32） # 2: 代表前一时刻的 BEV 特征和后一时刻的 BEV 特征，两个特征在计算的过程中是互不干扰的，                             # 40000: 代表 bev_query 200 * 200 空间大小的每个位置                             # 8: 代表8个头，                             # 32: 每个头表示为 32 维的特征2. spatial_shapes: (200, 200) # 方便将归一化的 sampling_locations 反归一化3. level_start_index: 0 # BEV 特征只有一层4. sampling_locations: (2, 40000, 8, 1, 4, 2)5. attention_weights: (2, 40000, 8, 1, 4)6. output: (2, 40000, 8, 32)``` --><h3 id="Spatial-Cross-Attention-模块">Spatial Cross-Attention 模块</h3><p>用于建模空间维度的信息，同样的，由于多头自注意力的计算量较大，因此仍使用可变形注意力模块来减少计算量。Spatial Cross-Attention (SCA) 可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">SCA</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>Q</mi><mi>p</mi></msub><mo separator="true">,</mo><msub><mi>F</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mo fence="true">∣</mo><msub><mi mathvariant="script">V</mi><mtext>hit </mtext></msub><mo fence="true">∣</mo></mrow></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi mathvariant="script">V</mi><mtext>hit </mtext></msub></mrow></munder><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mtext>ref </mtext></msub></munderover><mi mathvariant="normal">DeformAttn</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>Q</mi><mi>p</mi></msub><mo separator="true">,</mo><mi mathvariant="script">P</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msubsup><mi>F</mi><mi>t</mi><mi>i</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{SCA}\left(Q_p, F_t\right)=\frac{1}{\left|\mathcal{V}_{\text {hit }}\right|} \sum_{i \in \mathcal{V}_{\text {hit }}} \sum_{j=1}^{N_{\text {ref }}} \operatorname{DeformAttn}\left(Q_p, \mathcal{P}(p, i, j), F_t^i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop"><span class="mord mathrm">SCA</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.259em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0822em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hit </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0822em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hit </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4002em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8452em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3169em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.109em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ref </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm">DeformAttn</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">V</mi><mtext>hit</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{V}_{\text {hit}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0822em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hit</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是在当前 BEV Query <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">Q_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 中的 2D 点可能命中的相机视角集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">F_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0717em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> 是其中第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个相机视角的特征。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 是参考点的索引，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>ref</mtext></msub></mrow><annotation encoding="application/x-tex">N_{\text {ref}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ref</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是每个 BEV 查询的总参考点数。对于每个 BEV 查询 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">Q_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，我们使用投影函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{P}(p, i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> 从第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个相机视图中获取第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个参考点。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mrow><mo fence="true">(</mo><mi>x</mi><mo>−</mo><mfrac><mi>W</mi><mn>2</mn></mfrac><mo fence="true">)</mo></mrow><mo>×</mo><mi>s</mi><mo separator="true">;</mo><mspace width="1em"/><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mrow><mo fence="true">(</mo><mi>y</mi><mo>−</mo><mfrac><mi>H</mi><mn>2</mn></mfrac><mo fence="true">)</mo></mrow><mo>×</mo><mi>s</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">x^{\prime}=\left(x-\frac{W}{2}\right) \times s ; \quad y^{\prime}=\left(y-\frac{H}{2}\right) \times s,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9963em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mpunct">;</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mpunct">,</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo separator="true">,</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">H, W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> 是 BEV 查询的空间形状，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 是 BEV 网格的分辨率大小，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(x^{\prime}, y^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> 是车辆位置为原点的坐标。在 3D 空间中，位于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(x^{\prime}, y^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> 处的物体将出现在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> 轴上的高度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>z</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">z^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 处。因此，我们预定义一组锚点高度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mrow><mo fence="true">{</mo><msubsup><mi>z</mi><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo fence="true">}</mo></mrow><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mtext>ref </mtext></msub></msubsup></mrow><annotation encoding="application/x-tex">\left\{z_j^{\prime}\right\}_{j=1}^{N_{\text {ref }}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6618em;vertical-align:-0.5806em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0812em;"><span style="top:-2.2555em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.109em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ref </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5806em;"><span></span></span></span></span></span></span></span></span></span>，以便我们可以捕捉出现在不同高度的线索。这样，对于每个查询 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">Q_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，我们获得了一根 3D 参考点柱 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mrow><mo fence="true">(</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msubsup><mi>z</mi><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo fence="true">)</mo></mrow><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mtext>ref </mtext></msub></msubsup></mrow><annotation encoding="application/x-tex">\left(x^{\prime}, y^{\prime}, z_j^{\prime}\right)_{j=1}^{N_{\text {ref }}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6618em;vertical-align:-0.5806em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0812em;"><span style="top:-2.2555em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.109em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ref </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5806em;"><span></span></span></span></span></span></span></span></span></span>。最后，我们通过相机的投影矩阵将 3D 参考点投影到不同的图像视图中。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="script">P</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext> where </mtext><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>⋅</mo><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="left left left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>T</mi><mi>i</mi></msub><mo>⋅</mo><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="left left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>z</mi><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\mathcal{P}(p, i, j) &amp; =\left(x_{i j}, y_{i j}\right) \\\text { where } z_{i j} \cdot\left[\begin{array}{lllll}x_{i j} &amp; y_{i j} &amp; 1\end{array}\right]^T &amp; =T_i \cdot\left[\begin{array}{llll}x^{\prime} &amp; y^{\prime} &amp; z_j^{\prime} &amp; 1\end{array}\right]^T .\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.266em;vertical-align:-1.383em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.883em;"><span style="top:-4.1416em;"><span class="pstrut" style="height:3.0986em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span><span style="top:-2.383em;"><span class="pstrut" style="height:3.0986em;"></span><span class="mord"><span class="mord text"><span class="mord"> where </span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0812em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.383em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.883em;"><span style="top:-4.1416em;"><span class="pstrut" style="height:3.0986em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-2.383em;"><span class="pstrut" style="height:3.0986em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8674em;"><span style="top:-3.0274em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3674em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8674em;"><span style="top:-3.0274em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3674em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8674em;"><span style="top:-3.0274em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3674em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8674em;"><span style="top:-3.0274em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3674em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0986em;"><span style="top:-3.3203em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.383em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>这里，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{P}(p, i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> 是从第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个视图投影的第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个 3D 点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msubsup><mi>z</mi><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(x^{\prime}, y^{\prime}, z_j^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2448em;vertical-align:-0.3948em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span> 的 2D 点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>3</mn><mo>×</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">T_i \in \mathbb{R}^{3 \times 4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">×</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span> 是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个相机的已知投影矩阵。</p><h3 id="前向网络及输出">前向网络及输出</h3><p>Spatial Cross-Attention 模块的输出通过一个前向网络，得到最终的 BEV 特征。该 BEV 特征将作为后续 Decoder 的输入，可以用于完成不同的感知任务。</p><h2 id="下游任务">下游任务</h2><h3 id="目标检测">目标检测</h3><p>需要预测 10 个参数，包括 3 个尺度参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>l</mi><mo separator="true">,</mo><mi>w</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(l,w,h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span>，3 个中心位置参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y,z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span>，2 个旋转参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(cos(θ),sin(θ))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">))</span></span></span></span>，2 个速度参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>x</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>y</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(v_x ,v_y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。参考 Detr3D 中的 Decoder 模块，推理阶段使用 900 个 object queries，并保留 300 个具有最高置信度分数的预测框。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">L_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 损失在训练阶段被使用，对预测值和真值十个维度的差值进行计算。采用 Transformer 中常用的匈牙利匹配算法，Focal Loss + L1 Loss 的总损失和最小。</p><h3 id="全景分割">全景分割</h3><div style="width:50%;margin:auto"><img src="/autonomous-driving/bevformer/segmentation.png" class="" title="分割头结构"></div><p>全景分割的模型结构如上图所示，是一个遮罩分割头，参考 Panoptic SegFormer，用 query 来预测每个像素的类别，并生成 segmentation mask。</p><h1>总结</h1><p>本问介绍了 BEVFormer 的模型结构，主要包括特征提取、Encoder 结构和下游任务。BEV 作为 Query，贯穿了整个 transformer 模型结构，包含了当前的位置信息。这种基于 transformer 的模型结构，构建了 BEV 空间，更好的对应了下游的感知任务，也为进一步规划控制任务提供了更好的输入。</p><h1>Reference</h1><ul><li><a href="https://36kr.com/p/2259709856149378">一文看懂BEVFormer技术及其背后价值</a></li><li>BEVFormer: Learning Bird’s-Eye-View Representation from Multi-Camera Images via Spatiotemporal Transformers</li><li><a href="https://zhuanlan.zhihu.com/p/543335939">万字长文理解纯视觉感知算法 —— BEVFormer - Fangzh的文章 - 知乎</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Autonomous Driving</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>attention</tag>
      
      <tag>transformer</tag>
      
      <tag>autonomous-driving</tag>
      
      <tag>perception</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>从 DETR 出发，目标检测再学习</title>
    <link href="/computer-vision/detr/"/>
    <url>/computer-vision/detr/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>目标检测是 CV 中的一个重要任务，其目标是在图像中找到物体的位置和类别。当然，根据空间维度的不同，目标检测可以分为 2D 目标检测和 3D 目标检测。本文聚焦于 2D 目标检测，主要介绍 DETR 这个基于 transformer 的目标检测模型。</p><span id="more"></span><h1>目标检测任务</h1><h2 id="任务是什么？">任务是什么？</h2><p>目标检测任务，顾名思义，就是在图像中找到物体的位置和类别。通常输入是一张图片，输出是一系列的 bounding box，每个 bounding box 包含一个物体的位置和类别。用符号的语言来说：</p><ul><li>输入：一张图片，可以表示为一个矩阵，维度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(H,W,C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> 为高度，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> 为宽度，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> 为通道数。</li><li>输出：一系列的 bounding box，每个 box 包含一个物体的位置和类别，可以表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>w</mi><mo separator="true">,</mo><mi>h</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y, w, h, c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><ul><li>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> 为 bounding box 的中心坐标，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(w, h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span> 为 bounding box 的宽度和高度，有时又可以转换表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mtext>min</mtext></msub><mo separator="true">,</mo><msub><mi>y</mi><mtext>min</mtext></msub><mo separator="true">,</mo><msub><mi>x</mi><mtext>max</mtext></msub><mo separator="true">,</mo><msub><mi>y</mi><mtext>max</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_{\text{min}}, y_{\text{min}}, x_{\text{max}}, y_{\text{max}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">min</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">min</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 为类别，通常为任务类别数加一（多一个背景类别）。</li></ul></li></ul><h2 id="如何评估？">如何评估？</h2><p>首先在我们的预测任务中，有若干个类别，每一个类别都有若干目标，每一个目标都有一个 bounding box。我们的算法的输出是一个系列的 bounding box 以及某一个类别的置信度。那么评估就需要对比预测和真值的差距。</p><p>一般来说，我们对每一个类别单独考虑。</p><ul><li>首先，我们会使用 IoU（Intersection over Union）来评估两个 bounding box 的重叠程度。IoU 的计算方式为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mtext>Area of Overlap</mtext><mtext>Area of Union</mtext></mfrac></mrow><annotation encoding="application/x-tex">\frac{\text{Area of Overlap}}{\text{Area of Union}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2772em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Area of Union</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Area of Overlap</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，其值在 0 到 1 之间，越大表示重叠程度越高。我们将预测结果按照该类的置信度排序，然后逐个计算 IoU，如果 IoU 大于某个重叠阈值（例如 0.5），我们认为这个预测是正确的。（i.e.，如果我们模型认为某处有一定概率存在某物，这个位置的和真实标记重叠程度越大，那么预测就越正确。）</li><li>那么针对此排序，通过改变预测阈值，就可以计算一系列的 precision 和 recall。<ul><li>其中 precision 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mtext>TP</mtext><mrow><mtext>TP</mtext><mo>+</mo><mtext>FP</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\text{TP}}{\text{TP}+\text{FP}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2757em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">TP</span></span><span class="mbin mtight">+</span><span class="mord text mtight"><span class="mord mtight">FP</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">TP</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>recall 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mtext>TP</mtext><mrow><mtext>TP</mtext><mo>+</mo><mtext>FN</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\text{TP}}{\text{TP}+\text{FN}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2757em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">TP</span></span><span class="mbin mtight">+</span><span class="mord text mtight"><span class="mord mtight">FN</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">TP</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></li><li>这一系列的 precision 和 recall 可以绘制成曲线，称为 PR 曲线，其下方的面积称为 AP（Average Precision）。需要注意的是，如果我们的预测框多于或少于真实框，那么就会出现 FP 或 FN，从而影响 precision 和 recall 的计算。</li><li>之后，我们可以计算所有类别的 AP 的平均值，称为 mAP（mean Average Precision）。</li></ul><p>最终的 mAP 越高，说明我们的模型在目标检测任务上表现越好。</p><h2 id="如何设计误差函数？">如何设计误差函数？</h2><p>目标检测的误差函数通常是一个多任务学习的问题，其包含了两个部分：</p><ul><li>位置误差：通常使用 L1 或者 L2 范数来计算，即预测的 bounding box 和真实的 bounding box 之间的差距。</li><li>分类误差：通常使用交叉熵来计算，即预测的类别和真实的类别之间的差距。</li></ul><p>最终的误差函数是两者的加权和，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi>L</mi><mtext>loc</mtext></msub><mo>+</mo><mi>λ</mi><msub><mi>L</mi><mtext>cls</mtext></msub></mrow><annotation encoding="application/x-tex">L=L_{\text{loc}}+\lambda L_{\text{cls}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">loc</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">λ</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span> 是一个超参数。</p><h1>DETR 模型</h1><div class="note note-primary">            <p>DETR 是第一篇将 Transformer 应用到目标检测方向的算法。</p>          </div><h2 id="模型结构">模型结构</h2><div style="width:100%;margin:auto"><img src="/computer-vision/detr/model.jpg" class="" title="模型架构"></div><h2 id="目标检测前向传导">目标检测前向传导</h2><ul><li>首先原始图片通过骨干网络 CNN 提取特征，输入图片特征为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>m</mi><mi>g</mi></mrow></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>3</mn><mo>×</mo><msup><mi>H</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>×</mo><msup><mi>W</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msup></mrow><annotation encoding="application/x-tex">x_{img} \in \mathbb{R}^{3 \times H&#x27; \times W&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8252em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">im</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9425em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>，输出为降采样 32 倍的特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>C</mi><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f \in \mathbb{R}^{C \times H \times W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> 为通道数。</li><li>之后再通过一个卷积 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 降维，得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>d</mi><mo>×</mo><mo stretchy="false">(</mo><mi>H</mi><mo>×</mo><mi>W</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">z \in \mathbb{R}^{d \times (H \times W)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mbin mtight">×</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>$，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> 为一个更小的通道数。</li><li>之后将其加入位置编码（作为 Q 和 K），便可以作为编码器的输入。</li><li>解码器有两个输入，一个是编码器得到的特征，一个是 object queries，其维度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">N \times d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 为目标的个数（一个事先设置好的超参数，通常远大于实际目标数）。<ul><li>初始层的 self-attention 中使用 object queries 作为 Q 和 K，V，其中</li><li>中间层的多头 cross-attention 中使用编码器得到的特征作为 K 和 V，其中需要将位置编码加入 K。</li><li>Object queries 的作用类似于基于 CNN 的目标检测算法中的 anchor boxes，是一个可以训练的嵌入向量，用于预测目标的位置和类别。具体来说使用了 learnt positional encoding 作为 object queries，以保证每一个 query 可以独特的表示一个物体。</li><li>原始的 object query 也会通过 skip connection 传入每一层解码器的自注意力模块中的 Q 和 K，以及交叉注意力模块中的 Q。</li><li>N 个结果不是顺序得到的，而是一次性得到 N 个结果，这点和原始的 Transformer 的自回归计算是不同的（只做一次输出）。</li><li>每个 object queries 通过预测头预测目标的 bounding box 和类别，其中 bounding box 有三个值，分别是目标的中心点以及宽和高。超过目标个数的 ground truth 使用背景元素来作为负样本。</li></ul></li></ul><div style="width:60%;margin:auto"><img src="/computer-vision/detr/encoder_decoder.jpg" class="" title="编码器解码器结构"></div><h2 id="目标检测损失计算">目标检测损失计算</h2><p>得到预测结果以后，将 object predictions 和 ground truth box 之间通过匈牙利算法进行二分匹配。注意，匈牙利算法是用于解决二分图匹配的问题，即将 ground truth 的 K 个 bbox 和预测出的 100 个 bbox 作为二分图的两个集合，匈牙利算法的目标就是找到最大匹配，即在二分图中最多能找到多少条没有公共端点的边。匈牙利算法的输入就是每条边的 cost 矩阵假如有 K 个目标，那么 100 个 object predictions 中就会有 K 个能够匹配到这 K 个 ground truth，其他的都会和 “no object” 匹配成功，使其在理论上每个 object query 都有唯一匹配的目标，不会存在重叠。</p><p>Bounding box 和 ground truth 的匹配代价表示为:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>match </mtext></msub><mo>=</mo><mo>−</mo><msub><mn>1</mn><mrow><mo fence="true">{</mo><msub><mi>c</mi><mi>i</mi></msub><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∅</mi><mo fence="true">}</mo></mrow></msub><msub><mover accent="true"><mi>p</mi><mo>^</mo></mover><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mn>1</mn><mrow><mo fence="true">{</mo><msub><mi>c</mi><mi>i</mi></msub><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∅</mi><mo fence="true">}</mo></mrow></msub><msub><mi mathvariant="script">L</mi><mtext>box </mtext></msub><mrow><mo fence="true">(</mo><msub><mi>b</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {match }}=-1_{\left\{c_i \neq \varnothing\right\}} \hat{p}_{\sigma(i)}\left(c_i\right)+1_{\left\{c_i \neq \varnothing\right\}} \mathcal{L}_{\text {box }}\left(b_i, \hat{b}_{\sigma(i)}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">match </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord">−</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">{</span></span><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord amsrm mtight">∅</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">}</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">{</span></span><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord amsrm mtight">∅</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">}</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">box </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mn>1</mn><mrow><mo fence="true">{</mo><msub><mi>c</mi><mi>i</mi></msub><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∅</mi><mo fence="true">}</mo></mrow></msub></mrow><annotation encoding="application/x-tex">1_{\left\{c_i \neq \varnothing\right\}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9996em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">{</span></span><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord amsrm mtight">∅</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">}</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span> 是一个 bool 函数，当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">c_i \neq \varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6633em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span></span></span></span> 时为 1 ，否则为 0 。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个物体的类别标签。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> 是与第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个目标匹配的 bounding box 的 index。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>p</mi><mo>^</mo></mover><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{p}_{\sigma(i)}\left(c_i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> 表示DETR预测的第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> 个预测的 bounding box 的类别为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的概率。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\hat{b}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1079em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分别是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个目标的位置的ground truth的坐标 （中心点，宽，高）和预测的 bounding box 的坐标。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>box </mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {box }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">box </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是两个矩形框之间的距离，下面我们详细介绍它。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>box </mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {box }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">box </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 由 loU 损失和 L1 损失构成，它们通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mtext>iou </mtext></msub></mrow><annotation encoding="application/x-tex">\lambda_{\text {iou }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">iou </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi mathvariant="normal">L</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{\mathrm{L} 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">L</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 来控制两个损失的权值，表示为：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>box </mtext></msub><mrow><mo fence="true">(</mo><msub><mi>b</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><msub><mi>λ</mi><mtext>iou </mtext></msub><msub><mi mathvariant="script">L</mi><mtext>iou </mtext></msub><mrow><mo fence="true">(</mo><msub><mi>b</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>λ</mi><mrow><mi mathvariant="normal">L</mi><mn>1</mn></mrow></msub><msub><mrow><mo fence="true">∥</mo><msub><mi>b</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo>−</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence="true">∥</mo></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {box }}\left(b_{\sigma(i)}, \hat{b}_i\right)=\lambda_{\text {iou }} \mathcal{L}_{\text {iou }}\left(b_{\sigma(i)}, \hat{b}_i\right)+\lambda_{\mathrm{L} 1}\left\|b_{\sigma(i)}-\hat{b}_i\right\|_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">box </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">iou </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">iou </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.8497em;vertical-align:-0.6997em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">L</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.556em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.800em' viewBox='0 0 556 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43zM367 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.556em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.800em' viewBox='0 0 556 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43zM367 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.2486em;"><span style="top:-2.0003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6997em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>iou </mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {iou }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">iou </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 使用的是 GloU 损失，考虑了两个检测框最小外接矩形的大小（反应两者如何相交），表示为：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>iou </mtext></msub><mrow><mo fence="true">(</mo><msub><mi>b</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mo fence="true">∣</mo><msub><mi>b</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo>∩</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence="true">∣</mo></mrow><mrow><mo fence="true">∣</mo><msub><mi>b</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo>∪</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence="true">∣</mo></mrow></mfrac><mo>−</mo><mfrac><mrow><mo fence="true">∣</mo><mi>B</mi><mrow><mo fence="true">(</mo><msub><mi>b</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">\</mi><msub><mi>b</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo>∪</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence="true">∣</mo></mrow><mrow><mo fence="true">∣</mo><mi>B</mi><mrow><mo fence="true">(</mo><msub><mi>b</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {iou }}\left(b_{\sigma(i)}, \hat{b}_i\right)=1-\left(\frac{\left|b_{\sigma(i)} \cap \hat{b}_i\right|}{\left|b_{\sigma(i)} \cup \hat{b}_i\right|}-\frac{\left|B\left(b_{\sigma(i)}, \hat{b}_i\right) \backslash b_{\sigma(i)} \cup \hat{b}_i\right|}{\left|B\left(b_{\sigma(i)}, \hat{b}_i\right)\right|}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">iou </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.88em;vertical-align:-1.69em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.875em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='3.600em' viewBox='0 0 875 3600'><path d='M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189l0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.19em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.19em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">\</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.875em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='3.600em' viewBox='0 0 875 3600'><path d='M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558l0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>当我们通过上面的策略得到 ground truth 和预测 bounding box 的最优二部图匹配后，便可以根据匹配的结果计算损失函数了。DETR 的损失函数和匹配代价非常类似，不同的是它的类别预测使用的是对数似然，表示为式。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>Hungarian</mtext></msub><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mo fence="true">[</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mover accent="true"><mi>p</mi><mo>^</mo></mover><mrow><mover accent="true"><mi>σ</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mn>1</mn><mrow><mo fence="true">{</mo><msub><mi>c</mi><mi>i</mi></msub><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∅</mi><mo fence="true">}</mo></mrow></msub><msub><mi mathvariant="script">L</mi><mtext>box </mtext></msub><mrow><mo fence="true">(</mo><msub><mi>b</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mover accent="true"><mi>σ</mi><mo>^</mo></mover></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {Hungarian}}(y, \hat{y})=\sum_{i=1}^N\left[-\log \hat{p}_{\hat{\sigma}(i)}\left(c_i\right)+1_{\left\{c_i \neq \varnothing\right\}} \mathcal{L}_{\text {box }}\left(b_i, \hat{b}_{\hat{\sigma}}(i)\right)\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Hungarian</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord mtight">^</span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">{</span></span><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord amsrm mtight">∅</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">}</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">box </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span></span></span></span></span></p><p>它们另外一个不同是 bool 函数作用的位置不同，在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>match</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {match}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">match</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中背景目标不参与匹配代价的计算， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>Hungarian</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {Hungarian}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Hungarian</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 则也要计算背景目标的分类损失。</p><h2 id="全景分割前向传导">全景分割前向传导</h2><p>全景分割是继语义分割和实例分割之后的另一个更难的分割任务，它需要给图像中的每个像素点分配一个语义标签和一个实例 id。其中语义标签是物体的类别，实例 id 是每个不同物体对应的编号。</p><div style="width:60%;margin:auto"><img src="/computer-vision/detr/segmentation.jpg" class="" title="分割头"></div><p>在 DETR 中，它将全景分割任务分成 N 个在每个 bounding box 上的两个类别的分割任务，相比于目标检测，主要的区别在于模型的输出头。首先通过 CNN（残差网络）将图像编码降采样的 Feature Map，然后通过一组多头自注意力将 Feature Map 和 bounding box 的位置编码信息作为输入得到 N 个小尺寸的Attention Maps（类似之前的步骤）。再通过一组类似 FPN 的架构将图像上采样的原图的 1/4，得到 N 个mask logits，最后通过按像素点取 softmax 得到最终的分割效果。</p><h2 id="全景分割损失计算">全景分割损失计算</h2><p>骰子损失（DICE Loss）是在 V-Net 中提出的类似于 loU 损失的专门用于分割任务的损失函数，它的主要应用场景是分割任务中类别不平衡的问题。DICE 损失来自于 DICE 系数（DICE coefficient），它是一个集合相似度的衡量函数, 通常用来计算两个样本的相似度。</p><p>DETR的分割任务使用的损失函数表示为,</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>DICE </mtext></msub><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mover accent="true"><mi>m</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mn>2</mn><mi>m</mi><mi>σ</mi><mo stretchy="false">(</mo><mover accent="true"><mi>m</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><mrow><mi>σ</mi><mo stretchy="false">(</mo><mover accent="true"><mi>m</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mi>m</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {DICE }}(m, \hat{m})=1-\frac{2 m \sigma(\hat{m})+1}{\sigma(\hat{m})+m+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">DICE </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">m</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">m</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">mσ</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">m</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span> 是 sigmoid 激活函数。此项损失可以理解为某种 IoU，即预测的 mask 和真实的 mask 之间的重叠程度。此项损失会根据目标数进行归一化。</p><h1>总结</h1><p>本文是一个完整的目标检测任务及 DETR 模型介绍。之后的很多 2/3D 目标检测工作都是在此模型基础上进行的。基于 transformer 的目标检测模型是值得深入研究的方向。</p><h1>Reference</h1><ol><li><a href="https://medium.com/lifes-a-struggle/mean-average-precision-map-%E8%A9%95%E4%BC%B0%E7%89%A9%E9%AB%94%E5%81%B5%E6%B8%AC%E6%A8%A1%E5%9E%8B%E5%A5%BD%E5%A3%9E%E7%9A%84%E6%8C%87%E6%A8%99-70a2d2872eb0">mean Average Precision (mAP) </a></li><li><a href="https://zhuanlan.zhihu.com/p/387102036">Transformer目标检测之DETR</a></li><li>Carion, Nicolas, et al. “End-to-end object detection with transformers.” European conference on computer vision. Cham: Springer International Publishing, 2020.</li></ol>]]></content>
    
    
    <categories>
      
      <category>Autonomous Driving</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>attention</tag>
      
      <tag>transformer</tag>
      
      <tag>autonomous-driving</tag>
      
      <tag>perception</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sora 技术报告，阅读与思考</title>
    <link href="/machine-learning/sora/"/>
    <url>/machine-learning/sora/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>今日震撼于 OpenAI 视频生成模型 Sora 的产出效果，在此对技术报告进行阅读学习。在文末我也会加入一些自己的看法。</p><span id="more"></span><h2 id="Sora-生成效果">Sora 生成效果</h2><p>被生成的效果所震撼，尤其是视频 3 中列车通过阴影时车窗反射出的倒影。</p><p><video width="80%" height="80%"  src="https://cdn.openai.com/tmp/s/title_0.mp4"  autoplay controls loop></video><video width="80%" height="80%"  src="https://cdn.openai.com/sora/videos/closeup-of-womans-eye.mp4"  autoplay controls loop></video><video width="80%" height="80%"  src="https://cdn.openai.com/sora/videos/train-window.mp4"  autoplay controls loop></video></p><h2 id="技术报告内容">技术报告内容</h2><blockquote><p>This technical report focuses on (1) our method for turning visual data of all types into a unified representation that enables large-scale training of generative models, and (2) qualitative evaluation of Sora’s capabilities and limitations. Model and implementation details are not included in this report.</p></blockquote><p>首先指出报告主要由两部分组成，第一部分是将各种类型的视觉数据转换为统一的表示，以便大规模训练生成模型。第二部分是对 Sora 的能力和局限性进行定性评估。模型和实现细节不包括在此报告中。</p><blockquote><p>Sora is a generalist model of visual data—it can generate videos and images spanning diverse durations, aspect ratios and resolutions, up to a full minute of high definition video.</p></blockquote><p>首先指出先前模型的缺点，引出了 Sora，它可以生成各种长度、分辨率、比例的视频。主要有以下几个关键步骤。</p><h3 id="1-Turning-visual-data-into-patches">1. Turning visual data into patches</h3><p>同样是使用大模型，在互联网级别的数据上进行训练。受到语言模型对于 token 操作的启发，Sora 将视觉数据转换为补丁（patches）。</p><div style="width:100%;margin:auto"><img src="/machine-learning/sora/figure-patches.png" class=""></div><p>宏观来看，先将视频压缩到低维空间，然后再将其解码到时空补丁（spacetime patches）。</p><h3 id="2-Video-compression-network">2. Video compression network</h3><p>训练一个 1 中提到的将原始视频降维的神经网络。</p><blockquote><p>This network takes raw video as input and outputs a latent representation that is compressed both temporally and spatially.</p></blockquote><p>其中时间和空间信息同被压缩。</p><blockquote><p>Sora is trained on and subsequently generates videos within this compressed latent space.</p></blockquote><p>Sora 之后的生成过程都在这个压缩的潜在空间中进行。</p><blockquote><p>We also train a corresponding decoder model that maps generated latents back to pixel space.</p></blockquote><p>同样的，训练一个解码器，将潜在空间的数据映射回像素空间。</p><h3 id="3-Spacetime-Latent-Patches">3. Spacetime Latent Patches</h3><blockquote><p>Given a compressed input video, we extract a sequence of spacetime patches which act as transformer tokens. This scheme works for images too since images are just videos with a single frame.</p></blockquote><p>这些 patches 在训练时被当作 transformer 的 token 进行处理。视频和图像有着相同的处理方式。</p><blockquote><p>Our patch-based representation enables Sora to train on videos and images of variable resolutions, durations and aspect ratios.</p></blockquote><p>这种表示方式使得 Sora 可以在不同分辨率、持续时间和宽高比的视频和图像上进行训练。</p><blockquote><p>At inference time, we can control the size of generated videos by arranging randomly-initialized patches in an appropriately-sized grid.</p></blockquote><p>在推理时，可以通过将随机初始化的补丁排列在适当大小的网格中来控制生成的视频的大小。</p><h3 id="4-Scaling-transformers-for-video-generation">4. Scaling transformers for video generation</h3><blockquote><p>Sora is a diffusion model; given input noisy patches (and conditioning information like text prompts), it’s trained to predict the original “clean” patches.Importantly, Sora is a <strong>diffusion transformer</strong>.</p></blockquote><p>Sola 是一个 <strong>diffusion transformer</strong>，它通过输入噪声补丁（和文本提示等条件信息），训练来预测原始的“干净”补丁。</p><div style="width:100%;margin:auto"><img src="/machine-learning/sora/figure-diffusion.png" class=""></div><blockquote><p>In this work, we find that diffusion transformers scale effectively as video models as well. Below, we show a comparison of video samples with fixed seeds and inputs as training progresses. Sample quality improves markedly as training compute increases.</p></blockquote><p>在这项工作中，我们发现 diffusion transformer 在视频模型中也能有效扩展。随着训练计算量的增加，样本质量显著提高。</p><h3 id="5-Variable-durations-resolutions-aspect-ratios">5. Variable durations, resolutions, aspect ratios</h3><blockquote><p>Past approaches to image and video generation typically resize, crop or trim videos to a standard size – e.g., 4 second videos at 256x256 resolution. We find that instead training on data at its native size provides several benefits.</p></blockquote><p>之前的方法都会将视频调整到标准大小，例如 4 秒的视频，分辨率为 256x256。但我们发现，训练原始大小的数据提供了几个好处。</p><ol><li>采样的灵活性：从 1920<em>1080 到 1080</em>1920 中的任意尺寸。</li><li>构图上的提升：不容易出现主体仅部分存在于画面的情况。</li></ol><h3 id="6-Language-understanding">6. Language understanding</h3><blockquote><p>Training text-to-video generation systems requires a large amount of videos with corresponding text captions. We apply the re-captioning technique introduced in DALL·E 330 to videos.</p></blockquote><p>将 DALL·E 330 中的重新标注技术应用到视频中。</p><blockquote><p>We first train a highly descriptive captioner model and then use it to produce text captions for all videos in our training set.</p></blockquote><p>先训练一个描述模型对所有视频进行描述。</p><blockquote><p>We find that training on highly descriptive video captions improves text fidelity as well as the overall quality of videos.Similar to DALL·E 3, we also leverage GPT to turn short user prompts into longer detailed captions that are sent to the video model.</p></blockquote><p>同样使用 GPT 将短提示转换为详细的描述。</p><h3 id="7-Prompting-with-images-and-videos">7. Prompting with images and videos</h3><blockquote><p>Sora can also be prompted with other inputs, such as pre-existing images or video.This capability enables Sora to perform a wide range of image and video editing tasks—creating perfectly looping video, animating static images, extending videos forwards or backwards in time, etc.</p></blockquote><p>同样可以使用照片以及视频作为提示，这使得 Sora 可以执行各种图像和视频编辑任务。</p><h3 id="8-Image-generation-capabilities">8. Image generation capabilities</h3><blockquote><p>The model can generate images of variable sizes—up to 2048x2048 resolution.</p></blockquote><p>模型可以生成不同尺寸的图像，最高分辨率为 2048x2048。</p><h3 id="9-Emerging-simulation-capabilities">9. Emerging simulation capabilities</h3><blockquote><p>We find that video models exhibit a number of interesting emergent capabilities when trained at scale. These capabilities enable Sora to simulate some aspects of people, animals and environments from the physical world.</p></blockquote><p>我们发现，当大规模训练视频模型时，会出现一些有趣的新能力。这些能力使得 Sora 可以模拟一些来自物理世界的人、动物和环境的一些方面。</p><ol><li>3D consistency：在摄像机移动时，模型能够保持物体的一致性。</li><li>Long-range coherence and object permanence：即使物体被遮挡或者离开了屏幕，模型也能够保留它的存在。</li><li>Interacting with the world：视频中具体的交互行为会留下痕迹，比如画痕和咬痕。</li><li>Simulating digital worlds：比如我的世界中的玩家行为视频。</li></ol><h2 id="个人感想">个人感想</h2><p>总的来说，在语言模型之外，再一次证明了堆数据量的可靠性。那么在大规模数据下，工程上如何设计任务便成了重中之重。从当下表现的角度，同时考虑到未来一段时间可能的飞速进展，我有着以下几个问题，以及一些自己的看法。</p><h3 id="从大量的训练视频中到底学到了什么信息？">从大量的训练视频中到底学到了什么信息？</h3><p>首先不必多言的就是 low-level 的表征信息，即“如何读视频”。在海量的数据输入下，类似于 LLM，Sora 已经可以学到视频的统计信息。</p><p>但更重要的，我认为是 high-level 的信息，即“视频中那些不言而喻的正确事实”。浅层一些就是“石头是硬的”，“玻璃是脆的”，“河是流动的”，“船是浮着的”。深层一些就是，在视觉下，所有的宏观物理定律都投影在了二维平面上。这也是为什么在生成的视频中，基本上都满足物理规律以及几何原理。个人觉得如果将这个手段用于科学模拟以及发现会比较有意思。</p><h3 id="于-2D-相比我们是否需要-3D？">于 2D 相比我们是否需要 3D？</h3><p>这就引出了第二个问题，作为人而言，我们接触的世界是三维的，但是我们的视觉输入是二维的。初看 Sora 的时候，我还以为他会进行一些三维的推断，但是实际上并没有。这也许是因为 2D 的信息已经足够了，或者说 2D 的信息已经包含了 3D 的信息。这个也和特斯拉的纯视觉方案有些类似，其并未使用激光雷达三维点云。所以我们还需要 3D 吗？</p><p>这个问题或许可以拆成：</p><ol><li>在哪里我们一定需要 3D 以及为什么？（如果我们绝大多数的输入是以 2D 呈现的话）</li><li>如果有一定需要 3D 的场景，2D 训练数据生成的方式是否可以？（目前已经产生了良好的透视关系）</li></ol><h3 id="相比于图像，视频有着什么优势？应用场景在哪里？">相比于图像，视频有着什么优势？应用场景在哪里？</h3><p>图像就是单帧的视频。个人作为摄影爱好者一直在思考这个问题，目前仍没有明确的答案。或许之后可以新开一篇文章，可能会形而上一些。</p><p>但是从 Sora 的角度来看，它似乎第一次证明了视频的生成质量。可以用于之前大部分使用图像进行宣传的地方，比如广告、电商、游戏等。其还可以用于影视行业起到一些降本增效的辅助作用，比如特效、动画等。那么之外呢？如果说视频的生产成本降低了，那是不是视频会越来越多呢？换句话说是否会有更广阔的视频呈现空间（而不是其他空间）来冲刷大家的有限的空闲时间呢？</p><h1>Reference</h1><ul><li><a href="https://openai.com/research/video-generation-models-as-world-simulators">Video generation models as world simulators</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>diffusion</tag>
      
      <tag>video</tag>
      
      <tag>generative-model</tag>
      
      <tag>OpenAI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《特权和寻租的经济学》读书笔记</title>
    <link href="/reading-note/special-privilege-and-rent-seeking/"/>
    <url>/reading-note/special-privilege-and-rent-seeking/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>戈登·图洛克</p><span id="more"></span><h2 id="读书心得">读书心得</h2><h3 id="极简评价">极简评价</h3><p>内容上讲，或许这是一本有深度的书。但是从陈述的角度讲，这不是一本好书，更像是一本论文集。如果没有足够的知识储备，很难读懂这本书。在关联性以及条理性包括前续内容的介绍上，本书都有所欠缺。</p><h3 id="感想看法">感想看法</h3><ul><li>单纯让我想起之前人大代表关于“喝牛奶”的提案。</li><li>这本书读的好困难，经济学的基础较差，同时对美国政治并不太了解。</li><li>豆瓣上此书的评论甚少，不多的几条还是十几年前，讲国企讲腐败。有趣。</li><li>感觉很多东西没有讲清楚，本书讲的其实是“租出”“特权”，出租者通常是政府官员，租客通常是利益集团。寻租指的是租客找“出租特权”的过程。</li></ul><h2 id="内容摘录">内容摘录</h2><h3 id="悖论图洛克">悖论图洛克</h3><ul><li>无论其职位的高低，官僚只对他所面临的奖励和处罚作出反应。</li><li>世界上有很多类学者，有些学者擅长回答问题，有些学者则善于提出问题，图洛克显然属于后者。所以，对于读者而言，本书的意义不在于对寻租进行总结性分析，而是提出了一些有待于进一步研究的问题。</li></ul><h3 id="为何寻租业规模如此小">为何寻租业规模如此小</h3><ul><li>寻租的实际成本基本上是由选民直接承担的。</li><li>普通的投票者经常不知情，但却对丑闻很感性趣。</li><li>阻碍经济发展的寻租业的规模比其实际产生的影响看上去小的多。</li></ul><h3 id="关于寻租的随想">关于寻租的随想</h3><ul><li>苏联人在科学研究上的投入比美国更多，但因为他们是中央计划体制，所以取得的进展很小。在那里，这意味着，实验室中所有最聪明的人都在钻中央计划体制的空子，而只有第二层的人在从事实际研究。</li><li>寻租本身浪费了资源，寻租所产生的制度本身也有成本。</li><li>寻租的定义：利用资源为某些人谋取租金，并给社会带来了负的价值。</li><li>由此我得出结论，中国与韩国之所以这么穷的最根本原因是，这种体制使得经济进步很难发生，尽管它们拥有高素质的人和辉煌的历史。当时，我感到难以解释这种现象，但现在我认为可以用寻租理论来解释。</li><li>需要强调的是，寻租的减少并不是因为我们发现了什么神奇的方法，仅仅是因为政府的规模相对变小了。</li></ul><h2 id="豆瓣书评">豆瓣书评</h2><ul><li>小明家是卖臭豆腐的，每月收入5万块，因为老婆生了孩子开销增加，想要增加每个月2万的收入。这个时候，他想到了两个主意。一个是去隔壁街区再开一个臭豆腐摊。第二个是收买城管，把附近所有的臭豆腐店或者臭豆腐摊都赶走。这样他不仅可以增加销量，还可以提价，因为产生了垄断。最后扣除给城管的费用，也可以增加每个月2万的收入，而且还风险小，于是他决定采用第一种。第一种方案叫寻利。在个人获利的同时，社会总财富是增加的。第二种方案叫寻租。个人的获利是对他人利益的转移，而且对社会总财富是负效应。（臭豆腐提价对消费者有害，而且有人因为贵了，可能就不买了。）</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>economy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《有限与无限的游戏》读书笔记</title>
    <link href="/reading-note/finite-and-infinite-games/"/>
    <url>/reading-note/finite-and-infinite-games/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>詹姆斯·卡斯，于 1987 年写作。</p><span id="more"></span><h2 id="读书心得">读书心得</h2><h3 id="极简评价">极简评价</h3><p>个人认为本书的后半段过于形而上了。不过总体提出的论点“要玩无限的游戏”还比较有趣。但作者似乎也没有给出一个具体的无限游戏的例子，所以让我觉得本书还是有些模糊。当然，可能作者的主要目的还是引人对于有限游戏局限性的思考。</p><h3 id="感想看法">感想看法</h3><ul><li>有限游戏者的隐瞒行为，让我想到了 ray 的保持透明和开放。</li><li>每一局德州扑克就是一个典型的有限游戏。当然似乎一切有具体规则的游戏都是有限游戏。</li><li>没有读懂为什么讲有限和无限游戏会牵扯到性上。同时到后面其实不太懂为何和自然扯上关系。</li><li>人被机器所控制这一说法很有趣，让我想起之前某处看到的，网络上的输入框是一种让人填写正确答案的算法。此外也类似于动物园中猴看人的叙述。</li><li>感觉作者从“有限和无限”出发，上升到了自然、社会、神话、意识形态，过于跳脱，我没有太看懂之间的关联。</li><li>有限和无限可能本质在于是由世俗标准评价还是以内心好恶评价。如果自己的感受为准，而不是以获得外界标签为目标，那么便是无限游戏了。</li></ul><h2 id="内容摘录">内容摘录</h2><h3 id="第一章-世上至少有两种游戏">第一章 世上至少有两种游戏</h3><ul><li>有限游戏以取胜为目的，而无限游戏以延续游戏为目的。</li><li>所有有限游戏的关键在于，参与者对这些规则的认同使得这些规则最终生效。</li><li>如果某一规则是某个有限游戏特有的，那么在这个游戏进行期间，这些规则就不会改变，否则进行的就是另一个不同的游戏了。</li><li>无限游戏的规则必须在进行过程中改变。</li><li>语言的规则，或曰语法，总是不断发展的，以确保话语有意义，而辩论的规则必须保持不变。</li><li>有限游戏参与者在界限内游戏，无限游戏参与者与界限游戏。</li><li>有限游戏的所有限制都是自我限制。</li><li>有限游戏参与者拥有可随时离开赛场的自由，但实际上却必须留在斗争中。为了弥合这之间的鸿沟，我们可以说，有限游戏参与者在某种程度上自己遮蔽了自己的这种自由。</li><li>由于有限游戏旨在达成一个结果，由于它的角色已经写好，并且是在为观众表演，因此我们应该把有限游戏看作演戏似的。虽然剧本和情节似乎并非事先写好，但我们总能回首成功路，发现胜利者显然知道如何行动以及说些什么。</li><li>惊奇导致有限游戏终止，而它是无限游戏继续的原因。</li><li>由于有限游戏参与者受到的训练就是要防止未来改变过去，因此，他们必须隐瞒自己未来的举动，必须要让毫无准备的对手措手不及。有限游戏参与者必须表现成为其他人，而不是自己。</li><li>有限游戏参与者的所有举动都必须有欺骗性：声东击西、分散注意力、弄虚作假、误导、令人困惑。</li><li>由于无限游戏参与者准备好接受未来的惊奇，因此他们以完全开放的心态进行游戏。这里的开放并非指坦率，而是开放自己的弱点。这并不是暴露自己不变的个性—一如既往的真实自我，而是暴露自己不断的成长—有待成为的动态自我。</li><li>教育揭示出过去的越来越丰富的东西，因为它发现了过去未完成的事物，训练将过去视为已结束的时间，将未来视为将结束的时间；教育引导人走向不断的自我发现，训练引导人走向最终的自我定义。</li><li>人们在有限游戏中赢得的是头衔。</li><li>验证头衔并确保它们的永久识别，是社会的一项主要职能。</li><li>无限游戏参与者的生和死都是为了延续他人的生命</li><li>如果在游戏开始之前，一个人就拥有足够的权利赢得游戏，那么接下来发生的根本不是游戏</li><li>有限游戏的所有限制都是自我限制</li></ul><h3 id="第二章-没人能独自玩游戏">第二章 没人能独自玩游戏</h3><ul><li>因此，每一个社会最深刻最主要的斗争并不是与其他社会的斗争，而是与存在于它内部的文化的斗争—文化即是它本身。与其他社会的冲突，实际上是一个社会限制其自身文化极有效的手段。大权在握的社会并不是为了投入战争而让它们的创造者闭嘴，相反，投人战争正是让创造者沉默的一种手段。</li><li>这些博物馆的创立初衷并不是保护艺术品免于遭受人民破坏，而是使人民免于接触艺术。</li><li>这就是为什么爱国主义—一指的是意欲通过增强一个社会的权力来保护社会中的权力——在本质上是好战的。由于没有社会就没有奖励，没有敌人就没有社会，在我们能够需要从爱图者那里得到保护之前，爱国者首先必须创造出敌人来。只有在边界明确、充满敌意和危险的地方，爱国主义才繁盛不息。因此，爱国主义的精神是与军事或其他国际冲突形式典型地联系在一起的。</li><li>无限游戏参与者的每一步都是朝向视界的进发，有限游的多与者的每一步都是在这界之内的。因此，无限游戏的每一个瞬同都提供了一个新的视域和一系列新的可能性。</li><li>由于文化并不是人们单打独斗完成的，而是他们相互携手所成就的。我们可以说文化的诞生是在人们决定成为一群人民的时候。作为一群人民，人们对规范、道德和交流方式相互达成一致。</li><li>文化有时会遭到反对，它的思想、作品甚至语言都被压制。这是社会害怕文化在它边界内蔓延而采用的常见策略。但是，这是一种必然要失败的策略，因为它将创造性活动（poiesis）混淆为创造性活动的制成品（poiema）。</li><li>国家只能以国家作为仇敌，不能以人民为仇敌。“有时候，不杀害对方的任何一个成员也可以消灭一个国家。战争决不能产生不是战争的目的所必需的任何权利。”（卢梭）</li></ul><h3 id="第三章-我是自己的天才">第三章 我是自己的天才</h3><ul><li>一个能说话的机器人，和你说话时，并不是在向你说话。</li><li>就像你不可能行动你的行动一样，你也不可能思考你的思想。</li><li>原创性地言谈、行动或者思考，就是消除自我的边界，远离有疆域的人格特质。</li><li>这并不意味着，我能够看到你所看到的。恰恰相反，正因为我看不到你所看到的，我才去看。</li><li>不允许过去的成为过去，也许是有限游戏的参与者之所以那么严肃的最主要原因。只要有限游戏的参与者还有观众，游戏参与者们就希望观众能知道谁是获胜者。换句话说，有限游戏的参与者但凡还有一个观众，他们就希望这个观众是深深人戏的。</li><li>我们越是负面评价自己，就越是要扭转别人对我们的负面评价。</li><li>结果便是将矛盾推进到最高潮：通过证明观众们是错的，我们证明了他们是对的。</li><li>性吸引力，或者说性感，只有当因为某些人被冒犯到，才是有效的。色情文学之所以令人兴奋，就在于它揭示了某些被禁止的、不可见的东西。因此，在其中有着强制性的敌意，带有震动与暴力的性质。</li><li>有限的性，是一种剧本形式，人和人之间的距离经常被缩减到几乎为零，但是双方都没有被触动到。</li><li>在家庭中习得的不满模式在社会这个更大的剧本中得到表演。社会是我们向作为观众的父母证明自己的地方，证明自己并不是我们所认为的他们眼中的我们。</li><li>由于这一关系中所强调的并不是父母眼中的我们，而是我们所认为的父母眼中的我们，所以身为观众的他们，是超越他们的物理存在或者死亡的。而且出于同样的原因，他们也成了这样一种观众：我们永远不可能赢得他们的绝对赞誉。</li><li>由于对于想象中的观众极度敏感，所以文明很容易被其他文明所冒犯，所激怒。即便是最强大的社会也会被最弱小的社会弄得难堪：阿富汗之于苏联，阿根廷之于英国，格林纳达之于美国。</li><li>在做爱中尝试新鲜—新体位、使用药物、特殊的环境、加入新的性伴侣—只是对新瞬间的一种追求，这些曾经的瞬间只能永远活在回忆中。</li><li>有限的性的胜利，在于从游戏中解放，回归身体。无限的性的核心，在于与身体一起，解放为一种游戏。在有限的性中，我希望作为身体与你产生关联，而在无限的性中，我希望在你的身体里，与你产生关联。</li></ul><h3 id="第四章-发生在世界中的有限游戏">第四章 发生在世界中的有限游戏</h3><ul><li>有限游戏的结果，是等待着开始的过去。为某个结果而拼搏的参与者，都想要一个特有的过去。通过为未来的奖品而竞争，有限游戏的参与者争抢着一个得到奖励的过去。</li><li>无限游戏的参与者开始工作，并不是为了将一段时间用工作来填充，而是为了将一段工作用时间来填满。工作不是无限游戏的参与者打发时间的方式，而是产生各种可能性的方式。</li></ul><h3 id="第五章-自然是不能言说者的王国">第五章 自然是不能言说者的王国</h3><ul><li>因此，知识就像财产。它必须被出版、宣布，或者以启发的方式显现，使其他人不得不对它予以重视。它必须挡在别人的路上，它必须是标志性的，回指着占有知识者的竞争技能。</li></ul><h3 id="第六章-我们出于社会原因而控制自然">第六章 我们出于社会原因而控制自然</h3><ul><li>我们与自然的关系中存在着一个矛盾：我们越是勇猛精进地推进自然与我们自己计划的一致，我们就越是受制于它的无动于衷，面对它不可见的力量就越是脆弱。我们对于自然过程施加越多的强力，我们在它面前就变得越无力。</li><li>正如机器可以被认为是工人延长了的手和腿，工人也可以被认为是机器的延伸。所有的机器，特别是非常复杂的机器，都需要操作者将自身置于被提供的特定地点，机械性地工作以适应机器的功能。人为了控制而使用机器，却被机器所控制。</li><li>真正的旅行没有目的地。旅行者并不是去某个地方，而是时刻发现他们就身处另外的地方。</li></ul><h3 id="第七章-神话激发解释，但不接受任何解释">第七章 神话激发解释，但不接受任何解释</h3><ul><li>实际上，一种文化的活力，不取决于这些思想家发现知识新大陆的频率，而取决于他们启程寻找它们的频率。</li><li>当故事被重新讲述，并只为它自身而得到世世代代的重新讲述时，它便获得了神话的地位。</li><li>世界上有且只有一种无限游戏。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>philosophy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《我将宇宙随身携带—佩索阿诗集》读后感</title>
    <link href="/reading-note/carry-the-universe/"/>
    <url>/reading-note/carry-the-universe/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>作者，葡萄牙籍诗人，费尔南多·佩索阿。</p><p>这是一本因为书名而买的诗集，断断续续读完，并不记得哪些具体的诗，但记住了一种感觉。</p><span id="more"></span><h2 id="读后感">读后感</h2><p>这本书里的诗描述的客体种类繁多，有花花草草、各种动物、自然宇宙。但是有意思的一点在于，其描述都是以一种“客观”的方式进行。绝大多数诗中，作者将自己看作一个旁观者，睁大好奇的眼睛，去观察这个世界。他不掺杂自己的理解，不揣测事物的意义，用最真实的方式去描述。看似是在反对修辞，倒不如说，他不赋予事物任何的哲学意义，坚持事物仅仅是事物。</p><p>更有意思的一点在于，他总要强调自己“真实”的描述，即在描述之外，仍要强调描述的一切独立于作者的思想而存在。所以我们会经常看到以下类型的语句“我思考用眼睛和耳朵”，“我不知道我在想什么，我也不想知道”，“但事物并没有名字或人格”，“真实意味着不存在于我的内心”“《水就是水》”…可能作者生怕读者误解他在赋予事物意义，所以总是在强调它只是一个旁观者，事物并没有这种哲学意义。所以通篇串联下来，虽然每首诗在讲不同的观察，但是核心观点仅有一个——“我这个旁观者并不赋予事物意义，我只是观察和体会。”正如《一想到事物》这首诗中讲到，“我观看，事物存在。我思想，只有我存在。”</p><p>对于我个人来说，本书还是有着一定的启发，即“无我”。生活中我们总会给事物赋予我们自己的意义，但是这种意义并不是事物本身的意义。我们对自我的感知太强，以至于我们总是在用自己的眼光去看世界，而不是用世界的眼光去看世界。所以我们眼中的世界其实是自己的投射，有点类似于佛印和苏东坡说的“心中有佛所见皆佛，心中有屎所见皆屎。”（当然这个故事可能是小时候的鸡汤文）当然不论是佛还是屎，都是强加的意义，已经脱离了事物本质，蒙蔽了双眼。</p><p>但为什么要“无我”呢？剖离我的过程其实是一件较难的事情，要求人不以自己的价值观和好恶来看待事物。即更多的关注“是什么”“应该是什么”而不是“我觉得是什么”。这样便会不那么容易跳入以自我为中心的逻辑，也会避免由于自己人性的弱点而为自己无意设下的陷阱。</p><p>不过“无我之路”道阻且长，能时刻意识到自己处于自己的视角，而不是世界的视角，也还是不错的。</p>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>poem</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超级 Rui 的 2023 年度总结</title>
    <link href="/life/2023-year-report/"/>
    <url>/life/2023-year-report/</url>
    
    <content type="html"><![CDATA[<p>写在 2024 农历新年前，对过去一年的回顾。</p><span id="more"></span><h1>写在最最前</h1><p>以后打算把年终总结放在农历新年前写，一是因为年关事多外加自己实在拖延，二是农历新年的分割性似乎比阳历新年更加明显。暂定每年除夕前以及阳历七八月份吧。这是个人的第三篇总结了，还是希望坚持下去。过去的这一年个人处境和心态有着巨大的变化，可以说是人生中比较重要的一年。</p><h1>具体来说</h1><h2 id="学业">学业</h2><p>提交完论文之后这些手续拖得也太久了，不过终于也在 1 月份通过了答辩。答辩持续了近五个小时，第一次体会到“一个大写的博士”这句话的分量。这应该是年终总结里最后一次出现学业这一项了。</p><p>此外终于在博士毕业之前进行了学术会议汇报，有趣。</p><h2 id="健康">健康</h2><p>这半年恢复了运动，但是篮球好久没打了，取而代之的是跑步。跑步虽然比较无趣，但是也能提供一点运动量，听着播客似乎也能接受。当然运动频率还是没有保证，记录如下。</p><div style="width:40%; margin:auto"><img src="/life/2023-year-report/gym.jpeg" class=""></div><h2 id="工作">工作</h2><p>半年前期望如今会有一个不错的答案，而现在却还没有答案。不过在找工作的过程中看清了很多东西，打破了很多自己的幻想，让自己直接接触这个现实的社会。再次希望今年的半年报里可以给出一个答案，不必是一个最好的答案，但是是一个自己可以接受的答案。</p><h2 id="项目">项目</h2><p>半年前想了很多脑洞项目，但是现在看来似乎都浮于表面，并不是为了解决实际问题。从功利的角度来讲，并不能拿来卖钱（有人买单），于是也就没有继续思考下去。</p><h2 id="金钱与消费">金钱与消费</h2><p>有着与上次记录相似的财务状况。认为记录财务状况是一个很好的习惯，即清楚自己的资产负债表。有知有行提供的工具还是比较美观好用的。</p><p>发现越来越舍得花钱买体验，似乎有一些掉入消费主义。但是也有一些本质区别，即让“自己开心”还是“符合社会对开心的要求”。</p><h2 id="读书">读书</h2><p>上半年一本书都没有读，下半年读了很多书。读书很杂，有功利的也有非功利的。读到了最爱的一本书《献给阿尔吉侬的花束》。《马斯克传》我认为可以称为年度最佳科幻小说。也读了《别独自用餐》这种类成功学书籍。</p><p>读书是一件重要的事情，其获得的快乐本质上与旅游无异，同时也可以替代短视频奶头乐，何乐而不为。</p><h2 id="观影和视频">观影和视频</h2><p>今年并没有什么观影体验。但近期看《繁花》，王家卫导演监制。光影绝美，叙事的方式也很有趣。我倒是对故事线不是很感兴趣，虽然也跌宕起伏，但是更加喜爱摄影的格调。高级的事物总是会引人喜爱的。</p><h2 id="摄影">摄影</h2><p>这是拍照片最多的一年，提交完大论文之后又把相机们买了回来。但是似乎还是没有找到自己的风格。尝试了不少主题，但似乎还是拍的不够多，想的不够多。或许可以多看看多学学。已然意识到这是终身爱好，不必急于求成。</p><p>已有的作品整理展示或者印刷分享其实是一件较为重要的事。不管是从分享快乐还是从严肃成长方面，都可以更系统性的做起来。</p><h2 id="东游西逛">东游西逛</h2><p>去了贵阳去了杭州去了克拉科夫去了卡塔尔去了伊斯坦布尔去了东京。读博之后第一次出这么多门，感觉还是很不错的。东京已然成为内心最喜爱城市 top3，感叹这个城市的美感以及高级感。</p><h2 id="感情">感情</h2><p>我认识到人对自己需求的认识是会不断完善的。也认识到不会有完美的人，任何关系在袒露自我的过程中都会暴露出一些问题，本质原因是自我性的回归导致滤镜的打破。</p><p>人和人的深度关系基础是对其真实人格的接纳，而不是对自己内心幻想的接纳，即要爱真实的人。但是这是一件很难的事情，因为需要包容。拒绝接纳很简单，包容很难，希望自己能够逐步提升这个能力，不要只做简单的事。（此外，你觉得你是在包容别人，殊不知别人也在包容你，不要只看到自己单方面的付出。）</p><h1>认知方面</h1><p>在自己摸索以及和长辈们交谈的过程中，一次又一次地感受到了自己的认知水平的不足。以后每次总结都会对这段时间的认知变化进行记录。</p><p>但认知到底是个什么东西，似乎还没有一个准确的定义。或许指的是如何看待事物、优化能力、信息处理等。自己认为或有以下几个重要维度，每次总结或有删改。自己以为然的，记录在下面。</p><h2 id="自我提升">自我提升</h2><ul><li>在经验和方法论上和世界上各行业最优秀的人攀比 (学习), 在最终的结果上和过去的自己攀比。</li><li>优秀的人一定有稀缺性以及不一样的地方，至少不能被别人的帕累托前沿支配。</li><li>从追求简历美德到追求悼词美德。即从名头到价值，当然这两者也不是完全独立的。</li></ul><h2 id="心态调节">心态调节</h2><ul><li>和自己和解，不要总是苛求每一步的完美，否则容易捡了芝麻丢了西瓜。</li><li>降低期望值，不要把一些正在争取的事看作理所应当。</li><li>接受一切可能发生的结果。这一项很难，或许需要不断磨练。</li><li>急功近利和走捷径的心态要不得，有时候可以不那么聪明，踏实稳重一些。</li></ul><h2 id="做决定">做决定</h2><ul><li>“成年人的世界，在于你敢不敢承担风险，敢，就是成年人。”承担风险一定程度上可以看做不同维度间的选择，不能既要又要，想清楚自己要什么然后果断去做。</li><li>芒格说：“在选择人生伴侣时，你要在你能接触到的，并且愿意和你携手的人中，挑选一位最优秀的。有的人愿意和你携手，但你接触不到，那就不在考虑范围之内。” 做选择亦是如此，有很多虚假的选择会骗过你自己。</li></ul><h2 id="信息获取">信息获取</h2><ul><li>找到一个方向，阅读这个方向里最聪明人的历史所有微博记录，迅速增加观察世界的角度。</li></ul><h2 id="人际交往">人际交往</h2><ul><li>不同阶层的特征主要是感情的稀缺性以及资源量级的不同。</li><li>要做主动的人，不要怕麻烦别人，大部分长者以及有经验的人是乐于帮助你的，你不会损失什么，或许只有一些虚假的自尊。</li></ul><h2 id="一些道理">一些道理</h2><ul><li>骗别人可以，不要把自己也骗了。</li><li>你是你的投资组合中，最有价值的资产。你的声誉是你未来收入的代表。而声誉是一个简单的结构，建立在两个想法之上，能力：你能做什么，可靠性：你实际做了什么。对于时间的投资最好还是要落到这两个地方，即投资自己。</li></ul><h1>番外篇：一些碎碎念 Blah Blah</h1><ul><li>再次，太喜欢老板了。</li><li>自己出生 10000 天打卡纪念。</li><li>答辩完成如释重负。</li><li>做一只伊斯坦布尔的猫好幸福。</li><li>开始喝咖啡了，当然是比较弱的拿铁。</li><li>荒木经惟的照片过于有感染力。</li><li>想当一个摄影很棒的有趣的人。</li></ul><h1>总结展望</h1><h2 id="一些收获">一些收获</h2><p>科研成果满足毕业要求，终于能毕业了，这是今年最大的收获。</p><h2 id="一些遗憾">一些遗憾</h2><ul><li>没能进 VC 和量化这两个行业体验一下。</li></ul><h2 id="立起新的-Flag">立起新的 Flag</h2><p>沿用了很多上次的 flag，</p><ul><li>猛猛健康运动！</li><li>希望能找到一个喜欢的工作/事业。</li><li>希望能多多探索不一样的事物（包括自己）。</li><li>希望能坚持读书。</li><li>争取把多邻国搞定。</li><li>希望能精进一下摄影。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>年终总结</tag>
      
      <tag>生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Diffusion Model</title>
    <link href="/machine-learning/diffusion/"/>
    <url>/machine-learning/diffusion/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>一个非常非常简短的 diffusion model 学习，参考自 Lilian 的博客。</p><span id="more"></span><h1>生成式模型概览</h1><div style="width:90%;margin:auto"><img src="/machine-learning/diffusion/generative-overview.png" class="" title="生成式模型"></div><p>生成式模型通常都有着一个解构（压缩）至中间状态和重构（还原）的过程。在使用训练好的模型生成数据的时候，我们可以从中间状态开始，然后还原得到我们想要的数据。</p><h1>Diffusion</h1><h2 id="概览">概览</h2><blockquote><p>Diffusion models are inspired by non-equilibrium thermodynamics.They define a Markov chain of diffusion steps to slowly add random noise to data and then learn to reverse the diffusion process to construct desired data samples from the noise.Unlike VAE or flow models, diffusion models are learned with a fixed procedure and the latent variable has high dimensionality (same as the original data).</p></blockquote><p>不同于 GAN、VAE 等生成式模型，diffusion model 通过一个逐步加噪的过程来学习数据分布，再通过一个逐步去噪的过程来生成数据。</p><h2 id="Forward-diffusion-process">Forward diffusion process</h2><p>下图是 diffusion model 的一个示意图：</p><div style="width:90%;margin:auto"><img src="/machine-learning/diffusion/DDPM.png" class="" title="Denoising Diffusion Probabilistic Models"></div><p>加噪声的过程可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">;</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mi>β</mi><mi>t</mi></msub></mrow></msqrt><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>β</mi><mi>t</mi></msub><mi mathvariant="bold">I</mi><mo stretchy="false">)</mo><mspace width="1em"/><mspace linebreak="newline"></mspace><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(\mathbf{x}_t \vert \mathbf{x}_{t-1}) = \mathcal{N}(\mathbf{x}_t; \sqrt{1 - \beta_t} \mathbf{x}_{t-1}, \beta_t\mathbf{I}) \quad \\q(\mathbf{x}_{1:T} \vert \mathbf{x}_0) = \prod^T_{t=1} q(\mathbf{x}_t \vert \mathbf{x}_{t-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.2561em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9839em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.9439em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067l0 -0c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60zM1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2561em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathbf">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0954em;vertical-align:-1.2671em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>这个可以通过一个高斯采样来实现，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\beta_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 用来控制噪声的大小。此时我们利用换元法，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>t</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>α</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_t = 1 - \beta_t, \bar{\alpha}_t = \prod_{i=1}^t \alpha_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2332em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9335em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，可以得到：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left right" columnspacing="0em 1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow></msqrt><msub><mi mathvariant="bold-italic">ϵ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext> ;where </mtext><msub><mi mathvariant="bold-italic">ϵ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold-italic">ϵ</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo separator="true">,</mo><mo>⋯</mo><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn mathvariant="bold">0</mn><mo separator="true">,</mo><mi mathvariant="bold">I</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msqrt><mrow><msub><mi>α</mi><mi>t</mi></msub><msub><mi>α</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msqrt><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub><msub><mi>α</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msqrt><msub><mover accent="true"><mi mathvariant="bold-italic">ϵ</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext> ;where </mtext><msub><mover accent="true"><mi mathvariant="bold-italic">ϵ</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mtext> merges two Gaussians.</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>…</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><mi mathvariant="bold-italic">ϵ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">;</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\mathbf{x}_t &amp;= \sqrt{\alpha_t}\mathbf{x}_{t-1} + \sqrt{1 - \alpha_t}\boldsymbol{\epsilon}_{t-1} &amp; \text{ ;where } \boldsymbol{\epsilon}_{t-1}, \boldsymbol{\epsilon}_{t-2}, \dots \sim \mathcal{N}(\mathbf{0}, \mathbf{I}) \\&amp;= \sqrt{\alpha_t \alpha_{t-1}} \mathbf{x}_{t-2} + \sqrt{1 - \alpha_t \alpha_{t-1}} \bar{\boldsymbol{\epsilon}}_{t-2} &amp; \text{ ;where } \bar{\boldsymbol{\epsilon}}_{t-2} \text{ merges two Gaussians.} \\&amp;= \dots \\&amp;= \sqrt{\bar{\alpha}_t}\mathbf{x}_0 + \sqrt{1 - \bar{\alpha}_t}\boldsymbol{\epsilon} \\q(\mathbf{x}_t \vert \mathbf{x}_0) &amp;= \mathcal{N}(\mathbf{x}_t; \sqrt{\bar{\alpha}_t} \mathbf{x}_0, (1 - \bar{\alpha}_t)\mathbf{I})\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.6969em;vertical-align:-3.5984em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0984em;"><span style="top:-6.2173em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.1054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.5643em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.0616em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5984em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0984em;"><span style="top:-6.2173em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7742em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7342em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2658em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8811em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8411em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1589em;"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.745em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.705em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.295em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9519em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.9119em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067l0 -0c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60zM1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2881em;"><span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5812em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.1054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner">…</span></span></span><span style="top:-1.5643em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8428em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1972em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8811em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8411em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1589em;"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span></span></span><span style="top:-0.0616em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8428em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1972em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathbf">I</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5984em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:4.0984em;"><span style="top:-6.2173em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord"> ;where </span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord mathbf">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">I</span><span class="mclose">)</span></span></span><span style="top:-4.6054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord"> ;where </span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5812em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord"> merges two Gaussians.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">ϵ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\epsilon}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span></span></span></span> 是高斯噪声分布，不同方差的高斯分布可以合并得到一个新的高斯分布。通常来说，我们在噪声更大时，可以负担更长的更新，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>β</mi><mn>2</mn></msub><mo>&lt;</mo><mo>⋯</mo><mo>&lt;</mo><msub><mi>β</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\beta_1 &lt; \beta_2 &lt; \dots &lt; \beta_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mn>1</mn></msub><mo>&gt;</mo><mo>⋯</mo><mo>&gt;</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\bar{\alpha}_1 &gt; \dots &gt; \bar{\alpha}_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p><h2 id="Reverse-diffusion-process">Reverse diffusion process</h2><div style="width:90%;margin:auto"><img src="/machine-learning/diffusion/diffusion-example.png" class=""></div><p>如果我们可以逆转上述 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(\mathbf{x}_t \vert \mathbf{x}_{t-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 过程，并从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(\mathbf{x}_{t-1} \vert \mathbf{x}_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 中采样，那我么就可以从一个高斯分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn mathvariant="bold">0</mn><mo separator="true">,</mo><mi mathvariant="bold">I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_T \sim \mathcal{N}(\mathbf{0}, \mathbf{I})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord mathbf">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">I</span><span class="mclose">)</span></span></span></span> 逐步还原到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\beta_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 足够小，这个逆过程 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(\mathbf{x}_t \vert \mathbf{x}_{t-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 也应当是一个高斯分布。此时我们来学习一个参数化的模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">p_\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 来表示这个逆转过程。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo stretchy="false">)</mo><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mspace width="1em"/><mspace linebreak="newline"></mspace><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">;</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi mathvariant="bold">Σ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_\theta(\mathbf{x}_{0:T}) = p(\mathbf{x}_T) \prod^T_{t=1} p_\theta(\mathbf{x}_{t-1} \vert \mathbf{x}_t) \quad \\p_\theta(\mathbf{x}_{t-1} \vert \mathbf{x}_t) = \mathcal{N}(\mathbf{x}_{t-1}; \boldsymbol{\mu}_\theta(\mathbf{x}_t, t), \boldsymbol{\Sigma}_\theta(\mathbf{x}_t, t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0954em;vertical-align:-1.2671em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.242em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span></span></span></p><p>值得注意的是，这个逆条件概率在基于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的情况下更加易得：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">;</mo><mstyle mathcolor="blue"><mover accent="true"><mi mathvariant="bold-italic">μ</mi><mo>~</mo></mover><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mstyle mathcolor="red"><msub><mover accent="true"><mi>β</mi><mo>~</mo></mover><mi>t</mi></msub><mi mathvariant="bold">I</mi><mo stretchy="false">)</mo></mstyle></mstyle></mrow><annotation encoding="application/x-tex">q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0) = \mathcal{N}(\mathbf{x}_{t-1}; \color{blue}{\tilde{\boldsymbol{\mu}}}(\mathbf{x}_t, \mathbf{x}_0), \color{red}{\tilde{\beta}_t} \mathbf{I})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1813em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:blue;"><span class="mord accent" style="color:blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6813em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord boldsymbol" style="color:blue;">μ</span></span></span></span><span style="top:-3.3634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord" style="color:blue;">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span><span class="mopen" style="color:blue;">(</span><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct" style="color:blue;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mtight" style="color:blue;">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose" style="color:blue;">)</span><span class="mpunct" style="color:blue;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:red;"><span class="mord" style="color:red;"><span class="mord accent" style="color:red;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9313em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;color:red;">β</span></span><span style="top:-3.6134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord" style="color:red;">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mathnormal mtight" style="color:red;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mord mathbf" style="color:red;">I</span><span class="mclose" style="color:red;">)</span></span></span></span></span></p><p>通过贝叶斯法则可得：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∝</mo><mi>exp</mi><mo>⁡</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><msub><mi>β</mi><mi>t</mi></msub></mfrac><mo>+</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></msqrt><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo>−</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mfrac><mrow><msubsup><mi mathvariant="bold">x</mi><mi>t</mi><mn>2</mn></msubsup><mo>−</mo><mn>2</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mstyle mathcolor="blue"><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mstyle mathcolor="black"><mrow><mo>+</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><mstyle mathcolor="red"><msubsup><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mstyle></mstyle></mstyle></mrow><msub><mi>β</mi><mi>t</mi></msub></mfrac><mo>+</mo><mfrac><mstyle mathcolor="red"><msubsup><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mstyle mathcolor="black"><mrow><mo>−</mo><mn>2</mn><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></msqrt><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub></mrow><mstyle mathcolor="blue"><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mstyle mathcolor="black"><mrow><mo>+</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msubsup><mi mathvariant="bold">x</mi><mn>0</mn><mn>2</mn></msubsup></mrow></mstyle></mstyle></mstyle></mstyle><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo>−</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mstyle mathcolor="red"><mrow><mo stretchy="false">(</mo><mfrac><msub><mi>α</mi><mi>t</mi></msub><msub><mi>β</mi><mi>t</mi></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo stretchy="false">)</mo></mrow><msubsup><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mo>−</mo><mstyle mathcolor="blue"><mrow><mo stretchy="false">(</mo><mfrac><mrow><mn>2</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt></mrow><msub><mi>β</mi><mi>t</mi></msub></mfrac><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>+</mo><mfrac><mrow><mn>2</mn><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mstyle mathcolor="black"><mrow><mo>+</mo><mi>C</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow></mstyle></mstyle></mstyle></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0) &amp;= q(\mathbf{x}_t \vert \mathbf{x}_{t-1}, \mathbf{x}_0) \frac{ q(\mathbf{x}_{t-1} \vert \mathbf{x}_0) }{ q(\mathbf{x}_t \vert \mathbf{x}_0) } \\&amp;\propto \exp \Big(-\frac{1}{2} \big(\frac{(\mathbf{x}_t - \sqrt{\alpha_t} \mathbf{x}_{t-1})^2}{\beta_t} + \frac{(\mathbf{x}_{t-1} - \sqrt{\bar{\alpha}_{t-1}} \mathbf{x}_0)^2}{1-\bar{\alpha}_{t-1}} - \frac{(\mathbf{x}_t - \sqrt{\bar{\alpha}_t} \mathbf{x}_0)^2}{1-\bar{\alpha}_t} \big) \Big) \\&amp;= \exp \Big(-\frac{1}{2} \big(\frac{\mathbf{x}_t^2 - 2\sqrt{\alpha_t} \mathbf{x}_t \color{blue}{\mathbf{x}_{t-1}} \color{black}{+ \alpha_t} \color{red}{\mathbf{x}_{t-1}^2} }{\beta_t} + \frac{ \color{red}{\mathbf{x}_{t-1}^2} \color{black}{- 2 \sqrt{\bar{\alpha}_{t-1}} \mathbf{x}_0} \color{blue}{\mathbf{x}_{t-1}} \color{black}{+ \bar{\alpha}_{t-1} \mathbf{x}_0^2}  }{1-\bar{\alpha}_{t-1}} - \frac{(\mathbf{x}_t - \sqrt{\bar{\alpha}_t} \mathbf{x}_0)^2}{1-\bar{\alpha}_t} \big) \Big) \\&amp;= \exp\Big( -\frac{1}{2} \big( \color{red}{(\frac{\alpha_t}{\beta_t} + \frac{1}{1 - \bar{\alpha}_{t-1}})} \mathbf{x}_{t-1}^2 - \color{blue}{(\frac{2\sqrt{\alpha_t}}{\beta_t} \mathbf{x}_t + \frac{2\sqrt{\bar{\alpha}_{t-1}}}{1 - \bar{\alpha}_{t-1}} \mathbf{x}_0)} \mathbf{x}_{t-1} \color{black}{ + C(\mathbf{x}_t, \mathbf{x}_0) \big) \Big)}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.7254em;vertical-align:-5.1127em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.6127em;"><span style="top:-7.7045em;"><span class="pstrut" style="height:3.5188em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.9497em;"><span class="pstrut" style="height:3.5188em;"></span><span class="mord"></span></span><span style="top:-2.2365em;"><span class="pstrut" style="height:3.5188em;"></span><span class="mord"></span></span><span style="top:0.3995em;"><span class="pstrut" style="height:3.5188em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.1127em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.6127em;"><span style="top:-7.7045em;"><span class="pstrut" style="height:3.5188em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.9497em;"><span class="pstrut" style="height:3.5188em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5188em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7047em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7647em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7247em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mord"><span class="delimsizing size2">)</span></span></span></span><span style="top:-2.2365em;"><span class="pstrut" style="height:3.5188em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5188em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7047em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span><span class="mbin mtight" style="color:blue;">−</span><span class="mord mtight" style="color:blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span><span class="mord" style="color:black;"><span class="mord" style="color:black;">+</span><span class="mord" style="color:black;"><span class="mord mathnormal" style="margin-right:0.0037em;color:black;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mord" style="color:red;"><span class="mord" style="color:red;"><span class="mord mathbf" style="color:red;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathnormal mtight" style="color:red;">t</span><span class="mbin mtight" style="color:red;">−</span><span class="mord mtight" style="color:red;">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3064em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5105em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6964em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="color:red;"><span class="mord" style="color:red;"><span class="mord mathbf" style="color:red;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathnormal mtight" style="color:red;">t</span><span class="mbin mtight" style="color:red;">−</span><span class="mord mtight" style="color:red;">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3064em;"><span></span></span></span></span></span></span></span><span class="mord" style="color:black;"><span class="mord" style="color:black;">−</span><span class="mord" style="color:black;">2</span><span class="mord sqrt" style="color:black;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7647em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:black;padding-left:0.833em;"><span class="mord" style="color:black;"><span class="mord accent" style="color:black;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:black;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:black;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">t</span><span class="mbin mtight" style="color:black;">−</span><span class="mord mtight" style="color:black;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7247em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:black;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span><span class="mord" style="color:black;"><span class="mord mathbf" style="color:black;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span><span class="mbin mtight" style="color:blue;">−</span><span class="mord mtight" style="color:blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span><span class="mord" style="color:black;"><span class="mord" style="color:black;">+</span><span class="mord" style="color:black;"><span class="mord accent" style="color:black;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:black;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:black;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">t</span><span class="mbin mtight" style="color:black;">−</span><span class="mord mtight" style="color:black;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord" style="color:black;"><span class="mord mathbf" style="color:black;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mord"><span class="delimsizing size2">)</span></span></span></span><span style="top:0.3995em;"><span class="pstrut" style="height:3.5188em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord" style="color:red;"><span class="mopen" style="color:red;">(</span><span class="mord" style="color:red;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:red;"><span class="mord" style="color:red;"><span class="mord mathnormal" style="margin-right:0.05278em;color:red;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mathnormal mtight" style="color:red;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:red;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:red;"><span class="mord" style="color:red;"><span class="mord mathnormal" style="margin-right:0.0037em;color:red;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mathnormal mtight" style="color:red;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="color:red;margin-right:0.2222em;"></span><span class="mbin" style="color:red;">+</span><span class="mspace" style="color:red;margin-right:0.2222em;"></span><span class="mord" style="color:red;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:red;"><span class="mord" style="color:red;">1</span><span class="mspace" style="color:red;margin-right:0.2222em;"></span><span class="mbin" style="color:red;">−</span><span class="mspace" style="color:red;margin-right:0.2222em;"></span><span class="mord" style="color:red;"><span class="mord accent" style="color:red;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:red;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:red;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathnormal mtight" style="color:red;">t</span><span class="mbin mtight" style="color:red;">−</span><span class="mord mtight" style="color:red;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:red;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:red;"><span class="mord" style="color:red;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose" style="color:red;">)</span></span><span class="mord" style="color:red;"><span class="mord mathbf" style="color:red;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mathnormal mtight" style="color:red;">t</span><span class="mbin mtight" style="color:red;">−</span><span class="mord mtight" style="color:red;">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3053em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:red;">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord" style="color:blue;"><span class="mopen" style="color:blue;">(</span><span class="mord" style="color:blue;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.43em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord mathnormal" style="margin-right:0.05278em;color:blue;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:blue;border-bottom-width:0.04em;"></span></span><span style="top:-3.7047em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;">2</span><span class="mord sqrt" style="color:blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;padding-left:0.833em;"><span class="mord" style="color:blue;"><span class="mord mathnormal" style="margin-right:0.0037em;color:blue;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:blue;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mbin" style="color:blue;">+</span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mord" style="color:blue;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4417em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;">1</span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mbin" style="color:blue;">−</span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mord" style="color:blue;"><span class="mord accent" style="color:blue;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:blue;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:blue;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span><span class="mbin mtight" style="color:blue;">−</span><span class="mord mtight" style="color:blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:blue;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;">2</span><span class="mord sqrt" style="color:blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7647em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;padding-left:0.833em;"><span class="mord" style="color:blue;"><span class="mord accent" style="color:blue;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:blue;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:blue;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span><span class="mbin mtight" style="color:blue;">−</span><span class="mord mtight" style="color:blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7247em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:blue;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mtight" style="color:blue;">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose" style="color:blue;">)</span></span><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span><span class="mbin mtight" style="color:blue;">−</span><span class="mord mtight" style="color:blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord" style="color:black;"><span class="mord" style="color:black;">+</span><span class="mord mathnormal" style="margin-right:0.07153em;color:black;">C</span><span class="mopen" style="color:black;">(</span><span class="mord" style="color:black;"><span class="mord mathbf" style="color:black;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mathnormal mtight" style="color:black;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct" style="color:black;">,</span><span class="mspace" style="color:black;margin-right:0.1667em;"></span><span class="mord" style="color:black;"><span class="mord mathbf" style="color:black;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:black;"><span class="mord mtight" style="color:black;">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose" style="color:black;">)</span><span class="mord" style="color:black;"><span class="delimsizing size1" style="color:black;"><span style="color:black;">)</span></span></span><span class="mord" style="color:black;"><span class="delimsizing size2" style="color:black;"><span style="color:black;">)</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.1127em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>第二行的正比由高斯函数的公式得到，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi>σ</mi><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mrow></mfrac><mtext>  </mtext><msup><mi>e</mi><mrow><mo>−</mo><mfrac><msup><mrow><mo fence="true">(</mo><mi>x</mi><mo>−</mo><mi>μ</mi><mo fence="true">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup><mtext> ⁣</mtext></mstyle></mrow><annotation encoding="application/x-tex">{\displaystyle f(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}\;e^{-{\frac {\left(x-\mu \right)^{2}}{2\sigma ^{2}}}}\!}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2591em;vertical-align:-0.93em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2028em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3291em;"><span style="top:-3.4534em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.251em;"><span style="top:-2.5062em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384em;"><span style="top:-2.9384em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.5021em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="minner mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">μ</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0484em;"><span style="top:-3.0484em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4938em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:-0.1667em;"></span></span></span></span></span>。再使用配方法，可以得到一个新的高斯函数，其中均值和方差为：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mover accent="true"><mi>β</mi><mo>~</mo></mover><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mfrac><msub><mi>α</mi><mi>t</mi></msub><msub><mi>β</mi><mi>t</mi></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mfrac><mrow><msub><mi>α</mi><mi>t</mi></msub><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mo>+</mo><msub><mi>β</mi><mi>t</mi></msub></mrow><mrow><msub><mi>β</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mstyle mathcolor="green"><mrow><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><mo>⋅</mo><msub><mi>β</mi><mi>t</mi></msub></mrow></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mover accent="true"><mi mathvariant="bold-italic">μ</mi><mo>~</mo></mover><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mfrac><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi>β</mi><mi>t</mi></msub></mfrac><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>+</mo><mfrac><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mfrac><msub><mi>α</mi><mi>t</mi></msub><msub><mi>β</mi><mi>t</mi></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mfrac><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi>β</mi><mi>t</mi></msub></mfrac><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>+</mo><mfrac><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mstyle mathcolor="green"><mrow><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><mo>⋅</mo><msub><mi>β</mi><mi>t</mi></msub></mrow></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>+</mo><mfrac><mrow><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></msqrt><msub><mi>β</mi><mi>t</mi></msub></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\tilde{\beta}_t &amp;= 1/(\frac{\alpha_t}{\beta_t} + \frac{1}{1 - \bar{\alpha}_{t-1}}) = 1/(\frac{\alpha_t - \bar{\alpha}_t + \beta_t}{\beta_t(1 - \bar{\alpha}_{t-1})})= \color{green}{\frac{1 - \bar{\alpha}_{t-1}}{1 - \bar{\alpha}_t} \cdot \beta_t} \\\tilde{\boldsymbol{\mu}}_t (\mathbf{x}_t, \mathbf{x}_0)&amp;= (\frac{\sqrt{\alpha_t}}{\beta_t} \mathbf{x}_t + \frac{\sqrt{\bar{\alpha}_{t-1} }}{1 - \bar{\alpha}_{t-1}} \mathbf{x}_0)/(\frac{\alpha_t}{\beta_t} + \frac{1}{1 - \bar{\alpha}_{t-1}}) \\&amp;= (\frac{\sqrt{\alpha_t}}{\beta_t} \mathbf{x}_t + \frac{\sqrt{\bar{\alpha}_{t-1} }}{1 - \bar{\alpha}_{t-1}} \mathbf{x}_0) \color{green}{\frac{1 - \bar{\alpha}_{t-1}}{1 - \bar{\alpha}_t} \cdot \beta_t} \\&amp;= \frac{\sqrt{\alpha_t}(1 - \bar{\alpha}_{t-1})}{1 - \bar{\alpha}_t} \mathbf{x}_t + \frac{\sqrt{\bar{\alpha}_{t-1}}\beta_t}{1 - \bar{\alpha}_t} \mathbf{x}_0\\\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.4703em;vertical-align:-4.9851em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.4851em;"><span style="top:-7.5684em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9313em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.6134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.8907em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6813em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span></span><span style="top:-3.3634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.2546em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"></span></span><span style="top:0.3944em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.9851em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.4851em;"><span style="top:-7.5684em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1/</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1/</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;"><span class="mord" style="color:green;">1</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mbin" style="color:green;">−</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord accent" style="color:green;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:green;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:green;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:green;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;"><span class="mord" style="color:green;">1</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mbin" style="color:green;">−</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord accent" style="color:green;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:green;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:green;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span><span class="mbin mtight" style="color:green;">−</span><span class="mord mtight" style="color:green;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mbin" style="color:green;">⋅</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord mathnormal" style="margin-right:0.05278em;color:green;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.8907em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.43em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7047em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4417em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7647em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7247em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-2.2546em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.43em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7047em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4417em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7647em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7247em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;"><span class="mord" style="color:green;">1</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mbin" style="color:green;">−</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord accent" style="color:green;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:green;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:green;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:green;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;"><span class="mord" style="color:green;">1</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mbin" style="color:green;">−</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord accent" style="color:green;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:green;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:green;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span><span class="mbin mtight" style="color:green;">−</span><span class="mord mtight" style="color:green;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mbin" style="color:green;">⋅</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord mathnormal" style="margin-right:0.05278em;color:green;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:0.3944em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4547em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7047em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4417em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7647em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7247em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.9851em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>进一步考虑到之前的推导 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_0 = \frac{1}{\sqrt{\bar{\alpha}_t}}(\mathbf{x}_t - \sqrt{1 - \bar{\alpha}_t}\boldsymbol{\epsilon}_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3831em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.6279em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.803em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.763em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.237em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0822em;vertical-align:-0.25em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2078em;"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，均值可以进一步写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mover accent="true"><mi mathvariant="bold-italic">μ</mi><mo>~</mo></mover><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>+</mo><mfrac><mrow><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></msqrt><msub><mi>β</mi><mi>t</mi></msub></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><mfrac><mn>1</mn><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mstyle mathcolor="cyan"><mrow><mfrac><mn>1</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt></mfrac><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow></mstyle></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\tilde{\boldsymbol{\mu}}_t&amp;= \frac{\sqrt{\alpha_t}(1 - \bar{\alpha}_{t-1})}{1 - \bar{\alpha}_t} \mathbf{x}_t + \frac{\sqrt{\bar{\alpha}_{t-1}}\beta_t}{1 - \bar{\alpha}_t} \frac{1}{\sqrt{\bar{\alpha}_t}}(\mathbf{x}_t - \sqrt{1 - \bar{\alpha}_t}\boldsymbol{\epsilon}_t) \\&amp;= \color{cyan}{\frac{1}{\sqrt{\alpha_t}} \Big( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\epsilon}_t \Big)}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.309em;vertical-align:-2.4045em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9045em;"><span style="top:-4.9045em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6813em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span></span><span style="top:-3.3634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.3509em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4045em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9045em;"><span style="top:-4.9045em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4547em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7047em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4417em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7647em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7247em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9321em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8811em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8411em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1589em;"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.3509em;"><span class="pstrut" style="height:3.4547em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;"><span class="mord sqrt" style="color:cyan;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;padding-left:0.833em;"><span class="mord" style="color:cyan;"><span class="mord mathnormal" style="margin-right:0.0037em;color:cyan;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:cyan;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:cyan;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0007em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:cyan;"><span class="delimsizing size2" style="color:cyan;"><span style="color:cyan;">(</span></span></span><span class="mord" style="color:cyan;"><span class="mord mathbf" style="color:cyan;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mbin" style="color:cyan;">−</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mord" style="color:cyan;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2778em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;"><span class="mord sqrt" style="color:cyan;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;padding-left:0.833em;"><span class="mord" style="color:cyan;">1</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mbin" style="color:cyan;">−</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mord" style="color:cyan;"><span class="mord accent" style="color:cyan;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:cyan;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:cyan;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:cyan;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2078em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:cyan;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;">1</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mbin" style="color:cyan;">−</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mord" style="color:cyan;"><span class="mord mathnormal" style="margin-right:0.0037em;color:cyan;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;"><span class="mord boldsymbol" style="color:cyan;">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord" style="color:cyan;"><span class="delimsizing size2" style="color:cyan;"><span style="color:cyan;">)</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4045em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="Parameterization">Parameterization</h2><p>上述逆过程 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">;</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi mathvariant="bold">Σ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_\theta(\mathbf{x}_{t-1} \vert \mathbf{x}_t) = \mathcal{N}(\mathbf{x}_{t-1}; \boldsymbol{\mu}_\theta(\mathbf{x}_t, t), \boldsymbol{\Sigma}_\theta(\mathbf{x}_t, t)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.242em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)))</span></span></span></span> 中，我们可以对均值和方差进行参数化。目的是使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold-italic">μ</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{\mu}_\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6886em;vertical-align:-0.2441em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.242em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span></span></span></span> 来预测 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi mathvariant="bold-italic">μ</mi><mo>~</mo></mover><mi>t</mi></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt></mfrac><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow><annotation encoding="application/x-tex">\tilde{\boldsymbol{\mu}}_t = \frac{1}{\sqrt{\alpha_t}} \Big( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\epsilon}_t \Big)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9254em;vertical-align:-0.2441em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6813em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span></span><span style="top:-3.3634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7344em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3056em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5589em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8612em;"><span style="top:-2.6011em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8013em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1987em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">)</span></span></span></span></span>。因为在使用时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 已知，所以我们可以对高斯噪音项 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{\epsilon}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 进行参数化。这样，在时间步 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>，我们可以得到：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="bold-italic">μ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mstyle mathcolor="cyan"><mrow><mfrac><mn>1</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt></mfrac><msub><mi mathvariant="bold-italic">ϵ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>Thus </mtext><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">;</mo><mfrac><mn>1</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt></mfrac><msub><mi mathvariant="bold-italic">ϵ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo><mo separator="true">,</mo><msub><mi mathvariant="bold">Σ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\boldsymbol{\mu}_\theta(\mathbf{x}_t, t) &amp;= \color{cyan}{\frac{1}{\sqrt{\alpha_t}} \Big( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t) \Big)} \\\text{Thus }\mathbf{x}_{t-1} &amp;= \mathcal{N}(\mathbf{x}_{t-1}; \frac{1}{\sqrt{\alpha_t}} \Big( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t) \Big), \boldsymbol{\Sigma}_\theta(\mathbf{x}_t, t))\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.2443em;vertical-align:-2.3722em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8722em;"><span style="top:-4.8722em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.242em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord text"><span class="mord">Thus </span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3722em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8722em;"><span style="top:-4.8722em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;"><span class="mord sqrt" style="color:cyan;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;padding-left:0.833em;"><span class="mord" style="color:cyan;"><span class="mord mathnormal" style="margin-right:0.0037em;color:cyan;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:cyan;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:cyan;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0007em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:cyan;"><span class="delimsizing size2" style="color:cyan;"><span style="color:cyan;">(</span></span></span><span class="mord" style="color:cyan;"><span class="mord mathbf" style="color:cyan;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mbin" style="color:cyan;">−</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mord" style="color:cyan;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2778em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;"><span class="mord sqrt" style="color:cyan;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;padding-left:0.833em;"><span class="mord" style="color:cyan;">1</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mbin" style="color:cyan;">−</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mord" style="color:cyan;"><span class="mord accent" style="color:cyan;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:cyan;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:cyan;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:cyan;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2078em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:cyan;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;">1</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mbin" style="color:cyan;">−</span><span class="mspace" style="color:cyan;margin-right:0.2222em;"></span><span class="mord" style="color:cyan;"><span class="mord mathnormal" style="margin-right:0.0037em;color:cyan;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;"><span class="mord" style="color:cyan;"><span class="mord boldsymbol" style="color:cyan;">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="margin-right:0.02778em;color:cyan;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen" style="color:cyan;">(</span><span class="mord" style="color:cyan;"><span class="mord mathbf" style="color:cyan;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:cyan;"><span class="mord mathnormal mtight" style="color:cyan;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct" style="color:cyan;">,</span><span class="mspace" style="color:cyan;margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:cyan;">t</span><span class="mclose" style="color:cyan;">)</span><span class="mord" style="color:cyan;"><span class="delimsizing size2" style="color:cyan;"><span style="color:cyan;">)</span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0007em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2778em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2078em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size2">)</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3722em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="Loss-Function">Loss Function</h2><p>Training is performed by optimizing the usual variational lower bound (VLB) on negative log likelihood:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>L</mi><mtext>CE</mtext></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></msub><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></msub><mi>log</mi><mo>⁡</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><mo>∫</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo><mi>d</mi><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></msub><mi>log</mi><mo>⁡</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><mo>∫</mo><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mfrac><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mi>d</mi><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></msub><mi>log</mi><mo>⁡</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></msub><mfrac><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><mo>−</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msub><mi>log</mi><mo>⁡</mo><mfrac><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo><mo>=</mo><msub><mi>L</mi><mtext>VLB</mtext></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}L_\text{CE}&amp;= - \mathbb{E}_{q(\mathbf{x}_0)} \log p_\theta(\mathbf{x}_0) \\&amp;= - \mathbb{E}_{q(\mathbf{x}_0)} \log \Big( \int p_\theta(\mathbf{x}_{0:T}) d\mathbf{x}_{1:T} \Big) \\&amp;= - \mathbb{E}_{q(\mathbf{x}_0)} \log \Big( \int q(\mathbf{x}_{1:T} \vert \mathbf{x}_0) \frac{p_\theta(\mathbf{x}_{0:T})}{q(\mathbf{x}_{1:T} \vert \mathbf{x}_{0})} d\mathbf{x}_{1:T} \Big) \\&amp;= - \mathbb{E}_{q(\mathbf{x}_0)} \log \Big( \mathbb{E}_{q(\mathbf{x}_{1:T} \vert \mathbf{x}_0)} \frac{p_\theta(\mathbf{x}_{0:T})}{q(\mathbf{x}_{1:T} \vert \mathbf{x}_{0})} \Big) \\&amp;\leq - \mathbb{E}_{q(\mathbf{x}_{0:T})} \log \frac{p_\theta(\mathbf{x}_{0:T})}{q(\mathbf{x}_{1:T} \vert \mathbf{x}_{0})} \\&amp;= \mathbb{E}_{q(\mathbf{x}_{0:T})}\Big[\log \frac{q(\mathbf{x}_{1:T} \vert \mathbf{x}_{0})}{p_\theta(\mathbf{x}_{0:T})} \Big] = L_\text{VLB}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:14.6743em;vertical-align:-7.0871em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.5871em;"><span style="top:-10.1741em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">CE</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-8.1541em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span><span style="top:-5.5649em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span><span style="top:-2.9019em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span><span style="top:-0.2389em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span><span style="top:2.4241em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:7.0871em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.5871em;"><span style="top:-10.1741em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-8.1541em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">)</span></span></span></span><span style="top:-5.5649em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">)</span></span></span></span><span style="top:-2.9019em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">)</span></span></span></span><span style="top:-0.2389em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:2.4241em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">]</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">VLB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:7.0871em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>L</mi><mtext>VLB</mtext></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mi>q</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo stretchy="false">)</mo><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mi>q</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mi>q</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><mi>T</mi></munderover><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mi>q</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><mi>T</mi></munderover><mi>log</mi><mo>⁡</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mi>q</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><mi>T</mi></munderover><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><mi>T</mi></munderover><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mi>q</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><mi>T</mi></munderover><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mi>q</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><mi>T</mi></munderover><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mi>q</mi></msub><mo stretchy="false">[</mo><munder><munder><mrow><msub><mi>D</mi><mtext>KL</mtext></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>∥</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo stretchy="true">⏟</mo></munder><msub><mi>L</mi><mi>T</mi></msub></munder><mo>+</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><mi>T</mi></munderover><munder><munder><mrow><msub><mi>D</mi><mtext>KL</mtext></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>∥</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo stretchy="true">⏟</mo></munder><msub><mi>L</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></munder><munder><munder><mrow><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="bold">x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><mo stretchy="true">⏟</mo></munder><msub><mi>L</mi><mn>0</mn></msub></munder><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}L_\text{VLB} &amp;= \mathbb{E}_{q(\mathbf{x}_{0:T})} \Big[ \log\frac{q(\mathbf{x}_{1:T}\vert\mathbf{x}_0)}{p_\theta(\mathbf{x}_{0:T})} \Big] \\&amp;= \mathbb{E}_q \Big[ \log\frac{\prod_{t=1}^T q(\mathbf{x}_t\vert\mathbf{x}_{t-1})}{ p_\theta(\mathbf{x}_T) \prod_{t=1}^T p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t) } \Big] \\&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=1}^T \log \frac{q(\mathbf{x}_t\vert\mathbf{x}_{t-1})}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} \Big] \\&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \frac{q(\mathbf{x}_t\vert\mathbf{x}_{t-1})}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \log\frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big] \\&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \Big( \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)}\cdot \frac{q(\mathbf{x}_t \vert \mathbf{x}_0)}{q(\mathbf{x}_{t-1}\vert\mathbf{x}_0)} \Big) + \log \frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big] \\&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \sum_{t=2}^T \log \frac{q(\mathbf{x}_t \vert \mathbf{x}_0)}{q(\mathbf{x}_{t-1} \vert \mathbf{x}_0)} + \log\frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big] \\&amp;= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \log\frac{q(\mathbf{x}_T \vert \mathbf{x}_0)}{q(\mathbf{x}_1 \vert \mathbf{x}_0)} + \log \frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big]\\&amp;= \mathbb{E}_q \Big[ \log\frac{q(\mathbf{x}_T \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_T)} + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} - \log p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1) \Big] \\&amp;= \mathbb{E}_q [\underbrace{D_\text{KL}(q(\mathbf{x}_T \vert \mathbf{x}_0) \parallel p_\theta(\mathbf{x}_T))}_{L_T} + \sum_{t=2}^T \underbrace{D_\text{KL}(q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0) \parallel p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t))}_{L_{t-1}} \underbrace{- \log p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)}_{L_0} ]\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:30.024em;vertical-align:-14.762em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:15.262em;"><span style="top:-17.6633em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">VLB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-14.7564em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span><span style="top:-11.4571em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span><span style="top:-8.0617em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span><span style="top:-4.6662em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span><span style="top:-1.2708em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span><span style="top:2.1247em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span><span style="top:5.5201em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span><span style="top:8.9156em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:14.762em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:15.262em;"><span style="top:-17.6633em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:-14.7564em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6709em;"><span style="top:-2.1288em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1709em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:-11.4571em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:-8.0617em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:-4.6662em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:-1.2708em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:2.1247em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:5.5201em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:8.9156em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-1.4237em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">KL</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.6766em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-1.4237em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2025em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">KL</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.7181em;"><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-1.4237em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.6764em;"><span></span></span></span></span></span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:14.762em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>所以在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 时刻的损失可以用来最小化与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">μ</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\boldsymbol{\mu}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8757em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6813em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span></span><span style="top:-3.3634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span> 的差异：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>L</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo separator="true">,</mo><mi mathvariant="bold-italic">ϵ</mi></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi mathvariant="normal">∥</mi><msub><mi mathvariant="bold">Σ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mi mathvariant="normal">∥</mi><mstyle mathcolor="blue"><mrow><msub><mover accent="true"><mi mathvariant="bold-italic">μ</mi><mo>~</mo></mover><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mo>−</mo><mstyle mathcolor="green"><mrow><msub><mi mathvariant="bold-italic">μ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mstyle></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo separator="true">,</mo><mi mathvariant="bold-italic">ϵ</mi></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi mathvariant="normal">∥</mi><msub><mi mathvariant="bold">Σ</mi><mi>θ</mi></msub><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mi mathvariant="normal">∥</mi><mstyle mathcolor="blue"><mrow><mfrac><mn>1</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt></mfrac><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow><mo>−</mo><mstyle mathcolor="green"><mrow><mfrac><mn>1</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>−</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt></mfrac><msub><mi><mi mathvariant="bold-italic">ϵ</mi></mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mstyle></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo separator="true">,</mo><mi mathvariant="bold-italic">ϵ</mi></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msub><mi>α</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><msub><mi mathvariant="bold">Σ</mi><mi>θ</mi></msub><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mi mathvariant="normal">∥</mi><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">ϵ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo separator="true">,</mo><mi mathvariant="bold-italic">ϵ</mi></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msub><mi>α</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><msub><mi mathvariant="bold">Σ</mi><mi>θ</mi></msub><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mi mathvariant="normal">∥</mi><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">ϵ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}L_t &amp;= \mathbb{E}_{\mathbf{x}_0, \boldsymbol{\epsilon}} \Big[\frac{1}{2 \| \boldsymbol{\Sigma}_\theta(\mathbf{x}_t, t) \|^2_2} \| \color{blue}{\tilde{\boldsymbol{\mu}}_t(\mathbf{x}_t, \mathbf{x}_0)} - \color{green}{\boldsymbol{\mu}_\theta(\mathbf{x}_t, t)} \|^2 \Big] \\&amp;= \mathbb{E}_{\mathbf{x}_0, \boldsymbol{\epsilon}} \Big[\frac{1}{2  \|\boldsymbol{\Sigma}_\theta \|^2_2} \| \color{blue}{\frac{1}{\sqrt{\alpha_t}} \Big( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\epsilon}_t \Big)} - \color{green}{\frac{1}{\sqrt{\alpha_t}} \Big( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\boldsymbol{\epsilon}}_\theta(\mathbf{x}_t, t) \Big)} \|^2 \Big] \\&amp;= \mathbb{E}_{\mathbf{x}_0, \boldsymbol{\epsilon}} \Big[\frac{ (1 - \alpha_t)^2 }{2 \alpha_t (1 - \bar{\alpha}_t) \| \boldsymbol{\Sigma}_\theta \|^2_2} \|\boldsymbol{\epsilon}_t - \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t)\|^2 \Big] \\&amp;= \mathbb{E}_{\mathbf{x}_0, \boldsymbol{\epsilon}} \Big[\frac{ (1 - \alpha_t)^2 }{2 \alpha_t (1 - \bar{\alpha}_t) \| \boldsymbol{\Sigma}_\theta \|^2_2} \|\boldsymbol{\epsilon}_t - \boldsymbol{\epsilon}_\theta(\sqrt{\bar{\alpha}_t}\mathbf{x}_0 + \sqrt{1 - \bar{\alpha}_t}\boldsymbol{\epsilon}_t, t)\|^2 \Big] \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.6827em;vertical-align:-5.0914em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5914em;"><span style="top:-7.761em;"><span class="pstrut" style="height:3.4911em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.1873em;"><span class="pstrut" style="height:3.4911em;"></span><span class="mord"></span></span><span style="top:-2.3955em;"><span class="pstrut" style="height:3.4911em;"></span><span class="mord"></span></span><span style="top:0.348em;"><span class="pstrut" style="height:3.4911em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.0914em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5914em;"><span style="top:-7.761em;"><span class="pstrut" style="height:3.4911em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">ϵ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2∥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥</span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord accent" style="color:blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6813em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord boldsymbol" style="color:blue;">μ</span></span></span></span><span style="top:-3.3634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord" style="color:blue;">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen" style="color:blue;">(</span><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct" style="color:blue;">,</span><span class="mspace" style="color:blue;margin-right:0.1667em;"></span><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mtight" style="color:blue;">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose" style="color:blue;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:blue;">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mord boldsymbol" style="color:green;">μ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.242em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="margin-right:0.02778em;color:green;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen" style="color:green;">(</span><span class="mord" style="color:green;"><span class="mord mathbf" style="color:green;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct" style="color:green;">,</span><span class="mspace" style="color:green;margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:green;">t</span><span class="mclose" style="color:green;">)</span></span><span class="mord" style="color:green;"><span class="mord" style="color:green;">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mtight" style="color:green;">2</span></span></span></span></span></span></span></span><span class="mord" style="color:green;"><span class="delimsizing size2" style="color:green;"><span style="color:green;">]</span></span></span></span></span><span style="top:-5.1873em;"><span class="pstrut" style="height:3.4911em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">ϵ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2∥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥</span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord sqrt" style="color:blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;padding-left:0.833em;"><span class="mord" style="color:blue;"><span class="mord mathnormal" style="margin-right:0.0037em;color:blue;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:blue;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:blue;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0007em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:blue;"><span class="delimsizing size2" style="color:blue;"><span style="color:blue;">(</span></span></span><span class="mord" style="color:blue;"><span class="mord mathbf" style="color:blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mbin" style="color:blue;">−</span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mord" style="color:blue;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2778em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord sqrt" style="color:blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;padding-left:0.833em;"><span class="mord" style="color:blue;">1</span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mbin" style="color:blue;">−</span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mord" style="color:blue;"><span class="mord accent" style="color:blue;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:blue;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:blue;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:blue;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2078em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:blue;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;">1</span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mbin" style="color:blue;">−</span><span class="mspace" style="color:blue;margin-right:0.2222em;"></span><span class="mord" style="color:blue;"><span class="mord mathnormal" style="margin-right:0.0037em;color:blue;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord boldsymbol" style="color:blue;">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:blue;"><span class="mord mathnormal mtight" style="color:blue;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord" style="color:blue;"><span class="delimsizing size2" style="color:blue;"><span style="color:blue;">)</span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:blue;">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;"><span class="mord sqrt" style="color:green;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;padding-left:0.833em;"><span class="mord" style="color:green;"><span class="mord mathnormal" style="margin-right:0.0037em;color:green;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:green;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:green;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;"><span class="mord" style="color:green;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0007em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:green;"><span class="delimsizing size2" style="color:green;"><span style="color:green;">(</span></span></span><span class="mord" style="color:green;"><span class="mord mathbf" style="color:green;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mbin" style="color:green;">−</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2778em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;"><span class="mord sqrt" style="color:green;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;padding-left:0.833em;"><span class="mord" style="color:green;">1</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mbin" style="color:green;">−</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord accent" style="color:green;"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;color:green;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord" style="color:green;">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="color:green;min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2078em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="color:green;border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="color:green;"><span class="mord" style="color:green;">1</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mbin" style="color:green;">−</span><span class="mspace" style="color:green;margin-right:0.2222em;"></span><span class="mord" style="color:green;"><span class="mord mathnormal" style="margin-right:0.0037em;color:green;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mord" style="color:green;"><span class="mord boldsymbol" style="color:green;">ϵ</span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="margin-right:0.02778em;color:green;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen" style="color:green;">(</span><span class="mord" style="color:green;"><span class="mord mathbf" style="color:green;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mathnormal mtight" style="color:green;">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct" style="color:green;">,</span><span class="mspace" style="color:green;margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:green;">t</span><span class="mclose" style="color:green;">)</span><span class="mord" style="color:green;"><span class="delimsizing size2" style="color:green;"><span style="color:green;">)</span></span></span></span><span class="mord" style="color:green;"><span class="mord" style="color:green;">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:green;"><span class="mord mtight" style="color:green;">2</span></span></span></span></span></span></span></span><span class="mord" style="color:green;"><span class="delimsizing size2" style="color:green;"><span style="color:green;">]</span></span></span></span></span><span style="top:-2.3955em;"><span class="pstrut" style="height:3.4911em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">ϵ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:0.348em;"><span class="pstrut" style="height:3.4911em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">ϵ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8428em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1972em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8811em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8411em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1589em;"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.0914em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>忽略权重项进行简化可得：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>L</mi><mi>t</mi><mtext>simple</mtext></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>t</mi><mo>∼</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mi mathvariant="normal">∥</mi><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">ϵ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>t</mi><mo>∼</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub></mrow></msub><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mi mathvariant="normal">∥</mi><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">ϵ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}L_t^\text{simple}&amp;= \mathbb{E}_{t \sim [1, T], \mathbf{x}_0, \boldsymbol{\epsilon}_t} \Big[\|\boldsymbol{\epsilon}_t - \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t)\|^2 \Big] \\&amp;= \mathbb{E}_{t \sim [1, T], \mathbf{x}_0, \boldsymbol{\epsilon}_t} \Big[\|\boldsymbol{\epsilon}_t - \boldsymbol{\epsilon}_\theta(\sqrt{\bar{\alpha}_t}\mathbf{x}_0 + \sqrt{1 - \bar{\alpha}_t}\boldsymbol{\epsilon}_t, t)\|^2 \Big]\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.2em;vertical-align:-1.85em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.967em;"><span style="top:-2.4542em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">simple</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2458em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">∼</span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mclose mtight">]</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">∼</span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mclose mtight">]</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8428em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1972em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8811em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8411em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1589em;"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><strong>Diffusion 本质上是在对噪声进行学习，网络的输入是一张和噪声混杂的图片 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 以及一个时间步 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>，输出是一个噪声。</strong></p><h2 id="训练以及采样过程">训练以及采样过程</h2><div style="width:100%;margin:auto"><img src="/machine-learning/diffusion/DDPM-algo.png" class=""></div><p>现在对整体过程做一个总结：</p><ul><li>训练时，对于某一时间步 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>，我们可以采样一个高斯噪声，并由原始图片与采样的噪声得到该时间步的加噪图片 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，对于可训练的模型输入该加噪图片，输出对噪声的预测 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold-italic">ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{\epsilon}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">ϵ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，并且将预测误差作为损失进行训练。</li><li>推理采样时，从噪声出发，在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> 个时间步内的每一个时间步，使用训练好的模型对当前噪声图片进行预测并得到预测的噪声，并依据预测对图片进行更新，到最后得到目标图像 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li></ul><h1>Reference</h1><ul><li><a href="https://lilianweng.github.io/posts/2021-07-11-diffusion-models/">What are Diffusion Models?</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>diffusion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《马斯克传》读书笔记</title>
    <link href="/reading-note/elon-musk/"/>
    <url>/reading-note/elon-musk/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>酣畅淋漓的马斯克传记，我愿称之为 2023 最佳科幻小说。</p><span id="more"></span><h2 id="作者">作者</h2><p>Walter Isaacson，乔布斯传及爱因斯坦传的作者。</p><h2 id="极简简介">极简简介</h2><h3 id="极简评价">极简评价</h3><p>这本书过于有趣，不敢想象一个人的半生就已经如此精彩。这是一个纯粹的人，他的性格特点和棱角似乎一直都没有被磨平。比较惊叹的是他对于伟大事物的追寻以及魄力。读罢有一种让人想要行动起来的欲望。</p><h3 id="感想-看法">感想/看法</h3><ul><li>马克思造火箭这种风风火火的行为让我想到之前的亿万富翁泰坦号潜艇事故，安全和效率的确有 trade-off。</li><li>文中马斯克身边的人对做事都有一定的执着。有趣的是，不管是提拔还是开除，文中几乎没有提到待遇和股份，而是注重于能力和沟通。似乎世俗的指标在书中不值一提。</li></ul><h2 id="内容摘录">内容摘录</h2><ul><li>【火之缪斯】戏剧性是他人生中的最佳伴侣</li><li>【Zip2】“伟大的东西永远不会在风险投资人和职业经理人手里诞生，”马斯克告诉《公司》杂志，“他们没有创造力，也没有洞察力。”</li><li>【反抗者联盟】“你如果把社交网络和支付平台结合起来，就能创造出我心目中 <a href="http://X.com">X.com</a> 应该成为的样子。”</li><li>【火箭人】他因此发展出了一个概念，叫“白痴指数”，用来计算某个制成品的成本比其基本材料的成本高多少。如果一个产品的“白痴指数”很高，那么一定可以通过规划设计出更有效的制造技术来大幅降低它的成本。</li><li>【工业奇兵】他从这些风险投资案例中吸取了一个非常重要的教训：“让一家公司成功的不是产品本身，而是高效地制造产品的能力。这个问题其实就是，你怎么制造那些制造机器的机器。换句话说，你是怎么设计工厂的。”这是一个指导原则，后来马斯克把它内化成了自己的原则。</li><li>【人工智能】马斯克还意识到，一个人工智能系统能否成功，取决于它能不能从真实世界获得大量数据供机器学习。他当时意识到，特斯拉就是这样一个“金矿”，它每天收集数百万帧司机处理各类情况的视频。他说：“特斯拉可能比世界上其他公司拥有更多的真实世界数据。”他后来意识到，另一个真实世界数据的宝库就是推特：截至2023年，推特每天要处理5亿条人类发出的帖子。</li><li>【车用人工智能】马斯克在管理时喜欢通过下命令的方式来决定哪些指标最重要，于是他给了他们一个标准：特斯拉全自动驾驶车辆在没有人类干预的情况下能够行驶的里程数。</li></ul><h2 id="五步工作法">五步工作法</h2><ol><li>质疑每项要求，提出任何一项要求时，都应该附上提出这一要求的人。永远不要接受一项来自某个部门的要求，比如来自“法务部门”或着：“安全部门”的要求。你必须知道提出这项要求的人的名字。接下来你应该质疑它，不管这个人有多聪明。聪明人提出的要求才是最危险的，因为人们不太可能质疑他们。这件事要一直做下去，即便这项要求来自我马斯克本人。质疑后，大家就要改进要求，让它变得不那么愚蠢。</li><li>删除要求当中所有你能删除的部分和流程，虽然你可能还得把它们加回来。事实上，你如果最后加回来的部分还不到删除部分的10%，那就说明你删减得还不够。</li><li>简化和优化。这应该放在第2步之后，因为人们常犯的错误就是简化和优化一个原本不应该存在的部分或者流程。</li><li>加快周转时间。每个流程都可以加快，但只有遵循了前三个步骤之后才能这么做。在特斯拉工厂，我错误地把很多精力花在加快生产流程上，后来我才意识到有些流程原本就应该被拿掉。</li><li>自动化。在内华达工厂和弗里蒙特工厂犯下的一个大错就是我一开始试图将每个步骤进行自动化改造。我们本应该先质疑所有要求，删除不必要的部分和流程，把问题筛出来、处理掉，然后再推进自动化。</li></ol>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Elon-Musk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《为什么伟大不能被计划》读书笔记</title>
    <link href="/reading-note/greatness-cannot-be-planned/"/>
    <url>/reading-note/greatness-cannot-be-planned/</url>
    
    <content type="html"><![CDATA[<p>个人认为是一本被过誉的 2023 年畅销书。</p><span id="more"></span><h2 id="极简简介">极简简介</h2><p>作者 Kenneth Stanley &amp; Joel Lehman，两位都是 OpenAI 在职的研究员，ChatGPT 的核心研发科学家。今年大模型爆火，OpenAI 出圈，在创投圈此书可谓是风头无二。我或许知道此书题目想传达的“伟大不能被计划”的意思，但是还是未能免俗买来一看。</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>个人认为这是一本十分被过誉的书，只有一个核心观点 “探索十分重要”。围绕这一点作者展开了啰嗦的陈述（并算不上论证），凑满了一本书的篇幅。有一些启发，但是不多。</p><h3 id="缺点">缺点</h3><ul><li>有时候本文会自相矛盾，“发条玩具与双足机器人相比，奔跑速度之快令人印象深刻，但它不可能最终成为通往机器人技术革命的桥梁。”这里就相当于设立了机器人的远大目标，本质上还是某种计划。但是却用于论证一个小分支“不能只看当下表现”。</li><li>本文最大的问题或许还是论证逻辑不清晰，直接原因是定义不清。即没有讲清楚什么是“伟大”，也没有讲清什么叫“计划”，自己的理解是：<ul><li>“伟大”大多都是指当下预期的一些较为重要事物。</li><li>“计划”大多是指朝着目标行进的过程。</li><li>书中没有明说，但是其实表达的核心是“不能通过计划一条确定的路径得到伟大，而是要通过演化（寻找踏脚石）得到伟大”。</li></ul></li><li>演化可以理解为一个膨胀的树形结构，随着子代更新不断迭代到树的下一层。而伟大是指某个价值较高的叶节点。<ul><li>“伟大不能被计划”可以理解为规定一个较远的叶节点，难以从当前根结点出发以一个确定的路径到达。</li><li>从树的叶节点往回看，是一条清晰的逻辑通路，但是从根节点看，确实一个很大的搜索空间，所以我们当然可以说这个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">1/2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> 概率小到不合逻辑，即不能被计划。</li><li>这其实并不新鲜，这个和伟不伟大无关，和计不计划也无关。</li></ul></li><li>作者似乎啰嗦了半天，讲了一件显而易见的事情。</li></ul><h3 id="感想-看法">感想/看法</h3><ul><li>不太认可中文序言中的“求新就意味着求复杂”。根据奥卡姆剃刀原理，更复杂未必更好。当然“掌握更多信息”我还是赞同的。</li><li>预感通篇都会在讲 Exploration-Exploitation，结果是通篇都在强调 exploration。</li><li>“也许有时候支持最大限度的分歧，而不是一致的意见，会更有意义。”想到了 NCS 算法。</li><li>迭代更新解或者解集真的是计算机算法的基石之一，也是优化的基本逻辑。</li><li>要想清楚“我们在逃离什么”这一点十分有趣，这个其实可以指代我们当前的缺陷是在哪里。</li><li>新奇性算法本质上感觉是一种蚁群算法，追求蚁群整体利益最大化（某一只蚂蚁获得高收益），对每一只蚂蚁而言并非利益最大化。而最终的收益并不是线性的，某一只蚂蚁会遇到收益的爆炸增长，即找到那么多目标点中的一个即可。</li><li>使用图片培育做类比是很不具有普遍意义的，当然仅作为演化的一个例子出发没什么问题。</li><li>这本书让我想到那个问题“是否只有专家才能评价？”。</li><li>在世界上第一个生命出现之时，为什么他会活下去以及繁衍呢？即“活着”这一命题什么时候出现以及为啥出现？因为我们是往回看，所以看到的只是留下来的。所以一切能看到的东西都会有趋向于留下来的生命特征。最简单的就是被切一半还能留下来的特性，这就是原始的单细胞原核生物。</li><li>新产生的生命都是探索新赛道而不是卷旧赛道。</li><li>和基因之河很多描述类似，因为都是基于物种进化的概念而来。</li></ul><h2 id="按节讨论-摘录">按节讨论/摘录</h2><ul><li>从上述“搜素空间”的角度思考，“发现”便是我们把创造的过程看作搜索这个庞大房间的过程。</li><li>若目标设置得足够适度，它就会起到积极作用；反之，目标越“高大上”，情况就越复杂。</li><li>我们的世界充斥着为了获得成功而设置的各色目标和衡量标准，这使我们的生活变得机械化，压抑了我们的生活热情，但通往幸福和成功还有其他途径。</li><li>欺骗性往往是目标不能带来伟大成就的关键原因。如果目标具有欺骗性 （其实大多数 “高大上”的目标都如此），那么设定目标并以此为我们努力方向的做法对实现目标没有什么帮助。</li><li>但是，当目标的故事围绕着“生存和繁衍”这样的开放式约束条件展开时，我们应该小心对待。</li><li>通常情况下，目标应该是一个明确而具体的产物，且在成功实现目标的情况下，你最終确实会生产出它，而非一个模糊的笼统的描述。</li><li>“生存和繁衍”是自然进化过程寻找踏脚石的一种手段——它使进化过程能够识别出可能成功催生出其他生物的有机体。但这并不是非目标性探索的唯一手段。</li><li>我们这里谈论的“目标”都是深层次的远大目标，如果你距离目标只有一块踏脚石的距离，那么设置并遵循目标依然是有意义的。</li><li>设定目标尽管在当下很吸引人，却是整个过程中最容易完成的事情。</li><li>我们不妨将花在制定明确目标上的精力，转投到那些有希望引导我们实现某些伟大事业的踏脚石上，但这些踏脚石不一定淮确地通往我们设定的目标。</li><li>有趣的是，这种比较将问题从“我们正在接近什么”，变成 “我们正在逃离什么”，而逃离过去的有趣之处在于，它能够开启全新的可能性。</li><li>我们或许会假设，凌乱无序或疯狂甚至是开启伟大发现之旅的最佳方式。</li><li>关于简单的本质，我们可以长篇大论地说上好几章，但在本书范围内，简单行为的关键特征是，它不要求掌握关于这个世界的任何信息或知识。</li><li>从某种意义上说，经过漫长岁月的进化后，人类的身体已经成为一种关于人类所处的宇宙的相关事实的百科全书。</li><li>物理世界自身就提供了很多约束。新奇性搜索不会考虑许多可以想象但无法实现的行为。</li><li>世界的物理特性限制了新奇性搜素能考虑的所有行为，这一想法也解释了 新奇性搜索积累世果信息的趋势：真正成为下一步行为的踏脚石的那些行为，必须尊重现实世界运作的方式和规律。</li><li>放弃目标之所以困难，是因为这意味着放弃“存在正确道路”的想法。</li><li>一种可能性就是，如果人类并非进化的既定目标，那么使我们进化出有别于其他物种的特征，可能才是真正的目标。</li><li>匪夷所思的是，从那以后，生命的进程好像就停滞了，因为从原始数量和多样性来看，占主导地位的生命形式，从古至今都非单细胞生物莫属。</li><li>因为每位科学家个人的时间和资源都是有限的，所以每个学科社区，必须帮助其成员确定哪些科研想法才是最重要的想法。这样一来，同一个社区中的科学家们，就可以在不需要阅读全部论文或文献的情况下，了解到最前沿的信息。</li><li>如果一个新算法，在一个基准上的表现，比不上它的竞争对手，新想法的发明者往往会试图政善它的性能，或找到一个更有利的基准进行比较。</li><li>发条玩具与双足机器人相比，奔跑速度之快令人印象深刻，但它不可能最终成为通往机器人技术革命的桥梁。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OpenAI</tag>
      
      <tag>读书</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cognitive Architectures 学习</title>
    <link href="/extend-learning/cognitive-architectures/"/>
    <url>/extend-learning/cognitive-architectures/</url>
    
    <content type="html"><![CDATA[<p>对综述 <em>40 years of cognitive architectures: core cognitive abilities and practical applications</em> 的阅读学习笔记。</p><span id="more"></span><ul><li><a href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%89%8D">写在最前</a></li><li><a href="#%E8%AE%BA%E6%96%87%E5%86%85%E5%AE%B9%E6%80%BB%E8%A7%88">论文内容总览</a><ul><li><a href="#introduction">Introduction</a></li><li><a href="#what-are-cognitive-architectures">What are cognitive architectures?</a><ul><li><a href="#%E7%9B%AE%E6%A0%87">目标</a></li><li><a href="#%E6%9C%AC%E6%96%87%E7%9A%84%E8%AE%B0%E5%BD%95%E9%80%BB%E8%BE%91">本文的记录逻辑</a></li><li><a href="#%E8%AE%A4%E7%9F%A5%E6%9E%B6%E6%9E%84%E7%8E%B0%E7%8A%B6">认知架构现状</a></li></ul></li><li><a href="#taxonomies-of-cognitive-architectures">Taxonomies of cognitive architectures</a></li></ul></li><li><a href="#%E8%AE%A4%E7%9F%A5%E6%9E%B6%E6%9E%84%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9D%97">认知架构主要模块</a><ul><li><a href="#perception">Perception</a><ul><li><a href="#vision">Vision</a></li><li><a href="#audition">Audition</a></li><li><a href="#symbolic-input">Symbolic input</a></li><li><a href="#multi-modal-perception">Multi-modal perception</a></li></ul></li><li><a href="#attention">Attention</a></li><li><a href="#action-selection">Action selection</a></li><li><a href="#memory">Memory</a><ul><li><a href="#long-term-storage">Long-term storage</a></li><li><a href="#short-term-storage">Short-term storage</a></li><li><a href="#global-memory">Global Memory</a></li></ul></li><li><a href="#learning">Learning</a></li><li><a href="#reasoning">Reasoning</a></li><li><a href="#metacognition">Metacognition</a></li></ul></li><li><a href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E6%96%B9%E5%90%91">实际应用方向</a></li><li><a href="#%E8%AE%A8%E8%AE%BA">讨论</a></li><li><a href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E">写在最后</a></li></ul><h1>写在最前</h1><div class="note note-warning">            <p>由于先前并不太清楚认知架构到底是什么？用来做什么？所以此处先从从个人的机器学习背景出发做一个初步的理解。</p>          </div><p>首先，认知架构不是一个具体任务上的具体解决方案，而是一种范式，即具体任务上认知系统的设计思想、原则和方法。它们类似于编程中的类，而基于架构创建的特定认知系统则类似于类的实例。</p><p>这些认知架构提供了一种理解和模拟人类认知过程的方法，包括感知、注意机制、行为选择、学习、记忆和推理等核心认知能力。通过构建针对特定任务的认知系统，研究者可以模拟和理解这些核心认知能力是如何影响人类在实际应用中的表现的。在特定任务中，这些核心认知能力可以通过不同的方法和技术来实现，例如机器学习、深度学习、强化学习等。</p><p>这些系统可以应用于各种实际应用和研究问题，例如人机交互、教育、健康等领域。</p><h1>论文内容总览</h1><h2 id="Introduction">Introduction</h2><div class="note note-danger">            <p>Cognitive architectures reviewed in this paper are mainly used as research tools and very few are developed outside of academia.</p>          </div><p>本文的目的：</p><ul><li>To present a broad, inclusive, judgment-neutral snapshot of the past 40 years of development of the field with an emphasis on the core capabilities of perception, attention mechanisms, action selection, learning, memory, reasoning, meta reasoning and their practical applications.</li></ul><p>为了使本文易读，对调研边界作了如下限定：</p><ul><li>Consider only implemented architectures with at least one practical application and several peer-reviewed publications.</li><li>Do not explicitly include some of the philosophical architectures</li><li>Exclude large-scale brain modeling projects<ul><li>which are low-level and do not easily map onto the breadth of cognitive capabilities modeled by other types of cognitive architectures.</li><li>many of the existing brain models do not yet have practical applications.</li></ul></li></ul><h2 id="What-are-cognitive-architectures">What are cognitive architectures?</h2><h3 id="目标">目标</h3><ul><li>Reason about problems across different domains, develop insights, adapt to new situations and reflect on themselves.</li><li>Research in cognitive architectures is to model the human mind, eventually enabling us to build human-level artificial intelligence.</li><li>Provide evidence what particular mechanisms succeed in producing intelligent behavior and thus contribute to cognitive science.</li></ul><h3 id="本文的记录逻辑">本文的记录逻辑</h3><ul><li>What methods or strategies</li><li>How they have been used</li><li>What level of success has been achieved or lessons learned</li><li>Important elements that help guide future research</li></ul><h3 id="认知架构现状">认知架构现状</h3><p>Although particular models already demonstrate cognitive abilities in limited domains, at this point they do not represent a unified model of intelligence.</p><h2 id="Taxonomies-of-cognitive-architectures">Taxonomies of cognitive architectures</h2><p>Three major paradigms are currently recognized:</p><ul><li>Symbolic (also referred to as cognitivist)<ul><li>Symbolic systems excel at planning and reasoning, they are less able to deal with the flexibility and robustness that are required for dealing with a changing environment and for perceptual processing.</li><li>符号主义，更倾向于严格的逻辑推理与规划。</li></ul></li><li>Emergent (connectionist)<ul><li>The resulting system also loses its transparency, since knowledge is no longer a set of symbolic entities and instead is distributed throughout the network.</li><li>连接主义，更倾向于模拟人类大脑的神经网络。</li></ul></li><li>Hybrid</li></ul><h1>认知架构主要模块</h1><div class="note note-warning">            <p>基本是原文关键信息节选。</p>          </div><h2 id="Perception">Perception</h2><p>Perception is a process that transforms raw input into the system’s internal representation for carrying out cognitive tasks.The five most common ones are vision, hearing, smell, touch and taste.</p><h3 id="Vision">Vision</h3><ul><li>The real vision systems only receive pixel-level input with no additional information (e.g. camera parameters, locations and features of objects, etc.).</li><li>The simulated vision systems generally omit early and intermediate vision and receive input in the form that is suitable for the later stages of visual processing (e.g. symbolic descriptions for shape and color, object labels, coordinates, etc.).</li></ul><h3 id="Audition">Audition</h3><p>Since the auditory modality is purely functional, many architectures resort to using available speech-to-text software rather than develop models of audition.Much less attention is paid to the emotional content (e.g. loudness, speech rate, and intonation)</p><h3 id="Symbolic-input">Symbolic input</h3><p>These include input in the form of text commands and data, and via a GUI.</p><h3 id="Multi-modal-perception">Multi-modal perception</h3><p>Human brain receives a constant stream of information from different senses and integrates it into a coherent world representation.For the most part, cognitive architectures ignore cross-modal interaction.</p><h2 id="Attention">Attention</h2><p>Attention mediates the selection of relevant and filters out irrelevant information from the incoming sensory data.</p><p>Elements of attention are grouped into three classes of information reduction mechanisms:</p><ul><li>selection (choose one from many)</li><li>restriction (choose some from many)</li><li>suppression (suppress some from many).</li></ul><p>Overall, visual attention is largely overlooked in cognitive architectures research with the exception of the biologically plausible visual models (e.g. ART) and the architectures that specifically focus on vision research (ARCADIA, STAR).</p><h2 id="Action-selection">Action selection</h2><p>Action selection can be split into</p><ul><li>the “what” part involving the decision making</li><li>the “how” part related to motor control</li></ul><p>We distinguish between two major approaches to action selection: planning and dynamic action selection.</p><ul><li>Planning refers to the traditional AI algorithms for determining <strong>a sequence of steps</strong> to reach a certain goal or to solve a problem in advance of their execution.</li><li>In dynamic action selection, <strong>one best action</strong> is chosen among the alternatives based on the knowledge available at the time.</li></ul><h2 id="Memory">Memory</h2><p>Research on memory in the cognitive architectures mainly concerns its structure, representation and retrieval.Relatively little attention has been paid to the challenges associated with maintaining a large-scale memory store since both the domains and the time spans of the intelligent agents are typically limited.</p><h3 id="Long-term-storage">Long-term storage</h3><p>Long-term storage is further subdivided into semantic, procedural and episodic types, which store factual knowledge, information on what actions should be taken under certain conditions and episodes from the personal experience of the system respectively.</p><ul><li>procedural memory of implicit knowledge (e.g. motor skills and routine behaviors)</li><li>declarative memory, which contains explicit knowledge.<ul><li>semantic (factual) memory</li><li>episodic (autobiographical) memory.</li></ul></li></ul><h3 id="Short-term-storage">Short-term storage</h3><ul><li>sensory memory: cache the incoming sensory data and preprocess it before transferring it to other memory structures</li><li>working memory: mechanism for temporary storage of information related to the current task.</li></ul><h3 id="Global-Memory">Global Memory</h3><p>Some architectures do not have separate representations for different kinds of knowledge or short- versus long-term memory, and instead, use a unified structure to store all information in the system</p><h2 id="Learning">Learning</h2><p>Learning is the capability of a system to improve its performance over time.</p><p>The type of learning and its realization depend on many factors, such as design paradigm (e.g. biological, psychological), application scenario, data structures and the algorithms used for implementing the architecture, etc.</p><ul><li>Perceptual learning: applies to the architectures that actively change the way sensory information is handled or how patterns are learned on-line.</li><li>Declarative learning: declarative knowledge is a collection of facts about the world and various relationships defined between them.</li><li>Procedural learning: refers to learning skills, which happens gradually through repetition until the skill becomes automatic.</li><li>Associative learning: is a broad term for decision-making processes influenced by reward and punishment. Reinforcement learning (RL) and its variants are commonly used in computational models of associative learning.</li><li>Non-associative learning: does not require associations to link stimuli and responses together. Habituation and sensitization are commonly identified as two types of non-associative learning.<ul><li>Habituation describes gradual reduction in the strength of response to repeated stimuli.</li><li>Sensitization describes gradual increase in the strength of response to repeated stimuli.</li><li>Because of their simplicity, these types of learning are considered a prerequisite for other forms of learning.</li><li>Most of the work to date in this area has been dedicated to the habituation in the context of social robotics and human-computer interaction.</li></ul></li><li>Priming: occurs when prior exposure to stimulus affects its subsequent identification and classification.</li></ul><h2 id="Reasoning">Reasoning</h2><p>All cognitive architectures are concerned with</p><ul><li>practical reasoning: to find the next best action and perform it</li><li>theoretical reasoning: aims at establishing or evaluating beliefs.</li></ul><p>One of the main challenges a human, and consequently any human-level intelligence, faces regularly is acting based on insufficient knowledge or “making rational decisions against a background of pervasive ignorance”So far, the most consolidated effort has been spent on overcoming the insufficient knowledge and/or resources problem in continuously changing environments.</p><p>The question of whether higher human cognition is inherently symbolic or not is still unresolved.The symbolic and hybrid architectures considered so far, view reasoning mainly as a symbolic manipulation.</p><h2 id="Metacognition">Metacognition</h2><p>Intuitively defined as “thinking about thinking”, is a set of abilities that introspectively monitor internal processes and reason about them.Metacognition is also necessary for social cognition, particularly for the skill known in the psychological literature as a Theory of Mind (ToM).ToM refers to being able to acknowledge and understand mental states of other people, use the judgment of their mental state to predict their behavior and inform one’s own decision-making.</p><h1>实际应用方向</h1><p>What cognitive abilities have been demonstrated by the cognitive architectures and what particular practical tasks have they been applied to?</p><p><img src="application.png" alt="Architecture and Applications"></p><p>上图是文章中对现有架构的应用进行的分类统计。可以看到 ACT-R 这个架构的应用最多，其次是 ART 和 SOAR，或许之后可以对这三个架构进行更深入的了解。这些统计图表也可以在<a href="http://jtl.lassonde.yorku.ca/project/cognitive_architectures_survey/applications.html">此网站</a>查阅。</p><p>Categories of applications:</p><ul><li>Psychological experiments<ul><li>Demonstrate that cognitive architectures can adequately model human data</li><li>Give reasonable explanations for existing psychological or physiological phenomena.</li><li>If the data produced by the simulation matches the human data in some or most aspects, it is taken as an indication that a given cognitive architecture can to some extent imitate human cognitive processes.</li></ul></li><li>Robotics<ul><li>Much effort has been spent on navigation and obstacle avoidance, which are useful on their own and enable more complex behaviors.</li><li>Fetch and carry tasks</li><li>Search and object manipulation tasks</li></ul></li><li>Human performance modeling HPM<ul><li>Build quantitative models of human performance in a specific task environment.</li><li>Has been used extensively for military applications.</li></ul></li><li>Human-robot and human/computer interaction (HRI/HCI)<ul><li>The systems presented in this survey allow for some level of supervisory control ranging from single vowels signifying direction of movement for a robot to natural language instruction</li><li>Build decision support systems, i.e. intelligent assistants which can learn from and cooperate with experts to solve problems in complex domains.</li></ul></li><li>Natural language processing (NLP)<ul><li>Low-level auditory perception</li><li>Syntactic and semantic processing</li></ul></li><li>Categorization and clustering<ul><li>Process noisy sensory data.</li><li>Applications in this group are almost entirely implemented by the emergent architectures, such as ART and HTM, which are used as sophisticated neural networks.</li></ul></li><li>Computer vision<ul><li>Emergent cognitive architectures are widely applied to solving typical computer vision problems.</li><li>However, these are mainly standalone examples</li></ul></li><li>Games and puzzles<ul><li>Not to master the game but rather to use it as a step towards solving similar but more complex problems.</li><li>The only drawback of using video games for research is that embedding a cognitive architecture within it requires software engineering work.</li></ul></li><li>Virtual agents<ul><li>While HPM requires models which can closely model human behavior in precisely defined conditions, the goals of creating virtual agents are more varied.</li><li>Simulations and virtual reality are frequently used as an alternative to the physical embodiment.</li><li>Simulations model behavior of soldiers in dangerous situations without risking their lives.</li></ul></li></ul><h1>讨论</h1><div class="note note-warning">            <p>节选自原文讨论部分。</p>          </div><ul><li>The main contribution of this survey is in gathering and summarizing information on a large number of cognitive architectures influenced by various disciplines (computer science, cognitive psychology, philosophy and neuroscience).</li><li>The data presented in this survey (e.g. Sect. 11.2 on practical applications) shows that, by and large, the architectures have practical achievements only in several distinct areas and in highly controlled environments.</li><li>The resolution of the commonly acknowledged issues hinges on the development of objective and extensive evaluation procedures.<ul><li>Individual architectures are validated using a disjointed and sparse set of experiments, which cannot support claims about the abilities of the system or adequately assess its representational power.</li><li>However, comparisons between architectures and measuring overall progress in the field entails an additional set of challenges.</li></ul></li></ul><h1>写在最后</h1><p>这篇文章或许更注重从“道”的层面来分析认知架构，而不是从“术”的层面来分析。或者说，认知架构本来就是一种“道”，用于指导解决实际认知方面问题。从这个角度而言，或许重要的是如何把整个体系分析得更全面，以在具体场景下快速组装出可用系统。</p><p>（目前了解有限，自说自话）个人感觉认知架构最重要的东西似乎是本文那些图标里的坐标轴，即需要（能提供）什么功能，其次才是功能如何设计实现。那么从这个角度而言，或许本文提到的所有认知架构，都可以融合为一个架构库，在相同功能下（感知、储存、决策等）可以换用不同模块。当然不同功能的模块间可能需要一定程度适配，而不仅是暴力整合，但是在此之前“知道需要什么功能”应当是最重要的。这个个人认为是本文的最大贡献。</p><p>此外可能还有一些概念上的讨论。如何理解认知架构与我们当前说的 AI 玩游戏、机器人、智能助手这些领域的关系呢？后面这些概念基本都会在 AI 的范畴下讨论，而并不是认知架构的范畴下（这一点可能有个人 bias）。这些任务或许都比较实际，需要一个落地的系统，此系统可以依赖于认知架构的指导设计。所以边界上来说似乎比较模糊。个人认为不太需要割裂或者强行区分它们的定义，可以简单理解为一件事的多个角度思考。</p><p>那么如何使用这些认知架构呢？或许还是要具体任务具体分析</p><ol><li>先思考所需功能（根据任务目标分析）</li><li>再经验性地选择一些底层技术（符号？连接？）</li><li>然后再实现这些功能</li><li>拼装实现好的功能得到最终的系统并调优</li></ol><p>本文其实提供了 1、2 所需的经验，3、4 很大程度可以利用当前 AI 以及机器学习的技术，似乎这个逻辑较为清晰了。</p><p>最有趣的或许是认知科学这件事能用在哪些实际的任务上，这个就慢慢发掘吧。</p>]]></content>
    
    
    <categories>
      
      <category>Extend Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI</tag>
      
      <tag>Cognitive</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>具身智能</title>
    <link href="/extend-learning/embodied-ai/"/>
    <url>/extend-learning/embodied-ai/</url>
    
    <content type="html"><![CDATA[<p>具身智能作为当下最火的学界业界方向之一，在此从学界和产业的角度对其做一个调研。</p><span id="more"></span><div class="note note-warning">            <p>💡 本文致力于回答以下问题：</p><ul><li>什么是具身智能？如何理解具身智能？</li><li>当前具身智能的研究来到了什么位置？</li><li>如何理解具身智能的产业逻辑？</li><li>具身智能上下游产业链条有什么？各有什么例子？有什么产业预期？</li></ul>          </div><div class="note note-danger">            <ul><li>本文从定义出发，再由学界到产业界调研。</li><li>本文未深入上下游具体公司。</li><li>本文未对具体数据进行定量调研分析。</li></ul>          </div><ul><li><a href="#%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD">具身智能</a></li><li><a href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD">1. 什么是具身智能？</a><ul><li><a href="#ccf-%E5%AE%9A%E4%B9%89">CCF 定义</a></li><li><a href="#%E5%87%BA%E5%A4%84">出处</a></li></ul></li><li><a href="#2-%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD%E4%BB%8E%E6%A6%82%E5%BF%B5%E4%B8%8A%E6%B7%B1%E5%85%A5%E4%B8%80%E4%BA%9B">2. 具身智能：从概念上深入一些</a><ul><li><a href="#%E7%A0%94%E7%A9%B6%E7%9B%AE%E6%A0%87">研究目标</a></li><li><a href="#%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD%E7%89%B9%E6%80%A7%E4%B8%A4%E4%B8%AA%E7%BB%B4%E5%BA%A6">具身智能特性（两个维度）</a><ul><li><a href="#%E5%85%B7%E8%BA%AB%E5%BC%BA%E8%B0%83%E7%89%A9%E7%90%86%E4%B8%96%E7%95%8C">具身（强调物理世界）</a></li><li><a href="#%E6%99%BA%E8%83%BD%E5%BC%BA%E8%B0%83%E5%86%B3%E7%AD%96%E8%BF%87%E7%A8%8B">智能（强调决策过程）</a></li></ul></li><li><a href="#%E4%B8%AA%E4%BA%BA%E5%BD%93%E4%B8%8B%E5%AF%B9%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD%E7%9A%84%E7%90%86%E8%A7%A3">个人当下对具身智能的理解</a></li></ul></li><li><a href="#3-%E5%8F%91%E5%B1%95%E8%84%89%E7%BB%9C">3. 发展脉络</a><ul><li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BD%93%E4%B8%8B%E5%BC%BA%E8%B0%83%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD">为什么当下强调具身智能？</a></li><li><a href="#%E8%BF%91%E6%9C%9F%E5%8F%91%E5%B1%95%E6%97%B6%E9%97%B4%E7%BA%BF%E9%87%8D%E8%A6%81%E4%BA%8B%E4%BB%B6">近期发展时间线（重要事件）</a></li></ul></li><li><a href="#4-%E5%BD%93%E5%89%8D%E7%A0%94%E7%A9%B6%E7%8E%B0%E7%8A%B6">4. 当前研究现状</a><ul><li><a href="#%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD%E7%A0%94%E7%A9%B6%E6%A0%B8%E5%BF%83%E4%BB%A5%E5%8F%8A%E9%9A%BE%E7%82%B9%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%95%B4%E7%90%86">具身智能研究核心以及难点（不完全整理）</a><ul><li><a href="#%E6%84%9F%E7%9F%A5%E4%B8%8E%E8%A1%A8%E7%A4%BA">感知与表示</a></li><li><a href="#%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%80%82%E5%BA%94">学习与适应</a></li><li><a href="#%E5%8A%A8%E4%BD%9C%E4%B8%8E%E6%8E%A7%E5%88%B6">动作与控制</a></li></ul></li><li><a href="#%E8%BF%91%E6%9C%9F%E7%A0%94%E7%A9%B6%E8%BF%9B%E5%B1%95">近期研究进展</a><ul><li><a href="#%E4%BB%BF%E7%9C%9F%E6%96%B9%E9%9D%A2">仿真方面</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E6%96%B9%E9%9D%A2">数据方面</a></li><li><a href="#%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%96%B9%E9%9D%A2">大模型方面</a></li></ul></li><li><a href="#%E5%9B%BD%E9%99%85%E5%9B%BD%E5%86%85%E5%AD%A6%E8%80%85%E4%B8%8D%E5%AE%8C%E5%85%A8">国际国内学者（不完全）</a></li></ul></li><li><a href="#5-%E4%BA%A7%E4%B8%9A%E9%80%BB%E8%BE%91">5. 产业逻辑</a><ul><li><a href="#%E5%88%86%E6%9E%90%E6%80%9D%E8%B7%AF">分析思路</a></li><li><a href="#%E7%9B%AE%E6%A0%87%E5%AE%8C%E6%88%90%E5%BA%A6">目标完成度</a></li><li><a href="#%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD%E7%9A%84%E4%BB%B7%E5%80%BC">具身智能的价值</a><ul><li><a href="#%E6%9B%BF%E4%BB%A3%E4%BA%BA%E7%B1%BB%E8%A7%A3%E6%94%BE%E4%BA%BA%E5%8A%9B%E9%99%8D%E4%BD%8E%E6%88%90%E6%9C%AC">替代人类（解放人力、降低成本）</a></li><li><a href="#%E8%BE%85%E5%8A%A9%E4%BA%BA%E7%B1%BB%E5%A2%9E%E5%BC%BA%E4%BA%BA%E5%8A%9B%E9%99%8D%E4%BD%8E%E6%88%90%E6%9C%AC%E5%8C%96%E4%B8%8D%E5%8F%AF%E8%83%BD%E4%B8%BA%E5%8F%AF%E8%83%BD">辅助人类（增强人力、降低成本、化不可能为可能）</a></li></ul></li><li><a href="#%E6%8A%80%E6%9C%AF%E6%88%90%E7%86%9F%E8%B7%AF%E5%BE%84">技术成熟路径</a></li><li><a href="#%E6%88%90%E6%9C%AC%E5%8F%98%E5%8C%96%E8%B7%AF%E5%BE%84">成本变化路径</a></li><li><a href="#%E5%95%86%E4%B8%9A%E5%8F%91%E5%B1%95%E8%84%89%E7%BB%9C">商业发展脉络</a><ul><li><a href="#%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%B1%BB%E5%9E%8B%E6%8E%92%E5%BA%8F">机器人类型排序</a></li><li><a href="#%E5%B8%82%E5%9C%BA%E8%A7%84%E6%A8%A1">市场规模</a></li></ul></li><li><a href="#%E6%94%BF%E7%AD%96%E5%9B%A0%E7%B4%A0">政策因素</a></li></ul></li><li><a href="#6-%E4%BA%A7%E4%B8%9A%E9%93%BE%E6%9D%A1%E6%A2%B3%E7%90%86">6. 产业链条梳理</a><ul><li><a href="#%E4%B8%8B%E6%B8%B8%E5%BA%94%E7%94%A8%E6%96%B9%E5%90%91">下游应用方向</a><ul><li><a href="#%E6%9C%8D%E5%8A%A1%E5%9C%BA%E6%99%AF">服务场景</a></li><li><a href="#%E5%B7%A5%E4%B8%9A%E5%9C%BA%E6%99%AF">工业场景</a></li><li><a href="#%E7%A7%91%E7%A0%94%E5%9C%BA%E6%99%AF">科研场景</a></li><li><a href="#%E4%B8%80%E4%BA%9B%E5%85%AC%E5%8F%B8%E5%8F%8A%E4%BA%A7%E5%93%81">一些公司及产品</a></li></ul></li><li><a href="#%E4%B8%8A%E6%B8%B8%E6%8A%80%E6%9C%AF%E6%94%AF%E6%92%91">上游技术支撑</a></li></ul></li><li><a href="#7-%E4%B8%80%E4%BA%9B%E5%80%BC%E5%BE%97%E6%B3%A8%E6%84%8F%E7%9A%84%E9%A3%8E%E9%99%A9">7. 一些值得注意的风险</a></li><li><a href="#8-reference">8. Reference</a></li></ul><h1>具身智能</h1><h1>1. 什么是具身智能？</h1><h2 id="CCF-定义">CCF 定义</h2><p>实质：强调有物理身体的智能体通过与物理环境进行交互而获得智能的人工智能研究范式。</p><p>定义：具身智能是指一种基于物理身体进行感知和行动的智能系统，其通过智能体与环境的交互获取信息、理解问题、做出决策并实现行动，从而产生智能行为和适应性。</p><h2 id="出处">出处</h2><p>1950年，图灵在其为人工智能奠基、提出图灵测试的经典论文《Computing Machinery and Intelligence》的结尾展望了人工智能可能的两条发展道路：</p><ul><li>一条路是聚焦抽象计算（比如下棋）所需的智能。</li><li>另一条路则是为机器配备最好的传感器、使其可以与人类交流、像婴儿一样地进行学习。</li></ul><p>这两条道路便逐渐演变成了非具身和具身智能。前者即为我们当下普遍理解的 AI（以算法为中心），后者可以简单理解为 AI 与 Robots 的一个强交叉。</p><h1>2. 具身智能：从概念上深入一些</h1><h2 id="研究目标">研究目标</h2><p>探究如何使得智能体通过与环境产生交互后，通过自身的学习进化，产生对于客观世界的理解和改造能力。换句话说，如何使得机器人获得自主学习和操作能力。</p><p>目前主要包含三大研究方向：</p><ul><li>感知与表示：以何种方式对环境进行观测与建模。</li><li>学习和适应：对于建模好的环境，如何自适应任务场景并做出决策规划。</li><li>动作与控制：依据算法的决策，通过控制系统以物理动作输出。</li></ul><h2 id="具身智能特性（两个维度）">具身智能特性（两个维度）</h2><h3 id="具身（强调物理世界）">具身（强调物理世界）</h3><ul><li>环境角度：认知不能脱离物理世界存在。</li><li>智能体角度：认知对身体本身的形式依赖。身体参与了认知，影响了思维、判断等心智过程。</li><li>交互角度：有着物理环境交互能力。</li><li>概念角度：具身的概念是可检验、可测量的。（非责任心、荣誉、感情、欲望等主观概念）</li></ul><h3 id="智能（强调决策过程）">智能（强调决策过程）</h3><ul><li>学习能力：智能体（生物或机械）通过与环境产生交互后更新决策逻辑。</li><li>决策能力：有着自主智能决策能力（AI），即在环境中，通过输入当前状态可以返回决策。</li><li>泛化能力：机器在面对没见过的场景时，也能较好的进行决策。</li></ul><h2 id="个人当下对具身智能的理解">个人当下对具身智能的理解</h2><ul><li>具身智能主要针对于物理世界来设计智能化，期望智能体能够在物理世界中完成任务。<ul><li>要求智能体可以接受物理信息（通过传感器）</li><li>要求智能体可输出物理动作（通过控制系统）<ul><li>可对环境产生改变，例如机械手抓取任务等。</li><li>可不对环境产生改变，例如无人机自动巡航任务等。</li></ul></li><li>或要求智能体在交互过程中，建立并更新智能策略。</li></ul></li><li>物理世界有着以下关键特点<ul><li>状态空间极大：即可以被传感器捕捉的状态多样，同时传感器的种类多样</li><li>噪音极高：可能来自于传感器、气候等因素</li></ul></li><li>具身智能体有着以下特点<ul><li>通常由传感器、控制系统、智能系统组成。</li><li>智能体之间或存在细微差别，可能来源于制造因素、也可能来源于相似类型的不同设计。</li></ul></li><li>在物理环境中训练智能的过程（个人粗浅理解）<ul><li>可以看做某种预训练模型基于真实场景自适应，通过小样本学习或者某种 finetune。</li><li>通常需要利用模仿学习或者强化学习的方式来构建基础模型。</li></ul></li></ul><h1>3. 发展脉络</h1><h2 id="为什么当下强调具身智能？">为什么当下强调具身智能？</h2><ul><li>具身智能是多个学科交叉互助的产物，当前一系列基石研究已有了长足的发展，表现为：<ul><li>机器人学为具身智能供机械身体和基本运动控制；</li><li>深度学习中的神经网络可以作为具身智能中主要工具；</li><li>强化学习以是具身智能机器人的主要学习手段之一；</li><li>机器视觉给具身智能提供了处理视觉信号的能力；</li><li>计算机图形学开发的物理仿真环境为具身智能提供了真实物理世界的替代；</li><li>自然语言给具身智能带来了与人类交流、从自然文本中学习的可能；</li><li>认知科学进一步帮助具身智能体理解人类、构建认知和价值。</li></ul></li><li>得益于其他交叉学科的落地，具身智能产业相关链条已有基本的雏形。</li><li>互当前离身智能系统物理交互能力的缺失成为了当今通向通用人工智能的瓶颈。</li></ul><h2 id="近期发展时间线（重要事件）">近期发展时间线（重要事件）</h2><ul><li>2017年第一届机器人学习大会CoRL(Conference on Robot Learning)召开，机器人学习领域涌现了大量新的智能任务、算法、环境。在之后的1-2年，具身智能任务开始逐渐涌现。</li><li>2018、2019年的CoRL会议上，大量的具身智能学术任务开始被提出并受到关注，包括具身视觉导航、具身问答系统等。</li><li>2019-2022，国际学术社区举办了多个以具身智能为主题的研讨会和挑战赛，例如CVPR 2019举办的具身智能挑战赛和研讨会(Habitat: Embodied Agents Challenge and Workshop)以及CVPR 2020到2022的具身智能研讨会(Embodied AI Workshop)。</li><li>2023年5月英伟达创始人兼首席执行官黄仁勋在 ITFWorld2023 半导体大会上，认为人工智能下一个浪潮将是“具身智能”，即能理解、推理、并与物理世界互动的智能系统。</li><li>在2023年即将举办的CVPR 2023具身智能研讨会上，组织了包括基于AI Habitat、AI2-THOR、iGibson、Sapien仿真器的物体重排列、具身问答、具身导航和机器人操作挑战赛。</li></ul><h1>4. 当前研究现状</h1><h2 id="具身智能研究核心以及难点（不完全整理）">具身智能研究核心以及难点（不完全整理）</h2><h3 id="感知与表示">感知与表示</h3><p>这是具身智能的基石。如何感知其环境，并如何将这些感知信息转化为有用的内部表示，在真实世界中自主行动的前提。例如，物体识别、相对位置识别、地形理解等。</p><ul><li><strong>多模态信息的整合</strong>：机器通常通过多个传感器（如摄像头、激光雷达、触摸传感器等）来感知环境，如何有效地整合和处理这些多模态信息是一个挑战。</li><li><strong>噪声和不确定性</strong>：传感器数据经常伴随噪声和误差，如何从不完美的数据中获得可靠、可信的感知是一个关键问题。</li><li><strong>实时性</strong>：很多应用场景中，机器需要能够快速地处理大量的感知数据，并实时地做出决策。</li></ul><h3 id="学习与适应">学习与适应</h3><p>具身智能强调从经验中学习和适应。意味着机器需要能够根据其与环境的交互来学习新的技能，或在面临未知的情境时进行适应，以处理各种不可预见的任务和环境变化。</p><ul><li><strong>少量数据学习</strong>：与互联网应用中可用的大量数据相比，具身智能系统往往只能访问有限的数据，如何在少量数据上进行有效的学习是一个难点。</li><li><strong>持续学习</strong>：随着时间的推移，环境和任务可能会发生变化，如何使机器能够持续地学习和适应，而不忘记早先学到的知识，是一个挑战。</li><li><strong>与人类指示的偏差</strong>：由于机器人与人类运动学结构的显著差异，机器人观察到的人类指示对其来说可能并不是最理想的方式。</li><li><strong>安全的探索</strong>：在学习新任务或新技能时，机器需要进行探索，但过度的或不恰当的探索可能会导致伤害或损坏，如何进行安全的探索是一个问题。</li></ul><h3 id="动作与控制">动作与控制</h3><p>具身智能需要将学习到的知识转化为实际的、有目的的行动。涉及到如何在复杂的物理环境中进行精确、高效的动作控制，例如如何规划路径，如何操作物体等。这直接影响到机器的实用性和效率。</p><ul><li><strong>复杂环境中的动作规划</strong>：在复杂、变化的环境中规划动作（如导航或操纵物体）是非常困难的，特别是当环境中存在其他动态实体（如人或车辆）时。</li><li><strong>高维控制问题</strong>：具身智能系统，尤其是多自由度的机器人，面临高维度的控制（动作）空间，这使得动作规划和控制更为复杂。</li><li><strong>实时反应和调整</strong>：在很多情况下，机器需要能够快速地对突发事件做出反应，并实时调整其动作。</li></ul><h2 id="近期研究进展">近期研究进展</h2><p>仅不完全统计，仅涵盖一些重要角度，每一个角度都可以顺藤摸瓜深度下去。</p><h3 id="仿真方面">仿真方面</h3><ul><li>2021 李飞飞团队开发了一个被称作“进化游乐场”的环境，论文 Embodied Intelligence via Learning and Evolution，发表在 Nature Communication。</li></ul><p><img src="garden.png" alt="进化游乐场"></p><ul><li>2023 通过使用<a href="https://www.bigai.ai/blog/news/%e9%80%9a%e9%99%a2%e6%9c%ba%e5%99%a8%e4%ba%ba%e5%ae%9e%e9%aa%8c%e5%ae%a4%ef%bc%9a%e5%85%b7%e8%ba%ab%e6%99%ba%e8%83%bd%e4%bd%93%e6%8a%80%e8%83%bd%e5%ad%a6%e4%b9%a0%ef%bc%8c%e4%bb%8e%e9%87%8d%e5%bb%ba/">数据手套（data glove）</a>来采集人在完成操作任务时与物体的交互数据，并让机器人从中学习。</li></ul><h3 id="数据方面">数据方面</h3><ul><li>2023-07 在真实环境中，人类可以遥控操作机器人来采集专家数据，通过模仿学习算法来训练机器人习得技能或交互策略。RH20T 提供了一个 20TB 级别的大规模多模态模仿学习数据。</li></ul><h3 id="大模型方面">大模型方面</h3><ul><li>预训练语言大模型和多模态大模型（例如 CLIP、ViLD 和 PaLI）作为基础模型为具身智能体在复杂场景中执行长程任务提供了支持。<ul><li>微软提出 ChatGPT + 机器人思路。</li><li>谷歌推出了Say-Can 基于语言推理的机器人操作。</li><li>2023-03 来自谷歌和德国林工业大学的一组人工智能研究人员公布了史上最大视觉语言模型 PaLM-E。其包括了 40B 语言模型与 22B 视觉 ViT 模型，将大模型能力泛化至CV领域，赋予大模型视觉能力。（视觉 - 语言大模型）</li><li>将具身智能理解为大模型代理任务，可参考最新的调研报告 <a href="https://arxiv.org/pdf/2309.07864.pdf">The Rise and Potential of Large Language Model Based Agents: A Survey</a>。</li></ul></li><li>机器人的视觉 - 语言 - 动作（VLA）大模型<ul><li>2023-08 谷歌 DeepMind 推出了第一个控制机器人的<a href="https://cloud.tencent.com/developer/tools/blog-entry?target=http%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA3MzI4MjgzMw%3D%3D%26mid%3D2650885700%26idx%3D1%26sn%3D468cd498f0f82df7f605dacd8fda44c5%26chksm%3D84e48a3ab393032cd29186a2af60f5826da5c1c46f6d0a509916ba62d4fb1254e506c400b1fe%26scene%3D21%23wechat_redirect">RT-2</a>。</li><li>2023-10 DeepMind 汇集了来自 22 种不同机器人类型的数据，以创建 Open X-Embodiment 数据集，然后在之前的模型（RT-1 和 RT-2）的基础上，训练出了能力更强的 RT-X（分别为 RT-1-X 和 RT-2-X）。</li></ul></li></ul><h2 id="国际国内学者（不完全）">国际国内学者（不完全）</h2><ul><li>卢策吾 -上海交通大学</li><li>王鹤 - 北京大学</li><li>李飞飞 - 斯坦福大学</li></ul><div class="note note-primary">            <p>💡 以上是学界的具身智能进展。之后我们从产业的角度展开，我们先分析产业整体的逻辑，再进行上下游的梳理。</p>          </div><h1>5. 产业逻辑</h1><h2 id="分析思路">分析思路</h2><ul><li>假设最终的目标完成度。</li><li>探讨目标完成度的商业价值、社会价值以及市场规模。</li><li>目标完成度的技术成熟路径，以及不同时间节点的产业状况。</li><li>上游成本变化路径，其直接影响下游应用范围。</li><li>在不同时点的完成度下，下游应用的变化。</li><li>一些影响产业发展的因素，比如政策。</li></ul><h2 id="目标完成度">目标完成度</h2><ul><li>高智能人形机器人（通用、专用）<ul><li>有着与人相似的机械复杂度（动作空间）。</li><li>有着与人一定程度相似或超越的泛化决策能力。</li></ul></li><li>高品质机器系统（专用）<ul><li>以一种面向特定类别任务的，具有高效物理结构的形式存在。</li><li>具有面向特定任务的泛化决策和控制能力。</li></ul></li></ul><h2 id="具身智能的价值">具身智能的价值</h2><h3 id="替代人类（解放人力、降低成本）">替代人类（解放人力、降低成本）</h3><ul><li>具有高风险的、不宜人类参与的重要任务。</li><li>具有重复性、枯燥复杂但具有价值的任务。</li></ul><h3 id="辅助人类（增强人力、降低成本、化不可能为可能）">辅助人类（增强人力、降低成本、化不可能为可能）</h3><ul><li>人类能力扩展，机器快速操作、精细工艺辅助。（医疗机器、外骨骼、增强感知等）</li></ul><h2 id="技术成熟路径">技术成熟路径</h2><ol><li>人机交互（指令理解）和视觉环境理解问题已经取得突破性提升。<ul><li>现有 GPT 等大语言模型已经开始应用，机器人可以听得懂人的语言指令。</li><li>现有多模态大模型使得视觉环境的高质量理解成为了可能。</li></ul></li><li>机器人的决策能力依赖于指令理解和环境理解（当前基于大模型范式），需要下一步提升。<ul><li>决策能力包含分析、推理、判断等能力。</li><li>通常采用深度学习、神经网络、强化学习等学习手段。</li></ul></li><li>最后解决机器人的执行能力，让机器人处理现实中的复杂任务。<ul><li>这一步并不一定要在最后，可以与 2 同步进行。</li><li>最后的目标是达到完美控制效果（强依赖于决策质量）。</li><li>执行能力更多可能需要关注输出决策和控制行为的对齐。</li></ul></li></ol><h2 id="成本变化路径">成本变化路径</h2><p>从产业链条来看，似乎具身智能所有的上游（通用）零部件都已经有成熟的制造工艺（依赖于机械、AI 多年的发展）。但是专用于具身智能体的上游制造仍需考虑以下几个问题：</p><ul><li>部件小型化带来的技术挑战，导致的高成本。</li><li>由于具身智能对于某些零件高标准要求带来的高成本。</li><li>标准统一前、规模化之前，由于出货量低带来的高成本。</li></ul><p>随着具身智能产品的发展和标准统一，上游出货量增大，成本通常预期会下降。</p><h2 id="商业发展脉络">商业发展脉络</h2><h3 id="机器人类型排序">机器人类型排序</h3><p>考虑到降本周期（成本是否可负担）、应用难度（泛化性能是否足够）、市场接受度（带来的价值大小）等因素，我们认为最先应用的落地的可能是价格不敏感的、应用难度较低、市场接受度较高的机器人类型。</p><p><img src="type.png" alt="机器人应用发展路径"></p><p><strong>商用服务机器人:（已经在大量使用）</strong></p><p>接待机器人、迎宾机器人、服务机器人、导购机器人等，商用场景的价格敏感度较低，应用场景简单，市场接受度高，或成为最先落地的场景。</p><p><strong>特定行业的功能型机器人:</strong></p><p>电力巡检类操作类机器人、轨道交通的检修机器人、矿山里的机器人、农业机器人、建筑机器人等，此类环境危险恶劣，对机器人的需求度高价格不敏感。</p><p><strong>家庭服务机器人:</strong></p><p>家务机器人、陪伴机器人等，toC 场景的价格敏感度较高，并且家庭是非结构化环境，外部环境和任务较为复杂，技术上难度大，因此落地进度或慢于 toB 场景。</p><p><strong>通用人形机器人:</strong></p><p>人形机器人具有最完善的具身智能，能够集成各项人工智能技术，也是最为通用的机器人类型，潜在应用空间最为广阔，或成为机器人的终极形态。</p><h3 id="市场规模">市场规模</h3><p>在技术成熟 + 成本下降的背景下，市场规模会逐步增大，详细信息可以参考<a href="https://pdf.dfcfw.com/pdf/H3_AP202305231587087727_1.pdf?1684857767000.pdf">东吴证券研报</a>。研报中市场规模的推导比较简单粗暴，可作为一个参考思路。其认为至 2035 年，家庭陪伴机器人规模将达到 3 - 4.2 万亿元。</p><h2 id="政策因素">政策因素</h2><p>此处不赘述，国内对于 AI 这些行业一向是十分鼓励的（科研+产业），下面是一些例子：</p><ul><li>北京市发布《北京市促进通用人工智能创新发展的若干措施（2023-2025年）（征求意见稿）》，提出探索具身智能、通用智能体和类脑智能等通用人工智能新路径，包括推动具身智能系统研究及应用，突破机器人在开放环境、泛化场景、连续任务等复杂条件下的感知、认知、决策技术。</li></ul><h1>6. 产业链条梳理</h1><h2 id="下游应用方向">下游应用方向</h2><div class="note note-danger">            <p>此处我们仅仅谈论场景（实际需求），不考虑实现难度，尽量不谈论产品形态。实现难度和形态需要与业务强绑定，此处时间关系不深入探讨。</p>          </div><h3 id="服务场景">服务场景</h3><ul><li>商用场景：接待机器人、迎宾机器人、服务机器人、导购机器人。</li><li>家庭服务：家政机器机器人、陪伴机器人、亲子机器人、安全监护机器人</li><li>社会场景：搜救机器人</li><li>教育场景：教育机器人</li><li>交通场景：无人汽车</li><li>医疗场景：医疗辅助机器人</li></ul><h3 id="工业场景">工业场景</h3><ul><li>制造场景：加工机器人、装配机器人</li><li>物流场景：搬运机器人</li><li>探测场景：探测机器人、无人机</li><li>战争场景：战争机器人/狗、无人机</li></ul><h3 id="科研场景">科研场景</h3><ul><li>实验场景：实验员机器人</li></ul><h3 id="一些公司及产品">一些公司及产品</h3><p>具有产品的公司：</p><ul><li>星尘智能，腾讯RobticsX机器人实验室一号员工来杰创业。产品形态为轮式底盘+人形上身，面向科研场景。</li><li>特斯拉推出人形机器人擎天柱 Optimus。同时特斯拉的 Dojo AI 超级计算机项目用于加速训练和推理具身智能模型。</li><li>波士顿动力 Atlas 和 Spot 就具备接近具身智能的能力，它们可以通过机器人的身躯来模拟人类或动物的行为和动作，更加逼真地与人类进行互动。</li><li>机器人初创公司 Vayu Robotics，Geoffrey Hinton 加入。Hinton 认为它们的技术路线（工业机器人）和其他很多AI应用相比，AI道德风险更低。</li><li>小米人形机器人 Cyber One。</li><li>柏楚电子：智能焊接机器人。</li><li>萤石网络：BS1 清洁机器人（扫地机器人）。</li><li>越疆机器人：工业协作机器人、教育机器人。</li></ul><p>公司实验室：</p><ul><li>腾讯：Robotics X</li><li>阿里云：千问大模型接入工业机器人</li></ul><h2 id="上游技术支撑">上游技术支撑</h2><div class="note note-danger">            <p>此处或许需要讨论具身智能体相比于传统的机器人来说，会对上游的哪一个环节提出更高的质量数量以及创新要求。但是这一点通常需要和具体下游应用绑定，时间原因此处不过多展开。</p>          </div><p><img src="functions.png" alt="机器人核心功能"></p><p><img src="values.png" alt="核心部件价值量"></p><ul><li>感知系统：此处的技术栈和自动驾驶的技术栈较大重叠<ul><li>视觉传感器</li><li>激光雷达</li><li>毫米波雷达</li><li>力度、温度、陀螺仪等传感器</li></ul></li><li>控制与执行系统：<ul><li>控制器：为执行装置提供正确控制信号，生成控制指令。（似乎各大厂商差距不大，差异主要在于软件算法）</li><li>减速器：降低输入的速度并同时增加输出扭矩的机械设备。通过这种方式，减速器能够使机械运动更为稳定，提高输出扭矩，以便于驱动更大的负载。</li><li>伺服系统：根据控制器生成的指令，驱动和控制机器人的关节和电机，以实现精确和高效的运动控制。<ul><li>电机系统：应用于人形机器人的机械手部、身体关节（占据主要的价值量）</li></ul></li><li>电力驱动系统：为机器人提供动力，包括电池、电源等。</li></ul></li><li>运算交互系统：<ul><li>运算单元：云服务、GPU、CPU、AI 处理器</li><li>行为逻辑：AI 相关理解与规划技术，自主行动。</li><li>仿真系统：决策逻辑训练场</li><li>控制技术：高性能的控制算法</li></ul></li></ul><h1>7. 一些值得注意的风险</h1><ul><li>降本速度低于预期：机器人普及很大程度依赖于上游降本，如果成本下降幅度低于预期，可能导致市场放量较慢。</li><li>大模型技术痛点：包括可信、可靠性等方面。</li><li>基础设施不及预期：若 AI 基础设施不及预期，大模型训练或无法完成。</li><li>伦理风险：具身智能可能会生产违反常规、违背法律和道德的行为。</li></ul><h1>8. Reference</h1><ul><li><a href="https://stock.jrj.com.cn/2023/06/30084837659110.shtml">国泰君安证券：具身智能，人工智能的下一个浪潮</a></li><li><a href="https://www.ccf.org.cn/Media_list/gzwyh/jsjsysdwyh/2023-07-22/794317.shtml">具身智能 | CCF专家谈术语</a></li><li><a href="https://zhuanlan.zhihu.com/p/641155098">人形机器人行业深度报告：聚焦“具身智能”，产业化提速 - 未来智库的文章 - 知乎</a></li><li><a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=9687596">A Survey of Embodied AI: From Simulators to Research Tasks</a></li><li><a href="https://arxiv.org/pdf/2309.07864.pdf">The Rise and Potential of Large Language Model Based Agents: A Survey</a></li><li><a href="https://new.qq.com/rain/a/20230821A01PBR00#:~:text=,l4%20%E8%87%AA%E5%8A%A8%E9%A9%BE%E9%A9%B6%E7%9A%84%E6%99%BA%E8%83%BD%E5%8C%96%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%E3%80%82%E8%80%8C%E8%87%AA%E5%8A%A8%E9%A9%BE%E9%A9%B6%E6%98%AF%E2%80%9C%E5%85%B7%E8%BA%AB%E6%99%BA%E8%83%BD%E2%80%9D%20%E9%87%8D%E8%A6%81%E8%90%BD%E5%9C%B0%E5%9C%BA%E6%99%AF%E3%80%82%E6%9C%80%E4%B8%8A%E9%9D%A2%E6%98%AF%E2%80%9C%E4%BC%A0%E6%84%9F%E5%90%8E%E8%9E%8D%E5%90%88%E2%80%9C%EF%BC%8C%E4%BC%A0%E6%84%9F%E5%99%A8%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%90%8E%E5%86%8D%E8%9E%8D%E5%90%88%E3%80%81%E9%A2%84%E6%B5%8B%E3%80%81%E5%86%B3%E7%AD%96%E3%80%81%E6%8E%A7%E5%88%B6%E3%80%82">具身智能专题研究：解耦还是耦合？从AI化到工程化！</a></li><li><a href="https://pdf.dfcfw.com/pdf/H3_AP202305231587087727_1.pdf?1684857767000.pdf">AI浪潮下一站:具身智能****</a></li></ul><hr>]]></content>
    
    
    <categories>
      
      <category>Extend Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI</tag>
      
      <tag>VC</tag>
      
      <tag>Embodied AI</tag>
      
      <tag>Robotics</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《献给阿尔吉侬的花束》读后感</title>
    <link href="/reading-note/flowers-for-algernon/"/>
    <url>/reading-note/flowers-for-algernon/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>因为不是一本功利的书，所以也没像往常那样做笔记。读完已经接近一周，此处瑾记录一些自己的感受。</p><span id="more"></span><hr><p>这本书是在去欧洲开会的路上读的，去程读了不到一半，回程读完。读完的时候似乎飞机才刚进入国境内，仓内处于黑灯的休息状态。我关闭了阅读灯，把书放到了座椅前的网兜，闭上眼想要休息一会。过了几分钟，眼泪在黑暗中流了下来，我像洗脸一样将它抹开，但是又流了更多，我于是又把它抹开。过了一会好像不再流泪了，仓内的干燥空气把脸上的潮湿也吸干了。不久我便睡着了。</p><p>这是我第一次读软科幻小说，或者说是第一次完整的读完一本科幻小说。《三体》的原作我看了一半看不下去，后来才断断续续以听书的方式听完。这本软科幻并没有精妙的科学设定，一切都从人出发，又归结到人。不过似乎名家科幻大作都是以人为主要表达点，这个也不算是本书的独特之处。似乎我很爱这种独白类型的小说，《罪与罚》也是这样，对于我这种能敏感察觉感情变化的人来说着实是一种享受。</p><p>初看目录的时候看到“近步抱告”这些字，还以为是一本写机器人的书，瞬间觉得机器人和花束搭配十分浪漫，有一种美女野兽之感。但是很快我便意识到这不是写机器人的书，甚至在意识到这一点之前，我的关注点已经到了其他地方。书中的第一二行开始就有错别字，显出一种盗版书既视感，硬着头皮往下读，幸好错别字不影响汉字理解。很快到第一页脚注时，我便知道了这是查理这个傻子的第一人称写作，顿感牛逼，惊讶程度不亚于 2077 中的黑梦片段。于是接着读下去。</p><p>随后很快我知道了查理高登是一个渴望“便匆名”的傻子，参加了一项可以提升智力的人体实验，需要每天写下进步报告。也知道了阿尔吉侬这个好听的名字是指一只老鼠。整个故事是通过查理的进步报告以日记的形式展开。不得不说这是一个有趣的写作方式，的确将我吸引进来。我又知道了虽然查理智商不高，但是他待人接物单纯，也有不同于他人的变聪明的信念，所以在特殊学校中被尊敬的老师爱丽丝推荐到这个试验。实验初期，查理的智商的提升十分缓慢，给了我一个很好的视角观察这个在面包店工作的傻子的生活。</p><p>傻子似乎在任何地方都不受待见，虽然老板好心的留下了高登并照顾他，但其他的店员们，乔，弗兰克都在对他进行嘲笑和欺辱。有趣的是在查理的视角下他们是在表达友善。愚笨的他看不懂任何恶意，反而把他们都当成了善意，这也给人一种他傻得很可爱的感觉。在变聪明的过程中，查理也不断摄入新的知识来产生对这个世界的了解，渐渐地有一些事情他看懂了。他学会了他以前学不会的东西，发现了大家都想让他出丑，他做事情开始比别人做的都好，他开始改进工艺，他发现了金皮贪污面包店的钱。单纯的查理把这件事直接告诉了金皮让他下不为例，不久之后，欺负过他的店员们一致觉得这个聪明的查理不适合在面包店继续工作了，店长也觉得查理也会有更好的去处，就这样查理被开除了。这就是查理自我意识觉醒的最初的阶段。</p><p>阿尔吉侬，是一只成功的试验品老鼠，研究人员激发了它的超高智商，在迷宫问题中它可以游刃有余，甚至要比最初的查理要好很多。看到查理和老鼠比赛，我其实是比较震惊的，似乎蠢查理就像是一条狗，可以肆意的被人摆布。不过当时的查理并无意见，反而是遗憾于总是在和阿尔吉侬的比赛中落败。不过尼姆教授他们总是对他说，这件事有一个过程，你会变聪明的。后来的一天，查理在比赛中赢了阿尔吉侬。</p><p>进步报告中的错别字逐渐消失了，查理似乎变成了一个正常人，他爱上了他在特殊学校的老师爱丽丝，他有了一些愉快的约会。但是故事的发展不会停滞于此，查理的智商还在增加，他已经超越了正常人的范围成为了一个天才。他发现自己能很快的理解很多语言，很多学科，很多不同的专业领域。他发现大多数人都是普通人，那些所谓的专家，似乎也只是草台班子。曾经他崇敬的斯特劳斯医生、尼姆教授们，他也觉得也不过如此。他不满意自己被当成一个试验品，而不是一个人。他发现在他愚蠢的时候，没有人把他当做一个人，他只是一个试验品，在他聪明之后，似乎大家还是把他当做一个试验品，尽管他已经有了超脱于实验者的智力能力。后来，在一场智商提升的学术会议展示中，查理放走了阿尔吉侬，会议乱作一团，查理趁乱带着阿尔吉侬溜走了，去纽约住了下来。</p><p>我读书似乎忘得很快，我其实并不完全记得书中的内容，陈述上可能时序不清或者胡编乱造。印象中，似乎在纽约查理过了一小段还可以的日子。他有一个女邻居，从我的视角中看活泼且具有生命力，查理和她有过一些愉快的经历。有趣的是查理和爱丽丝在一起的时候，他并没有办法发生性关系，他发现自己体内还残存着旧查理的意识，阻止他这样做。有时他喝酒的时候，旧查理也会出来接管他的身体。此时的爱丽丝智力已经远远低于查理，两人的沟通出现障碍，智商 180 时的查理和智商 60 时的查理和爱丽丝间的隔阂同样的远，关系上两人似乎也默契地疏远。</p><p>查理生活的家庭是一个很普通的家庭。父母在查理小时候都求医问药想要让他变聪明，无果之后，父亲理性接受了查理是一个笨孩子的事实，但母亲却总是难以接受。母亲或许是爱查理的，或许又不是，在生下了妹妹之后，查理在母亲的眼中已经变成了一个累赘，一个可能随时会伤害到妹妹的可怕的人。可能是生下妹妹证明了傻孩子的出现并不是母亲的问题，那么查理才是那个问题。妹妹对傻哥哥也是十分厌恶，因为哥哥，她在学校收到人嘲笑和欺负，考试考好也得不到小狗作为奖励，因为爸爸说之前已经拒绝了哥哥的养狗请求，所以她无法拥有自己的“拿破仑”。直到有一天，妹妹撒了一个谎，母亲认为查理要伤害妹妹，便勒令父亲送走查理，从此查理再也没回过家。</p><p>阿尔吉侬似乎出现了一些问题，它的智力水平好像开始缓慢下降，也出现了一些心理问题。查理对此展开了一系列研究，结论是这种实验带来的智力的提升并不是持续的，维持一段时间过后，这种借来的智力便会悉数交还回去。对于一个刚拥有智力不久的人来说，这个似乎更像对一个健全人的癌症晚期判决书，你之后的每一天，都向着肉眼可见的最后一天更进一步。查理将这件事写成了论文。</p><p>查理想去看望一下父母。父亲在经营一家理发店，他没有认出来查理，查理也没有相认他，剪完了头发，查理离开了。他又找到了母亲，母亲心中的执念好像这一刻终于放下，自己的孩子真的可以变聪明，但是母亲的精神好像也出现了一些问题。查理把论文给了母亲，说这篇论文可以证明你的儿子不是傻子，并且比所有人都要聪明。之后妹妹回到了家，妹妹说她以为父母把他送去了低能中心，她以为他已经死了，她似乎已经不记得发生在他们之间的事，不记得那些恶意，她现在有了一条狗，名叫“拿破仑”。母亲的精神的确出现了问题，她突然又觉得查理又是那个危险的蠢孩子，会伤害她的女儿，拿着刀威胁着查理，于是查理便离开了。</p><p>查理带着阿尔吉侬回到了斯特劳斯医生和尼姆教授的实验室。阿尔吉侬的确变笨了，他已经不能灵活地走出迷宫了，这意味着他们也知道查理也会变回以前的样子。查理询问尼姆教授：“做实验之前你们应该考虑过如果实验失败会如何安置我。”教授说会把他安置到沃伦之家，那是一个照顾失智人员的地方。查理提出想去那里参观，他的确去了，是一个很好的地方，每一个失智人员的确都有受到像人一样的尊重。我不记得查理是怎么想的，大概有一种参观以后自己墓穴的感觉。读到此处时，我心中着实不是滋味，不知道是因为他的坦然，还是因为我必须要接受查理的这个结局。</p><p>查理和爱丽丝又回到了可以相处的阶段，此时他们真正意义上谈了一段恋爱。印象中有一个描写记忆深刻，大意是“我在往上攀升时经过你的楼层，现在我在下降途中再次经过，我想我不会再来这里，所以让我们在此道别。”智力的下降仍在继续，查理明显感受到了力不从心。本书这一时期的描写最让人难过，你能清楚看到上帝赋予了查理一些东西，却又要当着他的面一份份地再收回去。查理紧握着每一份他拥有的智力，努力的学习摄入，希望能让这一天来的再晚一些，却徒劳无功。</p><p>查理要查字典才能完成进步报告了，他觉得要用简单的字而不是复杂的字。</p><p>不记得阿尔吉侬什么时候去世了，查理放了一束花在他的坟上，房东太太觉得他很傻，他说阿尔吉侬是一只特别的老鼠。</p><p>查理的进步报告中又出现了错别字。</p><p>傻查理又回到了面包店，新来的伙计欺负他，乔、金皮他们把欺负他的新伙计教训了一顿。</p><p>最后，查理决定要去沃伦之家了，留下了一封给爱丽丝的信，信的末尾写着：“还有：如果你有机会请放一些花在后院的阿尔吉侬坟上。”</p><div style="text-align:center"><span style="width:48%;display:inline-block"><img src="/reading-note/flowers-for-algernon/pic1.jpg" class=""></span><span style="width:48%;display:inline-block"><img src="/reading-note/flowers-for-algernon/pic2.jpg" class=""></span></div><hr><p>最后的十几页内心实在是过于沉重，看到查理去参观自己的坟墓，看到查理紧握正在流失的光明，看到欺辱他的人变成保护他的人，看到最终的他选择离开，走向自己早已为自己准备好的坟墓。这种无力感在我的心中留下了深深的印象。</p><p>我不想思考谁会和查理共情，但是查理的确和阿尔吉侬共情了。呆呆傻傻的查理变得很温柔，他说阿尔吉侬是一只特别的老鼠，或许他内心想说的是查理也是一个特别的人。可惜的是似乎没什么人把他当做一个人，有人把他当成傻子，有人把他当成危险，有人把他当成实验品，有人把他当成高智商怪物，但是其实他想要的只是被当成一个正常人。似乎他一直都在寻求和解，父母、爱丽丝，或许他做到了，但是在最后已经不重要了，因为他已经理解不了了。</p><p>查理高登放在阿尔吉侬坟上的鲜花，也献给了查理高登。</p>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>科幻小说</tag>
      
      <tag>读后感</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>微波探测中的里德堡原子</title>
    <link href="/extend-learning/rydberg-microwave/"/>
    <url>/extend-learning/rydberg-microwave/</url>
    
    <content type="html"><![CDATA[<p>微波探测是一种重要的探测手段。本文将介绍微波探测的基本原理，以及里德堡原子在微波探测中的应用。</p><span id="more"></span><ul><li><a href="#%E5%BE%AE%E6%B3%A2%E6%8E%A2%E6%B5%8B">微波探测</a><ul><li><a href="#%E5%B8%B8%E8%A7%81%E6%8E%A2%E6%B5%8B%E6%8A%80%E6%9C%AF%E5%AF%B9%E6%AF%94">常见探测技术对比</a></li><li><a href="#%E6%A0%B8%E5%BF%83%E6%AD%A5%E9%AA%A4">核心步骤</a></li><li><a href="#%E5%BE%AE%E6%B3%A2%E6%8E%A2%E6%B5%8B%E5%8F%AF%E4%BB%A5%E6%8E%A2%E5%AF%BB%E7%9A%84%E7%89%A9%E4%BD%93%E6%80%A7%E8%B4%A8">微波探测可以探寻的物体性质</a></li><li><a href="#%E4%B8%80%E4%BA%9B%E5%BA%94%E7%94%A8">一些应用</a><ul><li><a href="#%E9%80%9A%E5%B8%B8%E8%A2%AB%E4%BD%BF%E7%94%A8%E7%9A%84%E9%A2%86%E5%9F%9F">通常被使用的领域：</a></li><li><a href="#%E5%85%B7%E4%BD%93%E7%9A%84%E4%BE%8B%E5%AD%90">具体的例子：</a></li></ul></li></ul></li><li><a href="#%E9%87%8C%E5%BE%B7%E5%A0%A1%E5%8E%9F%E5%AD%90%E5%9C%A8%E5%BE%AE%E6%B3%A2%E6%8E%A2%E6%B5%8B%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8">里德堡原子在微波探测中的应用</a><ul><li><a href="#%E9%87%8C%E5%BE%B7%E5%A0%A1rydberg%E5%8E%9F%E5%AD%90%E7%9A%84%E7%89%A9%E7%90%86%E6%80%A7%E8%B4%A8">里德堡(<strong><strong>Rydberg</strong></strong>)原子的物理性质</a></li><li><a href="#%E5%BE%AE%E6%B3%A2%E6%8E%A2%E6%B5%8B%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8">微波探测中的应用</a></li><li><a href="#%E4%B8%80%E4%B8%AA%E5%85%B7%E4%BD%93%E7%9A%84%E4%BE%8B%E5%AD%90">一个具体的例子</a></li></ul></li><li><a href="#%E9%87%8C%E5%BE%B7%E5%A0%A1%E5%8E%9F%E5%AD%90%E7%89%A9%E7%90%86%E8%83%8C%E6%99%AF">里德堡原子（物理背景）</a><ul><li><a href="#%E5%88%B6%E5%A4%87%E7%AE%80%E4%BB%8B">制备简介</a></li><li><a href="#%E5%88%B6%E5%A4%87%E5%85%83%E7%B4%A0%E9%80%89%E6%8B%A9%E7%AE%80%E4%BB%8B">制备元素选择简介</a></li><li><a href="#%E7%89%A9%E7%90%86%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86">物理基础知识</a><ul><li><a href="#%E9%87%8F%E5%AD%90%E6%95%B0">量子数</a></li><li><a href="#%E8%83%BD%E7%BA%A7">能级</a></li><li><a href="#%E8%B0%B1%E7%BA%BF">谱线</a></li></ul></li></ul></li></ul><h1>微波探测</h1><h2 id="常见探测技术对比">常见探测技术对比</h2><p>通常都是以电磁波作为载体，通过发射/接受电磁波过程并辅以数据处理来获得对目标物的信息。</p><ol><li><strong>光学成像和探测</strong>：<ul><li><strong>优势</strong>：光学成像提供高分辨率和颜色信息，广泛应用于医学诊断、工业检测和科学研究。</li><li><strong>劣势</strong>：光学成像受到材料的透明度和光线条件的限制，可能无法穿透某些材料或在低光条件下工作。</li></ul></li><li><strong>X射线成像和探测</strong>：<ul><li><strong>优势</strong>：X射线能穿透许多材料，用于内部结构的成像，如医学放射成像和工业无损检测。</li><li><strong>劣势</strong>：X射线具有辐射风险，长时间或高剂量的暴露可能对生物组织有害。</li></ul></li><li><strong>超声波成像和探测</strong>：<ul><li><strong>优势</strong>：超声波成像无辐射、成本低、设备便携，常用于医学诊断和工业检测。</li><li><strong>劣势</strong>：其分辨率和成像深度可能不如其他技术，且对操作技巧和材料的声学特性有一定要求。</li></ul></li><li><strong>红外成像和探测</strong>：<ul><li><strong>优势</strong>：红外成像能够在无光或低光条件下工作，用于热成像和夜视技术。</li><li><strong>劣势</strong>：分辨率和穿透能力可能不如微波和X射线技术。</li></ul></li><li><strong>磁共振成像（MRI）</strong>：<ul><li><strong>优势</strong>：MRI能提供软组织的高分辨率图像，无辐射风险，广泛应用于医学诊断。</li><li><strong>劣势</strong>：成本高、设备体积大，且对患者有一些限制（如金属植入物）。</li></ul></li><li><strong>微波探测</strong>：<ul><li><strong>优势</strong>：微波探测具有一定的穿透能力，能在多种环境条件下工作，设备通常较为便携，成本相对较低。微波探测也能在无光或低光条件下工作，如雷达和微波运动探测器。</li><li><strong>劣势</strong>：微波成像的分辨率通常低于光学和X射线成像，且可能受到其他电子设备和电磁干扰的影响。</li></ul></li></ol><figure>    <img src="spectrum.png" alt="电磁波谱" class="border">    <figcaption>电磁波谱</figcaption></figure><h2 id="核心步骤">核心步骤</h2><p>微波探测技术通常通过发射微波信号并分析这些信号与目标物体的交互来检测目标物体的某些性质，最直观的理解即为拍摄一张 2D 或者 3D 的照片，但不是利用可见光而是微波。完整的一套探测流程通常包含以下步骤：</p><ol><li><strong>微波发射</strong>：微波探测系统通常包括一个微波发射器，它能够发射微波频率范围内的电磁波。这些微波会传播到空间中，并可能与目标物体相互作用。</li><li><strong>信号反射和传输</strong>：当微波信号遇到一个物体时产生相互作用，它们可能会被反射、折射或吸收。反射的信号为分析物体提供了可能。</li><li><strong>信号接收与处理：</strong><ol><li><strong>天线接收</strong>：微波信号接收的第一步通常是通过天线捕获微波信号。天线的设计和选择对于信号的接收质量至关重要。</li><li><strong>低噪声放大器（LNA）</strong>：接收到的微波信号通常很弱，因此需要通过低噪声放大器（LNA）进行初步放大，以提高信号的强度并减小系统的噪声。</li><li><strong>变频滤波</strong>：微波信号通常会被下变频到较低的中频（IF）或基频，以便于后续的信号处理。这通常通过与本地振荡信号的混频实现。下变频后，信号通常会经过滤波器以去除不需要的频率成分和噪声。在中频阶段，信号可能会经过进一步的放大和滤波，以准备进行解调或数字化。</li><li><strong>解调</strong>：解调是从调制信号中提取原始信息的过程。解调器会根据信号的调制类型（如幅度调制、频率调制或相位调制）来提取信息。</li><li><strong>A/D转换</strong>：在解调后，信号可能会被转换成数字信号以便于进一步处理。模拟/数字转换器（ADC）将模拟信号转换为数字信号。</li><li><strong>数字信号处理（DSP）</strong>：数字信号处理可以包括滤波、解码、错误检测和纠正等多种操作，以从信号中提取有用的信息并准备进行输出或传输。</li><li><strong>输出或传输</strong>：最终，处理过的信号可以被输出到显示设备，或者通过通信接口传输到其他系统或网络。</li></ol></li></ol><h2 id="微波探测可以探寻的物体性质">微波探测可以探寻的物体性质</h2><p>通过微波探测，我们可以获得关于物质的许多不同的性质和信息，以下是一些具体的例子：</p><ol><li><strong>介电常数</strong>：微波探测可以用于测量物质的介电常数，这是物质对电场的响应的度量。介电常数反映了物质内部的极化特性，对于理解和利用物质的电磁特性非常重要。</li><li><strong>电导率</strong>：通过微波探测，可以测量物质的电导率，即物质能够传导电流的能力。电导率是评价物质的电学性质的重要参数。</li><li><strong>物质厚度和密度</strong>：微波探测可以用于测量物质的厚度和密度。通过分析微波信号在穿越物质时的衰减和延迟，可以推断物质的厚度和密度。</li><li><strong>物质温度</strong>：微波辐射与物质的温度有关。通过测量微波辐射，可以估算物质的温度，尤其是在高温或恶劣环境中。</li><li><strong>物质的结构和组成</strong>：通过微波成像和微波层析技术，可以获得物质内部结构和组成的信息。例如，微波探测可以用于检测缺陷、裂纹和内部异物。</li><li><strong>物质的运动和速度</strong>：通过雷达技术，微波探测可以用于测量物质的运动和速度。例如，微波雷达可以测量飞行物体的速度和方向。</li><li><strong>液体的含水量</strong>：微波探测可以用于测量土壤或其他材料中的水分含量。微波信号的传播速度和衰减率会受到水分含量的影响，从而可以用于估计液体的含水量。</li></ol><h2 id="一些应用">一些应用</h2><h3 id="通常被使用的领域：">通常被使用的领域：</h3><ul><li><strong>通信和数据传输</strong>：微波技术被广泛应用于数据、电视、电报、卫星和航天器通信等领域。</li><li><strong>雷达和远程探测</strong>：微波探测技术也用于雷达技术，可以用于探测飞机、船只和其他对象。</li><li><strong>医疗应用</strong>：微波传感器在医学领域也有广泛应用，如乳腺癌治疗、红白血细胞分离、肝组织疾病检测等。</li><li><strong>工业和生活应用</strong>：微波传感器可用于检测湿度、生物分子、压力等，并广泛应用于城市的废水和污水监测、吊车接近检测、运动检测等。</li></ul><h3 id="具体的例子：">具体的例子：</h3><p>微波探测技术能够用于探测和测量物质的多种性质。以下是一些具体的例子，每个例子都附有相关的文献报道：</p><ol><li><strong>湿度感测</strong>：通过使用双环谐振器作为敏感电极，研究人员测试了包括纯聚酰亚胺（PI）、PI-TiO2陶瓷复合材料和PI-Ag金属复合材料在内的多种敏感材料，以实现湿度的微波探测。<a href="https://www.sciencedirect.com/science/article/pii/S0925400521015033#:~:text=,tested%20as%20the%20sensing%20materials">link</a></li><li><strong>种棉的微波湿度感测</strong>：通过微波技术测量种棉的湿度，并收集了1.0 GHz到2.5 GHz频率范围内微波材料属性与种棉之间的基本关系的实验数据。<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5134502/">link</a></li><li><strong>材料表征和检查</strong>：微波和毫米波非破坏检测与评估（NDT&amp;E）技术适用于材料表征；用于检测层状复合材料的厚度、解层、剥离和涂层下的腐蚀；表面裂纹的检测和评估；以及混凝土和富树脂复合材料的固化状态监测等。<a href="https://royalsocietypublishing.org/doi/10.1098/rsta.2019.0585#:~:text=,composites%2C%20to%20name%20a%20few">link</a></li><li><strong>水分含量测量</strong>：描述了通过微波技术进行水分含量测量的传感器，特别是从在线使用的地下感测的角度来看。这项技术有半个世纪的历史，一些设置已经在实际生产过程中使用。<a href="https://link.springer.com/article/10.1023/A:1010120826266">link</a></li><li><strong>材料表征</strong>：通过基于基板集成波导（SIW）的微波传感器进行材料表征，传感器的主要感测原理是传输和反射信号。传感设备的基本构建块包括介质基板、地面平面和导电带。SIW技术已经引起了对创建大量微波集成电路的极大兴趣<a href="https://www.sciencedirect.com/science/article/pii/S2666351123000189">link</a></li><li><strong>微波吸收材料的电磁测量</strong>：优秀的微波吸收材料需要具有如高反射损失、宽带宽度、低重量、较低的涂层厚度、化学惰性和成本效益等主要属性。微波探测技术可以用于测量和评估这些属性，以确保材料的性能符合应用要求。<a href="https://link.springer.com/referenceworkentry/10.1007/978-981-19-1550-5_80-1#:~:text=,effectiveness">link</a></li><li><strong>评估建筑材料的表面电磁传感器</strong>：在这项研究中，使用微波开口矩形波导来测量波特兰水泥混凝土（PCC）的电磁属性，频率范围为7.0至13.0 GHz。<a href="https://www.researchgate.net/publication/345243038_Surface_Electromagnetic_Sensor_for_Evaluation_of_Construction_Material#:~:text=In%20this%20paper%2C%20microwave%20open,0%20GHz">link</a></li></ol><h1>里德堡原子在微波探测中的应用</h1><div class="note note-primary">            <p>💡 微波探测中的一个痛点是：如何接收微弱信号和如何进行高精度的电场检测。</p><p><strong>里德堡原子在微波信号接收和初步处理阶段很好的解决了这一痛点。</strong></p>          </div><h2 id="里德堡-Rydberg-原子的物理性质">里德堡(<strong><strong>Rydberg</strong></strong>)原子的物理性质</h2><p>首先我们指出里德堡原子不是指某特定元素的某一原子状态，而是对某一原子进行激发得到。此处我们先不对里德堡原子的物理原理深入展开（下一节展开），仅了解其可以用于微波探测的根本原因，即它本身重要的性质。</p><ol><li><strong>大的电偶极矩</strong>：<ul><li>里德堡原子通常具有高主量子数，电偶极矩非常大，这使得它们对电场极为敏感，能够有效地与电磁场相互作用。（当一个外部电场作用于具有电偶极矩的里德堡原子时，电偶极矩会倾向于与电场方向对齐。）</li><li>这种强烈的响应使得里德堡原子成为非常敏感的电场探测器，特别是在微波频段。（微波频段的电磁波的频率通常与里德堡原子的能级间的能量差匹配。这意味着微波信号可以有效地驱动里德堡原子之间的能级跃迁。）</li></ul></li><li><strong>长寿命</strong>：在合适的条件下，里德堡原子可以具有相对长的寿命。这使得它们有足够的时间与微波信号相互作用，从而能够进行高精度的测量。</li><li><strong>窄的谱线宽度</strong>：里德堡原子的谱线宽度非常窄，这意味着它们可以在很窄的频率范围内响应（窄的谱线宽度有助于提高微波探测的频率分辨率）</li><li><strong>可调谐的谱线</strong>：通过外部电场或磁场，可以控制调节里德堡原子的谱线位置。这种可调谐性使得里德堡原子微波探测系统能够在不同的频率上工作。</li><li><strong>非线性响应</strong>：由于它们的大电偶极矩和高主量子数（能级非常密集，能级之间的能量差异非常小），里德堡原子对电场具有非线性响应（一个系统对于输入信号的响应不是输入信号的简单线性倍数）。这种非线性响应使得它们能够在非常低的信号强度下进行有效的检测和测量。</li></ol><p>一句话来讲：里德堡原子对于电场敏感，且可以有较高的探测分辨率。</p><h2 id="微波探测中的应用">微波探测中的应用</h2><ol><li><strong>天线接收</strong>：里德堡原子可以充当超灵敏的微波接收天线。由于里德堡原子对电场的高度敏感性，它们可以直接感应微波信号的电场组分，并将其转换为量子信号，进而进行检测和分析。</li><li><strong>低噪声放大器（LNA）</strong>：由于里德堡原子的灵敏度非常高，它们可以在无需额外放大的情况下检测非常微弱的信号。这种性质使得里德堡原子在某些情况下可以替代传统的低噪声放大器，或与其配合使用以增加系统的信噪比。</li><li><strong>解调</strong>：里德堡原子也可以用于微波信号的解调。通过监测里德堡原子的量子态变化，可以直接获取微波信号的幅度、频率和相位信息，从而实现信号的解调。</li></ol><h2 id="一个具体的例子">一个具体的例子</h2><p>郭光灿院士团队在多频率微波传感上取得新进展。该团队史保森、丁冬生课题组，利用人工智能的方法，实现了基于里德堡原子多频率微波的精密探测，其相关成果已在《Nature Communications》<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://www.nature.com/articles/s41467-022-29686-7">[1]</span></a></sup>上发表。</p><figure>    <img src="rydberg-experiment.png" alt="实验设置" class="border">    <figcaption>实验设置</figcaption></figure><figure>    <img src="QR-experiemnt.png" alt="QR 重建" class="border">    <figcaption>QR 重建</figcaption></figure><ul><li>他们使用的里德堡原子的主量子数为 51/50（多个频率激发调制）。</li><li>这里的神经网络代替了传统的解调过程。</li><li>使用了二维码作为探测标的实验展示。</li></ul><h1>里德堡原子（物理背景）</h1><h2 id="制备简介">制备简介</h2><p>里德堡原子通常是通过实验手段制备出来的，而不是自然存在。在自然条件下，原子通常处于其最低能量状态（基态），而不是高能的里德堡态。里德堡态是原子的一种特殊的激发态，它们的电子被激发到离原子核很远的轨道上（具有很大的主量子数 n），这需要向原子提供额外的能量。</p><p>制备里德堡原子通常涉及以下几个步骤：</p><ol><li><strong>原子冷却</strong>：首先需要将原子冷却到很低的温度，以减少它们的热运动并提高激发的准确性。</li><li><strong>激光激发</strong>：使用激光将原子的电子激发到高能量状态。这通常通过使用精确调谐的激光光束来实现，以确保电子跃迁到期望的里德堡能级。</li><li><strong>状态控制</strong>：在某些情况下，可能还需要使用外部电场或磁场来稳定里德堡原子的状态，以防止它们过早地退回到低能态。</li></ol><h2 id="制备元素选择简介">制备元素选择简介</h2><p>除了氢原子，还可以制备不同其他元素的里德堡原子。以下是一些常见元素的例子：</p><ol><li><strong>碱金属元素</strong>：<ul><li>包括锂（Li）、钠（Na）、钾（K）、铷（Rb）和铯（Cs）在内的碱金属元素是制备里德堡原子的常见选择。碱金属元素只有一个外壳电子，这使得它们的能级结构相对简单，并且容易通过激光激发到里德堡状态。</li></ul></li><li><strong>碱土金属元素</strong>：<ul><li>包括铍（Be）、镁（Mg）、钙（Ca）、锶（Sr）和钡（Ba）在内的碱土金属元素也可以被激发到里德堡状态。虽然碱土金属元素的能级结构比碱金属复杂一些，但它们仍然是制备里德堡原子的好选择。</li></ul></li><li><strong>稀有气体元素</strong>：<ul><li>虽然不太常见，但稀有气体元素如氖（Ne）、氩（Ar）、氪（Kr）和氙（Xe）也可以被激发到里德堡状态。</li></ul></li><li><strong>过渡金属元素</strong>：<ul><li>一些过渡金属元素也可以被激发到里德堡状态，虽然这通常需要更复杂的激光激发方案。</li></ul></li></ol><p>选择哪种元素制备里德堡原子主要取决于特定应用的需求。例如，碱金属元素的里德堡原子通常用于高精度电场测量和量子信息处理应用，而碱土金属元素的里德堡原子可能更适用于特定类型的光学和量子实验。</p><h2 id="物理基础知识">物理基础知识</h2><h3 id="量子数">量子数</h3><p>量子数是用于描述原子和分子中电子状态的数值。它们是量子力学的基本概念，为电子的运动和排布提供了量化的描述。主要的量子数包括：</p><ul><li>主量子数 (n): 描述电子所在的能级，也与电子到原子核的平均距离有关。</li><li>角动量量子数 (l): 描述电子的轨道角动量。</li><li>磁量子数 (m): 描述电子在一个特定的能级中的不同取向。</li><li>自旋量子数 (s): 描述电子的内在角动量或自旋。</li></ul><h3 id="能级">能级</h3><p>能级是指原子或分子中电子的能量的离散值。在量子力学中，电子的能量是量化的，意味着电子只能占据特定的能量状态。能级是由量子数来标识的，不同的能级对应着不同的能量。随着能级的增加，相邻能级间的距离变小。</p><p>对于单电子原子，能级的能量可以由如下方式得到：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>E</mi><mi>n</mi></msub><mo>=</mo><mo>−</mo><mrow><mo fence="true">(</mo><mfrac><mrow><msup><mi>Z</mi><mn>2</mn></msup><mi>k</mi><msup><mi>e</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>n</mi><mn>2</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">E_n = -\left(\frac{Z^2 ke^2}{2n^2}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4411em;vertical-align:-0.95em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><p>其中，</p><ul><li>E_n 是第 n 能级的能量,</li><li>Z 是原子核的电荷数（对于氢原子，Z = 1）</li><li>k 是库仑常数</li><li>e 是电子的电荷</li><li>n 是主量子数</li></ul><p>对于多电子原子通常需要求解薛定谔方程或者进行数值模拟得到。</p><h3 id="谱线">谱线</h3><p>谱线是当电子在不同能级之间跃迁时产生的光的离散频率。谱线是原子和分子结构的重要证据，也是分析物质组成的重要工具。</p><ul><li><strong>谱线宽度</strong>：<ul><li>谱线宽度是指谱线的宽度（波峰的宽度），通常与能级的寿命以及其他外部和内部因素有关。窄谱线宽度意味着能级的能量（对应的光谱频率）非常确定，而宽谱线宽度则意味着较大的能量不确定性。</li></ul></li><li><strong>调谐</strong>：<ul><li>调谐是指通过外部控制（例如通过改变外部电场或磁场）来改变原子或分子的能级结构，从而改变谱线的位置。这种调谐能力使得可以根据需要调整系统的响应，例如，使得原子或分子能够吸收或发射不同频率的光。</li></ul></li></ul><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.nature.com/articles/s41467-022-29686-7">https://www.nature.com/articles/s41467-022-29686-7</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>Extend Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI4Science</tag>
      
      <tag>Rydberg</tag>
      
      <tag>Physics</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《别独自用餐》读书笔记</title>
    <link href="/reading-note/never-eat-alone/"/>
    <url>/reading-note/never-eat-alone/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>一本十多年前的成功学畅销书，旨在鼓励人们养成擅于人际交往的生活方式，并从中获益。</p><span id="more"></span><h2 id="作者">作者</h2><p>基斯·法拉奇 + 塔尔·雷兹</p><h2 id="读书心得">读书心得</h2><h3 id="极简评价">极简评价</h3><p>一本比较值得阅读的，可以一定程度帮助摆脱学生思维的非工具书。可以从价值的角度给人以人际关系和自我成长上的启发。</p><h3 id="个人认为的本书缺点">个人认为的本书缺点</h3><ul><li>这类型成功学畅销书实会包含很多听起来显然有道理但没什么信息量的话。核心观点和论据都比较单薄，大多都是例证法，且反复陈述。当然读起来其实可以跳过太多内容，读得飞快。</li><li>本书或许过于强调人脉而忽视做事的能力了。</li><li>读本书很多时候都觉得作者的方式“动机不纯”，当然这个是我目前学生思维下的看法。</li></ul><h3 id="感想看法">感想看法</h3><ul><li>这本书覆盖了很多我目前在尝试了解的内容，比如“自我探索”一类。书中的“蓝色火焰”和自己看到的三圆交接寻找事业有些相似，最近已在多处看到此类表述。</li><li>“胸怀大志者张弛有度”或许约等于之前理解的“君子不器”。</li><li>重要的是你能为别人提供什么？还是需要有自己的长板，能提供的价值。</li><li>这本书如果在几年前看可能会嗤之以鼻，因为自己难以将利益表达的很直白。但是现在我已经接受了以“价值”为核心的思考方式，觉得书中许多观点可以引起一些思考。</li><li>个人目前的理解中，最重要的能力是被人信任，这通常需要具有帮人解决问题的能力且真诚真实。</li><li>意识到“社交”、“人际交流”、“价值分享”是十分重要的。意识到这些点之后再自己去摸索，要远远比使用这些手册知识点合适的多。这本书千万不能当成工具书用，当成启发类书籍更加合适。（类似张无忌学太极剑）</li><li>个人品牌这一点很有趣，自己也开始做了一些尝试。</li><li>发自内心地对别人感兴趣，追问下去的能力似乎蛮重要。个人认为自己的好奇心还比较足，在这一方面有一定的长处。</li><li>豆瓣看到行者老孙的一条独特的书评“根据这本书的做法成为你的朋友的人，基本上是和法拉奇一类的人。不是和法拉奇一类的人，用这种办法只能让他们离你远去。”但是结合目前互联网流行的 i 人社交方式是“被 e 人发现”来看，这个点评也未必准确。有的时候你可以提供一个契机让大家都快乐（收获价值），何乐而不为？</li><li>“世界上有三种东西可以让人们的友情变得深厚，它们是健康、财富和孩子。”联想到之前看到的一个穷人和富人的需求对比图。</li></ul><h2 id="内容摘录">内容摘录</h2><h3 id="第一部分：思想篇">第一部分：思想篇</h3><ul><li>生活的规律就是：碰上对的人，以一个对的理由，由他引你进入一个对的圈子。</li><li>主动与人交流不仅会让他人的生活有所改变，也有利于探素、丰富自己的人生。</li><li><strong>真正的社交是使别人更成功，是努力让给予多过索取。</strong></li><li>以关系为导向的职业生涯会使你供职的公司受益，因为每个人能从你的成长中获益——正因为你能创造价值，人们才渴望与你接触。</li><li>“大家都很乐意接受别人的慷慨，但前提是你要主动走出去寻求别人的慷慨。”</li><li>但你首先得学会慷慨待人，如果你不能以同样的热情将自己的圈子推荐给别人，你就不可能扩大白己的圈子。你帮助的人越多，你得到的帮助越多，然后你就能帮助更多的人。</li><li>他认为关系像切成许多块的煎饼，吃一块就少一块。然而，我却觉得它更像肌肉，使用越频繁，它就越健壮。</li><li>**底线：素取之前要先给予。**如果你慷慨待人，你也会得到慷慨的回报。</li><li>“目标就是一个在规定时间内必须完成的梦想。”这一定义指出了一点：写下自己的目标之前，你必领搞清楚自己的梦想是什么；否则，从一开始，你就会发现自己正在走向一个自己根本不想去的地方。</li><li>问那些最了解你的人：你最大的优点是什么？缺点是什么？他们在哪些方面特别佩服你？在哪些方面你还需要别人的帮助以待提高？</li><li>如果彼此欣赏，就要建立关系。</li><li>在商界，我们常说：好顾客就是老顾客。换句话说，你最成功的一次销售是你之前的某笔买卖带来的，而不是你新做成的某笔交易。如果你要认识自己圈子外的人，老顾客的介绍也是一种可靠的途径。</li><li>但结交的第一步与陌生人没有半毛钱关系，因为你得从你认识的人下手。</li><li><strong>胸怀大志者张弛有度。</strong></li><li>如果你有话要说，那么就充满激情地把它说出来；同时，你还要保证这些话言之有物、感情真挚。很多人都不明白这个道理：当你和一群人待在一起，和他们进行蜻蜓点水式的交流时，如果你眼晴还不安分地四处乱瞟，寻找下一个交流对象，那么你很快就会失去人们对你的尊重。</li><li>最棒的社交达人根本不社交一一他们与人为友。</li></ul><h3 id="第二部分-技巧篇">第二部分 技巧篇</h3><ul><li><strong>人最深层的本性就是受人欣赏。</strong></li><li>我们愿意分享给大众看的，通常是那些对我们构成挑战，或那些对我们很重要的事物，这种趋势根本没有变化。</li><li>我想说的重点是什么？重点就是要时刻尊重行政助理的能力。给子他们应有的尊严，再去跟他们接触。如果他们得到了尊重，成功的大门也会向你敞开，即使面对的是权力最大的决策者。</li><li><strong>重要的是你跟朋友聚到一起做什么</strong>，而不是你们多久见一面。这就是你要格外在意什么地方你最自在，以及做什么活动你最喜欢的原因。</li><li>如果你不打算努力把这些人变成你生活中的一部分，那何苦给自己找麻烦去认识新朋友呢？</li><li>另一个可以保持继续交流的有效方法就是将一些相关的文章转发给自己社交网络里面可能感兴趣的人。</li><li>将后续跟进当作一种习惯，让它自然而然地发生。</li><li>别再把自己下一次商业会议当作休假了，把它视作一次精密策划的竞争机会，一个可以完成任务的竞争机会。</li><li>如果你有机会与新朋友见面，请把自己打造成 “消息通”，这是任何一个社交高手都会具备的重要素质。</li><li>会议中，休息时段才是工作真正开始的时候。</li><li>你的“弱联结”与你接触的是不同的世界。他们与身处不同环境的各色人群交往，从他们那里你可以获得大量的知识和信息，而这些不仅自身学不到，在好朋友那里也学不到。</li><li>与猎头打交道的另一个建议就是把自己当作一个“伪猎头”。时不时注意与猎头、求职者或者咨询顾问和咨询公司联系。当你帮他人谋得一份工作，他们在得知有新职位空缺的消息时，很容易就会想起你。</li><li>总归一个词：联系。更确切地说，跟“引荐人”联系。</li><li><strong>信任在社交圈互换的过程中是必不可少的</strong>，这要求我们对待他人的朋友要绝对尊重。</li><li>哈勒尔的研究结果表明，<strong>运用语言越得心应手，生活中便越容易成功。</strong></li><li>我一次又一次地惊讶于<strong>示弱原则在闲聊艺术中的力量。</strong></li></ul><h3 id="第三部分-把交情由浅变深">第三部分 把交情由浅变深</h3><ul><li><strong>让别人把事情做好的唯一途径在于承认他们的重要性</strong>，并让他们感受到自己很重要。</li><li><strong>世界上有三种东西可以让人们的友情变得深厚，它们是健康、财富和孩子。</strong></li><li>在你的资金资源和相关资源比较薄弱时，社会套利实际上并没有大大的障碍。解决之道就在于知识，这是社会套利策略里最有价值的现金资产。知识是自由的，书籍、文章、网络上面都有，随处都可以发现很多，而且对谁都很珍贵。</li><li>戴尔•卡耐基的话可以这么理解：在两个月时间里对他人的成功表现出极大兴趣，与用两年时间让别人对你自己的成功感兴趣相比，前者会让你更成功。</li><li><strong>别拿自己开玩笑，实际上人人都在乎自己的生日！</strong></li></ul><h3 id="第四部分-数字时代的联系">第四部分 数字时代的联系</h3><ul><li>分享重大信息，让他们大笑或者大叫。</li><li><strong>信息要有支撑。</strong></li><li>不要找借口，你要对任何带有你名字的东西付百分百的责任。</li><li>艾萨克•阿西莫夫（Isaac Asimov）曾说过：“在科学领域，最振奋人心的并不是听到人喊 ‘我发现了’，而是‘有点儿意思’，因为它往意味着新的发现将要诞生。”</li><li>搬到大城市后，你能接触到更多不同的人，他们不一定是你的朋友，但他们可以给你带来不同的想法，提供各种机会；或者说通过他们，你可以认识到更多可以帮你的人。</li><li>多去参加研讨会等会议，这里有很多跟你价值观相似、志趣相投的人，他们都是支持你的原动力。</li></ul><h3 id="第五部分-付出就有回报">第五部分 付出就有回报</h3><ul><li>那么做营销需要注意什么呢？很简单，变得有趣些！</li><li><strong>你得让人觉得跟你交谈是件值得的事儿，甚至愿意花时间谈论你。</strong></li><li>“大家都知道你”—这只不过证明你是个名人，但是“大家因为你的某些独特之处而记住你”则大大不同。后者代表着尊重。</li><li>对于商业来讲，<strong>有时候创新只不过是把每个人都知道的信息点整合起来，串点成线而已</strong>。你不需要再发明一遍轮子，你只需要换个车厢。</li><li>内容制造者是无法外包的。</li><li><strong>学习并成为这方面的专家，最好的办法就是你得去亲自传授这方面的知识</strong>一一没有更好的逼迫自己的方法。</li><li>我知道的很多优秀的 CEO 就<strong>算没有相关技能和经验，也不会轻易对机会说不</strong>。相反，他们会把这种情况看作机遇。他们会说：“这个我们能做。”然后再号召员工一起学习。</li><li>你要好好想想，你还需要什么专业知识才能给你的朋友圈以及你的公司才来更大的价值。</li><li>小说家米兰 •昆德拉（Milan Kundera）说过：“调情代表着你答应上床，只不过不完全保证罢了。”</li><li>你的个人信息中应该包含你想让别人用来形容你的词。把它们写下来是第一步。问问你最信任的朋友，他们会用哪几个词形容你，包括好的方面和不好的方面。同时问一下到目前为止，你展现出的技能及长处是什么。</li><li>“不思考则罢，一旦开始思考，就要从大处着眼。”一一唐纳德•特朗普</li><li>所有俱乐部都是基于共同利益而建。而将他们捆绑在一起的则是他们共有的特点。也就是说，他们需要一个结件而出的理由。</li><li>你需要时刻警醒，不要一成为社交好手，就忘了自己起初的定位和价值观。</li><li>我认识到傲慢是一种病，它会让你忘记真正的朋友，忘记这些朋友有多么重要。</li><li>我每隔一段时间就会回顾过去，联系那些自我孩童时起就对我很重要的人。我去拜访我早年的导师，并告诉他们，他们对我多么重要，我今天的成功离不开他们当年的帮助。</li><li>要想得到别人的指导，最好的方法就是先不求回报地帮助别人。如果你需要学到某人的知识，那你就想办法证明你对他有用。</li><li><strong>社交并不仅是你实现目标的工具，更是一种生活方式。</strong></li><li>有多少人能够走进我们家，打开冰箱随便我点东西喝呢？实际上，这样的人并不多。人们需要与一些人保持这种 “冰箱权利的关系”</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ray-Dalio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Computer and AI Aided Drug Design</title>
    <link href="/extend-learning/cadd/"/>
    <url>/extend-learning/cadd/</url>
    
    <content type="html"><![CDATA[<p>Computer-Aided Drug Design (CADD)，即计算机辅助药物设计，是当下药物设计的一个重要技术手段。同时随着 AI 技术的发展，人工智能辅助药物设计（AIDD），作为 AI4Science 的重要一环，也在制药领域发挥着越来越重要的作用。</p><span id="more"></span><div class="note note-warning">            <p>本文的主要内容来源于几份 AIDD/CADD 相关的白皮书，一些大模型的知识，以及一些知乎上的回答。本文对以下方面进行了整理：</p><ul><li>制药行业的基本流程。</li><li>CADD/AIDD 的基本信息以及发展时间线。</li><li>AIDD 的应用场景。</li><li>AIDD 的发展现状以及挑战。</li></ul>          </div><div class="note note-danger">            <ul><li>本文未深入讨论 AIDD 应用场景中的具体问题。</li><li>调研过程中收集了一些 AIDD 的综述性文献，将在之后整理技术发展时再进行学习，不在本文中探讨。</li></ul>          </div><ul><li><a href="#%E7%8E%B0%E4%BB%A3%E8%8D%AF%E7%89%A9%E8%AE%BE%E8%AE%A1%E6%A6%82%E8%A7%88">现代药物设计概览</a><ul><li><a href="#%E5%85%B3%E9%94%AE%E6%AD%A5%E9%AA%A4">关键步骤</a></li></ul></li><li><a href="#cadd-%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF">CADD 基本信息</a><ul><li><a href="#cadd-%E7%AE%80%E4%BB%8B">CADD 简介</a></li><li><a href="#%E7%8E%B0%E4%BB%A3%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E5%8F%8A-cadd-%E5%8F%91%E5%B1%95%E5%8E%86%E5%8F%B2">现代制药行业及 CADD 发展历史</a></li></ul></li><li><a href="#aidd-%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF">AIDD 基本信息</a><ul><li><a href="#aidd-%E7%AE%80%E4%BB%8B">AIDD 简介</a></li><li><a href="#aidd-%E5%8F%91%E5%B1%95%E5%8E%86%E5%8F%B2">AIDD 发展历史</a></li></ul></li><li><a href="#aidd-%E4%BB%A3%E8%A1%A8%E6%80%A7%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">AIDD 代表性应用场景</a><ul><li><a href="#%E9%9D%B6%E7%82%B9%E5%8F%91%E7%8E%B0">靶点发现</a></li><li><a href="#%E9%9D%B6%E7%82%B9%E9%89%B4%E5%AE%9A">靶点鉴定</a></li><li><a href="#%E5%88%86%E5%AD%90%E7%94%9F%E6%88%90%E7%AD%9B%E9%80%89">分子生成/筛选</a></li><li><a href="#%E6%B4%BB%E6%80%A7%E9%A2%84%E6%B5%8B">活性预测</a></li><li><a href="#%E5%8C%96%E5%90%88%E7%89%A9%E5%90%88%E6%88%90">化合物合成</a></li></ul></li><li><a href="#aidd-%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E7%9A%84%E7%8E%B0%E7%8A%B6%E5%8F%8A%E6%8C%91%E6%88%98">AIDD 制药行业的现状及挑战</a><ul><li><a href="#ai-%E8%BE%85%E5%8A%A9%E8%8D%AF%E7%89%A9%E7%A0%94%E5%8F%91%E5%85%AC%E5%8F%B8">AI 辅助药物研发公司</a></li><li><a href="#%E4%B8%80%E4%BA%9B-ai-%E5%90%88%E4%BD%9C%E8%81%9A%E7%84%A6%E7%9A%84%E7%96%BE%E7%97%85">一些 AI 合作聚焦的疾病</a></li><li><a href="#%E8%A1%8C%E4%B8%9A%E6%8C%91%E6%88%98">行业挑战</a></li></ul></li><li><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE">参考文献</a></li></ul><h1>现代药物设计概览</h1><p>药物发现是一个<strong>昂贵且耗时</strong>的过程，平均获批的药物需要 10 到 15 年的时间来开发，估计成本为 8-20 亿美元。现代药物发现与设计的整体流程如下图所示。</p><figure>    <img src="pipeline1.png" alt="药物研发基本流程" class="border">    <figcaption>药物研发基本流程示意图。CRO 指受托研究机构（Contract research organization）<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[带你读《生命科学行业云上解决方案及最佳实践》——计算机助力药物研发](https://developer.aliyun.com/article/1227273)">[1]</span></a></sup></figcaption></figure><p>流程上：药物研发的输入是一个疾病（已有知识的某种表征），通过一系列的尝试/搜索/试错（实验/模拟），输出一个有着一定功效的药物（小分子/大分子结构），再对其进行药理、毒理评估，以及一系列临床试验，最终走向上市。</p><h2 id="关键步骤">关键步骤</h2><p>本节我们对药物研发中的关键步骤进行一些了解，主要限于临床研究之前的研究。其余步骤（临床试验、审批等）的难点并非局限于技术，所以在此不过多展开。以下步骤按照顺序陈述，每一步骤可能依赖于实验 🧪 和计算 💻 方法。</p><div class="note note-primary">            <p><strong>本节主要参考亿欧智库的《2021中国AI/计算制药 产业报告：药物发现篇》。</strong></p>          </div><p><strong>目标蛋白研究：</strong></p><ul><li>靶点与生物标记识别与验证：在基于结构的药物设计的早期阶段，识别和验证潜在的药物靶点蛋白，涉及基因组学、转录组学和蛋白质组学等。</li><li>🧪分子生物学特性研究：开始化合物搜索过程之前，选定特定蛋白质作为药物靶点后，需要全面了解该蛋白生物学功能和在疾病发展中的角色。</li><li>🧪蛋白质结构解析：确定目标蛋白的三维结构，可以通过实验工具进行，包括但不限于核磁共振、光谱、冷冻电镜和 X 射线晶体学。</li><li>💻同源建模预测结构：在缺乏实验数据（冷冻电镜）的情况下，同源建模可用于预测目标蛋白的三维结构，特别是当已知与目标蛋白序列相似的模板蛋白结构时。</li></ul><p><strong>药物设计–搜索与筛选：</strong></p><ul><li>💻虚拟筛选 (VS)：通过计算机模拟来筛选出可能与目标蛋白结合的小分子化合物。</li><li>💻药效团与先导化合物设计：确定和模拟小分子与目标蛋白之间的结合模式（最佳形状和电荷分布），从而为先导化合物的发现和优化提供依据。</li><li>💻构效关系（QSAR）分析：通过分析化合物的化学特性与其生物活性（如酶抑制、细胞毒性等）之间的关联，为化合物优化提供依据，与🧪分子生物学特性研究相互补充。</li></ul><p><strong>药物与目标交互：</strong></p><ul><li>💻结合位点识别与特性分析：在已知目标蛋白三维结构的基础上，识别并研究小分子可能与之结合的位点。</li><li>💻分子对接与亲和力预测：运用计算模型预测药物小分子与目标蛋白之间的最优结合模式及其亲和力。</li><li>💻分子动力学模拟：通过模拟分子运动来获取目标蛋白与小分子交互过程的动态信息，进一步了解药物作用机制，与🧪实验数据对比验证。</li></ul><p><strong>临床前研究：</strong></p><ul><li>🧪化学、制造和控制：初始合成用于快速毒理评估，不考虑成本。随项目进展，优化合成路线和工艺，以适应I-III期临床和商业需求。💻亦用于合成路线模拟。</li><li>🧪药代动力学：分析药物在体内的吸收、分布、代谢、排泄特性，以指导临床给药形式、频率和剂量。</li><li>🧪安全性药理：验证化合物对特定疾病的生物活性，并评估潜在副作用，特别是在心血管、呼吸和中枢神经系统方面。💻用于预测副作用。</li><li>🧪毒理研究：包括多种毒性评估，特定高耗资毒理实验（如致癌性、生殖毒性）可延至临床试验阶段。</li><li>🧪制剂开发：早期焦点在简便给药，无需完整处方。随项目进展，全面优化给药方式和处方，如解决吸收差或稳定性问题。💻用于制剂优化模拟。</li></ul><h1>CADD 基本信息</h1><h2 id="CADD-简介">CADD 简介</h2><p><strong>什么是CADD？</strong></p><p>计算辅助药物设计（CADD）是一个多学科领域，涵盖生物学、化学、物理学和计算科学等多个方面。CADD 使用各种计算方法（如分子力学、量子力学和人工智能）来构建模型，解释现有的生物分子现象，如小分子与药物靶点的结合情况，并利用这些模型预测新的现象，如找到活性分子或优化分子性质。目前来看 CADD 已经是药物研发中不可分割的一部分。</p><p><strong>为什么重要？</strong></p><ul><li><strong>成本效益</strong>: CADD 可大幅减少药物开发的时间和成本，估计能降低药物开发成本多达50%。</li><li><strong>全周期应用</strong>: 可用于药物开发的大多数阶段，包括目标识别、目标验证、先导发现、先导优化以及临床前研究。</li><li><strong>成功案例</strong>: 如卡托普利、多佐胺、奥司他韦、阿利吉仑和诺拉曲塞等多种已获批药物都经过了 CADD 优化。</li></ul><h2 id="现代制药行业及-CADD-发展历史">现代制药行业及 CADD 发展历史</h2><div class="note note-primary">            <p><strong>本节主要参考亿欧智库的《2021中国AI/计算制药 产业报告：药物发现篇》以及晶泰科技的《人工智能药物研发技术指南》。</strong></p><p><strong>本节的信息补全由 GPT4 展开（细节上或有一些错误，但时间上应当较为准确）。暂时没有时间逐项纠错，日后若有需要再进行优化。</strong></p>          </div><p>📈 行业里程碑：</p><ul><li>1966：赛勒斯·利文索尔将计算机模拟与分子图像相结合，标志着计算机辅助药物设计的初步发展。为科学家提供了一个全新的工具来理解和研究生物大分子。</li><li>1970年代：分子图形学出现使得科学家能以三维方式可视化分子结构。</li><li>1979：Tripos 出现，成为第一家专门从事 CADD 的公司。</li><li>1980年代：分子动力学模拟的发展，使研究人员能够实时观察和理解分子行为。</li><li>1984：BioDesign 公司启动了第一个基于蛋白质模拟的商业项目。</li><li>1987：Gaussian 成立，该公司推出了 Gaussian 软件，广泛用于量子化学计算。</li><li>1990年代：虚拟高通量筛选，允许研究人员通过计算手段快速筛选大型化学文库，以寻找有潜力的候选药物分子。</li><li>1990：Schrödinger 成立，该公司开发了一系列用于分子模拟和药物设计的软件工具。</li></ul><p>📊 数据方面：</p><ul><li>1965：Cambridge Crystallographic Data Centre (CCDC) 成立，开始收集和存储晶体结构数据，对化学和生物学研究具有基础性意义。</li><li>1971：Protein Data Bank (PDB) 成立，专门用于收集蛋白质和其他大生物分子的三维结构数据。</li><li>2004：PubChem 数据库上线，提供大量的化学分子和物质的信息，包括其结构、性质和生物活性。</li><li>2008：ChEMBL 数据库发布，收集与药物发现相关的生物活性数据。</li><li>2014：SureChEMBL 数据库发布，为公开获取的化学专利提供一个可搜索的资源，助力创新和药物开发。</li></ul><p>🔬 方法方面：</p><ul><li>1964：Hansch-Fujita &amp; Free-Wilson，早期用于预测分子生物活性的统计方法，建立分子属性与生物活性之间的关系模型。</li><li>1981：早期计算化学软件，MOPAC 主要用于量子化学计算，AMBER 主要用于生物大分子领域分子动力学模拟。</li><li>1982：Dock，一个用于模拟小分子与大分子（通常是蛋白质）相互作用的软件。</li><li>1983：CHARMM，用于模拟生物大分子，如蛋白质和核酸，具有广泛的应用。</li><li>1989：AutoDock，用于模拟分子对接的软件，广泛用于虚拟筛选，以帮助研究人员从大型化合物库中找到可能的药物候选分子。</li><li>1999：FMO，用于处理非常大的分子系统，将大分子分解为较小的片段并分别进行量子化学计算，能够更高效地处理复杂系统。</li></ul><div class="note note-success">            <p>我们可以发现，主要的事件都处于数据整合、数据分析处理以及物理计算模拟的领域，这也是计算机可以发挥作用的方向。</p>          </div><h1>AIDD 基本信息</h1><h2 id="AIDD-简介">AIDD 简介</h2><p><strong>什么是 AIDD？</strong></p><p>人工智能辅助药物设计 (AI-assisted drug discovery) 是使用人工智能技术来帮助药物设计和发现新的药物的过程。</p><p><strong>为什么重要？即有什么优势？</strong></p><figure>    <img src="AI-save.png" alt="AI 在药物研发中的优势" class="border">    <figcaption>AI 在药物研发中的优势</figcaption></figure><h2 id="AIDD-发展历史">AIDD 发展历史</h2><div class="note note-primary">            <p><strong>本节主要参考亿欧智库的《2021中国AI/计算制药 产业报告：药物发现篇》以及晶泰科技的《人工智能药物研发技术指南》。</strong></p><p><strong>本节的信息补全由 GPT4 展开（细节上或有一些错误，但时间上应当较为准确）。暂时没有时间逐项纠错，日后若有需要再进行优化。</strong></p>          </div><ul><li>2014 AIDD 的重要模型生成对抗神经网络(GAN)提出。</li><li>2014 由 D.E. Shaw 开发的专用于分子动力学模拟的超级计算机系统 Action 2 诞生。</li><li>2016 专注蛋白质运动研究的 Relay Therapeutics 成立。</li><li>2017 蛋白质结构预测的基础模型 Transformer 诞生。</li><li>2017.07 《新一代人工智能发展规划》发布，基于人工智能开展研究和新药研发，推进医药监管智能。</li><li>2018 蛋白质结构预测的模型 AlphaFold 诞生。</li><li>2018 国内 Al 制药公司成立迎来第一批浪潮（当年 8 家公司成立）。</li><li>2019 美国颁布 American Al Initiative FDA 与 NIH 旨在用于推动新药发现与审批。</li><li>2020 蛋白质结构预测的模型 AlphaFold2 诞生，并于 2021 年开源，蛋白质结构预测得分超过 90 分。</li><li>2020 首个Al研发药物 DSP-1181 (Exscientia) 进入临床试验阶段。</li><li>2020：Schrödinger 上市。</li><li>2021 全球 AI 药物发现领域投融资累计超 $100亿。</li><li>2021 国内两款 Al 辅助设计的药物（未知君与冰州石）进入临床试验阶段。</li></ul><div class="note note-success">            <p>至少从各大机构的研究报告中可以看到，生成式模型在这一波发展中起到了重要的作用。</p>          </div><h1>AIDD 代表性应用场景</h1><div class="note note-primary">            <p><strong>本节的内容大多摘自《2021中国AI/计算制药 产业报告：药物发现篇》以及中银证券的《AI 新药研发(AIDD)行业系列报告》中 41- 50 页，并进行简化修改。</strong></p><p><strong>本节的信息补全由 GPT4 展开（细节上或有一些错误，但时间上应当较为准确）。暂时没有时间逐项纠错，日后若有需要再进行优化。</strong></p>          </div><figure>    <img src="AI-participate.png" alt="AI 可参与的新药研发从药物发现到上市流程" class="border">    <figcaption>AI 可参与的新药研发从药物发现到上市流程</figcaption></figure><figure>    <img src="AI-application.png" alt="AI 在药物研发中具体应用场景" class="border">    <figcaption>AI 在药物研发中具体应用场景</figcaption></figure><figure>    <img src="AI-save.png" alt="AI 在药物研发中的优势" class="border">    <figcaption>AI 在药物研发中的优势</figcaption></figure><h3 id="靶点发现">靶点发现</h3><ul><li>通过对基因等医学大数据的挖掘分析来实现，通过比较正常组织和疾病组织，分析这两个组织的RNA或/和蛋白质差异表达，结合通路分析和强大的数据整合来发现靶点信息。</li><li>难点：发现新靶点需要极其专业的生物学知识，数据量较小，而人工智能更适合解决确定性场景问题。</li></ul><h3 id="靶点鉴定">靶点鉴定</h3><ul><li>具有已知生物活性的分子，如天然药物分子，需要鉴定其作用靶点以阐明其作⽤机制，进入药物开发阶段，通过分析和学习目标分子的已知类似分子的靶点，为目标分子预测其靶点。</li><li>难点:两种场景应用较困难，一是目标分⼦是全新结构，无法匹配到合适的类似物分⼦；二是⽬标分⼦的靶点为新靶点，该靶点尚未有已知的配体分⼦。</li></ul><h3 id="分子生成-筛选">分子生成/筛选</h3><ul><li>研究人员在《Chemical Neuroscience》上发表了一篇关于“化学空间” 的研究报告，该报告指出：理论上潜在药物小分子的数量达10^60，但目前研究人员合成的药物仅占潜在药物中的很小一部分。</li><li>AI 分子生成是计算机程序通过对海量的化合物或者药物分子进行学习， 基于已有分子结构及活性，自动学习它们的性质，总结提取化合物分子的结构等规律，并根据这些规律生成很多自然界从未存在过的化合物作为候选药物分子，有效构建拥有一定规模且高质量的分子库。</li><li>分子生成一方面可以拓展化学空间，为药物研发提供更多的先导化合物，另一方面可以通过机器学习提高先导化合物的质量，减少实验。</li><li>在进行生物活性实验筛选之前，利用计算机上的分子对接软件模拟目标靶点与候选药物之间的相互作用，计算两者之间的亲和力大小，大大降低实验筛选化合物数量，同时提高先导化合物发现效率。</li><li>难点：人工智能缺乏变通性，可能会剔除掉一些不符合其提取的规律特征的高潜力药物分子。</li></ul><h3 id="活性预测">活性预测</h3><ul><li>活性预测是通过让机器学习某个靶标蛋白与分子的相互作用数据或者多个靶标与分子的相互数据来建立预测模型，从而预测新分子的活性；或者用无标记数据的方法提取分子特征，再针对单一靶标建模的方法来做活性预测。目的是减少实验次数，节省时间和成本。</li><li>难点：由于数据来源于不同的实验室，不同实验室在实验过程中可能会存在误差，导致数据的整合缺乏标准，同时精准度不高，从而会影响到进一步的预测。</li></ul><h3 id="化合物合成">化合物合成</h3><ul><li>相较于制药行业的其他环节，化合物合成环节的数据量充足，化学反应的数据量达到了四五千万之多，且这些数据质量较高。</li><li>难点：<ol><li>这些反应的数据库主要掌握在 Scifinder 以及 Reaxys 国外两家数据库公司手里。</li><li>化合物合成虽然是药物研发上的重要一环，但并不被认为是核心环节，所以目前对于 AI 制药公司来说，给予的重视度与资源投入较少。</li></ol></li></ul><h1>AIDD 制药行业的现状及挑战</h1><h3 id="AI-辅助药物研发公司">AI 辅助药物研发公司</h3><div class="note note-primary">            <p><strong>国内的公司可以参阅中银证券的《AI 新药研发(AIDD)行业系列报告》中 57 - 59 页。</strong></p>          </div><figure>    <img src="AIDD-major.png" alt="AI 制药公司在各阶段的业务情况" class="border">    <figcaption>AI 制药公司在各阶段的业务情况</figcaption></figure><h3 id="一些-AI-合作聚焦的疾病">一些 AI 合作聚焦的疾病</h3><div class="note note-primary">            <p><strong>本节的内容大多摘自亿欧智库的《2021中国AI/计算制药 产业报告：药物发现篇》，并进行简化修改。</strong></p>          </div><figure>    <img src="disease.png" alt="药企在AI合作上聚焦的疾病方向" class="border">    <figcaption>药企在AI合作上聚焦的疾病方向</figcaption></figure><h2 id="行业挑战">行业挑战</h2><div class="note note-primary">            <p><strong>本节的内容大多摘自亿欧智库的《2021中国AI/计算制药 产业报告：药物发现篇》，并进行简化修改。</strong></p>          </div><p><strong>数据问题</strong></p><ul><li><strong>新药数量有限</strong>：自工业革命起，人类发现的新药只有1000多种，分布在几百个靶点上，且分布不均。</li><li><strong>数据不规范</strong>：历史上的药物研发数据并非专为AI准备，行业中没有统一标准数据集。数据来自不同实验室，各有其实验习惯和数据标准，可能存在误差。</li><li><strong>数据私有化</strong>：药物研发数据为企业核心资产，不易共享。尤其是有价值的数据，如失败案例，而公开的大多为成功研发数据。</li><li><strong>数据获取困难</strong>：药物研发时间长、成本高，一个药物可能需10年研发。若AI制药公司想自行积累数据，会面临巨大时间和资金压力。</li></ul><p><strong>问题场景</strong></p><ul><li><strong>机器学习的局限性</strong>：机器学习需要高度规范化的数据，但灵活性差。</li><li><strong>药物研发的挑战</strong>：药物研发仍然充满不确定性，知识不完备，同时需要高度的创新和灵活性。</li></ul><p><strong>人才需求</strong></p><ul><li><strong>交叉学科人才短缺</strong>：AI与新药研发是多学科交叉领域，涉及药物化学、分子生物学、量子力学等多学科。由于涉及计算机学科与传统药学、生物学的融合，人才短缺，专业壁垒高。</li></ul><h1>参考文献</h1><p><strong>研究报告以及白皮书</strong></p><ul><li><strong>《AI 新药研发(AIDD)行业系列报告》 – 中银证券</strong><ul><li><strong>强烈推荐！</strong> 十分详细。</li><li>主要是从商业角度对整个制药流程进行分析。</li></ul></li><li>《人工智能药物研发技术指南》-- 晶泰科技<ul><li><strong>推荐！</strong> 建议在对流程有一定认识之后再阅读。</li><li>包含了制药流程中许多技术上的关键问题介绍。</li></ul></li><li>《2021中国AI/计算制药 产业报告：药物发现篇》-- 亿欧智库</li><li>《行业百科系列之医药篇——医药研发环节解密》-- 中债资信</li><li>《【2021版】全球44家顶尖药企AI辅助药物研发行为白皮书》-- 速石科技 fastone</li></ul><p><strong>相关综述文献（不含在本文内容中）</strong></p><ul><li>Askr, H., Elgeldawi, E., Aboul Ella, H. et al. Deep learning in drug discovery: an integrative review and future challenges. Artif Intell Rev 56, 5975–6037 (2023).</li><li>Computational Approaches in Drug Discovery, Development and Systems Pharmacology, Book • 2023</li><li>Bassani, Davide, and Stefano Moro. “Past, Present, and Future Perspectives on Computer-Aided Drug Design Methodologies.” Molecules 28.9 (2023): 3906.</li></ul><!-- **参考网页**- [药物设计学中，CADD现在还有实际研究意义吗？ - 青梅煮药的回答 - 知乎](https://www.zhihu.com/question/464530681/answer/3023795560)- [药物设计学中，CADD现在还有实际研究意义吗？ - AIDD Pro的回答 - 知乎](https://www.zhihu.com/question/464530681/answer/1984454064)- [CADD的职业规划是怎样的, 如何从数据分析走到CADD？ - 求索的回答 - 知乎](https://www.zhihu.com/question/451044829/answer/1814084039)- [化学专业读研走CADD是否待遇会好一些？ - 奋斗的乐天派的回答 - 知乎](https://www.zhihu.com/question/582157841/answer/2914985403)- [CADD研一新手上路   跪求高人指点  该从何学起？ - StoneMIND Collector的回答 - 知乎](https://www.zhihu.com/question/21749830/answer/2369245462)- [怎样看待cadd在未来新药研发的地位和角色？ - AIDD Pro的回答 - 知乎](https://www.zhihu.com/question/265213630/answer/1956475967)- [计算机下的生物信息方向算天坑吗？ - 火鸡科学家的回答 - 知乎](https://www.zhihu.com/question/579487884/answer/2851750207)- [想往CADD方向发展，需要做些什么准备？ - 陶术的回答 - 知乎](https://www.zhihu.com/question/379527499/answer/2392119405)- [怎样看待cadd在未来新药研发的地位和角色？ - AIDD Pro的回答 - 知乎](https://www.zhihu.com/question/265213630/answer/1956475967)- [【收藏】最全新药研发流程 - 药驿站的文章 - 知乎](https://zhuanlan.zhihu.com/p/71213145) --><p><strong>脚注</strong><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://developer.aliyun.com/article/1227273">带你读《生命科学行业云上解决方案及最佳实践》——计算机助力药物研发</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section></p>]]></content>
    
    
    <categories>
      
      <category>Extend Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI4Science</tag>
      
      <tag>AIDD</tag>
      
      <tag>CADD</tag>
      
      <tag>VC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>国富论</title>
    <link href="/reading-note/the-wealth-of-nations/"/>
    <url>/reading-note/the-wealth-of-nations/</url>
    
    <content type="html"><![CDATA[<p>现代经济学之父，亚当斯密的传世著作。</p><span id="more"></span><h2 id="极简简介">极简简介</h2><p>本书从生产的三大要素出发（劳动、土地、资本）讨论市场经济行为（看不见的手）以及分工理论。此外本书也从政治经济学的角度讨论了现代意义的国家的责任与税收。</p><h2 id="个人看法">个人看法</h2><p>本书的阅读过程实在是间断，前两章前年先读，第三章隔了一年，最后两章今年近期才读完。如此的阅读方式或许遗漏了重点，此处仅以自己印象来进行评价，读个乐子，不求甚解。本书的优点我就不赘述了，毕竟传世巨作。总的来说，其对我个人的意义主要还是加深了一些对劳动和商品价值的理解。</p><h3 id="缺点">缺点</h3><p>我个人认为本书存在着显然的局限性，即一个很强的假设——“人是理性且自由利己的”。这一假设也在后来几百年的研究中不断的被敲打，不过作为理想的经济学模型来说，其仍有极大的参考价值。毕竟做研究还是需要定好假设的，通常越本质的研究，假设越少越简单。此外，本书并没有加入很多货币的讨论，从完整分析经济的角度上来说或许缺了一块（不过货币学说在金属本位下或许较为直观，不用过多阐明）。或许还是要再读一遍加深理解，来发掘更多的缺陷。</p><h3 id="感想-看法">感想/看法</h3><ul><li>经济学的确和资产负债表等会计类知识高度相关，从个人/公司/国家不同层级来看，清楚的了解自己的资产负债表是十分重要的。</li><li>书中生产性劳动和非生产性劳动，让人想起翟老师说的可贸易品和不可贸易品。不过此处是以价值的角度来衡量劳动，那么劳动的定价的确是比较有意思的话题。</li><li>或许第二篇提到的资本国内运作可以和当下的“以国内大循环为主”联系起来。或许内循环的确要重于外循环。</li><li>“在对外贸易出现之前，剩余生活资料都被用于供养家眷/佃农等，导致贵族/地主的实力权威强大，政府权威弱小。而外商和制造业的出现，他们会选择将这些剩余的资料购买一些无用的东西，宁愿舍弃从这些资料中获得的势力和权威而将其拱手让人。”这个或许从一定程度上带来了国家政局的安定，即地方势力的自我阉割。</li><li>俄乌战争双方缺的都不是钱而是物资，而两者好像都有渠道搞到物资。</li><li>维持市场看来是要比赚货币更重要。联系到了之前的“我们为什么要资助落后国家？”的思考，以及大家挤破头杀入印度市场的现象。</li><li>本书很大程度上在阐明国家在经济调控中处于的位置，同时展现了不少手段（关税等）。</li><li>“但是对于真正的各个职业需要的工具的出口，并不是通过高额的关税来制约的，而是通过绝对禁止来制约的。”想到了光刻机。</li><li>书中提到的很多问题和现象好像目前越南也拥有。</li><li>所以到底什么是“生产”呢？或许需要一个更精确的定义。</li><li>亚当斯密对中国的分析很到位，国内大市场再加一个广阔的国外市场可以是的制造品大大增加，如果再通过自己的船只经营，使得制造业生产力大大提升。此外还能学到国外机械的制造和使用方法。但是当时的中国除了模仿日本外，再没有机会模仿外国改良自己了。</li><li>当前购房的行为一定程度上也是一种加在公民身上的土地税。</li><li>此书多处强调公平！经济上和法律上的公平。很难想到是一本数百年前的书。</li><li>进口商人准备货仓的形式和如今的国际物流货仓十分相近！竟然 250 年前就有相似的形式了。</li><li>看到一些说法是读《国富论》之前应当先读《道德情操论》，已加入书单。</li><li>Fun fact，亚当斯密出生的那一年，中国雍正皇帝登基。写《国富论》的那一年，1776 年，美国同年发布《独立宣言》。当国外的学者已经在探究社会经济运行的本质之时，我国似乎并没有“思想”上的进步。</li><li>好的经济制度就是鼓励每个人去创造财富的制度。</li><li>本书似乎讲的并不是国家该怎么富，更多的是在讲什么是“富”，以及每个人在此过程中的位置。</li><li>香港似乎的确符合书中描绘的这么一个自由主义的弱政府经济港。</li><li>但是这种发达经济下的分工模式也反映出很多问题。在这种螺丝钉化的培养模式下，产出了大量具有螺丝钉能力（比较优势）的年轻人。当社会总需求大幅降低的时候，这些年轻人无从就业，一定程度上又使得社会效率变得低下。</li><li>“固定资本和流动资本目的一致：使供消费使用的资产不会短缺而且还要增加”，这句话或许是在强调消费的重要性，因为其造就资本的流动，反应了人的正常需求。</li><li>重视商人的确是一种试错成本很低的探索手段，远远高效于政治家的“计划”。</li><li>似乎我们曾经也有重商主义的影子，即重生产，轻消费。现在已经意识到了这种问题，想拉动消费需求，但是似乎还是没有找到好的方法。</li><li>农耕文明似乎在中国人的基因里种下了对于房产的渴望。</li><li>“多数人的穷困是少数人富有的前提”，这句话振聋发聩。在越南，少数人先富起来似乎使得多数人永远陷入了穷困（中性表述）。</li></ul><h2 id="按节讨论-摘录">按节讨论/摘录</h2><h3 id="第一篇：论劳动生产力增进的原因并论劳动生产自然分配给各阶级人民的顺序">第一篇：论劳动生产力增进的原因并论劳动生产自然分配给各阶级人民的顺序</h3><ul><li>可以通过契约交换购买来满足自己的绝大部分需求，所以才从这种相互交换的倾向中产生了分工。</li><li>分工的程度受到交换能力大小的限制。</li><li>商品市场价格或实际价格与自然价格不一致的原因何在？<ul><li>一个人贫穷或者富有，就要以他所能支配劳动的多少而定，就是看他能购买多少劳动。</li><li><strong>劳动才是衡量一切商品内在交换价值的真实尺度。</strong> 只有用劳动做标准，才能把任何时代任何地方的商品价值拿来做比较。</li></ul></li><li>土地私有和资本私有出现，劳动者独享自己全部劳动生产物的原始状态便宣告结束了。<ul><li>地租和利润在劳动者在土地上全部劳动所得中被扣除。</li></ul></li><li>以工资为生的劳动者的需求，必然随着一个国家收入和资本的增加而增加（国民财富增加）。<ul><li>丰厚劳动报酬是国民财富增长的必然结果和自然表征。</li><li>贫困劳动者生活资料匮乏是社会停滞不进的表征。</li><li>劳动者食不果腹，则是社会迅速倒退的特征。</li></ul></li><li>劳动者供给会回归到与社会需求相适应的程度。</li><li>劳动者越多，分工越精细，当前分工更先进的设备制造出来，生产力增加。</li><li>用生产商品所需劳动量的减少抵偿劳动价格的提升。</li><li>某行业资本增加导致相互竞争导致利润减少。</li></ul><h3 id="第二篇：论资产的性质、积累与使用">第二篇：论资产的性质、积累与使用</h3><ul><li>希望通过它可以获得收入的那一部分资产叫做资本。</li><li>行业不同，所需资本差异巨大。</li><li>一个国家社会的总资产便是他全体居民的资产，分为三个部分：<ul><li>消费部分，不产生收入。</li><li>固定资本。</li><li>流动资本：货币、食品、材料、制成品。</li></ul></li><li><strong>固定资本流动资本目的一致：使供消费使用的资产不会短缺而且还要增加。</strong></li><li>一个国家每年能够通用的货币数量是有每年在境内流通的消费品的价值决定的。</li><li>对大国来说，个人的奢侈和任意而为并不会产生很大的影响。另一部分人的借鉴慎重通常能够补偿奢侈和任意而为的人所消耗的那一部分，并且还有剩余。</li><li>中国、古埃及、印度的剩余产品，大多都由外国人出口，所交换回来的也多为他们所需要的东西，常常是金银。</li><li>事实上，对外贸易的资本运作速度很少能达到国内贸易的运作速度。</li><li>政治经济学的远大目标，便是增长本国财富、增强本国实力，所以出于对本国经济的考虑，不应奖励对外消费品贸易，而应奖励国内贸易；不应奖励运输贸易，而应奖励对外消费品贸易。出于对本国经济的考虑，不应强迫也不应诱使较大份额的资本违背事物的自然趋势，流入到对外消费品贸易或运输贸易渠道中去。</li><li>当某一特定产业部门的生产超出了本国需求时，剩余部分必定会被送到国外，以交换国内所需要的物品。</li><li>如果一个国家所积累的资本不能全部用在满足本国的消费需求、维持本国的生产性劳动时，那么他所剩余的部分自然就会流进运输贸易渠道，用于满足其他国家的消费需求，维持其他国家的生产性劳动。运输贸易是巨额国民财富的自然结果和象征，但却并不是国民巨额财富的自然原因。</li></ul><h3 id="第三篇：论不同国家的财富发展">第三篇：论不同国家的财富发展</h3><ul><li>在文明社会，城市与农村之间的贸易往来是其商业的重要组成部分。</li><li>至于把剩余产品输出、送往国外的资本到底是哪国的资本，是外国的还是本国的，则不太重要。</li><li>如果本国的资本不足以支持对所有土地进行耕种和最大限度地对自然生成物进行加工，那么即使将本国的剩余产品送往国外的资本不属于本国，也会对本国有利。这是因为有了这种资本，就能使本国的所有资本投资于更有利的用途上。</li><li>大地主的愚蠢，商人和工匠的勤劳，最终促成了这场变革的完成。</li></ul><h3 id="第四篇：论政治经济学体系">第四篇：论政治经济学体系</h3><ul><li>货物除了可以购买货币之外，还可以有许多其他用处。但是货币除了购买货物之外，就没有其他任何用处了。</li><li>人们需要货币，更多的时候需要的不是货币本身，而是货币所能购买的物品。</li><li>不论哪个国家，依赖铸币流通的商品的价值都支配着其国内铸币的数量。商品的价值增多了，立刻有一部分的商品会被送到有金银铸币的外国，购买流通商品所需要增加的铸币。</li><li>一国要维持在异国的军队并进行对外战争，并不一定要储蓄金银。因为维持军队的不是金银，而是可消费的物品。</li><li>在遥远的地方建立殖民地，不仅可以给母国的货物和商人提供某些特权，而且往往获得垄断权。</li><li>社会总产业不能超过社会总资本所能维持的限度。</li><li>哪种国内产业最适宜投资，哪种产业生产物有最大价值，因为商人本身就处在当事人的位置上，所以他们做出的判断要比政治家或立法者准确的多。</li><li>立法者的思考应该受长久不变的普遍原理的指导，政治家作为狡猾权谋的动物，才会受暂时变化的支配。</li><li>为禁止国外商品输入，或者是为减少外国商品输入而征收的赋税，显然是既破坏了贸易自由也破坏了关税收入。</li><li>有些外国商品在输入时，就已经注定了输入量会大大超过国内能消费的量，那么在再次输出时，就会退还已经缴纳的全部税款。</li><li>只有输出品是真正输送到外国去时，退税制度才会带来益处，如果输出去的货物最后又被偷偷的运回国内，那么这种退税制度就没有任何用处了。</li><li>当制造业发展到一定程度的时候，各种职业需要的工具的制作，就会成为许多非常重要的制造业的目标。给这种工具的输入任何额外的奖励，都会对从事这个行业的制造业者的利益产生很大的妨害。所以，这样的进口，不但不会受到奖励，而且通常会被禁止。</li><li>重商主义所要奖励的产业，都是由富有而有权势的人所经营的。至于那些由贫苦而弱小的人经营的产业，通常是被重商主义忽视或者抑制的。</li><li>一个国家的君主对于隶属于它的各个阶层的人民都应该公平地对待。为了一个阶级的利益而损害另一个阶级的利益，很明显是违反这个原则的——禁止羊毛出口的条令，恰恰就是为了制造者的利益而损害了生产羊毛的人的利益。</li><li>但是对于真正的各个职业需要的工具的出口，并不是通过高额的关税来制约的，而是通过绝对禁止来制约的。</li><li>这些规定可以被人们称道的就是它们的出发点——拓展我国的制造业。但是它拓展所采用的方达井不是通过提升自己的制造业。而是通过阻碍周边国家的制造业， 并尽所能地灭所有可能和我国进行竞争的国家的制造业。</li><li><strong>所有生产的唯一目的和宗旨就是消费。</strong> 只有当促进消费者的利益必须要考虑生产者利益的时候，生产者的利益才会被重视，也只有在这种情况下，才需要重视。这个准则是非常明白的，简直就不用证明。但是在重商主义下，消费者的利益几乎总是为了生产者的利益而被牺牲掉。重商主义仪乎抛弃了消费，而是把生产当作了所有工商业的最终目的。</li><li>在一个国家中，每个人为了改变自身处境而进行的自然努力就会成为一种保护力，可以在许多方面预防并矫正那些不公平、有制约作用的政治经济政策带来的不好结果。这种不好的政治经济政策，毫无疑问会防碍一个国家交得富有繁荣的自然进步，但是它并不能完全阻止这种自然进步，更不能让一个国家后退。</li><li>重农主义学说最大的错误，在于将工匠、制造业工人和商人都当作是没有生产或者是不能生产的阶级。</li><li>一个阶级更大的生产能力，绝对不能够让其他阶级成为没有生产或者是不能生产的阶级。</li><li>有用劳动的生产力改进与否受两个因素影响：劳动者自身能力的提升，劳动者工作使用机械的政进。</li><li>而且如果一个国家的国内市场不能像中国那么广阔而有利的话，那么制造品也常常需要通过对外贸易进行销售。如果没有广阔的国外市场，那么在国土面积不大、只能提供狹小国内市场的国家（或者是因为国内某生产物不能自由销往国内各地、或者是因为国内各个地方间交通不方便的国家），制造业就不可能会有很好的发展。</li><li><strong>制造业是通过分工日臻完善的，而制造业所能实行的分工的细化程度，又一定是由市场范围决定的。</strong></li></ul><h3 id="第五篇：论君主或国家的收入">第五篇：论君主或国家的收入</h3><ul><li>农业是有固定性的。就算是农耕文明程度最低、耕作方式最落后的农民，也一定要有一个固定的住处。一旦要放弃这个住处，就会遭受巨大的损失。</li><li>勤劳而殷实的国家，通常最容易引起周国国家的侵犯。所以，如果国家不采取一些新的方法加强国防，人民形成的习惯，会让他们完全地失去保护自己的能力。</li><li><strong>多数人的穷困是少数人富有的前提。</strong> 富人的富有会激起穷人的不满，穷困会驱使穷人、羡慕会煽动并盅惑穷人，让他们侵害富人的财产。</li><li>人们都愿意接受自己或者是自己的祖辈服从过的世家，如果原来不比自己优越的家门突然超越并可以支配他们了，那么他们就会愤愤不平。</li><li>如果司法权和行政权没有分离，那么公正很容易就会被人们通常所说的政治势力牺牲掉。承担着国家重任的人，就算是没有什么腐败的想法，也总会觉得为了国家的重大利害关系，有时有必要牺牲个人的权利。</li><li>为了尽可能地让这种生产物既产量丰富，又价格合适，那么就必须努力给这个生产物提供广阔的市场。以而就有必要在國内各个地方建立最自由、最方便而且最低廉的交通。要建立这种交通，只有建造最好的运河和最好的道路。</li><li>文明社会中所有下级人民的理解力，经常被粗野的无知和愚钝所麻痹，这种无知和愚钝也可以說是一种精神上的残疾和畸形。</li><li>在自由的国家中，政府的安全极大地建立在人民对于政府行为所持的好感度上。人民不轻率地、随意地判断政府的行动，的确是一件非常重要的事。</li><li>在欧洲，已经没有一个现代文明国家把土地作为国家私有财产，把地租作为公共收人的主要来源了。</li><li>一个文明国家的必要费用，如果只依靠君主或国家特有的资财和土地两项收入进行支付，那么不但不合理，而且也不够。那么剩下的方法，就是依靠其他项的税收来支付了，也就是，人民需要自己拿出一部分私人的收人来弥补国家公共的收入。</li><li>一般来说，要通过消费品来判断一个人全部费用是奢侈还是节俭，最好是根据房租判断。</li><li>管理国家的人，通常都会给自己或者是自己的直接从属人员以超过合适额度的报酬。</li><li>对奢侈品征收的赋税，除了会提高商品本身的价格外，对其他任何商品的价格都没有提高作用。但是对生活必需品征收的税。因为提高了劳动工资，所以一定会提高所有制造品的价格，从而缩小它贩卖和销售的范围。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
      <tag>经济</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《基因之河》读书笔记</title>
    <link href="/reading-note/river-out-of-eden/"/>
    <url>/reading-note/river-out-of-eden/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>一本 Ray Dalio 送给王岐山的书<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="《原则》书中提及。">[1]</span></a></sup>。</p><span id="more"></span><h2 id="作者">作者</h2><p>Richard Dawkins 理查德·道金斯，自私的基因作者，牛津大学教授，英国皇家科学院院士。</p><h2 id="极简简介">极简简介</h2><p>一本从进化论的角度来看待基因的书籍。对基因的传递逻辑以及这这种信息传播系统的特点进行了阐述。</p><h2 id="读书心得">读书心得</h2><h3 id="极简评价">极简评价</h3><p>个人认为本书可以看做高中生物基因知识以一种哲学角度（探求本质）的展开。包含一些比较有趣的知识，比如线粒体夏娃。陈述较为平实，没有太多乏味的陈述。把一些不是很显而易见但是细想会有一些道理的点阐述的比较清楚。推荐阅读。</p><h3 id="感想看法">感想看法</h3><ul><li>线粒体夏娃。原来现代人的线粒体基因都一样，而且都来源于同一位女性。好奇其他生物是否存在线粒体夏娃这一概念。</li><li>为什么基因会使用四进制呢？</li><li>卵子的不同部位化学物质梯度差异似乎带来了初步的分化引导指令。</li><li>为什么女性和女性不能生娃？或者说，为什么一定会有两种性别？</li><li>“造物者的效用函数几乎从不会是为大多数谋求最大福利，而是在为私欲而产生的不协调的争斗中背叛其初衷。”，然后就卷了起来。</li><li><strong>“当效用函数是 DNA 的生存时，就注定生命并非是以幸福为宗旨。”</strong> 这句话有点像是“人生的意义是活着”，比较震撼。当然作为个人来说，幸福的确是人生意义之一。</li><li>效用函数未必是以 DNA 生存来标定的，或许这只是一种外显的结果。</li><li>或许在其他的环境中，也存在这么一种可以更新迭代的遗传系统，未必是以 DNA 或蛋白质的形式展开，但是也需要满足物理的原理。</li></ul><h2 id="内容摘录">内容摘录</h2><ul><li>在数千个连续的世代之后，依然存在的基因大概率是优秀的基因。</li><li>某只个体白蚁究竟会成为拥有繁殖能力的蚁后，还是成为不具有生育能力的工蚁，取决于环境，而非基因。</li><li>这个基因也来自你四位祖辈中的一辈，来自你八位曾祖辈中的一位且只有一位。</li><li>区别某一物种的依据就是，任一物种的所有成员体内都流淌着同一条基因之河，某一物种的全部基因要准备好成为彼此的好伙伴。</li><li>人一生中最重要的时刻并非出生、结婚或死亡，而是原肠胚的形成。</li><li><strong>当你踏出时光机，眼睛看见的每一个人要么是全体人类的共同祖先，要么谁的祖先也不是。</strong></li><li>线粒体包含了一个过往的独立纪录，没有受到主核 DNA 的污染。</li><li><strong>你的线粒体 DNA 和我的线粒体 DNA 之间会存在一些不同之处，而这些不同的数量就是我们的祖先在多久之前分离开来的测量方法。</strong></li><li>无论你怎么看待这个问题，追湖到 200 万年之前，所有人类都是非洲人。除此之外，非洲夏娃理论还认为，如果仅仅追湖到几十万年前，当时幸存下来的人类也都是非洲人。</li><li>线粒体夏娃是女性专属继承路径上距今最近的人类共同祖先，而还有许多其他方式可以成为祖先的后代，而无须沿袭女性专属路径，可以说人们还有成百上千万条其他的路可以走。</li><li><strong>生命真正的效用函数，即在自然界中得到最大化的事物是 DNA 生存。</strong></li><li>美丽本身并非绝对的美德，但如果某些基因的确能让雄性具有该物种雌性认为值得拥有的特征，那么这些基因无论如何都能生存下来。</li><li>造物者的效用函数几乎从不会是为大多数谋求最大福利，而是在为私欲而产生的不协调的争斗中背叛其初衷。</li><li>如果是在十岁时就被开启的致病基因，那么基本上就没有传播下去的可能性了。</li><li>无论何时，某个基因因为在个体年轻时产生有益效应而得到自然选择的偏好，比如年轻雄性的性吸引力，这个基因都可能存在负面影响，比如诱发中老年阶段的某种特定疾病。</li><li><strong>当效用函数是 DNA 的生存时，就注定生命并非是以幸福为宗旨。</strong></li><li>基因不在乎痛苦，因为它毫无顾忌。</li><li>自然对众生的痛苦毫无兴趣，除非痛苦会影响到 DNA 的生存。</li><li>在充满冷却液氨的世果中，DNA 或蛋白质系统无法发挥作用，但也许有某种遗传和胚胎系统可以在其中发展。</li></ul><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>《原则》书中提及。<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ray-Dalio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>P、NP 与 NP 完全问题</title>
    <link href="/computer-science-engineering/p-np/"/>
    <url>/computer-science-engineering/p-np/</url>
    
    <content type="html"><![CDATA[<p>起因是看到了 Matrix67 的旧文<a href="http://www.matrix67.com/blog/archives/105">《什么是 P 问题、NP 问题和 NPC 问题》</a>，然后发现自己对这些“问题”并不是完全清楚，于是这里做一个总结。本文大篇幅摘自 <a href="https://yzhang-gh.github.io/notes/others/p-np.html#%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6">yuzhang 的博客总结</a>，外加一些删减与修改。</p><!-- omit in toc --><h1>P、NP 与 NP 完全问题</h1><blockquote><p>🥥 In a Nutshell</p><p>简单的问题，难的问题，更难的问题，更更难的问题<span class="cn-font" lang="zh-CN">……</span>最难的问题，无法解决的问题</p></blockquote><h2 id="时间复杂度">时间复杂度</h2><p>要想衡量一个算法跑得快不快，直接测一个程序要运行多少秒的研究意义不大，因为这个结果会受具体物理设备的影响。我们需要的是一个对于算法本身效率的度量。</p><p>算法的<strong>时间复杂度</strong>描述的是执行一个算法所需要的<strong>时间</strong>相对于<strong>问题规模</strong>（输入规模）的<strong>函数关系</strong>，大约相当于该算法所需要的单元操作的数量。下表是一些常见的时间复杂度（更详细的表格可见<a href="https://zh.wikipedia.org/wiki/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6#.E5.B8.B8.E8.A7.81.E6.97.B6.E9.97.B4.E5.A4.8D.E6.9D.82.E5.BA.A6.E5.88.97.E8.A1.A8">此处</a>）</p><table><thead><tr><th>名称</th><th>复杂度</th><th>算法举例</th></tr></thead><tbody><tr><td>常数时间</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td>判断一个二进制数的奇偶</td></tr><tr><td>线性时间</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td>找出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 个数中的最大值</td></tr><tr><td>线性对数时间</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td>快速排序</td></tr><tr><td>二次时间</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td>冒泡排序</td></tr><tr><td></td><td></td><td></td></tr><tr><td>指数时间</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">2^{O(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></td><td>使用动态规划解决<a href="https://zh.wikipedia.org/wiki/%E6%97%85%E8%A1%8C%E6%8E%A8%E9%94%80%E5%91%98%E9%97%AE%E9%A2%98">旅行商问题</a></td></tr><tr><td>阶乘时间</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n!)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">!)</span></span></span></span></td><td>使用暴力搜索解决旅行商问题</td></tr></tbody></table><p>时间复杂度常用大 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span> 符号表示，不包括这个函数的首项系数和低阶项。比如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mn>5</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">3n^2+5n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span><span class="mord mathnormal">n</span></span></span></span> 对应的时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，首项系数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> 不影响时间增长速度，而低阶项 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">5n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span><span class="mord mathnormal">n</span></span></span></span> 随着 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 的增长（至极限）会远小于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>，这种方式称为<strong>渐进时间复杂度</strong>。从理论分析的角度，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>0.01</mn><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(0.01n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">0.01</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 要比 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>100</mn><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mn>100</mn><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(100n^2+100n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">100</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">100</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 复杂度高，不过对于现实中的具体问题，首项系数和低阶项仍然值得具体分析。（<a href="https://zh.wikipedia.org/wiki/%E9%93%B6%E6%B2%B3%E5%BC%8F%E7%AE%97%E6%B3%95">银河式算法</a>）</p><p>时间复杂度常被分为两种级别，一种是<strong>多项式级复杂度</strong>，比如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mi>c</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 等，其特点是规模 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 出现在底数的位置。另一种是<strong>非多项式级复杂度</strong>，比如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>c</mi><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(c^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n!)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">!)</span></span></span></span>。后者的复杂度远远大于前者，使用其来解决问题往往是不现实的。</p><h2 id="P-问题">P 问题</h2><p><span class="cn-font" lang="zh-CN">——</span>可以在多项式时间<strong>找出解</strong>的问题<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="严格来说是**判定性问题 / 决策问题**（输出为 yes 或 no）或**最优化问题**，几乎所有最优化问题都有对应的**简单一点的**判定性问题，比如「求最小路径」与「是否存在小于 $\small \ell$ 的路径」。此外还有函数式问题 (function problem)，允许其它形式的输出，比如「求两数之和」，这些相应的问题称为 **FP** 和 **FNP**。">[1]</span></a></sup></p><p><strong>P</strong> 通常表示那类可以「有效率地解决」或「温驯」的可计算型问题，即使指数级可能非常高。数据结构与算法课中遇到的问题基本都属于 <strong>P</strong> 类，比如排序问题。</p><p>那么比 <strong>P</strong> 更难一些的问题是什么呢？</p><h2 id="NP-问题">NP 问题</h2><p><span class="cn-font" lang="zh-CN">——</span>可以在多项式时间里<strong>验证一个解</strong>的问题</p><p><strong>NP</strong> 问题不是「非 <strong>P</strong> 问题 / non-<strong>P</strong>」，而是「可以由<strong>非</strong>确定型图灵机 (<strong>N</strong>ondeterministic Turing machine) 在多项式 (<strong>P</strong>olynomial) 时间解决的问题<span class="punct-halt">」</span>（图灵机是一种用来研究算法复杂度的计算模型，此处我们不深究。严格来说，<strong>P</strong> 问题是指「可以由确定型图灵机在多项式时间解决的问题」）。</p><p>但是上面这个定义看着就有点吓人，我们不妨关注 <strong>NP</strong> 的另一个<strong>等价定义</strong>：「可以在多项式时间<strong>验证</strong>一个解的问题」。</p><blockquote><div style="text-align:center"><span style="width:40%;display:inline-block">    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6c/Hamiltonian_path_3d.svg" alt="Hamiltonian path 3d" width="200" style="margin: 0 15px 10px"></span><span style="width:40%;display:inline-block">    <img src="https://upload.wikimedia.org/wikipedia/commons/6/60/Hamiltonian_path.svg" alt="Hamiltonian path" width="200" style="margin: 0 15px 10px"></span></div><p><strong>哈密顿路径 / 环</strong> (Hamiltonian path/cycle) 就是经典的 <strong>NP</strong> 问题，意思是给定一个图（顶点和边），判断是否存在一条 恰好经过每个顶点一次 的路径或者环。验证这个问题的解只需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>（顺着路径检查就行），但是想从一个图中寻找这样一个 Hamiltonian path 到现在还没有多项式级的算法。</p></blockquote><p><strong>很明显，P 问题是 NP 问题的子集</strong>：对于一个判定性问题（输出 yes 或 no），如果你已经能在多项式时间解出答案，那么验证一个解只需要比较一下了。</p><p><strong>那么 P 等不等于 NP 呢？</strong> 这个问题对数学家尤其有吸引力。「对于数学家来说如果有一个机器能帮助他们证明各种定理那就爽了。数学家经常干的两件事：① 给出证明，② 验证某个证明是不是对的。直觉上肯定验证更容易一些，但如果 somehow 可以证明 <strong>NP</strong> = <strong>P</strong>，也就是说<strong>验证</strong>和<strong>给出证明</strong>其实在数学上是等价的，那么这个证明很可能给出了如何把<strong>验证一个证明是否正确 NP</strong> 转化为<strong>如何给出一个证明 P</strong> 的方法，从此以后数学家只要思考如何验证证明的正确性就能自动得到证明了，那不爽炸了。那个时候密码学的重要性只是崭露头角，但即使是在数学上的重要性，也足够让这个定义吸引人了。」</p><div class="note note-success">            <p><strong>P</strong> 与 <strong>NP</strong> 对于密码学的重要性则在于：现在最广泛应用的非对称加密方法（如 RSA）的核心假设就是大整数分解是<strong>难</strong>的（非 <strong>P</strong>）。两个数相乘得到乘积很容易，但是想找出大整数（乘积）的因数就不容易了，而其中最难分解的是两个大质数^[两个差不多大小的质数]的乘积。整数分解显然是 <strong>NP</strong> 问题，如果 <strong>P</strong> = <strong>NP</strong>，则意味着其肯定存在多项式时间的算法，破解加密算法也就「容易」了。</p>          </div><p>虽然 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi mathvariant="sans-serif">P</mi><mo>=</mo><mrow><mi mathvariant="sans-serif">N</mi><mi mathvariant="sans-serif">P</mi></mrow><mo stretchy="false">?</mo></mstyle></mrow><annotation encoding="application/x-tex">\small \mathsf{P} = \mathsf{NP}?</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;"></span><span class="mord mathsf sizing reset-size6 size5">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathsf">NP</span></span><span class="mclose sizing reset-size6 size5">?</span></span></span></span> 问题一直到现在仍然没有找到解决的思路，但是在研究这个问题的过程中，人们也有很多其它的发现。</p><h2 id="NP-完全问题">NP 完全问题</h2><p>(aka <strong>NP-complete problems</strong>)<span class="cn-font" lang="zh-CN">——</span><strong>NP</strong> 问题中「<strong>最难</strong>」的一部分问题</p><p>在此之前，我们需要先引入一个概念：<strong>归约</strong> <strong>(reduction)</strong>。</p><blockquote><p>🌰 Before we continue</p><p>一个数学家的房子着火了。他找来一个物理学家帮忙把火扑灭。第二天，数学家发现房子里的天然气泄漏了。于是他毫不犹豫地点燃了房子。</p><p>在医院，物理学家问，你为什么要这样做。数学家平静地望着天花板，说到，这样一来，问题就被转化为一个已经解决了的问题。</p></blockquote><p>简单来说，<strong>归约</strong>就是从一个问题 A 转化为另一个问题 B，于是可以用问题 B 的解法来解决问题 A。假如 A 问题是求解一个一元一次方程，B 是求解一个一元二次方程，很显然 A 可以归约为 B，因为一个一元一次方程相当于一个二次项系数为 0 的一元二次方程，解法就可以照搬了。</p><p>「问题 A 可归约为问题 B」有一个重要的直观意义：问题 A 不会比问题 B 难 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>A</mi><msub><mo>≤</mo><mi>F</mi></msub><mtext> ⁣</mtext><mi>B</mi></mstyle></mrow><annotation encoding="application/x-tex">\small A \le_F\! B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.135em;"></span><span class="mord mathnormal sizing reset-size6 size5">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size5"><span class="mrel">≤</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3056em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace sizing reset-size6 size5" style="margin-right:-0.1667em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.615em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05017em;">B</span></span></span></span>)。通过归约，我们可以找到应用范围更广，但是复杂度也更高的问题。那如果我们把若干「小」<strong>NP</strong> 问题不断地归约到更通用的「大」<strong>NP</strong> 问题上，最后会得到什么呢？答案就是<strong>超级 NP</strong> 问题<span class="cn-font" lang="zh-CN">——</span><strong>NP 完全</strong>问题，只需要满足两个条件：① 是 <strong>NP</strong> 问题，② 所有的 <strong>NP</strong> 问题都能（在多项式时间内）归约为它（从证明策略的角度，只需证明某个已知的 <strong>NP 完全</strong>问题可以归约为它）。</p><p>现在人们已经发现了很多 <strong>NP 完全</strong>问题，比如：</p><ul><li><strong>布尔可满足性问题</strong> (Boolean satisfiability problem, aka <strong>SAT</strong>)<span class="cn-font" lang="zh-CN">——</span>第一个被证明是 <strong>NP 完全</strong>的问题。对于一个由若干布尔变量构成的表达式 (formula)，问是否存在一组变量取值使得表达式为 True（也即 <strong>satisfiable</strong>）</li><li>前文提到的<strong>哈密顿环 / 路径问题</strong></li><li><strong>图着色问题</strong>：用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 种颜色给图的顶点着色，要求相邻顶点不能是相同颜色</li></ul><p>此外，在 <strong>NP</strong> 问题中还存在一些问题，目前人们既不能确定其是不是 <strong>P</strong>，也不确定是不是 <strong>NP 完全</strong>，比如前面提到的整数分解问题，目前已知的最好算法比指数时间要快，比多项式时间要慢。</p><p>那么还有没有比 <strong>NP 完全</strong>问题更难的呢？</p><h2 id="NP-困难">NP 困难</h2><p>(aka <strong>NP-hard</strong>)<span class="cn-font" lang="zh-CN">——</span>至少和 <strong>NP 完全</strong>问题<strong>一样难</strong>的问题</p><p>了解了 <strong>NP 完全</strong>问题之后，<strong>NP-hard</strong> 问题就很好理解了：不要求是一个 <strong>NP</strong> 问题，但是所有的 <strong>NP</strong> 问题都能（在多项式时间内）归约为它。换句话说，<strong>NP-hard</strong> 问题是<strong>至少和 NP 完全问题一样难</strong>的问题（而 <strong>NP 完全</strong>问题是 <strong>NP</strong> 问题中<strong>最难的</strong>那部分问题）</p><ul><li><strong>旅行商问题 (TSP)</strong>也即<strong>最短路径问题</strong>，已知一系列城市以及两两之间的距离，经过每个城市恰好一次又返回到起点的<strong>最短路径</strong>是哪条（其决策版本「是否存在一条长度小于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ℓ</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">ℓ</span></span></span></span> 的路径」则缩小为 <strong>NP 完全</strong>问题）</li><li><strong>停机问题</strong>：给定一个程序和其输入，判断这个程序会不会一直运行下去。SAT 问题可以归约为停机问题（<strong>NP-hard</strong> ✓）。而停机问题是不可判定问题，显然不是 <strong>NP 完全</strong>问题。</li></ul><div class="note note-success">            <p>tip 理论与实际<strong>P</strong> 不一定简单<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[**P** 真的容易处理吗？](https://zh.wikipedia.org/wiki/P/NP%E9%97%AE%E9%A2%98#P.E7.9C.9F.E7.9A.84.E5.AE.B9.E6.98.93.E5.A4.84.E7.90.86.E5.90.97.EF.BC.9F)">[2]</span></a></sup>，<strong>NP 困难</strong>问题也不一定难准确的解 / 最好的解是很难，但是足够好的解不难，比如旅行商问题的很多研究</p>          </div><h2 id="总结">总结</h2><p>最后用一个图来总结上面这些问题的关系，其中值得注意的几点是：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi mathvariant="sans-serif">P</mi><mo>⊆</mo><mrow><mi mathvariant="sans-serif">N</mi><mi mathvariant="sans-serif">P</mi></mrow><mtext> </mtext><mo stretchy="false">(</mo><mi mathvariant="sans-serif">P</mi><mo>=</mo><mrow><mi mathvariant="sans-serif">N</mi><mi mathvariant="sans-serif">P</mi></mrow><mo stretchy="false">?</mo><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small \mathsf{P} \subseteq \mathsf{NP}\:(\mathsf{P} = \mathsf{NP}?)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7474em;vertical-align:-0.1224em;"></span><span class="mord mathsf sizing reset-size6 size5">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size5">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathsf">NP</span></span><span class="mspace sizing reset-size6 size5" style="margin-right:0.2222em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathsf sizing reset-size6 size5">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathsf">NP</span></span><span class="mclose sizing reset-size6 size5">?)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi mathvariant="sans-serif">N</mi><mi mathvariant="sans-serif">P</mi></mrow><mtext>-</mtext><mrow><mi mathvariant="sans-serif">c</mi><mi mathvariant="sans-serif">o</mi><mi mathvariant="sans-serif">m</mi><mi mathvariant="sans-serif">p</mi><mi mathvariant="sans-serif">l</mi><mi mathvariant="sans-serif">e</mi><mi mathvariant="sans-serif">t</mi><mi mathvariant="sans-serif">e</mi></mrow><mo>=</mo><mrow><mi mathvariant="sans-serif">N</mi><mi mathvariant="sans-serif">P</mi></mrow><mo>∩</mo><mrow><mi mathvariant="sans-serif">N</mi><mi mathvariant="sans-serif">P</mi></mrow><mtext>-</mtext><mrow><mi mathvariant="sans-serif">h</mi><mi mathvariant="sans-serif">a</mi><mi mathvariant="sans-serif">r</mi><mi mathvariant="sans-serif">d</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small \mathsf{NP}\text{-}\mathsf{complete} = \mathsf{NP} \cap \mathsf{NP}\text{-}\mathsf{hard}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8em;vertical-align:-0.175em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathsf">NP</span></span><span class="mord text sizing reset-size6 size5"><span class="mord">-</span></span><span class="mord sizing reset-size6 size5"><span class="mord mathsf">complete</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathsf">NP</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin sizing reset-size6 size5">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathsf">NP</span></span><span class="mord text sizing reset-size6 size5"><span class="mord">-</span></span><span class="mord sizing reset-size6 size5"><span class="mord mathsf">hard</span></span></span></span></span></li></ul><figure>    <img src="p-np-npc.svg" alt="p np npc" class="border">    <figcaption>Euler diagram for P, NP, NP-complete, and NP-hard set of problems. (source: <a href="https://commons.wikimedia.org/w/index.php?curid=3532181" target="_blank" rel="noopener noreferrer" class="outbound">Wiki</a>)</figcaption></figure><h2 id="参考材料">参考材料</h2><ul><li>维基百科：<a href="https://zh.wikipedia.org/wiki/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6">时间复杂度</a>，<a href="https://zh.wikipedia.org/wiki/P/NP%E9%97%AE%E9%A2%98"><strong>P</strong>/<strong>NP</strong> 问题</a>等</li><li><a href="http://www.matrix67.com/blog/archives/105">什么是 P 问题、NP 问题和 NPC 问题 - Matrix67</a></li><li><a href="https://www.zhihu.com/question/27039635/answer/101730260">怎么理解 P 问题和 NP 问题？- 王宇的回答 - 知乎</a></li><li><a href="http://home.cse.ust.hk/~lzhang/teach/comp3721/Notes/21.pdf">P &amp; NP - COMP3721: Theory of Computation - HKUST</a></li><li><a href="https://yzhang-gh.github.io/notes/others/p-np.html#%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6">P、NP 与 NP 完全问题</a></li></ul><hr><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>严格来说是<strong>判定性问题 / 决策问题</strong>（输出为 yes 或 no）或<strong>最优化问题</strong>，几乎所有最优化问题都有对应的<strong>简单一点的</strong>判定性问题，比如「求最小路径」与「是否存在小于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi mathvariant="normal">ℓ</mi></mstyle></mrow><annotation encoding="application/x-tex">\small \ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;"></span><span class="mord sizing reset-size6 size5">ℓ</span></span></span></span> 的路径」。此外还有函数式问题 (function problem)，允许其它形式的输出，比如「求两数之和」，这些相应的问题称为 <strong>FP</strong> 和 <strong>FNP</strong>。<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://zh.wikipedia.org/wiki/P/NP%E9%97%AE%E9%A2%98#P.E7.9C.9F.E7.9A.84.E5.AE.B9.E6.98.93.E5.A4.84.E7.90.86.E5.90.97.EF.BC.9F"><strong>P</strong> 真的容易处理吗？</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>Computer Science and Engineering</category>
      
    </categories>
    
    
    <tags>
      
      <tag>algorithms</tag>
      
      <tag>NP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>写给大家看的设计书</title>
    <link href="/reading-note/non-designer/"/>
    <url>/reading-note/non-designer/</url>
    
    <content type="html"><![CDATA[<p>作者 Robin WIlliams，著名设计师，技术专家。Adobe 和 Mac 社区偶像级专家。</p><span id="more"></span><h2 id="读书心得">读书心得</h2><h3 id="极简评价">极简评价</h3><p>蛮不错的书，用极短的篇幅将设计的大多基础注意事项阐述清楚。</p><h3 id="感想看法">感想看法</h3><ul><li>Joshua Tree 是一个很鲜明的例子：一旦你能够说出什么东西的名字，你就会掌握它，拥有它，让它受你所控。这个我的理解是“定义清晰”、以及“简单入门”，能带来更好的深入理解。</li><li>视觉设计的主要原则或许还是要贴近人眼获取信息的 CNN 模式和 attention。</li><li>衬线和无衬线加粗字体交替使用似乎真的蛮好看。</li><li>像是一本工具书，看起来比较教条。</li><li>似乎对本书比较好的吸收方法是：仅记住一些原则，然后把好看的图片过一遍。</li></ul><h2 id="内容摘录">内容摘录</h2><ul><li>四大基本原则：对比，重复，对齐，亲密性。</li><li>微微眯起眼睛，统计眼睛停顿的次数。</li><li>任何元素都不能在页面上随意安放。每一项都应当与页面上的某个内容存在某种视觉联系。</li><li>在打破规则之前必须清楚规则是什么。</li><li>对其的根本目的是使页面统一而且有条理。</li><li>冷色趋于做背景色，而暖色是趋进型的。所以如果要组合冷色和暖色，一定要少用些暖色。</li><li>CMYK 中混合色同在调色板混合色类似。组成 RGB 的有色光束并不是从任何无理物体反射来的，这是直接从显示器传入你眼睛的光，如果将所有颜色混合在一起会得到白色。</li><li>需要印刷的项目应当使用 CMYK，需要在屏幕上看到的内通应使用 RGB。</li><li>在页面上放一个很大、有趣而且很明显的东西。如果能让读者的是先停在这个中心点上，他们往往更有可能阅读其余的文本。</li><li>如果你的新闻简报看上去有些乏味平淡，只需对标题和子标题使用一种效果强烈的加粗无衬线字体，就能立刻让它生动起来。</li><li>ﬁ <code>opt+shift+5</code> ﬂ <code>opt+shift+6</code></li><li>不要使用下划线。永远不要使用。</li><li>如果你希望人们去具体读某些文字，可以选择设置为旧式体。</li><li>目光很受暖色的吸引，所以只需要很少的一点红色就可以产生对比。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
      <tag>设计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>远程服务器配置</title>
    <link href="/programming/server/"/>
    <url>/programming/server/</url>
    
    <content type="html"><![CDATA[<p>远程服务器配置相关内容。</p><span id="more"></span><h2 id="服务器代理设置">服务器代理设置</h2><p>由于有时需要在服务器上下载被墙的数据，所以需要设置代理。通常只会在 Python 场景下使用，可以使用 <code>os</code> 模块设置代理。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Proxy on server.</span><br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># 设置代理</span><br>os.environ[<span class="hljs-string">&#x27;http_proxy&#x27;</span>] = <span class="hljs-string">&quot;http://127.0.0.1:7890&quot;</span><br>os.environ[<span class="hljs-string">&#x27;https_proxy&#x27;</span>] = <span class="hljs-string">&quot;http://127.0.0.1:7890&quot;</span><br><br><span class="hljs-comment"># 测试代理</span><br>result = os.system(<span class="hljs-string">&#x27;curl -v google.com&#x27;</span>)<br><span class="hljs-built_in">print</span>(result)  <br></code></pre></td></tr></table></figure><p>但是服务器端配置代理比较麻烦，多次尝试 clash 都不能保证稳定运行。幸好不会重度使用代理，所以可以使用简单的方法，将本地的代理转发到服务器上。仅需要将 <code>127.0.0.1</code> 替换为本地的 IP 地址即可。（当然前提需要在服务器上可以 ping 通本地 IP）</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>server</tag>
      
      <tag>proxy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超级 Rui 的 2023 半年度总结</title>
    <link href="/life/2023-halfyear-report/"/>
    <url>/life/2023-halfyear-report/</url>
    
    <content type="html"><![CDATA[<p>写在 2023 年中，对 2023 年上半年的回顾。（过于忙碌拖了整整一个月）</p><span id="more"></span><h1>写在最最前</h1><p>2023 年上半年过于充实和忙碌，实在是值得记录一下。自己也在定期写总结的路上迈出了第二步。这半年似乎一切都好起来了，各方面都看到了一些曙光。心理上似乎朝着更健康年轻的状态发展，好奇心和行动力增强，就像看到的那句话一样“在接近三十岁的日子里，我的十八岁开始了”。</p><h1>具体来说</h1><h2 id="学业">学业</h2><p>上半年，出差许久的老板终于回来了，不得不说这是提高效率的最大因素（大误）。不过显然之前读博在方法论上就有问题，导致了效率低下以及“磨洋工”现象层出不穷。切换到产出导向的工作方式后，今年还是完成了不少工作。之前的接收的 Trans 正式见刊；零碎的一个工作整理出来也被 ECAI 接收了，还能去闪击一下波兰；主业的策略设计也完成了投到了 CIKM。此外和同学们也合作进行了一些工作，参与了 idea 讨论，论文修改，图像绘制等等工作内容。这些合作是以前组里的同学间十分缺少的，但是这些合作确实十分有乐趣且比较高效。六月份组里承办了 ecole，七月份大家还去了贵州的大数据人工智能会议，感觉作为团建还是十分不错的。</p><p>在七月底终于提交了大论文。结构上应该是没有问题了，即这个故事是可以讲完整了。写完论文在写致谢的时候可以说是十分感慨。</p><p>此外，鉴于之前踩了超级多的坑，所以打算之后整理一个踩坑总结，能让后来者受用一些。似乎组里的老师们都很忙碌，如果有一个指导手册一样的东西，可以让大家少走一些弯路以及省一些时间。</p><h2 id="健康">健康</h2><p>上半年似乎身体上没有什么大问题，但是也不是特别的舒服。或许因为思想上比较焦虑和紧张，再加上没有太多的运动，所以身体上也会有一些不适。这半年意识到了一个问题，即身体是一切又一切的根本，没有身体的健康，一切都是空中楼阁。以前的自己似乎对这一点“知而不行”，或许主要是因为觉得自己还年轻可以作，又或许是觉得保护身体总是可以等等再去做，导致健康状况在一点一点的损耗。现在终于交完了大论文忙完了小论文，健康生活规律运动我来了！</p><p>（此外还是需要给自己建一个健康档案。）</p><h2 id="认知">认知</h2><p>今年在科研之外的认知上或许有了较大的提升。</p><h3 id="信息获取">信息获取</h3><p>今年迷上了听播客，个人认为信息质量极高，一些访谈节目内容极其有深度且可以提供很多独到的见解，可以作为极高质量的二手信息源。此外在最新的科技和商业信息方面，推特是极好的一手信息源，能看到很多最新的商业动向以及学术前沿的讨论和工作。即刻是一个很好的商业朋友圈，可以看到很多创业前沿，或者小领域中的优秀/有趣人物的见解和生活，最近才刚刚使用。</p><h3 id="信息输出">信息输出</h3><p>意识到了输出/展示/交流的重要性。不要在意别人的眼光，错了傻了只有先把观点抛出来出来才会被发现，这是性价比最高的方式。如果为了那点无意义的自尊，掩盖了认知问题上的问题，反而会使得这些缺陷像瘤子一样生根带来偏见。</p><p>（在乎你的人不会介意你的傻和错，不在乎你的人你也没必要在乎他们。）</p><h3 id="人际交往">人际交往</h3><p>“信任”似乎是人际交往中最重要的条目，其或许主要来源于两点“不害人的品质”和“把事情做成功的能力”。有了信任，才有一切人际交往中互换（信息/资源）的可能。“把事情做成功的能力”某种意义上又是高配版的“不把事情搞砸的能力”，在这方面还是需要不断的磨练。</p><h3 id="心态调节">心态调节</h3><p>一定程度上有了一些疏解焦虑的能力。</p><ul><li>对于未来的焦虑可以通过把事情的演化路线想清楚一些来缓解。并不需要有一个完整的树脉络，但是一定要有最顶端的几层。这样可以大致得到一个还可以接受的最保底的结果（在一两个标准差内），极大程度减轻了总体的“选择焦虑”。</li><li>对于当下事务的焦虑（恐惧）所带来的拖延可以通过拆解目标来缓解。即有什么不想做且必须做的事情，先简单规划一下放到日程中，对整体时间线有一个把控之后，这件事也不会那么陌生，可以降低做事情的排斥心态。</li></ul><h3 id="人生目标">人生目标</h3><p>即“自己想要什么”。或许很多人穷极一生都没有想清楚这个问题。这半年我在这个问题上或许有了一丢丢进展。</p><p>首先这一定是一个多目标优化问题，其中包含了“健康”、“体面活着”、“些许尊严”这些基础目标，当然我知道同时满足这些目标已经很难了。在此之外，我觉得对我而言最重要的是“意义感”，即我可以为大家带来什么，能不能过了自己心里那一关。我知道这一项会看起来有一些“学生思维”，也表现出“未经社会毒打”，但是我仍希望这一点目标可以在日后的生活中保持下去。当然这一认识仍不全面且有点“虚”，希望日后可以得到更深更细的答案。</p><p>此外意识到不可以总在别人规定的赛道上忙碌，一定要找到适合自己的目标赛道，甚至是一条新赛道。本质上是要从“小镇做题家”向“小镇出题家”的方向过渡，乐观来看，没有人可以在你的赛道上击败你。所以说在满足基础的情况下，没有必要追求世俗意义的成功（金钱/名声/资源），多在自己喜爱且有意义的方向上探索，或许才是更有价值的。</p><h2 id="工作">工作</h2><p>今年正式踏上了找工作的路途，产生了很多不切实际的期望，带来了许许多多焦虑，也打破很多幻想。最重要的一点是认识到了“实习”（一种尝试和试错的最低成本方式）的重要性，由于前些年在 PhD 路途上过于坎坷，并没有在此方向上进行探索。不过还好还有些时间，急需去“小马过河”。希望今年的年终报告里可以在这一项下得到一个较为不错的答案。</p><h2 id="项目">项目</h2><p>上半年自己有一个很不一样的变化，就是开始“想做一些事”了。这些事并不是吃喝玩乐，而是似乎真正能产生一件作品的事，准确的来说是项目。按理说在十八九岁二十出头的年纪，创造力似乎最旺盛，但是彼时彼刻我并没有这些异想天开的想法，只是想着按部就班的上自己的课。所以好像在最好的年纪错过了很多探索的机会和人生的可能。</p><p>上半年似乎有一些项目想做，但是苦于没有时间，下半年可以推进：</p><ul><li><strong>河山大学</strong>：山河大学有感而发。本项目是一个知识路径整理库，为广大学子提供自学指导（公益项目）。</li><li><strong>AIGCompany</strong>：公司自动化建立及运营（面向个人公司维护者）。</li><li><strong>时间线</strong>：历史事件时间线，用于 traceback to a certain time。</li><li><strong>量化人</strong>：不是“数字孪生”那种模仿人说话以及长相的项目，而是尽量学习人的操作逻辑，似乎更像模仿学习。但是目前还没有想好一个合适的场景。</li></ul><h2 id="金钱与消费">金钱与消费</h2><p>依旧处于无收入吃陈粮的阶段哈哈。并没有买什么不必要的东西，着力于把钱花在刀刃上。当然吃喝住行等方面还是没有太降低预算，能用钱买来的快乐/时间是十分值得且具有性价比的。</p><h2 id="摄影">摄影</h2><p>卖掉了心爱的相机换取了盘缠哈哈哈，想起那首歌“我把我的梦想就卖了三两三”（哈哈哈哈过于鬼畜）。但是买了一个很喜欢的长焦卡片，在我踌躇的过程中涨了不少价（市价上升过于可怕）。长焦拍云过于适合，也过于解压。不过总的来说上半年没咋出去拍，成片还是少了些。</p><h2 id="读书">读书</h2><p>今年至今过于忙碌，并没有读书，实属惭愧。那么多想看的书，后半年猛猛读！</p><h2 id="感情">感情</h2><p>WYC 好棒！稳中有进！再接再厉！</p><h1>番外篇：一些碎碎念 Blah Blah</h1><ul><li>上半年主线好像还不错，再接再厉。</li><li>实验室迷上了打德州，同学之间充满了尔虞我诈哈哈哈。</li><li>老爸出生 20000 天打卡纪念，老爸说“争取再活两万天”。</li><li>自己的 Flomo 使用方法被官方点赞，有点开心。</li><li>提交完大论文之后给老板发了一个“爱你”的表情包哈哈哈。</li><li>今年买了好多域名，还是希望能做一些事情的。</li><li>“遇事多问凭什么”感觉可以作为很大的一个指导方针。</li><li>又被老板认真 cue 了情商低。</li><li>太喜欢老板了，真的十分庆幸有这样的好导师。</li><li>意识到了行动力的重要性！</li><li>要认识到“别人是别人，你是你。”</li></ul><h1>总结展望</h1><h2 id="一些遗憾">一些遗憾</h2><p>上半年的遗憾不太多，或许只有没读多少书和运动比较少这两点。</p><h2 id="立起新的-Flag">立起新的 Flag</h2><ul><li>仍旧希望能和 wyc 长久一些。（美好祝愿）</li><li>猛猛健康运动！</li><li>希望能找到一个喜欢的工作/事业。</li><li>希望能多多探索不一样的事物（包括自己）。</li><li>希望能把项目推一推。</li><li>希望能坚持读书。</li><li>多邻国似乎今年日语搞不完了，争取把第二个 Section 搞定。</li><li>希望能继续养成写总结的习惯。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>年终总结</tag>
      
      <tag>生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>某风险投资招聘笔试问卷</title>
    <link href="/writing/xvc/"/>
    <url>/writing/xvc/</url>
    
    <content type="html"><![CDATA[<p>本帖是某基金招聘笔试问卷的回答，由于问题比较有价值，自己也的确经过了一些思考，故整理成文。</p><p>（此公司真的是梦中情司，不管是从招聘推文还是历史推送还是任何互联网资料来看，都充满了深深的人文关怀以及深度的思考。完全无法拒绝这样的气质，个人认为能从中学到不少东西以及发挥自己的作用。几个星期过去了，还无法摆脱对他的喜爱，仍在其历史推送中学习。）</p><p>（距离提交已经一个星期了，许愿有机会能够进入这样的公司，并和几位有趣的创始人共事。）</p><span id="more"></span><h1>问题一</h1><h2 id="问题">问题</h2><p>在商业上你有什么独特的观察或思考角度，请列举3个并解释。（请在表达清晰的前提上控制字数）</p><p>注：请不要仅仅列举你的角度，还要尽量给出背后的思考逻辑以及触动你获得这个视角的基础信息（下同）。这个观察或思考角度可以是对某个人群的行为洞察、某个零售业态的商品结构组合、某个公司/行业危机征兆等、关于产品的设计（比如某个增加用户粘性的产品功能设计、或者feed流的排序逻辑改进）、某个组织管理架构方式（比如这个组织是否高效、汇报线和权责划分方式跟成员的激励/动机）</p><h2 id="回答">回答</h2><p><strong>由大到小，我们从以下三个层面分析：行业层面，产品层面，用户层面。</strong></p><p><strong>行业层面</strong>：如何思考什么行业可能有较大的机会？以问题为导向思考。</p><ul><li><strong>什么是机会</strong>？机会通常指当下没有但是未来会有的方向和需求。预测未来是一件十分困难的事情，不管是预测技术、产业、还是社会变革（存在微观上的自由）。相对而言，预测什么问题或许能在不久的将来得到解决比较容易（存在宏观上的必然）。举个例子，寒武纪的创始人曾经跟我们说过，他创立寒武纪前期进行了以下分析“人工智能这件事似乎是一个真命题，那么如果它发展起来的话，社会需要什么？那么我们认为至少需要高效的计算单元”。从需求或潜在需求为导向思考，或许是最正确的方式。</li><li><strong>什么不是机会</strong>？我们可以判断这个行业是否（即将）解决了一个社会的大需求，且没有带来太大的负面影响。举个例子，之前的社区团购，它想解决的似乎是“菜市场/便利店到小区楼下这一公里的问题”，于是首先进行大量补贴抢占市场。这个需求是否足够大有待商榷，因为买菜以有多种解决方案（包括家里的闲人买菜，顺路买菜，周期性囤菜）。此外社区团购带来了一定社会意义上的负面作用（违背了商业向善），即通过低价倾销，使得个体户菜贩等弱势群体收到了损失。即媒体所说的“科技公司不应该和菜市场阿姨抢生意”【4】。所以从“理想、愿景、使命感、社会责任的角度来讲”，一门好的生意，或许世俗意义上应当有着较好的愿景。</li></ul><p><strong>产品层面</strong>：思考何谓护城河？护城河是设计角度出发的产品自我强化的能力。</p><ul><li><strong>产品自我强化的能力是护城河</strong>，即随着产品的使用，在某项重要指标上得以自然而然地提升。“用户，品牌，平台”等等仅仅是这一能力的外在表现。该能力因行业而异，例如奢侈品就是宣传效应，模型就是准确率，社区就是繁荣共创程度。举例来看，当前绝大多数的AI产品没有护城河，基于且仅基于prompt的应用，没有任何的不可替代性以及自我强化能力。</li><li><strong>如何得到自我强化能力</strong>？我们认为需要精心的设计。举几个例子，midjourney的优质图片选择反馈（即你需要在四张图中选一张），抖音的操作反馈（即点赞收藏评论和浏览时长）。这种反馈会在技术上或者用户体验上累积优化，并用于提升产品效用，这一循环难以被打破。这些流程是由很优秀的产品经理配合产品特性设计出的。一个另外的例子，ChatGPT并没有一种类似的反馈（反馈很弱），所以似乎这也是他们发力建造插件仓库的原因之一，即通过开发者在另一个方向自我强化（卷起来）建立护城河。</li></ul><p><strong>用户层面</strong>：思考用户有什么普遍特性？这里我们仅讨论其中的标签文化，即大家乐于给自己打标签，并以此参与社会消费娱乐活动。</p><ul><li><strong>是否存在</strong>？个人通过浅层的观察，可以举一些或宽或窄的例子，“麦门信徒”【1】，“i人e人（MBTI）”【2】，“星座”，”社畜“，”狗粉丝“【3】等等。源头上来讲，这些与商业行为或相关或无关，或来源于社会阶层，或来源于社会讨论，并且很多人会“骄傲”“坦诚”的自称自己从属于某一标签。但不论来源，人们乐意给自己贴标签这件事似乎是普遍存在的。</li><li><strong>为何存在</strong>？个人认为主要原因之一或许是人对归属感的强烈需求。当然此处未经深度调研，或许是一个有趣的话题。</li><li><strong>存在于哪里</strong>？个人认为并不适用于一些低链接人类（线上线下社会联系较为松弛）。这里同样未经深度探索，也是一个值得思考的问题。</li><li><strong>如何利用</strong>？从商业上来说即考虑如何通过这一现象变现。这可能在深度调研之后才会有答案。凭借目前的理解，或许利用标签进行社群活动，吸引潜在产品投放广告或许是一个最粗浅的方式。此处还需要有更深更全面的思考。</li></ul><p><strong>Reference</strong>：</p><ol><li><a href="https://www.sohu.com/a/645096673_120153933">https://www.sohu.com/a/645096673_120153933</a></li><li><a href="https://www.16personalities.com/free-personality-test">https://www.16personalities.com/free-personality-test</a></li><li><a href="https://www.huxiu.com/article/364840.html">https://www.huxiu.com/article/364840.html</a></li><li><a href="https://zhuanlan.zhihu.com/p/336849579">https://zhuanlan.zhihu.com/p/336849579</a></li></ol><h1>问题二</h1><h2 id="问题-2">问题</h2><p>有什么商业问题、经济问题、历史问题、学科问题或其他问题是过去半年到一年一直困扰你的，你的思考路径和阶段性的结论是什么（不一定要完全解决这个问题）？</p><h2 id="回答-2">回答</h2><p>近一年，由于科研、论文、找工作、毕业等许多场景交织，有着较多烦恼。在去年12月ChatGPT发布之后，我的多种烦恼似乎汇聚到了一起，变成了一个大问题，即“<strong>通用人工智能（AGI）好像要来了，作为大半个从业者（同为AI方向的研究），我在这个浪潮中会处于怎么样的一个位置？</strong>”</p><p><strong>首先将问题具体化</strong>。假设“我仍旧会在AI方向从业深耕”，那我好奇“一个强大的 AGI，他能做什么（以前做不到的事）？”目前什么叫做 AGI似乎也没有一个定论，wiki【1】也没有一个十分准确的定义，那我们此处将其认为“有着搜索，学习，知识表示，外加一定通用问题解决能力，外加自然语言能力的Agent。”但是我们发现，这个定义似乎仍然没有那么清晰。</p><p><strong>进一步细化问题</strong>，AGI在当下似乎一定程度上可以与ChatGPT这种类大语言模型（LLM）的效果等价（在不考虑物理实体以及交互质量的情况下）。那么我们的问题再次简化为“LLM究竟到底能做什么以前做不到的事？以及我可以在其中扮演什么角色？”至此，我们的问题已经十分的具体，那么我们可以尝试回答。</p><p><strong>探究第一个小问题</strong>，“LLM”是什么？这是一种基于Transformer架构的（通常是decoder为基础的）神经网络，以概率分布为输出而得到下一个“token”。那么本质上来说，它似乎好像和有限状态机【2】这种状态转移的模型（在状态足够多的情况下）没有太大区别。但是在表现上来说，它带来了惊人的生成（状态转移）效果。而有限状态机因为基于图结构，无法容纳过多的状态，所以无法达到文本生成的目的。</p><p><strong>探究第二个小问题</strong>，现在我们可以讨论一个LLM能干什么以前做不到的事。从直观效果上来看，其“文本生成”基于其广阔的训练数据，其效果似乎极其优异，那么作为“智能客服”或者“智能文秘”，或许已经十分适用，能达到先前无法企及的表现。但这一分析流于表面，我们或许可以分析其本质上从社会角度带来的不同。我们认为 LLM 可以近似的当成一个黑盒的具有少量内存的“大脑”（当然会有很多功能缺失，例如其他感官能力）。那么在未来算力以及模型升级的情况下，“大量廉价的具备一定信息处理生成能力的大脑”可以作为已经构建好的基础设施。</p><p><strong>探究第三个小问题</strong>，有了这些有数量规模的“大脑”，我们可以做什么。似乎就是“信息生成”以及“信息处理”两方面。“信息生成”，即AIGC，已经被大量谈论到了，甚至已经造成了一定程度的互联网污染，我们不在这一方面展开。但是“信息处理”似乎没有很多地被深度谈及到。那么基于LLM的信息处理相较于其他的信息处理有什么区别呢？作为“脑”来说，对于非结构化信息的处理比较擅长，不论是少量深度非结构化数据（AI论文梗概），还是批量浅度非结构化数据（平台上AI情绪分析）。似乎这个推论比较显然，但是并没有看到太多这方面的，非简单调用prompt的工作。或许需要深入思考一下为什么。</p><p><strong>目前的结论</strong>：在此情况下，对于基于强非结构化数据的需求来说，（批量化）LLM应该算是一个很强的解决方案。那么或许我可以在这一方面做一些细微的工作，当然这个需求是什么，这类数据是什么，或许还需要深入的调研。目前我并没有一个很清晰的结论。</p><p><strong>Reference</strong>：</p><ol><li><a href="https://zh.wikipedia.org/wiki/%E9%80%9A%E7%94%A8%E4%BA%BA%E5%B7%A5%E6%99%BA%E6%85%A7">https://zh.wikipedia.org/wiki/通用人工智慧</a></li><li><a href="https://zh.wikipedia.org/wiki/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA">https://zh.wikipedia.org/wiki/有限状态机</a></li></ol><h1>问题三</h1><h2 id="问题-3">问题</h2><p>列举你最后看的3本书（按时间倒序），请给出书名、开始看的时间、是否看完了、是否推荐。挑选其中1本描述它给你的关键启发。</p><h2 id="回答-3">回答</h2><p>今年过于忙碌，并没有沉浸式读书（仅偶尔翻书），时间上最近的认真读的书也要追溯到去年。由于自己平时有记录读书笔记的习惯，所以也比较好整理本问题。（读书笔记请见：<a href="https://www.superui.cc/categories/reading-note/%EF%BC%89">https://www.superui.cc/categories/reading-note/）</a></p><p><strong>按顺序来说从近到远三本书为</strong>：</p><ul><li>《罪与罚》，约2022-10开始读，到2022-11读完。十分推荐，认为适合所有读者。</li><li>《论个人在历史上的作用问题》，于2022-08阅读完毕，很薄的一本书，印象中或许只用了一两天读完。推荐，但是仅推荐给对哲学问题较为感兴趣的朋友（读懂或许需要很多的社会阅历以及深度思考，个人并没有读很懂）。</li><li>《浪潮之巅》，约2022-05开始读，到2022-07读完。这是我第二次读这本书，目的是回顾当代信息技术发展的脉络（并思考个人职业规划）。对于想要了解现代科技史以及对商业感兴趣的朋友十分推荐。</li></ul><p><strong>在此介绍《罪与罚》这本书以及其对我的关键启发</strong>。本书是俄国著名作家陀思妥耶夫斯基的代表作之一，称得上是世界文学巨作。我阅读本书的原因首先是久仰大名（在我的待读列表中躺尸很久），其次是罗翔老师总是在各种场合多多少少的提到这本书，让人心生好奇。在三本书中，本书或许是最通俗易懂的，但是它引起的思考足够震撼。</p><p><strong>先简要介绍故事</strong>，这本小说从第三人称视角讲述了一个青年犯罪者拉斯科尔尼科夫杀人以及之后内心挣扎，并最终到警局自首的事件。在这个较为简单的故事线下，复杂之处在于主人公及其丰富且细致的“内心活动”。在第三者的视角，我们可以清晰的看到他认为自己作为不寻常人实施犯罪的“自我逻辑”，再到他的事后惊恐慌张带来的强烈“心理生理反应”，再到他内心的平静慌张痛苦的“多种心态交织”，再到最后他自首进入监狱获得了重生。</p><p><strong>在此我们选取一个视角来描述其对我关键启发</strong>。个人认为最有趣的点在于拉斯科尔尼科夫的观点“有的天才，有权跨越法律或道德界限”，这也是他实施杀人的理论支柱。此处抛开法律，抛开“什么是天才”，我从中看到了一种强烈的“自我”特性。即以“我”为中心，“我”有权定义且影响整个社会。作为读者，我认为这是一个很普遍的现象，甚至我自己也会有一些这样的毛病（尽力改正中）。这个现象或许会带来两类后果，一是以自我为中心会带来强烈的自大感，感性上来看这种自大会严重影响与周围人的交往关系，即缺乏尊重。二是，理性上来看，这种自大会导致对外界的排斥，沉浸在自己的小世界，使得与客观真相越来越远。这两方面都会对个人的发展带来极其严重的消极影响。所以这本书又一次让我认识到，“以自我为中心”的危害。</p><h1>问题四</h1><h2 id="问题-4">问题</h2><p>（选填）你是否投资二级市场（A股、港股、美股均可）？若有请列举最近投资或正在关注的3个公司，并选取其中1家阐述投资逻辑。</p><h2 id="回答-4">回答</h2><p>我有进行A股，美股的“炒股”行为，目前并算不上严格意义的投资，或许称为投机更准确（因为并没有通过大量交互形成一个很强的逻辑体系）。目前主要的行为可以看做个人对某行业和股票技术上的所见所想的验证，本人把这个交互过程看作一个“消费”过程。</p><p><strong>三个目前关注的公司</strong>：寒武纪（AI芯片），理想（新能源汽车），新希望（生猪养殖）</p><p>下面我来阐述寒武纪这家公司的投资逻辑，从行业，技术，产品+竞品，客户，风险层面讨论出发，目前对该公司的总体看法谨慎乐观。</p><p><strong>关键词</strong>：AI计算需求，国产替代，（较国内同行）先发优势。</p><h3 id="概况">概况</h3><p>这是一家AI芯片制造公司，有着成熟的产品。于2020年在科创版上市，发行首周最高价接近300元，之后的两年股价阴跌，最低到了50元之下，直到2022年中开始横盘，并于2022年12月开始拉升，在2023年4月一度回到了270元的高位，目前处于高位震荡的情况。目前公司未有盈利，总市值约780亿。</p><h3 id="行业方面分析">行业方面分析</h3><p>创始人（目前是董事长）陈天石教授在很早的时候做了宏观的分析猜想，即“在人工智能这个真命题下，我们认为至少需要高效的计算单元”。随着人工智能的发展（搜索，学习，知识表示），这一猜想已被证实。可以说未来这个行业会成为基础设施般的存在，在以数据驱动的社会中，以及无法绕过。此处我们有较为正面的结论。</p><h3 id="技术实力分析">技术实力分析</h3><p>公司的创始团队来源于中科大以及中科院，陈天石教授在博士期间研究人工智能领域的演化算法方向，是2011年CCF优秀博士论文奖获得者。创始人团队在近五六年多次向我们进行技术讲座，让我们了解到了该公司的创业史。单从技术而言，寒武纪团队在2014年就开始就研发AI专用加速芯片，开发了一套独立的底层指令集以及AI计算通用架构，并多年在ISCA（国际处理器架构年会）上获得同行评议得分第一【1】。此外，Google TPU技术论文也多次引用到了寒武纪团队的论文【2】，这里其实已经可以体现出其团队的不俗技术实力以及先发优势。由于本人并没有深入了解AI处理器的技术架构，技术实力的分析仅到此。此处我们有较为正面的结论。</p><h3 id="产品以及竞品分析">产品以及竞品分析</h3><p>公司目前在做云端的智能加速卡（用于AI训练推理，通用型较弱，但是能效较高），并持续推出成熟产品。寒武纪主营在AI芯片，并无通用型的GPU产品。其还未正式发布的产品思源590【3】号称接近A100的水平。竞品方面没有深入研究，华为海思、地平线、燧原科技、昆仑芯等都有相关产品，但是从当前视角来看，似乎没有质的区别。但是这一大类国产产品（甚至可以说除了英伟达之外的所有产品），用户端社区效应差，目前没有出现英伟达Cuda般的生态，所以大规模受学界业界认可还任重道远。此处我们评价谨慎乐观。</p><h3 id="客户分析">客户分析</h3><p>目前的客户主要是政府（珠海合作项目）以及一些大厂（阿里云浪潮曙光）【6】。政府采购应当会持续，因为难以购入海外产品。大厂由于成本限制，在已经解决需求的情况下似乎也会倾向购买性价比更高的产品。这个角度来看，在产品能稳定出货，且产品力不大幅下降的情况下，我们保持谨慎乐观。</p><h3 id="潜在风险">潜在风险</h3><p>在2022年底被加入美国实体清单【4】，面临缓存断供，七纳米制程设计无法找台积电代工，EDA工具无法使用更新等风险。所以在制裁下大规模出货可能性有限【5】。但是或许可以代理找台积电生产【6】。在此方面，我们持谨慎态度。</p><h3 id="总结">总结</h3><p>从行业，产品，客户，风险上来看，我们对公司的发展持谨慎乐观态度，目前其发展的负面因素在其他的国内竞品公司上也都有存在，所以或许分析整个行业会比较合理。此外，我并未从财务方面对公司进行估值，在当前价格下，考虑到AI当下投资的过于乐观，个人认为需要注意风险。</p><p><strong>Reference：</strong></p><ol><li><a href="https://mp.weixin.qq.com/s/1Gzig2lgJGyt0BwwpZ3oZA">https://mp.weixin.qq.com/s/1Gzig2lgJGyt0BwwpZ3oZA</a></li><li>Jouppi, Norman P., et al. “In-datacenter performance analysis of a tensor processing unit.” Proceedings of the 44th annual international symposium on computer architecture. 2017.</li><li><a href="https://www.fxbaogao.com/detail/3620830">https://www.fxbaogao.com/detail/3620830</a></li><li><a href="https://finance.sina.com.cn/chanjing/gsnews/2022-12-16/doc-imxwvwhx6670147.shtml">https://finance.sina.com.cn/chanjing/gsnews/2022-12-16/doc-imxwvwhx6670147.shtml</a></li><li><a href="https://www.51cto.com/article/758076.html">https://www.51cto.com/article/758076.html</a></li><li><a href="https://xueqiu.com/6347482150/246397389">https://xueqiu.com/6347482150/246397389</a></li></ol><h1>问题五</h1><h2 id="问题-5">问题</h2><p>（选填）假设你获得了3000万人民币创业资金，可以自己组建团队创业，简单介绍你首选和次选的产品和商业模式，并说明理由。注意：请不要仅仅描述你的计划，而同时描述你的关键选择背后的独特观察，如果做过相应的事实收集工作，也请进行描述。</p><h2 id="回答-5">回答</h2><h3 id="首选产品">首选产品</h3><p><strong>行业：“量化自我”</strong></p><p>即个人行为模式的复制建模，对应大家对“自我了解”、“经验归纳”以及未来可能存在的“在线自我”的需求。这是一个长期存在的需求。举例，一个高产出画师作画规则的量化分析，一个高质量研究员研究套路的量化分析，基金经理行为决策的模式分析，自我做决定时的原理探索分析。这个是大模型出现之前无法解决的，因为人能提供的是是高度非结构化的数据，在当前时间节点，大模型至少提供了一种量化方式。</p><p><strong>产品</strong>：</p><ul><li>动机：或许受限于技术，也受限于真实人类数据，我们此处将场景限定在一个很小的范围，即“基于对话的自我认知系统” 。这个对应到的观察是，“很多人其实并不知道自己要什么”，举一个例子，“很多产品经理都无法表述出其最后想要一个什么样的产品，输入输出是什么”，那么我们其实可以在一定规则下，探究用户的思维，帮他挖掘构建逻辑树。在面向普通个人之外，本产品可以应用到具体的行业，比如产品设计和咨询，可以将经验性事项流程化规模化。</li><li>产品形态：具体来说我们想要的效果是，输入一个具体的话题或决策目标，通过多轮次基于选择的对话，输出一个逻辑树来帮助用户分析问题（并将逻辑树生成一个初步的文本结果）。</li></ul><p><strong>事实搜集</strong>：</p><ul><li>需求逻辑方面并未进行事实搜集。</li><li>相关产品，目前发现少量相关工作。</li><li>浙大本科生团队数字孪生【1】，其产品形态与我们的切入点极其不同，他们目前是做了一个虚拟宠物形态的模拟。但是从愿景上看，个人认为有着极大的相似。</li></ul><p><strong>商业模式</strong>：</p><ul><li>用户：面向企业用户，作为某种能力培训辅助系统。</li><li>收费方式：订阅收费，类SaaS。</li><li>护城河（先产品模式再技术）<ul><li>模式上：<ul><li>在相似问题/领域上经验累积，可以提升该专业方向的交互质量。</li><li>交互过程中隐式对人的模仿，可以完成数据飞轮下的产品迭代</li></ul></li></ul></li><li>技术设计上：<ul><li>一种在交互使用中，提升“逻辑树的构建模式、下轮沟通会话构建、问题泛化能力”的技术设计。</li></ul></li></ul><p><strong>备注</strong>：首选此项目的原因是该项目天花板更高。初步的产品未必需要3000万资金来推动。目前提到的自我认知系统最核心的部分是问题分解能力。初步的问题分解能力构建成本或许较低，但是日后“解构问题能力”的升级，或许会需要较大的数据和算力开销。</p><h3 id="次选产品">次选产品</h3><p><strong>行业：历史数据库</strong></p><p>即历史的数据抽象装载。对应大家对历史经验的探求需求，和以史为镜的参考价值。目前没有听说过这个行业（至少没有听过和见过数字化的此行业），或许因为在此前这一需求难以实现，而大模型为此非结构化数据分析提供了可能。</p><p><strong>产品形态</strong>：输入某一件具体时点的事件（配合该时点的其他信息），输出一个历史中的相关时点信息以及相似度分析。</p><p><strong>商业模式</strong>：</p><ul><li>用户：面向企业。主要用户为政府机构，金融公司，以及大量研究者。</li><li>收费方式：类似Bloomberg。</li><li>护城河（先产品模式再技术）<ul><li>模式上：<ul><li>本地留存收集构建的大量高质量数据。</li><li>用户查询的统计价值探索，即用户更在意什么。我们可以挖掘为什么，并精细化产品。</li><li>数据上的持续更新迭代能力。</li></ul></li><li>技术上：<ul><li>时间节点以及历史事件切片向量化方式</li><li>强大的数据库来做嵌入和检索。</li></ul></li></ul></li></ul><p><strong>备注</strong>：该项目可能资金消耗较大，因为数据的采集以及清洗修补会耗费大量的资源人力。但是一旦建成产品，短时间内或许有着较高的竞争壁垒。</p><p><strong>Reference</strong>：</p><ol><li><a href="https://www.xiaohongshu.com/explore/649bbee8000000001303d12f">https://www.xiaohongshu.com/explore/649bbee8000000001303d12f</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Writing</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VC</tag>
      
      <tag>风险投资</tag>
      
      <tag>创业</tag>
      
      <tag>读书笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>大语言模型代理</title>
    <link href="/writing/LLM-agent/"/>
    <url>/writing/LLM-agent/</url>
    
    <content type="html"><![CDATA[<p>其实自己一直在想大语言模型（仅讨论 LLM，其他任务上的 transformer 生成模型不考虑）可以做什么，绝大多数人的想象力都是有限的，我也不例外。我的主要观点一直在不断的坚定，即“非结构化数据处理”的问题，当然这个问题在哪里还需要广泛深度的调研。昨天终于有空读了 Lilian Weng 的 LLM Powered Autonomous Agents<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[LLM Powered Autonomous Agents](https://lilianweng.github.io/posts/2023-06-23-agent/)">[1]</span></a></sup>，这篇博客从“术”的层面，介绍了大语言模型可以在能力边界上做什么扩展。这一类工作被称为“自动代理”，面向特定任务。</p><span id="more"></span><h1>文章关键内容</h1><p>个人认为此博客比较细致，谈到了方方面面，此处我们粒度不需要那么细。文章中最重要的内容我认为是对整体技术脉络的把控（<strong>技术树</strong>）以及对大语言模型的能力边界的划分（<strong>局限性/挑战</strong>）。本节内容全部摘录自博客原文。</p><div style="width:80%;margin:auto"><img src="/writing/LLM-agent/agent-overview.png" class="" title="Agent 概览"></div><p><strong>Challenges：</strong></p><ul><li><strong>Finite context length</strong>: The restricted context capacity limits the inclusion of historical information, detailed instructions, API call context, and responses. The design of the system has to work with this limited communication bandwidth, while mechanisms like self-reflection to learn from past mistakes would benefit a lot from long or infinite context windows. Although vector stores and retrieval can provide access to a larger knowledge pool, their representation power is not as powerful as full attention.</li><li>Challenges in <strong>long-term planning</strong> and <strong>task decomposition</strong>: Planning over a lengthy history and effectively exploring the solution space remain challenging. LLMs struggle to adjust plans when faced with unexpected errors, making them less robust compared to humans who learn from trial and error.</li><li><strong>Reliability of natural language interface</strong>: Current agent system relies on natural language as an interface between LLMs and external components such as memory and tools. However, the reliability of model outputs is questionable, as LLMs may make formatting errors and occasionally exhibit rebellious behavior (e.g. refuse to follow an instruction). Consequently, much of the agent demo code focuses on parsing model output.</li></ul><h1>个人思考</h1><p>核心观点仍旧是“LLM 的强项在且仅在于非结构化数据处理”，但是从这一角度细化下去还是有很多东西可以谈。</p><ul><li>什么是“非结构化数据”？<ul><li>这类型的数据在哪个领域大量存在？这个数据在哪个领域十分重要？</li><li>在这些领域上“非结构化数据”带来的挑战是不是以前无法解决的？即之前我们没有很好的办法来处理这些数据？（或许这个要讨论调研 NLP 方向以及智能决策方向的大多数任务。）</li></ul></li><li>“数据处理”的输出是什么？<ul><li>是要处理为结构化数据吗？那么似乎可以用于专用的领域强模型。</li><li>是要处理为另一种非结构化数据吗？那么似乎直接用于需要非结构化数据的任务。</li></ul></li><li>“数据处理”之后要做什么？<ul><li>之前能做但是没做好的任务。</li><li>之前不能做的任务。</li></ul></li></ul><p>还是没想清楚 LLM 带来了什么本质上的不同，似乎只是在“非结构化数据处理”这一步上有了更好的方法，但是这个方法能做什么，能做到什么程度，还是需要思考。</p><h1>Reference</h1><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://lilianweng.github.io/posts/2023-06-23-agent/">LLM Powered Autonomous Agents</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>Writing</category>
      
    </categories>
    
    
    <tags>
      
      <tag>随笔</tag>
      
      <tag>互联网</tag>
      
      <tag>chatgpt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Web 3.0，从 Chatgpt 说起</title>
    <link href="/writing/web3chatgpt/"/>
    <url>/writing/web3chatgpt/</url>
    
    <content type="html"><![CDATA[<ul><li><em>2023-06-14</em>: 批注。目前看来我的观点并不具有独特性，因为自己没有进行过多地调研，才自大地觉得自己的见解十分独到。当然总体来说以信息的视角讨论这些定义的更迭是没有问题的。此外或许可以从徐梧老师的《我眼中的 VR、AR 和 Metaverse：三维信息技术革命》这篇文章中再次探讨一下交互方面的逻辑。</li></ul><hr><p>上一波所谓 Web3.0 以及元宇宙的热潮已经褪去很久，我向来对这些不以需求为导向的噱头产品不抱有期待。我从不认为那些区块链或数字货币的营销即为 web3.0，新一代的互联网信息技术不应当与这些肤浅的割韭菜概念等同。近几个月 Chatgpt 的兴起让我对 Web3.0 的定义有了新的思考。当然本文不会探讨技术细节，希望从“名词之争”的角度找出更准确的定义。本文或许长期更新，当前仅为一个思路，希望大家来辩经。</p><span id="more"></span><h1>个人观点在最前</h1><span style="color:red">如果从 web 1.0 和 web 2.0 相关的概念出发，以信息为核心维度来看，这一波基于大模型的“类 ChatGPT 信息生成技术”或许才能称为真正的 web 3.0。</span><p>（之前那一波基于区块链的数字货币/NFT 等技术（的炒作）目前我还不知道把它归为哪类（或许更多的是金融衍生品创新），但在我看来称其为 web3.0 是极度不合适的。在术的层面或许有一点道理，但是道的层面没什么道理。）</p><h1>历史上的 Web 1.0 以及 Web 2.0</h1><p>我对这个的理解主要来源于对《浪潮之巅》的阅读，当时还写了<a href="/reading-note/top-of-the-wave/" title="读书笔记">读书笔记</a>。此外加入 wiki 和 ChatGPT 的解释，或许对 web 1&amp;2 可以展现得较为清楚。</p><h2 id="Web-1-0">Web 1.0</h2><div class="note note-success">            <p>Wiki:<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Web1](https://en.wikipedia.org/wiki/Web_2.0#Web_1.0)">[6]</span></a></sup></p><p>Web 1.0 is a retronym referring to the first stage of the World Wide Web’s evolution, from roughly 1989 to 2004. According to Graham Cormode and Balachander Krishnamurthy, “content creators were few in Web 1.0 with the vast majority of users simply acting as consumers of content”.</p><p>Web 1.0是一个返璞词，指的是万维网发展的第一阶段，时间大约从1991年到2004年。根据科莫德和克里希纳穆绥的说法，“在Web 1.0中，内容创作者很少，绝大多数用户只是内容的消费者。”</p>          </div><div class="note note-primary">            <p>ChatGPT:</p><p>Web1.0是指早期的互联网，它主要是静态网页，信息流只是单向的，用户只能被动地接收内容，没有互动性。Web1.0 时期的网站主要是由个人和机构创建的，内容相对比较单一。</p>          </div><p>到2000年世界上流量最大的网站全部是门户网站，在美国是雅虎、MSN 和 Excite 等。在中国则是新浪、搜狐和网易三大门户网站。<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="吴军. 浪潮之巅. 人民邮电出版社, 2019.Metaverse">[7]</span></a></sup></p><p>我本人对这一段历史只有较为模糊的印象，依稀记得 360 的网站导航指向的一系列信息网页。</p><h2 id="Web-2-0">Web 2.0</h2><div class="note note-success">            <p>Wiki<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Web2](https://en.wikipedia.org/wiki/Web_2.0)">[5]</span></a></sup></p><p>Web 2.0 (also known as participative (or participatory) web and social web) refers to websites that emphasize user-generated content, ease of use, participatory culture and interoperability (i.e., compatibility with other products, systems, and devices) for end users.</p><p>Web 2.0（也称为参与式网络或社交网络），指以最终用户为目标，强调用户生成内容、易用性、参与文化和互操作性（如：与其它产品、系统和设备兼容）的网站。</p>          </div><div class="note note-primary">            <p>ChatGPT:</p><p>Web2.0则是指随着互联网技术的发展，互联网上的信息变得更加丰富和多样化。Web2.0的特点是用户可以通过各种方式主动参与到内容的创作和分享中，例如博客、社交媒体、维基百科等平台。Web2.0也成为了“社交互联网”的时代，人们可以通过互联网进行社交互动，实现信息共享和交流。</p>          </div><p>互联网2.0的公司不应该过多主导内容和服务，不应该参与和用户的竞争。以YouTube 为例，它host 的内容是用户（包括个人和专业的传媒公司）提供，它自己并不制作和拥有内容， 与其他提供内容的用户竞争。互联网2.0公司的一个普遍特点就是专注于打造通用的平台，而由社会上的开发力量和广大用户补充成完整的服务，从Wikipedia 到Facebook 都是如此，它们相当于软件时代的甲骨文和微软。<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="吴军. 浪潮之巅. 人民邮电出版社, 2019.Metaverse">[7]</span></a></sup></p><p>这个是互联网的当前版本，也是我与大家最熟悉的版本，每个人都有自己的社交账号，在网络上搜索信息并发布着内容。</p><h1>Web 3.0 应该是什么？</h1><h2 id="当前普遍接受的-Web3-概念">当前普遍接受的 Web3 概念</h2><div class="note note-success">            <p>Wiki:<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Web3](https://en.wikipedia.org/wiki/Web3)">[4]</span></a></sup></p><p>Web3 (also known as Web 3.0) is an idea for a new iteration of the World Wide Web which incorporates concepts such as decentralization, blockchain technologies, and token-based economics.Specific visions for Web3 differ, and the term has been described by Bloomberg as “hazy”, but they revolve around the idea of decentralization and often incorporate blockchain technologies, such as various cryptocurrencies and non-fungible tokens (NFTs).</p><p>Web3（也被称为 Web 3.0，又寫為 web3）是關於全球資訊網發展的一个概念，主要與基於區塊鏈的去中心化、加密貨幣以及非同質化代幣有關。與區塊鏈有關的 web3 概念是由以太坊聯合創始人 Gavin Wood 於 2014 年提出，並於 2021 年受到加密貨幣爱好者、大型科技公司和創業投資公司的關注。</p>          </div><p>目前 Web3 和区块链（数字货币）元宇宙<sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Metaverse](https://en.wikipedia.org/wiki/Metaverse)">[8]</span></a></sup>（一种基于虚拟连接的去中心化的社交环境）几乎成为了强相关的等价概念。这些概念混杂在各种信息源中对大家进行强势输出。或许大家已经形成思维定式，在绝大多数人眼中这些概念是等价的。</p><h2 id="ChatGPT-对什么是-Web-3-0-的解释">ChatGPT 对什么是 Web 3.0 的解释</h2><p>令人惊奇的是，ChatGPT 给出了一个我从来没有见过的 Web 3.0 的解释。这是我第一次看到不同于“基于区块链”的 Web3 定义（当然有可能是我的孤陋寡闻）。</p><div class="note note-primary">            <p>ChatGPT:</p><p>Web3.0则是指未来互联网的发展方向。Web3.0的特点是更加智能化、个性化和自适应，它能够更好地理解用户的需求，提供更为精准的服务。Web3.0也被称为“语义网”，它可以通过自然语言理解技术，将人类语言转化为机器可读的语义信息，从而实现更好的智能化交互。</p><p>总的来说，Web1.0、Web2.0和Web3.0代表了互联网在不同阶段的发展和变革。Web1.0时期是互联网的起步阶段，Web2.0时期是互联网的社交互联网时代，而Web3.0则是互联网向智能化和个性化方向发展的趋势。</p>          </div><p>这个 Chatgpt 的版本其实更加贴合我个人的理解。相信 Chatgpt 这样的输出也包含了一些 OpenAI 人员对互联网发展自己的理解和私心。</p><h1>我个人对 Web 3.0 这个名词的理解</h1><p>“名词之争”：在这里什么技术叫什么名字对技术的发展大概率不会有太大影响。这里仅做一个 Web 3.0 或许可能更适合指什么东西的讨论。</p><p>首先我们提出一些公理：</p><ol><li>每一代互联网都需要以<strong>信息</strong>为核心，包括且不限于信息的产生和分发和产权。</li><li>每一代互联网都需要对社会有着<strong>实际的而非虚构的</strong>积极正面的作用。</li><li>作为信息革命，需要伴随着大量基础设施的发展。<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Why it’s too early to get excited about Web3](https://www.oreilly.com/radar/why-its-too-early-to-get-excited-about-web3/)">[3]</span></a></sup><sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Web3](https://en.wikipedia.org/wiki/Web3)">[4]</span></a></sup></li></ol><p><strong>在这个基础上，我认为基于大模型的“类 ChatGPT 信息生成技术”才是 web 3.0 的核心含义。</strong>即从“机构收集数据”到“用户生产数据”到“自动生产数据”的一个变迁。（后者也会包含前者）当然这个在技术上是一个信息的解构与重构过程。</p><h2 id="Web-1-2-3-的对比">Web 1/2/3 的对比</h2><p>基于当前理解，我们可以从信息的维度对三种 Web 进行对比。（后一代纪可以包含前一代纪的内容。）</p><table><thead><tr><th>特点</th><th>Web1.0</th><th>Web2.0</th><th>Web3.0（基于当前分析）</th></tr></thead><tbody><tr><td>信息内容</td><td>静态网页，网站预筛选</td><td>以用户为中心进行内容创作</td><td>由人工智能系统辅助的以人为中心的创作</td></tr><tr><td>信息分发</td><td>网站</td><td>搜索引擎/社交网络</td><td>对话系统/智能辅助系统</td></tr><tr><td>信息产权</td><td>网站所有</td><td>公司/个人所有</td><td>机构（模型产权）/公司（Prompt 产权）/个人（细分内容产权）</td></tr><tr><td>信息存储</td><td>公司服务器</td><td>数据中心</td><td>数据中心 &amp; 区块链</td></tr><tr><td>信息交互性</td><td>用户被动接收内容</td><td>用户主动参与内容创作和分发</td><td>用户主动参与内容创作分发与反馈</td></tr><tr><td>信息交互方式</td><td>向单向传输（文本形式）</td><td>双向传输（文本/图像/视频等）</td><td>双向传输（更多的模态 VR/AR）（元宇宙）</td></tr><tr><td>信息基础设施</td><td>互联网</td><td>数据中心 &amp; 服务器</td><td>基于大量预训练数据的大模型</td></tr><tr><td>行业信息壁垒</td><td>内容质量</td><td>社区维护</td><td>大模型在特定场景的定制化</td></tr><tr><td>相关信息技术</td><td>古早互联网信息技术</td><td>Web服务、社交网络、博客等</td><td>人工智能、区块链、物联网、VR/AR 等</td></tr><tr><td>价值</td><td>高效的信息收集</td><td>更高效的信息收集与传播</td><td>更高效的信息收集处理与传播</td></tr></tbody></table><p>（本表格基于 chatgpt 预生成更改。）</p><h1>Reference</h1><section class="footnotes">[object Object]<div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.bilibili.com/read/cv14711971">聂辉华、李靖：《元宇宙的秩序：一个不完全契约理论的视角》</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/448262398">为什么现在对 Web3 感到兴奋还为时过早</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.oreilly.com/radar/why-its-too-early-to-get-excited-about-web3/">Why it’s too early to get excited about Web3</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://en.wikipedia.org/wiki/Web3">Web3</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://en.wikipedia.org/wiki/Web_2.0">Web2</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://en.wikipedia.org/wiki/Web_2.0#Web_1.0">Web1</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:7" class="footnote-text"><span>吴军. 浪潮之巅. 人民邮电出版社, 2019.Metaverse<a href="#fnref:7" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://en.wikipedia.org/wiki/Metaverse">Metaverse</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>Writing</category>
      
    </categories>
    
    
    <tags>
      
      <tag>随笔</tag>
      
      <tag>互联网</tag>
      
      <tag>chatgpt</tag>
      
      <tag>web1.0</tag>
      
      <tag>web2.0</tag>
      
      <tag>web3.0</tag>
      
      <tag>元宇宙</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Contrastive Learning 再次学习</title>
    <link href="/machine-learning/contrastive-learning-again/"/>
    <url>/machine-learning/contrastive-learning-again/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>由于最近工作需要用到对比损失，这里对近期看到的一些资料进行整理。之前我们也对对比学习做过一个初步学习，具体详见<a href="/machine-learning/contrastive-learning/" title="此笔记">此笔记</a>。</p><span id="more"></span><p>本文主要是对以下三篇资料的学习：</p><ul><li>SimCSE: Simple Contrastive Learning of Sentence Embeddings <a href="https://arxiv.org/pdf/2104.08821.pdf">[2021, EMNLP]</a></li><li>Prototypical Contrastive Learning of Unsupervised Representations <a href="https://arxiv.org/pdf/2005.04966.pdf">[2021, ICLR]</a></li><li><strong>Tutotial:</strong> Contrastive Data and Learning for Natural Language Processing <a href="https://contrastive-nlp-tutorial.github.io/files/contrastive_nlp_tutorial.pdf">[2022, NAACL]</a></li></ul><h1>SimCSE</h1><p>同时有监督式和无监督式对比学习，standard <strong>dropout</strong> used as noise：</p><ol><li>Unsupervised approach:<ul><li>使用两次 dropout 并互为正样本。</li><li>Unsupervised SimCSE essentially improves uniformity while avoiding degenerated alignment via dropout noise, thus improving the expressiveness of the representations.</li></ul></li><li>Supervised approach:<ul><li>将标注样本加入对比学习。</li><li>Takes alignment between semantically-related positive pairs and uniformity of the whole representation space to measure the quality of learned embeddings.</li></ul></li><li>对比了其他的正样本生成方式：<ul><li>crop / word deletion / synonym replacement</li></ul></li><li>使用 supervised  和 unsupervised CL：<ul><li>目测这个 supervised 里面已经包含了 unsupervised？</li><li>在他自己的分析中，他们这种使用 dropout 的方法保证了 uniformity 和 alignment。</li></ul></li></ol><h1>Prototypical Contrastive Learning</h1><p>同时使用无监督对比表征学习和聚类。</p><ol><li>It encodes semantic structures discovered by clustering into the learned embedding space.</li><li>Propose ProtoNCE loss, a generalized version of the InfoNCE loss for contrastive learning, which encourages representations to be closer to their assigned prototypes.<ul><li>包含一项 infoNCE，to retain the property of local smoothness and help bootstrap clustering.</li><li>也包含一项 cluster 相关的 loss，形式和 infoNCE 很像，只是把 augmented examples 替换成了 cluster centroids。这个其实可以看做某种半/无监督类型的对比，因为本质上是使用了 pseudo-labels。</li></ul></li></ol><h1>Contrastive Data and Learning for NLP</h1><p>这个是 NAACL 上的一个 Toturial，此处记录一些自认为重要的点：</p><ol><li>Contrastive Learning = Contrastive Data Creation + Contrastive Objective Optimization</li><li>Noise Contrastive Estimation (NCE) 仅是对比学习中的一类 loss。</li><li>Normalized Temperature-scaled Cross-Entropy (NT-Xent) 即为 InfoNCE with Cosine Similarity on Normalized Embeddings。</li><li>Hard negative mining: find hard negative examples. We want to ancher-neg is greater than anchor-pos, at least by the margin.</li><li>更大的批选取通常有更好的表现。</li><li>Two geometric forces on the hypersphere: alignment &amp; uniformity</li></ol><h1>My Questions?</h1><p>本次阅读这些文章主要是为了回答自己的两个问题：</p><ol><li>在文本上如何进行正负样本的构建？（图像上的构建方式在上一次的学习笔记中已经提到不少。）<ul><li>crop / word deletion / synonym replacement / back-translation / cut-off / mixup</li></ul></li><li>同时添加 supervised 和 unsupervised contrastive loss 这种方式有时表现不错，如何解释？<ul><li>前两篇文章都有监督损失和非监督损失的结合，都取得了较好的表现。</li><li>或许是因为两种结合可以更好的保证学得表征的 alignment &amp; uniformity。</li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>contrastive-learning</tag>
      
      <tag>self-supervised-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>对于主动学习的一些思考</title>
    <link href="/machine-learning/al-thinking/"/>
    <url>/machine-learning/al-thinking/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>主动学习发展已经约 30 年，作为领域里面的无名小卒，自己也对这个方向有大概四五年的了解。近些年发现本领域的文章以灌水居多，真正提出问题和解决问题的少之又少（虽然绝大多数领域都是这样）。目前有一些人对 AL 的实用性和表现提出了质疑，并且也收获了一些认可。那么主动学习领域到底会何去何从？本文我会整理总结一下自己的看法，或许有一些观点缺乏证据支持，若日后需要深入，则会补上。</p><span id="more"></span><h1>客观上 AL 是什么？</h1><div class="note note-primary">            <p>关于 AL 的具体信息，可见本人 <code>awesome-active-learning</code> 的仓库，详见<a href="https://github.com/SupeRuier/awesome-active-learning">此链接</a>。</p>          </div><h2 id="主动学习面向的问题">主动学习面向的问题</h2><p>在机器学习中，需要标记样本来训练模型，获得标记样本需要成本（人工标注，实验模拟等）。为了训练一个良好的模型，获取标记样本的成本往往可观。所以我们期望可以使用更少的标记成本（通常意味着更少的标记样本）来训练得到一个表现相当的可用模型。</p><p>这个问题通常有两个解决思路：</p><ol><li>在少量标记样本下，尽可能来提升模型的表现。</li><li>选取更加值有价值的样本进行标注且训练模型。</li></ol><h2 id="主动学习的基本思路">主动学习的基本思路</h2><h3 id="一个重要的假设">一个重要的假设</h3><p>并不是所有的样本对于模型训练有着相同的重要性。相同数量的重要样本训练出的模型要好于相同数目的劣质样本。那么选择重要样本标记并训练可以有效减少标注成本（因为不同样本的标记成本近似相同）。</p><h3 id="基本解决方案（通常遵循的思路）">基本解决方案（通常遵循的思路）</h3><p>迭代式选取与训练：</p><ol><li>基于当前标记样本训练模型。</li><li>基于当前训练好的模型选取重要的新样本并更新已有标记样本库。</li><li>重复 1&amp;2 直到预算耗尽。</li></ol><p>于是乎绝大多数工作的重点都放在了如何定义“重要”以及如何选取“重要样本”。</p><h1>客观上 AL 现状？有什么局限？</h1><h2 id="现状">现状</h2><h3 id="从论文的角度而言">从论文的角度而言</h3><ol><li>从论文发表的角度来看，每年都会有一定程度的顶会顶刊，作为一个相对成熟的领域还算正常。</li><li>从论文的内容来看<ol><li>高水平会议以及期刊针对于 AL 方法或者当前解决方案的局限性进行分析讨论。</li><li>其他绝大多数工作是将 AL 当作工具与其他领域问题结合使用。在这些问题上或提出新策略，或没有。</li><li>针对传统问题提主动学习策略的越来越少。</li></ol></li></ol><h3 id="从应用的角度而言">从应用的角度而言</h3><ol><li>听说过一些数据标记公司使用 AL 来标记/构建模型。</li><li>也能时常看到一些科学界或者产业界的应用论文。</li></ol><h3 id="从学者研究强度的角度而言">从学者研究强度的角度而言</h3><p>每年也都有几篇 AL 相关的博士论文。也仍有一些课题组将 AL 作为研究重点之一。详见我们的 <a href="https://github.com/SupeRuier/awesome-active-learning">AL 资料库</a>。</p><h2 id="局限性-质疑">局限性/质疑</h2><p>我曾写过一个相关深度主动学习局限性相关论文的（见<a href="/paper-reading/deep-AL-criticism/" title="阅读笔记">阅读笔记</a>）。此外在 <code>awesome-active-learning</code> 的仓库中也有进行一些更新，详见<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/subfields/deep_AL.md">此链接</a>。</p><p>目前来说，对于现有主动学习工作/框架的质疑主要集中于以下几点：</p><ol><li>表现上（是否可以在有限样本下获得最大程度提升）：<ol><li>在用少量标记样本的前提下，表现远差于基于半监督学习和自监督学习的方法（不论用什么策略）。</li><li>如果与基于半监督学习和自监督学习的方法结合使用主动学习，AL 的提升不明显。</li></ol></li><li>可靠性上（使用可以使选用的策略优于其他策略）：<ol><li>当前许多工作提出的方法的可信性有限，不同的文章中相同的策略有时会给出不同的结果。没有一些约定俗成的 benchmark 来对比不同文章的策略。这个可能来源于不同的 AL 的设定（不同 AL_batchsize 或者重复次数随机种子可能会影响最终表现）。</li><li>当前对于主动学习策略的理解有限，同一个策略在不同的设定下可以有不同的表现，当前缺乏不同场景下哪种策略更适用的认识。</li><li>在一些场景下，主动学习甚至表现差于随机选取。</li></ol></li><li>实际使用上（是否可以顺利地部署）：<ol><li>由于主动学习实际使用中只有一次使用机会，那么如何保障其至少不差？（可靠性相关）</li><li>主动学习的标注流程与实际的标注条件或许存在冲突（串行并行）。</li></ol></li></ol><h1>我们是否还需要 AL？（以问题为导向）</h1><p>从实际的角度来看判断一个技术是否还有用，在以问题为导向的思路下，或许可以从以下几个角度思考：</p><ol><li>该技术可以用来解决的问题是否还存在？是否发生变化？</li><li>是否有其他的技术完美解决这个问题？</li><li>该技术的表现是否达到可用标准？</li></ol><h2 id="问题是否还存在？是否发生变化？">问题是否还存在？是否发生变化？</h2><p>“针对任务构建模型时标注成本昂贵的”问题依旧存在，但或许有了一些变化。</p><ol><li>标记需要付出成本的前提依旧存在。<ul><li>标注的定义更加广义，人工之外可能还有机器，亦或一些模拟实验。</li><li>随着一些众包平台的发展，或许一些简单的人力标注成本有所降低。</li></ul></li><li>监督学习的场景下，训练“特定任务”上的良好模型仍需要相对多的标记样本。<ul><li>但是纯监督学习的应用场景或许越来越少（实际使用中或许越来越局限）。</li></ul></li></ol><h2 id="其他解决方式的是否比-AL-好？">其他解决方式的是否比 AL 好？</h2><p>总的来说，主动学习期望以少量标记样本获得较好表现，当前有着以下一些方法同样面对这个场景，区别在于他们并没有着重于样本评估选取。</p><ol><li>半监督学习，同时利用标记以及未标记样本，在少样本下表现较好（于少样本监督学习）。</li><li>自监督学习，利用未标记样本和辅助任务提取标准，在使用少量标记样本 fine-tune，复杂任务上表现较好（于少样本监督学习）。</li><li>类迁移学习（预先存在一些知识积累）：<ol><li>迁移学习：有一些目标领域标记样本，通常表现好于仅在目标领域少量样本监督学习。</li><li>小样本学习：通常标记数目极少，several-shots，表现好于仅使用小样本监督学习。</li></ol></li></ol><p>这些方法通常都好于仅使用少量样本的监督学习，因为其或多或少都用到了标记样本之外的更多信息（好于单纯仅仅使用 AL）。可以说这些方法或多或少的解决了小样本下低标注成本的学习问题。</p><h2 id="AL-表现上是否达到可用标准？">AL 表现上是否达到可用标准？</h2><p>“可用标准”或许难以定义，但是考虑到其他方法的优良表现，可以认为在很多情况下，简单的仅在监督学习中使用主动学习是不能满足需求的，即不可用。</p><p>但“其他解决方式结合 AL 的重要样本选取”相对于“仅使用其他解决方式”而言，很多时候是可以带来表现提升的（表现更好通常就意味着更节省成本。）</p><ul><li>例如一些半监督学习/自监督学习/数据增强 + AL。</li><li>例如域迁移/预训练模型 + AL。</li></ul><p>所以，与各种先进范式结合的 AL 选取是可以达到使用标准的，即可用。但需要注意的是 AL 于其它范式的结合带来的提升并不能保证很大，同时在训练上可能也会带来负担（多次训练）。</p><h2 id="我们是否还需要-AL？">我们是否还需要 AL？</h2><ol><li>如果单样本标注成本极高<ul><li>那么哪怕极少量的标记数降低都可以带来可观的成本节约。</li><li>这些情况往往在科学研究，医疗分析等强依赖专家或者模拟实验中出现。</li><li>这种情况我们需要 AL。</li></ul></li><li>如果单样本标注成本有限。<ul><li>那么需要极大量的标记数目减少才可以节约成本。</li><li>这种情况在很多常见的任务中都会出现，成本或有不同，但是应该还是在一个数量级。</li><li>这种情况非 AL 或许已经可以带来极大的成本节约。</li><li>如果预算其极有限，那么或许我们进一步还需要 AL。</li></ul></li></ol><h1>个人看法</h1><p>如果还想在 AL 领域继续深入研究：</p><ol><li>使用时需要与先进范式结合及对比，而不是简单的使用随机选取监督学习作为基线。</li><li>目前预训练模型取得了长足的进展，其往具体任务上的迁移或许是一个较好的方向。个人认为 GPT-3 这种大模型以及将来可能出现的基于大量数据的“数据预收集预处理”知识库才是所谓 web3.0 的真正路径。</li><li>需要找昂贵标记成本的实际运用，这是 AL 最有实际价值的地方。<ol><li>这个可以指单次标注十分耗费金钱</li><li>也可以指单次获得标注十分耗时</li><li>也可以指其他不可避免的困难</li></ol></li><li>AL 实际使用中有着一些阻碍，可能仍需要进一步研究。<ul><li>选取样本的依据及合理性，包含一些理论研究</li><li>不同数据分布条件下的考虑</li><li>传统 AL 流程的复杂度和易用性</li><li>其他种种可以见我们的 <a href="https://github.com/SupeRuier/awesome-active-learning#5-practical-considerations---%E8%BF%90%E7%94%A8-al-%E6%97%B6%E7%9A%84%E8%80%83%E8%99%91">AAL 仓库</a></li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>active-learning</tag>
      
      <tag>thinking</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spiking Neural Network</title>
    <link href="/machine-learning/spiking-neural-network/"/>
    <url>/machine-learning/spiking-neural-network/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>此处记录对于 Spiking Neural Network（脉冲神经网络）的学习。SNN 号称是 BP 网络之后的第三代神经网络，名头很响，但好像并没有看到太多应用。这里不求甚解，只希望把最基本的与 ANN 的对应关系简要了解。</p><span id="more"></span><h1>Spiking Neural Network 脉冲神经网络</h1><p>总的来说 SNN 与传统的 ANN 比较相似，不同点主要在于以下几个地方：</p><ol><li>信息载体使用脉冲而不是浮点数。</li><li>神经元使用类膜电压变化来产生脉冲而不是乘加运算。</li><li>主要使用突触可塑性而不是仅用 BP。</li></ol><h2 id="神经元基本运算">神经元基本运算</h2><p>神经元由 ANN 中处理浮点数转化为 SNN 这里的处理脉冲信号。</p><div style="width:70%;margin:auto"><img src="/machine-learning/spiking-neural-network/neural.jpg" class="" title="神经元"></div><p>多受到刺激超过阈值时，生成新脉冲，并进入一段时间的不应期。</p><div style="width:70%;margin:auto"><img src="/machine-learning/spiking-neural-network/neural_process.jpg" class="" title="脉冲信号的处理"></div><h2 id="模型如何训练">模型如何训练</h2><h3 id="脉冲时间的可塑性">脉冲时间的可塑性</h3><p>应用在脉冲神经网络的最常见的学习方法是依赖脉冲时间的可塑性(Spiking Time Dependency Plastic)，以下简称STDP。</p><p>突触的权重改变量依赖输入输出脉冲时间间隔。如果存在因果性，则加大权重：</p><ol><li>如前神经元发出一个脉冲，后神经元紧接着产生了一个脉冲，前后脉冲时间差极小且为正值，其中有较强的因果性，其突触权重应该大大增加。</li><li>当前神经元发出一个脉冲，过了很久后神经元也产生了一个脉冲，前后脉冲时间差极大，则其中因果关系不明显，突触权重不变化。</li><li>当后神经元发出了一个脉冲，其处于不应期，这时前神经元输入了一个脉冲，脉冲时间差为负，其非因果，突触权重应大大减小。</li></ol><p>在STDP中没有涉及到任何标签、误差信息，这是一种非监督学习。</p><h3 id="ANN-到-SNN-的转换">ANN 到 SNN 的转换</h3><p>在输入上，要将输入信号编码为脉冲序列。所有神经元用相应的 spiking neuron 替换，所得权重要进行量化。</p><h3 id="BP-算法">BP 算法</h3><p>预估网络中得变化参数得梯度从而进行反向传播。离散的输出不可导的，但是我们可以创造一个函数去逼近它，只要符号是对的，我们的梯度下降的方向就是对的，尽管不一定能最速下降，但好歹也能下降。这样得算法虽然还存在争论但它确实在某种程度上降低了SNN得训练复杂度，这样得算法比如有 spikeprop, Slayer 等等。</p><h1>Reference</h1><ul><li><a href="https://zhuanlan.zhihu.com/p/260539428">Spiking Neural Network简述 - Yannan的文章 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/416187474">脉冲神经网络 (Spiking Neural Network) 解读 (一) - 科技猛兽的文章 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/485170683">脉冲神经网络 Spiking Neural Network - 张丰麒的文章 - 知乎</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>spiking-neural-network</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Boltzmann Machine</title>
    <link href="/machine-learning/boltzmann-machine/"/>
    <url>/machine-learning/boltzmann-machine/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>此处记录对于 Boltzmann Machine，即玻尔兹曼机的学习。在互联网上并没有找到太多很好的资料，看了半天仍旧云里雾里，这里还是以我自己个人了解模型的思路来进行学习。以目前的了解来看，这一系列模型用得并不太多，只是偶尔被拉出来提到，所以还是得看一下。</p><span id="more"></span><h1>Restricted Boltzmann Machine 受限玻尔兹曼机</h1><h2 id="1-模型长什么样子">1. 模型长什么样子</h2><p>首先介绍玻尔兹曼机（BM），如图所示。显而易见这是一个全连接的图，v 代表 visible 即可见节点，h 代表 hidden 即隐藏节点。</p><div style="width:25%;margin:auto"><img src="/machine-learning/boltzmann-machine/bm.png" class="" title="玻尔兹曼机"></div><p>而对于受限玻尔兹曼机（RBM）而言，其包含可见层 V 和隐藏层 H，层内则不存在任何连接，即为一个二分图，如下所示。</p><div style="width:70%;margin:auto"><img src="/machine-learning/boltzmann-machine/rbm.jpg" class="" title="受限玻尔兹曼机"></div><p>由于层内不存在连接，则<strong>当给定可见层神经元的状态时，各隐藏层神经元的激活条件独立；反之当给定隐藏层神经元的状态是，可见层神经元的激活也条件独立</strong>。</p><h2 id="2-模型如何做预测">2. 模型如何做预测</h2><p>在了解模型结构之后，我们需要知道假设我们已经有训练好的模型之后，如何进行预测。换句话说就是预测需要用到模型中的那些部分以及需要进行什么步骤。</p><p>一般来说，我们做预测是想获得隐藏层（hidden）处的取值。RBM中的每个神经元只可能是二元状态0或1中的一种。我们最关心的因子是隐藏层或输入层地神经元位于状态1（激活）的概率。给定一个输入向量 v，可以得出单个隐藏神经元 j 激活的概率：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mo>∣</mo><mi mathvariant="bold">v</mi><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo fence="true">(</mo><mo>−</mo><mrow><mo fence="true">(</mo><msub><mi>b</mi><mi>j</mi></msub><mo>+</mo><msub><mi>W</mi><mi>j</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></msup></mrow></mfrac><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><msub><mi>b</mi><mi>j</mi></msub><mo>+</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>v</mi><mi>i</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">p\left(h_j=1 \mid \mathbf{v}\right)=\frac{1}{1+e^{\left(-\left(b_j+W_j v_i\right)\right)}}=\sigma\left(b_j+\sum_i v_i w_{i j}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1248em;vertical-align:-0.8034em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2799em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8301em;"><span style="top:-3.0051em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight">−</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8034em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0277em;vertical-align:-1.2777em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>同样的，给定一个隐藏层向量 j，可以得出单个输入神经元 i 激活的概率：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo>∣</mo><mi mathvariant="bold">h</mi><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo fence="true">(</mo><mo>−</mo><mrow><mo fence="true">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><msub><mi>W</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></msup></mrow></mfrac><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>h</mi><mi>j</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">p\left(v_i=1 \mid \mathbf{h}\right)=\frac{1}{1+e^{\left(-\left(a_i+W_i h_j\right)\right)}}=\sigma\left(a_i+\sum_j h_j w_{i j}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">h</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1248em;vertical-align:-0.8034em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2799em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8301em;"><span style="top:-3.0051em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight">−</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8034em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1638em;vertical-align:-1.4138em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>预先不知道的变量（或许通常为隐变量），即可作为模型的输出。</p><h2 id="3-模型如何训练">3. 模型如何训练</h2><p>从模型的预测方式可以看出，在我们知道偏置向量和权值矩阵之后即可使用模型进行预测。RBM 是一种基于能量的模型，它尝试最小化一个预先设定好的能量函数，在优化的过程中得到相关的参数。首先这个能量定义为（至于为什么这样定义在此不做讨论）：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>a</mi><mi>i</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>b</mi><mi>j</mi></msub><msub><mi>h</mi><mi>j</mi></msub><mo>−</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E(\mathbf{v}, \mathbf{h})=-\sum_i a_i v_i-\sum_j b_j h_j-\sum_{i, j} v_i h_j w_{i j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>然后可得其联合概率分布：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>Z</mi></mfrac><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>Z</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi></mrow></munder><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}p(\mathbf{v}, \mathbf{h}) &amp; =\frac{1}{Z} e^{-E(\mathbf{v}, \mathbf{h})} \\Z &amp; =\sum_{\mathbf{v}, \mathbf{h}} e^{-E(\mathbf{v}, \mathbf{h})}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.0957em;vertical-align:-2.2978em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7978em;"><span style="top:-4.7978em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">h</span><span class="mclose">)</span></span></span><span style="top:-2.7618em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2978em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7978em;"><span style="top:-4.7978em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="mopen mtight">(</span><span class="mord mathbf mtight" style="margin-right:0.01597em;">v</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">h</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.7618em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">v</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">h</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="mopen mtight">(</span><span class="mord mathbf mtight" style="margin-right:0.01597em;">v</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">h</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2978em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中 Z 为配分函数（partition function），用来做归一化。这个分布即为<strong>玻尔兹曼分布</strong>。RBM 的训练包括为给定的输入值寻找使能量达到最小值的参数。能量最小则联合分布最大，即当下状态的发生概率最大。</p><blockquote><p>利用基于能量的模型的原因是这样的，对于一个给定的数据集，如果不知道其潜在的分布形式，那是非常难学习的，似然函数都写不出来。比如如果知道是高斯分布或者多项分布，那可以用最大化似然函数来学出需要学习的对应参数，但是如果分布的可能形式都不知道，这个方法就行不通。而统计力学的结论表明，任何概率分布都可以转变成基于能量的模型，所以利用基于能量的模型的这个形式，是一种学习概率分布的通法。</p></blockquote><p>对于实际问题，我们可得观测数据的概率分布，即联合分布的一个边缘分布，即：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>P</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mi>h</mi></munder><msub><mi>P</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><msub><mi>Z</mi><mi>θ</mi></msub></mfrac><munder><mo>∑</mo><mi>h</mi></munder><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>E</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">P_\theta(v)=\sum_h P_\theta(v, h)=\frac{1}{Z_\theta} \sum_h e^{-E_\theta(v, h)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3521em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.6236em;vertical-align:-1.3021em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">h</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>再使用最大似然估计（对数形式），在对应的样本集 S 上来求得对应的参数值。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ln</mi><mo>⁡</mo><msub><mi>L</mi><mrow><mi>θ</mi><mo separator="true">,</mo><mi>S</mi></mrow></msub><mo>=</mo><mi>ln</mi><mo>⁡</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><mi>P</mi><mrow><mo fence="true">(</mo><msup><mi>v</mi><mi>i</mi></msup><mo fence="true">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><mi>ln</mi><mo>⁡</mo><mi>P</mi><mrow><mo fence="true">(</mo><msup><mi>v</mi><mi>i</mi></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ln L_{\theta, S}=\ln \prod_{i=1}^{n_s} P\left(v^i\right)=\sum_{i=1}^{n_s} \ln P\left(v^i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9402em;vertical-align:-1.2777em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6625em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9402em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6625em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p><p>如何来计算梯度（以优化似然）呢？一般使用迭代的方式逼近。目前在用的方法是吉布斯采样（得到原始向量重建值）+ 对比散度（使用重建值计算梯度）+ 梯度上升（更新梯度）的方法。（具体细节在此不赘述，日后若有需要再深入学习。）</p><h1>Deep Boltzmann Machine 和 Deep Belief Net</h1><p>深度信念网络（DBN）也是经常听到的一个名词，其结构和深度玻尔兹曼机（DBM）有一些相似。此处仅做一个了解，日后若有需要再深入学习。</p><h2 id="模型长什么样子">模型长什么样子</h2><div style="width:70%;margin:auto"><img src="/machine-learning/boltzmann-machine/dbn.jpeg" class="" title="深度信念网络"></div><br><p>简单来说第一层都是一样的，即为一层 RBM。DBN 的后面几层为前向网络，而 DBM 的后面几层仍为 RBM。整体来看，DBN是有向图（除了最上层的RBM是无向图），是巧妙结合了有向图和无向图的生成模型；DBM每相邻的两层都是RBM，是完全的无向图。</p><h1>Reference</h1><ul><li><a href="https://zhuanlan.zhihu.com/p/22794772">受限玻尔兹曼机（RBM）学习笔记 - 祁昆仑的文章 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/38024014">深度学习邂逅物理：受限玻尔兹曼机原理解析</a></li><li><a href="https://zh.wikipedia.org/wiki/%E7%8E%BB%E5%B0%94%E5%85%B9%E6%9B%BC%E6%9C%BA">玻尔兹曼机</a></li><li><a href="https://zhuanlan.zhihu.com/p/34201655">深度学习基础：Boltzmann Machines - 羽刻的文章 - 知乎</a></li><li><a href="https://www.zhihu.com/question/35396583/answer/1562794617">深度学习中，深度波尔兹曼机（DBM）和深度置信网络（DBN）都有哪些区别？ - gwave的回答 - 知乎</a></li><li><a href="https://cloud.tencent.com/developer/news/240089">深度置信网络＆深度玻尔兹曼机</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>boltzmann-machine</tag>
      
      <tag>deep-belief-net</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Forward Forward Algorithm</title>
    <link href="/machine-learning/forward-forward/"/>
    <url>/machine-learning/forward-forward/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>Hinton 在 NeurIPS 2022 提出了 Forward Forward Algorithm<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[The Forward-Forward Algorithm: Some Preliminary Investigations](https://www.cs.toronto.edu/~hinton/FFA13.pdf)">[1]</span></a></sup>，好像还挺有意思，在此做一个学习。</p><span id="more"></span><h2 id="说在最前">说在最前</h2><p>老爷子的原文的思考角度仍然是以问题出发，先从 back-propagation 所拥有的问题讲起，引出更“人脑式”的 Forward Forward Algorithm（FFA）。本文不在意算法的具体表现怎样，也不在意具体如何代码实现，仅对文章思想作一个了解。本文写成于略读了原文，以及一些知乎讨论之后，或许有一些不正确的记载，敬请指正。</p><h2 id="主要思想">主要思想</h2><h3 id="单层的模式">单层的模式</h3><p>不需要通过最后一层将误差一层层反传回来调整权值（即不用 back-propagation），而是在每一层使用正样本（第一次 forward）和负样本（第二次 forward）来对权重进行调整。两次前想的操作完全相同，除了使用不同的数据和相反的目标。相似于反向传播中存在的损失函数 loss，FFA 中的目标函数为 goodness（大佬命名的确通俗），如下所示。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mtext> positive </mtext><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>y</mi><mi>j</mi><mn>2</mn></msubsup><mo>−</mo><mi>θ</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\text { positive })=\sigma\left(\sum_j y_j^2-\theta\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord"> positive </span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1638em;vertical-align:-1.4138em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> 是一个阈值，而不是参数/权重。正样本需要调节权重使 goodness 增加，负样本则相反。具体来说权重如何更新呢？我暂时没有找到相关表述，或许还是使用梯度下降（感觉很多时候梯度下降和反向传播混为一谈了）。</p><p>下面是一些相关的原文表述：</p><blockquote><p>The idea is to replace the forward and backward passes of backpropagation by two forward passes that operate in exactly the same way as each other, but on different data and with opposite objectives.The positive pass operates on real data and adjusts the weights to increase the goodness in every hidden layer.The negative pass operates on “negative data” and adjusts the weights to decrease the goodness in every hidden layer.This paper explores two different measures of goodness – the sum of the squared neural activities and the negative sum of the squared activities, but many other measures are possible.</p><p>The aim of the learning is to make the goodness be well above some threshold value for real data and well below that value for negative data.</p></blockquote><p>个人的理解即为使得在每一层中正样本更容易激活，而负样本更难以激活（即 activity 更小）。</p><h3 id="多层的模式">多层的模式</h3><p>在多层网络中，由于上一层已经使得正负样本模长产生区别，所以在输入下一层之前，需要对隐层向量长度进行标准化。</p><p>下面是一些相关的原文表述：</p><blockquote><p>But if the activities of the first hidden layer are then used as input to the second hidden layer, it is trivial to distinguish positive from negative data by simply using the length of activity vector in the first hidden layer.There is no need to learn any new features.To prevent this, FF normalizes the length of the hidden vector before using it as input to the next layer.This removes all of the information that was used to determine the goodness in the first hidden layer and forces the next hidden layer to <strong>use information in the relative activities of the neurons</strong> in the first hidden layer.These relative activities are unaffected by the layer-normalization.To put it another way, the activity vector in the first hidden layer has a length and an orientation.The length is used to define the goodness for that layer and <strong>only the orientation is passed to the next layer</strong>.</p></blockquote><h2 id="讨论">讨论</h2><p>把最终的 loss 反传取消，换成了每一层的限制，可能是这个文章最重要的 intuition。但是好像已经有很多人做过类似的尝试了，比如马毅教授 的 NeurIPS 2020 中稿文章 MCR2<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[如何评价 马毅教授 的 NeurIPS 2020 中稿文章 MCR2 及 自称弄明白深度学习了？ - 刘斯坦的回答 - 知乎](https://www.zhihu.com/question/423767542/answer/1893558922)">[3]</span></a></sup>。（总体来说是我不太熟悉的训练方式，还是有一点意思的。）</p><h2 id="Reference">Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cs.toronto.edu/~hinton/FFA13.pdf">The Forward-Forward Algorithm: Some Preliminary Investigations</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.zhihu.com/question/570153849/answer/2787026263">如何评价Hinton提出的Forward-Forward方法？ - 刘斯坦的回答 - 知乎</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.zhihu.com/question/423767542/answer/1893558922">如何评价 马毅教授 的 NeurIPS 2020 中稿文章 MCR2 及 自称弄明白深度学习了？ - 刘斯坦的回答 - 知乎</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>deep-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超级 Rui 的 2022 年</title>
    <link href="/life/2022-year-report/"/>
    <url>/life/2022-year-report/</url>
    
    <content type="html"><![CDATA[<p>写在 2023 年年初，对 2022 的回顾。</p><span id="more"></span><h1>写在最最前</h1><p>第一次写年终总结，契机可能是看到了 github 上大家的年终总结，大家都在认真的描述自己或好或坏的一年，让自己有了一丝感动，原来大家在那么用力的过好自己的生活。好像博客搭建之初就是为了写一些自己的想法，但是这些年下来逐渐变成了一个笔记本，脱离了自己的初衷。在新年伊始，觉得还是应该好好的回顾一下过去的一年，这也是很不平凡的一年。</p><p>不太记得我的 2022 是以什么姿态展开的了，找不到任何形式的记录，不论是照片还是朋友圈，甚至都找不到聊天记录。隐约中好像是在五月天的线上简单的跨了一个年。那时候好像疫情已经被控制住，除了健康码和行程码之外，除了没有什么大型文娱活动之外，一切还算比较正常。但一整年的疫情变化让人诧异，奥密克戎的肆虐，攻陷了香港，也在内地开始传播，国内政府的处理手段过于让人惊异。年初的西安孕妇无法就医流产，后来的上海全城物资紧缺（不能说原因下的人们有心无力），再到每一个城市的说封就封，基层权力的无休止放大和黑暗化，自己对社会的信心开始动摇。年末迎来了预期之内的解封，重获了久违的自由，但好像明白了自己就是一粒沙，在棋手的棋盘上微不足道。</p><p>读博已经过去了四年多，学业也如期进入延期毕业，虽然在入学时就已经预期了延期，但是仍旧十分忐忑。第四年结束时，老板的批评对自己有了重重的一击，接着就是一段时间的消沉，不过后来事情好像缓缓的恢复了正轨。此外也搬回了家住，重启了和父母的长期相处，感觉依旧在磨合。总之今年一整年感觉都在不断地认识自己，或许有了一些成果，但是总体仍旧在了解自己的过程中。久违的情感线的确有了一些新进展，算是给 2022 年画上了一个比较好的句号。</p><h1>具体来说</h1><h2 id="反反复复的疫情">反反复复的疫情</h2><p>疫情对自己的心态有着很大的影响，新冠在 2022 年的一波三折，让自己对整个社会产生了极大的怀疑。这一年经历的事情或许是一种“中国大家长”式的“牺牲自由的保护”，或许无可厚非，虽然喜爱自由的我并不喜爱这些管控措施，但是不得不说他们的确在一定时间段内对绝大多数人都起到了超越带来的“不方便”的保护。但可怕的是，权力的不断蔓延和失控，层层加码的防控，西安流产的孕妇，京东拼死送不进上海的物资，“爱丁堡”的戏虐，北京的居委会“软肋”，让我大受震撼和大失所望。从上海那一波过后，自己渐渐觉得开完会之后是一定会放开的，事实也的确是这样。但是放开之后也惊讶于其“仓促”，好像这么多年在“骗钱的”连花清瘟之外并没有什么长足的准备，一波感冒发烧的高潮前，人们买不到药，让人惊讶。</p><p>自己也阳了，虽说一直觉得总是会阳的不是什么大事，但是真的阳的时候，觉得还是很感慨的，好像自己在新冠纪元下总算真实的参与了一波。身边的老师朋友的防护也十分的注重， wzy 更是全副武装拒人千里之外，让人感到害怕。爸妈也都得了，一个患病之初惊讶的问我“你怎么没买连花清瘟？”，一个在康复之后就开始喝酒，实在是让人不能放心。自己也没有高烧，吃了准备的布洛芬，低烧加没精神加咳嗽，体验卡就到期了。总之，做了三百多次核酸的深圳一年结束了。</p><h2 id="学业和工作">学业和工作</h2><p>其实一直不想谈论自己的学业，一是觉得自己太菜了，二是觉得可能有点逃避，三是觉得徒增焦虑。但是好像不谈的话事情也不会变得更好，不如仔细回想一下。</p><p>上半年对社会的失望和失去信心让我产生了对“未来工作”的焦虑，毕竟已经第四年，如果正常毕业的话下半年就该工作了。那段时间伴随着各大厂的裁员，大家都人心惶惶，自己虽然还有“毕业”这件事作为一道屏障，还是忍不住担心了起来。总之到处“取经”加上自己“分析”，好像有了一套自己的看法，结论并不重要，但是中间的几条推论或许值得作为之后的指导方针：一是要去核心岗位，业务才是核心竞争力；二是要去你的竞争力可以累积，以达到一加一等于二的位置。</p><p>其八月底的时候在办延期手续，期间和老板沟通了好几次，讨论了进度和补助等等的东西。印象最深刻的是 9.1 号的那个晚上，和老板通了一通电话，他惊讶于“你怎么还在想这些东西？”“你现在这些进度将来怎么吃这碗饭？”“你的态度是不是端正？”那天是我的生日，但是在几天的压抑下心情并不好，老板这几盆冷水实在是透心凉。那次谈话让我重新的又一次认识到了自己的“幼稚”，好像总是活在自己的世界中，总是仅仅从自己的角度考虑问题。记得他说“别说科研了，也别说其他什么事物，哪怕是你和女朋友相处，你也得想想对方要什么而不是你认为对方要什么。”在科研上的体现就是是否能做出好工作，在人际的体现就是你的“情商”是否高。那通电话我最大的收获就是：不能总是“我觉得”，而是“大家觉得是什么样”或者“应该是什么样”或者“事实是什么样”。此外，前几年提出的“信马由缰”又在脑海中被 recall 了，当时的确觉得应该痛改前非（端正一下态度），毕竟人的精力的确是有限的。</p><p>那通谈话过后，的确进入了一段时间的充实期，不过或许主要原因还是那段时间主要是改论文，目标明确，在不久之后第一篇文章终于也被接收，也拥有了一篇 Trans。在那之后又回到了“问题”“方法”“实验”的这一循环中，要在一个场景下设计新策略，或许有些撞大运的样子，目标的明确程度没有那么高，那种高强度的充实期又向平常回归了一些。有意思的是十二月的某一天，在一个新思路下策略跑出了无比显著的优良表现，尝试了几种不同的组合都能说明有效，于是得意洋洋的在多个数据集上跑起了实验，并且编辑好了给老板的邮件。在发送之前，保险性的又检查了一遍代码，发现代码中自己不小心“作弊”多选了样本，显著的好结果都是假的，心又跌到谷低，洋洋得意瞬间消失，编辑好的邮件也删除掉了。科研路上的常规操作罢了，此后又恢复了策略的常规设计当中。</p><!-- 此外还有一件有趣的事是，之前接受的期刊邀请我当审稿人，第一次以自己的名义审稿（而不是老板分配任务）。于是乎长篇大论写出了自己的审稿意见，给了一个 minor revision。最后看到总的审稿结果是拒稿，另外两位审稿人简单一笔带过，让我显得认真又滑稽。不管怎么样，科研经验又增加了一些。 --><h2 id="与家人">与家人</h2><p>第四年之后就不能住学校了，于是搬回了一站地铁之外的家里。我其实一直抵触回家住，因为实在是和害怕父母长期相处，因为之前寒暑假总是会爆发冲突，但是这次好像还好，总的来说还算平静。搬回家没多久就是自己的生日，和老板通话的那个晚上。通话的时候我还没回家，回家的路上自己想了很多，包括与父母的关系。我总是抱怨爸爸妈妈，嫌弃他们给的不够好，观念老旧，不相信科学什么的，所以平时的沟通好像总是带有一种“教育”他们的感觉。那天回家，爸爸妈妈给我买了蛋糕，我自己几乎从不过生日，也很多年没吃过蛋糕。吃蛋糕的时候爸爸妈妈也和我聊了这些年的规划，包括他们即将退休什么的，他们有什么打算，还有表示对我将来选择的支持。那一刻我深感羞愧，我总是在抱怨“我觉得”他们做的不够好，但是他们其实已经给我了很多“他们觉得”足够好的事物，虽然我平时对他们很蛮横，但是他们的未来规划里处处有我处处考虑我，让我深深地感受到了自己的自私。晚上睡觉之后，给他们编辑了一段微信，表示了谢谢他们，我爱他们。</p><p>搬回家也带回来了 Luna。来福和豆豆两条狗对这只猫十分感兴趣，然而猫却很自闭胆小，所以时刻就会出现追逐逃窜逼到墙角这种戏码。为了避免纷争，买了一个栅栏隔开了猫狗。来福是一条大大咧咧的狗，对 Luna 充满了好奇，我甚至怀疑他喜欢我们家 Luna，不过他总在栅栏打开的时候跑进来偷吃猫粮，坏狗一只。豆豆是一只很神经敏感的小母狗，脾气暴躁总觉得大家对他有敌意，对于 Luna 总是会凶狠的叫和追逐，但是她其实很胆小，追逐也是在瓷砖上原地打滑，等待 Luna 跑远才追上去。在来福不在身边的时候，豆豆就很怂，并不敢对 Luna 发起什么攻势。Luna 也是一只怂猫，但是也有着猫的好奇，所以总是跨过栏杆出来玩，尤其是我在外面的时候。她也发现了豆豆的虚张声势，逐渐胆子大了，甚至有时两狗一猫可以很近的对峙，十分有趣。不知道新一年，这三个狗东西能不能和睦相处。</p><div style="width:100%; margin:auto"><img src="/life/2022-year-report/dog-cat.jpg" class=""></div><h2 id="与朋友">与朋友</h2><p>感觉这一年和朋友相处多了很多。</p><p>最好的朋友 zy 毕业跑去杭州工作了，本来最最开始觉得这个人也会一直在深圳一直在身边，结果最终还是到了另一个城市。人生中第一次和一个朋友有这么久的长时间生活重叠，从深圳到英国再回来有五年了。好像什么都聊，除了没什么太多共同爱好之外，真的是很交心的朋友，科研学习上也给予了自己很大帮助。走了之后好像有一种“依赖摆脱”的强迫独立感，interesting。不过后来还是去杭州找了一次 zy，感觉小日子过得还不错，也就放心了，希望新一年他能找到他的合适的伴侣。</p><p>今年朋友里最大的事情好像是 srx 结婚，第一次以好友的身份参加婚礼。从初中开始的好朋友，结束十年的爱情长跑结婚了，看着还挺感动，留下了一两滴喜悦的泪水。拍了好多照片帮了好多忙，全场最佳男性 Maid of Honor 好吧哈哈哈。</p><p>好像很多很好的朋友这年也都结了婚，甚至有的还有了娃，让人惊讶。但是有时候距离遥远的话，错过了 pyq 就会一无所知（没看到 hy 的朋友圈），成年人好像有一种不互相打扰的默契（更愿意相信他们不是因为关系不亲近而没想私发我）。朋友们还是要多联系一下，相信他们不会觉得我打扰他们。同时少找 hy 看病，多聊聊非医患关系哈哈哈哈。</p><p>此外的话，高中同学在深圳凑齐了四个人，真不错。zj 又重新去读书了，有目标感的读书真不错。还有实验室的同学们也真好，喜欢他们。还有参加了几次社交局，认识了一些玩伴和酒友，令人快乐。希望新一年可以多维护发展积极正面的朋友关系。</p><h2 id="运动健康">运动健康</h2><p>今年总算对运动做了记录，但是仅仅是很潦草的记录。有过一段时间的健康生活，也有了紧接着的懒散。篮球打得越来越少了，懒惰+篮球场遥远或是最大原因。学会了跟着视频做运动，但是好像仅仅是动一动。今年爬了很多山：塘朗山，七娘山，小南山，大雁顶。好像爬山并不是很有趣，可能还是要和好玩的人一起爬才好。</p><div style="width:60%; margin:auto"><img src="/life/2022-year-report/exercise.png" class=""></div><p>身体方面的确是我的正常水平：</p><ul><li>今年做了两三年的年度常规体检</li><li>喜提人生第一次骨折，还是肋骨骨折</li><li>扁桃体发炎好几次（迟早割了这玩意）</li><li>补了牙齿，但是好像又有了龋齿</li><li>胸闷胸痛好几次哈哈以为自己要死了，医生和 hy 说其实没必要那么关注自己的身体</li><li>新冠体验卡，滴！</li></ul><h2 id="金钱与消费">金钱与消费</h2><p>今年最大的改变是没有了收入，只能靠前些年攒的钱过日子，这个现象可能要持续到毕业，当然我还是坚信“毕业之后就会有钱”这种事。</p><p>理财方面这一年就很统一，基金赔了很多、股票赔了很多、美股过山车也赔了很多哈哈哈。不过总体上也都还在自己的心理和客观承受能力范畴之内。我仍旧认为年轻时候多亏亏钱没什么不好的，毕竟我现在也亏不了多少，总比将来有钱了交学费好。（当然话是这么说，有时候看到那个绿油油的数字就会觉得，我有这个钱为啥不去给自己快乐快乐呢？）</p><p>此外消费观今年在逐渐完善。根源好像是买相机的时候，当时咨询过一个二手商家一款旧相机，他跟我说“没必要在这种太老的机子中挑挑拣拣，你值得拥有一些好东西的。”当然这是商家引诱消费的惯用话术，但是的确让我反思了我的消费观，并且意识到“我的确配得上好东西，此外贵的东西的确有它的价值。”那么最重要的东西或许还是搞清自己的需求，常用的东西再贵也不贵。</p><h2 id="摄影">摄影</h2><p>摄影好像是我从初中就拥有的爱好，起源于老爸或许是出于炫耀购买的单反。这么多年来这个爱好贯穿了我的每一年，但是我却没意识到它是一个爱好，也没有把它当成一件很特别的事情。</p><p>手机一直是我这么多年拍照的主力，直到今年我又摸到了当年的那台老单反，忽然意识到虽然我没有用相机，但是摄影已经贯穿了我的生活，抛开作品质量而言已经成为了我生命的一部分。于是我对设备也进行了更新，也提高了拍摄的频率，好像眼里的世界变得更有趣了起来。不，或许是在我眼里一贯是那么有趣，但是我愿意多拍下来一些了。买了我最爱的 GR3，每天在口袋中，留下了很多很值得回忆的瞬间。对摄影的看法也发生了改变，从“记录”转向了“表达”，同样在这个时候，我开始自诩为“摄影师”了。</p><div style="width:100%; margin:auto"><img src="/life/2022-year-report/gr3.jpg" class=""></div><p>今年发了一条 B 站视频，我的第一条视频“洗猫”。想起来之前卖给我相机的那个人，他说他“本来是想立志做一个 up 主的”，最后也没能实现。做视频好像也有一丝意思，以后可以多进行尝试。今年的 Best of 2022 的摄影作品还没有整理出来，之后应该也会做成视频分享出来。</p><h2 id="读书">读书</h2><p>今年看了一些书，不多，但至少还是在读。印象深刻的有以下几本：《乌合之众》，《浪潮之巅》，《罪与罚》。自己读书好像一直都很功利，想着从书中直接获得可以拿来用的东西（结论），所以更偏好一些“工具类”书籍。比如从《乌合之众》中了解到了群体的运作模式，从《浪潮之巅》中了解到了互联网的发展历史，这些都是直接可以和现实社会的事件对应起来的，好读也好用。而《罪与罚》这种小说就难懂了很多，它需要理清繁琐的人物关系，否则难以读明白，更别说读懂。但是这部小说给我留下了很深的印象，或许是因为他通篇都是精神独白，我比较喜欢这种心理活动的描写。此外“自己认为的正义”和“正义”之间的关系，让我想起了老板对我的教诲“不要总是你觉得”，似乎很多事情都是相通的，过于关注自己好像并不是什么好事。</p><p>当然还有一些前一年就开始看的书，现在都没看完，罪过罪过。</p><h2 id="观影和视频">观影和视频</h2><p>相比往年，这一年好像没有看太多电影和剧，或许是因为的确没什么新电影，或许也是因为觉得看的太累。但是的确看了一些令人印象深刻的作品，包括电影、剧、还有一些其他视频作品。</p><p>《爱在三部曲》，的确给到我震撼，一部对话式的作品，让我意识到或许真的能遇到灵魂伴侣，或许真的有人会因为你是你而爱你。巧合式的相遇和剧情推进，过于浪漫温柔。无法抵抗浪漫和温柔。</p><p>《隐入尘烟》，是一部全网下架的片子，也是因为下架我才产生了兴趣拿来看看。这部电影的画面十分的美，色调和构图十分喜爱。至于剧情则有些压抑，主角有一种林冲式的悲剧，底层人民的厄运魔咒似乎无法通过乐观和勤劳逃脱。社会主义下不能这么惨，或许这就是被禁的原因吧。</p><p>《我的三体之章北海传》，是在看艺画开天的《三体》之后才接触了这个作品，基于“我的世界”拍摄。最大的感触是，不通过特效和噱头是可以吸引人的眼球把故事讲漂亮的。当然叫好和叫座或许大多时候都是冲突的。印象最深刻的可能还是北海的那一句“没关系的，都一样”。</p><p>《是，首相》真的是一部有趣的剧。俗话说“半部 YMP 治天下”，让人看到政治的荒诞与幽默。英式英语好像也很好听，汉皮真的很可爱。之后应该会认真学习一下。</p><p>《木鱼水心的水浒讲解》是木鱼水心 2022 年一整年的作品，的确能让人了解水浒的来龙去脉。我一直没有完整读过水浒（惭愧惭愧），算是对其了解甚微。这个系列着实给我补充了很多文学历史以及艺术知识。目前对《水浒》所描绘的那个世界充满了反感，所以看了一半暂停了观看，但是这个系列在我心中已经拥有了很高的评分。</p><h2 id="游戏">游戏</h2><p>好像是今年弃坑了原神，太非太累了，不过好像后面的剧情很不错，可以之后尝试下回来看看。此外还在 w2g 中用模拟器下载了塞尔达，但是好像心境与以前不同了，也很难玩下去，或许需要一段大块时间以及一个舒适的沙发吧。</p><p>断断续续的在玩王者，还是喜欢这种有选手参与感的游戏，可以贯彻我“与人斗其乐无穷”的理念。获得了两次五杀！喜爱上了新英雄，觉得获取了一些没有意义的成就感。</p><h2 id="个人管理">个人管理</h2><p>这一年搭建了一套 Flomo + Notion + Blog 的个人管理流。碎片信息放 Flomo，然后在 Notion 中整理培养，最后发布在 Blog 上。但是实践下来好像并没有像我设计之初预想的那样高效（抛去我懒的因素来说）。</p><p>Blog 成为了我的学习笔记发布中心，还有一些遇到小困难的解决过程记录本。没有宣传出去，有用的东西也很难帮到别人。此外建立之初我好像是想多加入一些我的思考和碎碎念，但是一直也没有实施太多，或许之后还是应该思考一下博客的定位。当然博客主题没那么好看也是我一直踌躇着不进行深度内容改版的原因，或许要先进行外观改版。</p><p>Notion 和 Flomo 的交互使用好像也没有那么顺畅，好像主要是因为我并没有那么愿意写和整理。此外即使有些东西想要认真写，想到最终发布在博客的流程较为繁琐（要用电脑 commit），就又忘记开始了。或许我需要一个动态的博客，还有一个实时的瀑布流动态功能。</p><h2 id="感情">感情</h2><p>因为比较重要所以放在最后写。这一年对于感情的心态有了较大的变化。在 2021 的上一段感情过后，认为现阶段可能并不适合恋爱，原因包括时间精力金钱等方面，但是或许最重要的还是心态。心态上我很怀疑会不会有人真的因为“你是你”而喜欢你，就像《爱在》里面一样。在我心中，这个答案很难说是肯定的，我觉得找到一个契合的灵魂或许是一件不可能的事情。此外虽然后面也谈了一些恋爱，但是好像很难走出第一段恋爱对自己造成的自我怀疑与否定，很多时候是我觉得我没事了，但是其实还是有事。所以好像回到了 2016 那种状态，自我怀疑与挣扎，但是那时候还有人会提醒我“我值得很好的”（我竟然还有截图我真牛逼），但这次好像只有我自己。</p><div style="width:100%; margin:auto"><img src="/life/2022-year-report/qb-chat.png" class=""></div><p>这种状态下我有在思考一段良好关系乃至婚姻的意义。一个人但凡活着总要有点事情做，不管是大事还是小事，不管是做一年还是一辈子。（如果一个人不做事，那这个人就不算一个社会学意义上的人。）在这个基础上，做事是会有挫折的，也是会有喜悦的，这个时候如果是一个人，挫折可能太大压垮了自己，喜悦也可能无人深度分享而快速消散。在这个情况下，人就需要一个战友，可以把自己的后背交给他，当你遇到挫折的时候他会支撑着你，当你们遇到快乐的时候会相互分享，有他的陪伴你可以更好地去做你的事情。这或许就是良好关系的意义所在。</p><!-- 但是这个战友好像太难找到了，我好像曾经拥有这么一个战友，但是关键时刻她还是会毅然决然的离开你。 --><!-- 所以我也在怀疑这种“因为你是你而产生的喜爱”关系的真实性和可获得性，同时也害怕费尽心机找一个人之后不合适再分开，未免有点过于难受。 --><!-- 那这种情况还不如找玩伴，大家为了自己的快乐而快乐，于是心态好像偏向了短择，觉得没必要敞开内心。 --><p>我很难相信能恰好遇到一个合适的战友。在这种情况下自己变得越来越自私和自我，对于索取的重视好像远超过了付出，可怕的是还不自知。这个好像就是传统意义上的“丧失了爱的能力”。</p><p>但有一天我意识到了一个道理“如果你害怕失败而不去开始而不去付出，那么可能永远找不到那个合适的人”。世界上虽然那么多人，但是和你相衬的已经很少了，如果抱着一个封闭的心态，很可能一辈子都无法找到这个人。一个人的离开其实恰恰说明了不合适，既然不是你的错，那么没有必要对自己“施加惩罚”，没必要这样对待自己。意识到这个之后，先前的阴影才完全消散，也那么恐惧和排斥一段关系了。于是认真的思索了我到底喜欢什么样的人，列了一个长长的单子，“这个人”好像过于完美，以至于我好像没有见过。和 hy 聊过这个单子，她看过之后说这么多年也只见过她老公一个这样的人（我谢谢你）。但是这个也进一步让我意识到，这样一个人是多么的难得，她不会从天上掉下来，应该主动的去寻找，去了解别人。</p><p>认识 wyc 应该是 2022 最值得记录的事情。也幸好自己反复思索过后跑回去索要了联系方式。前期好像并没有太多的交流，直到认识一周后的线下接触，发现我们有好多的“我也是”的相似点，相处的过程无比舒服。连续见了几天面，每一次都很轻松舒适，好像总有说不完的话，总想和她多待一些时间，每次分开自己都有点恋恋不舍。之后某一天，我突然想起我还有一个关于我喜欢什么样的人的长长的单子，回看发现这个人好像完美满足我的那一堆 cliche。那么难找到的那一个人，竟然被我找到了！相处了一段时间后，在圣诞节前后我们在一起了，并且有了久违的一种想要广而告之的感觉。单纯从要联系方式到熟识这一过程来看，好像认识她并不是一件稀奇或者困难的事情。但是考虑到这么长时间以来自己心态的转变和波动（再加上自己对自己“到底喜欢什么”了解的不断加深），才能发现遇到她这件事是多么的来之不易。和她度过了 2022 年的最后一天，在海边看了烟花，觉得生活十分美好。</p><!-- 珍贵的人我会好好去珍惜。 --><div style="text-align:center"><span style="width:48%;display:inline-block"><img src="/life/2022-year-report/together.jpg" class=""></span><span style="width:48%;display:inline-block"><img src="/life/2022-year-report/firework.jpg" class=""></span></div><h1>番外篇：一些碎碎念 Blah Blah</h1><ul><li>今年出现的 chatGPT 和 AI 作画真的让人惊叹！</li><li>发现了最爱的香水，“乔治勋爵的悲剧”！</li><li>这一年买卖了太多东西，咸鱼达人好吧。与人斗其乐无穷！</li><li>今年的年度之歌竟然是《Cornfield Chase》</li><li>第一次以产品经理的视角来参与 Moment 这件产品和相关讨论，发现好像这种事情过于简单（相比于科研）。</li><li>去了性教育展的集市很快乐，发现很多人不羞于谈论性。然而第二天就停展了。</li><li>又一次开始看老友记咯！</li><li>今年又做了很多有趣的梦！当然佩服自己的梦里的想象力。</li><li>觉得深圳真的是文化荒漠，一个人出门竟然想不到任何可以去的地方。（当然可能是我的原因）</li><li>勇士夺冠了！想到 2019 在英国大晚上爬起来看球的充满心塞的自己。</li><li>竟然很喜欢黄巢的反诗，“待到秋来九月八，我花开后百花杀。冲天香阵透长安，满城尽带黄金甲。”这也太酷了吧！</li><li>男女对立也太可怕了，真的可怕。看那些新闻真的悲哀与难过。</li></ul><h1>总结展望</h1><h2 id="一些遗憾">一些遗憾</h2><ul><li>主线任务完成得不够好吧，自己好像是一个总是迷失在支线里的人。</li><li>有一些人际关系没有处理好。</li></ul><!-- - 有一些人际关系没有处理好，主要可能是一些 date 的对象。 --><ul><li>好像也没有做多一些事情，也没有把做了的每一件事情做好。</li></ul><h2 id="立起新的-Flag">立起新的 Flag</h2><ul><li>希望明年能多写写做成了什么事。（大家还是要看结果的而不是过程）</li><li>希望能和 wyc 长久一些。（美好祝愿）</li><li>多邻国还是走下来了哦，希望今年把日语搞完。（我也不知道能不能搞完）</li><li>希望能坚持读书。</li><li>希望不要沉迷支线，多打打主线任务，做精做好。</li><li>希望能养成写总结的习惯，回顾起来应该挺有意思。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>年终总结</tag>
      
      <tag>生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>牛顿法（Newton&#39;s method）学习</title>
    <link href="/math/newtons-method/"/>
    <url>/math/newtons-method/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>牛顿法是一种在实数域和复数域上迭代近似求解方程的方法。此处做一个简单的学习。</p><span id="more"></span><h2 id="牛顿法能做什么？直观上怎么做的？">牛顿法能做什么？直观上怎么做的？</h2><p>一般来说，牛顿法主要用在两个方面:</p><ol><li>求方程的根：通过当前解与函数的切线在 x 轴的交点迭代更新解值，以求得方程的解。</li><li>最优化：最优化问题通常可以理解为求函数导数的解（导数值为0），则可以使用 1 中求方程的根的方法。</li></ol><p>一个简单的过程示意图如下所示：</p><div style="width:60%;margin:auto"><img src="/math/newtons-method/example.gif" class=""></div><h2 id="具体来说怎么做？">具体来说怎么做？</h2><p>求解方程时，迭代更新 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mfrac><mrow><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">x_{n+1}=x_n-\frac{f\left(x_n\right)}{f^{\prime}\left(x_n\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>最优化时，迭代更新 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mfrac><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow><mrow><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">x_{n+1}=x_n-\frac{f^{\prime}\left(x_n\right)}{f^{\prime \prime}\left(x_n\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3649em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4289em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h2 id="有什么特点？">有什么特点？</h2><p>牛顿法最突出的优点是收敛速度快，具有局部二阶收敛性。通俗来说梯度下降法每次只从你当前所处位置选一个坡度最大的方向走一步，而牛顿法在选择方向时，不仅会考虑坡度是否够大，还会考虑你走了一步之后，坡度是否会变得更大。所以，可以说牛顿法比梯度下降法看得更远一点，能更快地走到最底部。</p><h2 id="有什么局限性？">有什么局限性？</h2><ol><li>基本牛顿法初始点需要足够“靠近”极小点，否则有可能导致算法不收敛。这样就引入了全局牛顿法。</li><li>在牛顿法的迭代中，需要计算海森矩阵（函数的二阶导数）的逆矩阵，这一计算比较复杂，这样就引入了拟牛顿法，用一个矩阵来替代。<ul><li>DFP(Davidon-Fletcher-Powell)算法(DFP algorithm)</li><li>BFGS(Broyden-Fletcher-Goldfard-Shano)算法(BFGS algorithm)</li><li>Broyden类算法(Broyden’s algorithm)</li></ul></li></ol><h2 id="Reference">Reference</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/37524275">梯度下降法、牛顿法和拟牛顿法 - Eureka的文章 - 知乎</a></li><li><a href="https://zh.m.wikipedia.org/zh-hans/%E7%89%9B%E9%A1%BF%E6%B3%95">牛顿法</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Math</category>
      
    </categories>
    
    
    <tags>
      
      <tag>optimization</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>罪与罚</title>
    <link href="/reading-note/crime-and-punishment/"/>
    <url>/reading-note/crime-and-punishment/</url>
    
    <content type="html"><![CDATA[<p>文学著作，在世界文坛有着极高的地位。</p><span id="more"></span><h2 id="作者">作者</h2><p>俄国作家陀思妥耶夫斯基。其有着西伯利亚长达十年的流亡经验。</p><h2 id="极简简介">极简简介</h2><p>这本书被罗翔老师在多个场合无数次的反复提到。这本小说讲述了一个青年犯罪者拉斯科尔尼科夫杀人以及之后的心路历程，并最终到警局自首的故事。</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>第一次见到心理活动描写如此密集细腻的文学作品，让我这个对人感兴趣的读者感到十分过瘾。无数的内心独白仿佛真的是写出了一个真实的善恶交织的有点拧巴的人。书名中的罪是杀人罪，而罚更多的是来源于内心的痛苦，良心的折磨，这一点描写得十分清楚。人物的心理转变及其有意思，从一个极度自我的视角，到慢慢发现了这个视角存在的问题，即“不是任何事物都是为自己存在的”，而有些美好善良的人和品质是客观独立存在且不为自己意志为所有的。那种基于“自我世界”的理论构建过程似乎能引起很多人的共鸣，同时这套理论的解体过程也能引发大家的思考。</p><p>人物关系十分复杂，人名繁多，在俄语中一个人有三个名字，而我又是断断续续读书，所以人物关系初读有点混乱。</p><h3 id="感想-看法">感想/看法</h3><ul><li>初读此书十分震撼。“杀人”这种事竟然可以在自我体系下逻辑自洽。可怕的是现实中有此类逻辑的人并不少，或许并未上升到烧杀掠抢的层级，但是在自己的逻辑圈里，他们的行为永远是合理且不容他人质疑的。</li><li>小说中其实提出了一个“超人有权“跨越”法律或道德界限”观点，然后以罗季昂为例来佐证这个观点的不合理之处，这种叙事方式很有意思。</li><li>心理上的痛苦带来了生理上的痛苦，这个在主人公的行为刻画上体现的很明显。至少从这个角度看，如果真的做了极其不道德或者极其令人惊恐的事，还是会很大程度上从生理上表现出来。</li><li>索尼娅如此正直美好纯洁的人真的是天使啊！虽然在现实中不相信这种以德报怨，坦然接受不公的人的存在，但是还是希望身边能有这样一个人。这样的人总是能让你看到世界的美好，让你走在不错误的道路上。希望每个人都能有自己的索尼娅。</li><li>同样是被社会压迫，罗季昂和索尼娅有着完全不同的反应，比较有趣，也比较现实。好奇这种差异性是如何诞生的。</li><li>波尔菲里这个人也比较有意思，最开始咄咄逼人希望使别人认罪，但是后来真诚劝说希望别人认罪。算是很有事业心的人了哈哈。</li><li>从“罪与罚”这三个字来看，社会中，很多人犯罪，罚的却是其他人通常是长年累月心理上的折磨，他们本身是否受到心灵上的自我问询有待怀疑。例如美国那些变态杀人狂。</li><li>思考人为什么会去犯罪呢？浅问一下，是因为自身还是因为社会呢？或许还是因为个人吧，如果全归结于社会的话，人就没有责任一说了。一个没有责任的人难以认为是一个健全人。同时归结于社会也不现实，毕竟建立一个象牙塔乌托邦的社会并不实际。</li><li>最重要的一点，不要陷入自己的逻辑自洽，不要骗了自己。要努力走出自我，走出自己的不能证伪的逻辑圈。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>训练集样本对于测试集 loss 的影响</title>
    <link href="/machine-learning/loss-gradient/"/>
    <url>/machine-learning/loss-gradient/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>主动学习中通常要评估样本的重要性/信息量，以选择最有价值样本使得模型提升最大。这一点在样本可解释性中也有体现，即“什么样的样本对于训练来说更加重要？”本文是几篇论文【1，2】的阅读笔记，从梯度的角度阐释样本对于最终测试集表现的影响。</p><span id="more"></span><h2 id="训练样本如何影响测试表现【2】">训练样本如何影响测试表现【2】</h2><p>自然的，去掉一个样本带来的参数变化可以写作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mi>z</mi></mrow></msub><mo>−</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\theta}_{-z}-\hat{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1662em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9579em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>，其中</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mi>z</mi></mrow></msub><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>θ</mi><mo>∈</mo><mi mathvariant="normal">Θ</mi></mrow></munder><munder><mo>∑</mo><mrow><msub><mi>z</mi><mi>i</mi></msub><mo mathvariant="normal">≠</mo><mi>z</mi></mrow></munder><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>θ</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\theta}_{-z} \stackrel{\text { def }}{=} \arg \min _{\theta \in \Theta} \sum_{z_i \neq z} L\left(z_i, \theta\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3613em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4882em;vertical-align:-1.4382em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="mrel mtight">∈</span><span class="mord mtight">Θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7795em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>但是对于每一个样本而言，我们不可能总是去掉它并重新训练一个模型。于是我们可以从 influence function 的角度来理解这个问题。即计算样本权重变化一个很小的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> 时所带来的参数变化（原始权重为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>），在这种情况下</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>θ</mi><mo>∈</mo><mi mathvariant="normal">Θ</mi></mrow></munder><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>θ</mi><mo fence="true">)</mo></mrow><mo>+</mo><mi>ϵ</mi><mi>L</mi><mo stretchy="false">(</mo><mi>z</mi><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{\theta}_{\epsilon, z} \stackrel{\text { def }}{=} \arg \min _{\theta \in \Theta} \frac{1}{n} \sum_{i=1}^n L\left(z_i, \theta\right)+\epsilon L(z, \theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4391em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="mrel mtight">∈</span><span class="mord mtight">Θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7795em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span></p><p>此时将样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> 在参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> 上权重增大 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> 时所带来的 influence 写作</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mrow><msub><mi mathvariant="script">I</mi><mtext>up,params </mtext></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mfrac><mrow><mi>d</mi><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub></mrow><mrow><mi>d</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">∣</mo></mrow><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><mo>−</mo><msubsup><mi>H</mi><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mo stretchy="false">(</mo><mi>z</mi><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\left.\mathcal{I}_{\text {up,params }}(z) \stackrel{\text { def }}{=} \frac{d \hat{\theta}_{\epsilon, z}}{d \epsilon}\right|_{\epsilon=0}=-H_{\hat{\theta}}^{-1} \nabla_\theta L(z, \hat{\theta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0497em;vertical-align:-1.2997em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">up,params </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6349em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">ϵ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.333em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='3.000em' viewBox='0 0 333 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.8486em;"><span style="top:-1.4003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4337em;vertical-align:-0.4758em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.2242em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span><span style="top:-2.9634em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4758em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mover accent="true"><mi>θ</mi><mo>^</mo></mover></msub><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi mathvariant="normal">∇</mi><mi>θ</mi><mn>2</mn></msubsup><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">H_{\hat{\theta}} \stackrel{\text { def }}{=} \frac{1}{n} \sum_{i=1}^n \nabla_\theta^2 L\left(z_i, \hat{\theta}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4787em;vertical-align:-0.3257em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3743em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span><span style="top:-2.9634em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3257em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span> 是正定的 Hessian 矩阵。在训练集中去掉 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> 点就相当于将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> 设为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">-\frac{1}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，那么参数的变化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mi>z</mi></mrow></msub><mo>−</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\theta}_{-z}-\hat{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1662em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9579em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span> 则可在不重训练模型的情况下近似为 $ -\frac{1}{n} \mathcal{I}_{\text {up,params }}(z)$.这样在更改 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> 权重的情况下，对于一个测试样本的影响的解析解可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="script">I</mi><mrow><mtext>up </mtext><mo separator="true">,</mo><mtext> loss </mtext></mrow></msub><mrow><mo fence="true">(</mo><mi>z</mi><mo separator="true">,</mo><msub><mi>z</mi><mtext>test </mtext></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mrow><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mfrac><mrow><mi>d</mi><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>z</mi><mtext>test </mtext></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><mrow><mi>d</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">∣</mo></mrow><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mrow><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msub><mi>z</mi><mtext>test </mtext></msub><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><mfrac><mrow><mi>d</mi><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub></mrow><mrow><mi>d</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">∣</mo></mrow><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msub><mi>z</mi><mtext>test </mtext></msub><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mo stretchy="false">(</mo><mi>z</mi><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \mathcal{I}_{\text {up }, \text { loss }}\left(z, z_{\text {test }}\right) &amp;\left.\stackrel{\text { def }}{=} \frac{d L\left(z_{\text {test }}, \hat{\theta}_{\epsilon, z}\right)}{d \epsilon}\right|_{\epsilon=0} \\ &amp;=\left.\nabla_\theta L\left(z_{\text {test }}, \hat{\theta}\right)^{\top} \frac{d \hat{\theta}_{\epsilon, z}}{d \epsilon}\right|_{\epsilon=0} \\ &amp;=-\nabla_\theta L\left(z_{\text {test }}, \hat{\theta}\right)^{\top} H_{\hat{\theta}}^{-1} \nabla_\theta L(z, \hat{\theta}) . \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.7785em;vertical-align:-4.6392em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.1392em;"><span style="top:-7.1392em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">up </span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight"> loss </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.4895em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"></span></span><span style="top:-0.5008em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.6392em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.1392em;"><span style="top:-7.1392em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em;"><span style="top:-2.464em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">ϵ</span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.19em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.333em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='3.600em' viewBox='0 0 333 3600'><path d='M145 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v2400 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-1.1486em;"><span style="top:-1.1003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5997em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.4895em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.389em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6349em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">ϵ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.333em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='3.000em' viewBox='0 0 333 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.8486em;"><span style="top:-1.4003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2997em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.5008em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.389em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.2242em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span><span style="top:-2.9634em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4758em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.6392em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="主动学习中对这一结论的运用【1】">主动学习中对这一结论的运用【1】</h2><p>依赖上一节中的影响力估计，训练集中样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 对测试集中样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">x_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 在损失上的影响为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mtext>loss</mtext></msub><mrow><mo fence="true">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">I_{\text{loss}}\left(x, x_j\right)=\frac{1}{n} \nabla_\theta L\left(f_\theta\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(f_\theta(x)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">loss</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>那么在整个测试集的总影响可以写作</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>I</mi><mtext>loss</mtext></msub><mrow><mo fence="true">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munder><mo>∑</mo><mi>j</mi></munder><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_j I_{\text{loss}}\left(x, x_j\right)=\frac{1}{n} \sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">loss</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7352em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">T^{c+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 是在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 个循环过后的模型。尽管单一样本可能对某一测试样本有副作用，但是总体来说训练样本对于整个测试集的影响是正面的。那么，在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 个循环中移除一个训练样本，得到的测试集损失则变为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>L</mi><mtext>test</mtext><mrow><mo mathvariant="normal">′</mo><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>I</mi><mtext>loss </mtext></msub><mrow><mo fence="true">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munder><mo>∑</mo><mi>j</mi></munder><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} L_{\text {test}}^{\prime c+1} &amp;=L_{\text {test }}^{c+1}+\sum_j I_{\text {loss }}\left(x, x_j\right) \\ &amp;=L_{\text {test }}^{c+1}+\frac{1}{n} \sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.799em;vertical-align:-2.6495em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.1495em;"><span style="top:-5.4209em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.3857em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.6495em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.1495em;"><span style="top:-5.4209em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">loss </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-2.3857em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.6495em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>由于测试集样本未知，即无法直接得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>j</mi></msub><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5248em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.089em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.3987em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span>。所以我们同时在等式两边取 Frobenius Norm，得到</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>L</mi><mtext>test</mtext><mrow><mo mathvariant="normal">′</mo><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">∥</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munder><mo>∑</mo><mi>j</mi></munder><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><mo>⋅</mo><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} L_{\text {test}}^{\prime c+1} &amp;=\left\|L_{\text {test }}^{c+1}+\frac{1}{n} \sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right)\right\| \\ &amp; \leq L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right)\right\| \\ &amp;=L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\nabla_\theta L\left(T^{c+1}(x)\right)^{\top} \sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\| \\ &amp; \leq L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\nabla_\theta L\left(T^{c+1}(x)\right)\right\| \cdot\left\|\sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\| \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:13.855em;vertical-align:-6.6775em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.1775em;"><span style="top:-9.1775em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.7138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span><span style="top:1.2138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.6775em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.1775em;"><span style="top:-9.1775em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-5.7138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span><span style="top:1.2138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.6775em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>而对于一个固定的测试集来说，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∥</mo><msub><mo>∑</mo><mi>j</mi></msub><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><annotation encoding="application/x-tex">\left\|\sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.556em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.800em' viewBox='0 0 556 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43zM367 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.3987em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.556em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.800em' viewBox='0 0 556 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43zM367 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span></span> 可以看做一个不变项。所以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mtext>test</mtext><mrow><mo mathvariant="normal">′</mo><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">L_{\text {test}}^{\prime c+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2458em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4542em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2458em;"><span></span></span></span></span></span></span></span></span></span> 的上界主要依赖于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><annotation encoding="application/x-tex">\left\|\nabla_\theta L\left(T^{c+1}(x)\right)\right\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span></span></span></span>。但是在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 个循环，模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">T^{c+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 不可知，所以使用模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mi>c</mi></msup></mrow><annotation encoding="application/x-tex">T^{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span></span></span></span> 来做一个近似，即</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>L</mi><mtext>test</mtext><mrow><mo mathvariant="normal">′</mo><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><mo>⋅</mo><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≲</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><mo>⋅</mo><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} L_{\text {test}}^{\prime c+1} &amp; \leq L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\nabla_\theta L\left(T^{c+1}(x)\right)\right\| \cdot\left\|\sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\| \\ &amp; \lesssim L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\nabla_\theta L\left(T^c(x)\right)\right\| \cdot\left\|\sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\| \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.9275em;vertical-align:-3.2138em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.7138em;"><span style="top:-5.7138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.2138em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.7138em;"><span style="top:-5.7138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">≲</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∥</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">∥</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.2138em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>那么在主动学习的范畴下，更高的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><annotation encoding="application/x-tex">\left\|\nabla_\theta L\left(T^{c}(x)\right)\right\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∥</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">∥</span></span></span></span></span> 可以使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">L_{\text {test }}^{c+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2458em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4542em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2458em;"><span></span></span></span></span></span></span></span></span></span> 的上界更低。所以应当选择梯度范数更低的样本。</p><p>具体梯度的计算需要通过 loss function 使用反向传播。然而具体的真实标记并未获得，所以需要特地设计损失函数来计算梯度。文章中提到了两种梯度的计算，第一种是 Expected-Gradnorm Scheme</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>L</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow></msub><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>∣</mo><mi>x</mi><mo fence="true">)</mo></mrow><msub><mi>L</mi><mi>i</mi></msub><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}L_{exp}\left(T^c(x)\right)=\sum_{i=1}^N P\left(y_i \mid x\right) L_i\left(T^c(x), y_i\right)\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.303em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.803em;"><span style="top:-3.803em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.303em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.803em;"><span style="top:-3.803em;"><span class="pstrut" style="height:3.8283em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.303em;"><span></span></span></span></span></span></span></span></span></p><p>另一种是 Entropy-Gradnorm Scheme</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>L</mi><mrow><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>∣</mo><mi>x</mi><mo fence="true">)</mo></mrow><mi>log</mi><mo>⁡</mo><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>∣</mo><mi>x</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}L_{e n t}\left(T^c(x)\right)=-\sum_{i=1}^N P\left(y_i \mid x\right) \log P\left(y_i \mid x\right)\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.303em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.803em;"><span style="top:-3.803em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.303em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.803em;"><span style="top:-3.803em;"><span class="pstrut" style="height:3.8283em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.303em;"><span></span></span></span></span></span></span></span></span></p><h2 id="主动学习相关">主动学习相关</h2><p>当然也有很多其他的主动学习工作使用到了梯度，但是他们考虑问题的入手角度不同。本文介绍的这种通过梯度的评估本质上是考虑其对测试误差的提升。而其他的基于梯度方法通常是来评估样本对模型可能带来多大的改变，比如 EGL 和 BADGE。尤其是 EGL，在形式上和本文介绍的方法很相似，不同的是其仅计算最后一层的梯度。</p><h2 id="一些数学基础：Hessian-矩阵">一些数学基础：Hessian 矩阵</h2><p>黑塞/海森矩阵是在求多元函数的所有二阶偏导数。具体来说，假设有一个实值函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">f\left(x_1, x_2, \ldots, x_n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>，其所有的二阶偏导数在定义域内连续，那么函数的黑塞矩阵为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="bold">H</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>x</mi><mi>n</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\mathbf{H}=\left[\begin{array}{cccc}\frac{\partial^2 f}{\partial x_1^2} &amp; \frac{\partial^2 f}{\partial x_1 \partial x_2} &amp; \cdots &amp; \frac{\partial^2 f}{\partial x_1 \partial x_n} \\\frac{\partial^2 f}{\partial x_2 \partial x_1} &amp; \frac{\partial^2 f}{\partial x_2^2} &amp; \cdots &amp; \frac{\partial^2 f}{\partial x_2 \partial x_n} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\\frac{\partial^2 f}{\partial x_n \partial x_1} &amp; \frac{\partial^2 f}{\partial x_n \partial x_2} &amp; \cdots &amp; \frac{\partial^2 f}{\partial x_n^2}\end{array}\right]\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.7986em;vertical-align:-3.1493em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-5.6493em;"><span class="pstrut" style="height:5.6493em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.55em;"><span style="top:-5.55em;"><span class="pstrut" style="height:8.6em;"></span><span style="width:0.667em;height:6.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.600em' viewBox='0 0 667 6600'><path d='M403 1759 V84 H666 V0 H319 V1759 v3000 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v3000 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.05em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-6.2668em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.6264em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051em;"><span style="top:-2.1885em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3115em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5916em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6051em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.5134em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.0834em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-6.2668em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6051em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.6264em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051em;"><span style="top:-2.1885em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3115em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5916em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.5134em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.0834em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-6.0793em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span style="top:-4.4176em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span style="top:-2.3259em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-0.8959em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-6.2668em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6051em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.5134em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.0834em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.214em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5452em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.55em;"><span style="top:-5.55em;"><span class="pstrut" style="height:8.6em;"></span><span style="width:0.667em;height:6.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.600em' viewBox='0 0 667 6600'><path d='M347 1759 V0 H0 V84 H263 V1759 v3000 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v3000 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.05em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-5.6493em;"><span class="pstrut" style="height:5.6493em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span></span></span></span></p><p>用下标记号表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathbf{H}_{i j}=\frac{\partial^2 f}{\partial x_i \partial x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9722em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6123em;vertical-align:-0.5423em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。</p><p>可以在泰勒展开中理解这个矩阵。在一元函数中，泰勒展开式为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo>+</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>+</mo><mfrac><mrow><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow></mrow><mrow><mn>2</mn><mo stretchy="false">!</mo></mrow></mfrac><mi mathvariant="normal">Δ</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">f(x)=f\left(x_0\right)+f^{\prime}\left(x_0\right) \Delta x+\frac{f^{\prime \prime}\left(x_0\right)}{2 !} \Delta x^2+\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.1149em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4289em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.313em;"></span><span class="minner">⋯</span></span></span></span></span></p><p>相应的，在多元函数中</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo>+</mo><mi mathvariant="normal">∇</mi><mi>f</mi><msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">T</mi></msup><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant="normal">Δ</mi><msup><mi>x</mi><mi mathvariant="normal">T</mi></msup><mi mathvariant="bold">H</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>+</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">f(x)=f\left(x_0\right)+\nabla f\left(x_0\right)^{\mathrm{T}} \Delta x+\frac{1}{2} \Delta x^{\mathrm{T}} \mathbf{H}\left(x_0\right) \Delta x+\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2312em;vertical-align:-0.25em;"></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span class="mord mathbf">H</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.313em;"></span><span class="minner">⋯</span></span></span></span></span></p><h2 id="Reference">Reference</h2><ol><li>Wang, Tianyang, et al. “Boosting active learning via improving test performance.” Proceedings of the AAAI Conference on Artificial Intelligence. Vol. 36. No. 8. 2022.</li><li>Koh, Pang Wei, and Percy Liang. “Understanding black-box predictions via influence functions.” International conference on machine learning. PMLR, 2017.</li><li><a href="https://en.wikipedia.org/wiki/Hessian_matrix">https://en.wikipedia.org/wiki/Hessian_matrix</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>loss</tag>
      
      <tag>gradient</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习中的 Lipschitz Continuity</title>
    <link href="/machine-learning/lipschitz-in-ml/"/>
    <url>/machine-learning/lipschitz-in-ml/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>在 discriminator 的学习使用中，经常会见到这个 Lipschitz Condition，在此处做一个学习。</p><span id="more"></span><h2 id="Lipschitz-Continuity">Lipschitz Continuity</h2><p>Lipschitz Continuous 是比可微分更严格的条件，这个性质限制了函数的微分值必须有上下限。换句话说，目标函数会被一个一次函数上下夹逼，如下图所示。</p><div style="width:50%;margin:auto"><img src="/machine-learning/lipschitz-in-ml/Lipschitz_Visualisierung.gif" class=""></div><p>以公式的形式展开，函数需要满足以下条件：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∥</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><mo>⩽</mo><mi>L</mi><mi mathvariant="normal">∥</mi><mi>x</mi><mo>−</mo><mi>y</mi><mi mathvariant="normal">∥</mi></mrow><annotation encoding="application/x-tex">\|f(x)-f(y)\| \leqslant L\|x-y\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord">∥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord">∥</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∥</span></span></span></span></span></p><h2 id="为什么会在机器学习中使用？">为什么会在机器学习中使用？</h2><p>本人目前见到过的使用地点多在 discriminator 相关工作中。Discriminator 在 GAN 相关模型中是一个必要的结构，在域迁移的模型中也多有使用。其作用是将真实样本与虚假样本分开，之后在将其固定来训练生成器使得判别器无法将虚假样本分开。</p><p>当下 GAN 可以生成足以骗过人类的高质量图像，但是其训练过程的不稳定仍然是一个具有挑战性的问题。因此，一系列的研究工作都着眼于解决不稳定训练的问题。WGAN 中使用 wasserstein distance 来代替原始 GAN 中的分类损失，效果良好。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">(</mo><msub><mi>P</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>P</mi><mi>g</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><munder><mrow><mi>inf</mi><mo>⁡</mo></mrow><mrow><mi>γ</mi><mo>∈</mo><mo>∏</mo><mrow><mo fence="true">(</mo><msub><mi>P</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>P</mi><mi>g</mi></msub><mo fence="true">)</mo></mrow></mrow></munder><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∼</mo><mi>γ</mi></mrow></msub><mo stretchy="false">[</mo><mi mathvariant="normal">∥</mi><mi>x</mi><mo>−</mo><mi>y</mi><mi mathvariant="normal">∥</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\left(P_r, P_g\right)=\inf _{\gamma \in \prod\left(P_r, P_g\right)} \mathbb{E}_{(x, y) \sim \gamma}[\|x-y\|]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7383em;vertical-align:-0.9883em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.309em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span><span class="mrel mtight">∈</span><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∏</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9883em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord">∥</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∥</span><span class="mclose">]</span></span></span></span></span></p><p>但是由于这个形式十分难以求解，所以将该优化问题转换为以下形式。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>W</mi><mrow><mo fence="true">(</mo><msub><mi>P</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>P</mi><mi>θ</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><munder><mrow><mi>sup</mi><mo>⁡</mo></mrow><mrow><mi mathvariant="normal">∥</mi><mi>f</mi><msub><mi mathvariant="normal">∥</mi><mi>L</mi></msub><mo>≤</mo><mi>K</mi></mrow></munder><msub><mi mathvariant="double-struck">E</mi><mrow><mi>x</mi><mo>∼</mo><msub><mi>P</mi><mi>r</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>x</mi><mo>∼</mo><msub><mi>P</mi><mi>θ</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">W\left(P_r, P_\theta\right)=\sup _{\|f\|_L \leq K} \mathbb{E}_{x \sim P_r}[f(x)]-\mathbb{E}_{x \sim P_\theta}[f(x)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.9104em;vertical-align:-1.1604em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em;"><span style="top:-2.1146em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∥</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mtight"><span class="mord mtight">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span><span class="mrel mtight">≤</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">sup</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1604em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0059em;vertical-align:-0.2559em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2559em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span></span></span></span></span></p><p>这个转化通过对判别器应用正则化或归一化，将判别器形式化定义为一个利普希茨连续的函数（Lipschitz continuous function），其利普希茨常数为 K。这样，在不大幅度牺牲判别器性能的条件下，判别器的梯度空间会变得更平滑，可以更加稳定的训练。在此技术上，有谱归一化和梯度归一化等工作。</p><h2 id="Reference">Reference</h2><ul><li><a href="https://mp.weixin.qq.com/s/V7DzjtidOI6ohocRgAgUEA?">舍弃谱归一化，这篇ICCV’21论文用梯度归一化训练GAN，效果极好</a></li><li><a href="https://blog.csdn.net/c9Yv2cf9I06K2A9E/article/details/83112332">深度学习中的Lipschitz约束：泛化与生成模型</a></li><li><a href="https://ai.stackexchange.com/questions/29904/what-is-lipschitz-constraint-and-why-it-is-enforced-on-discriminator">What is Lipschitz constraint and why it is enforced on discriminator?</a></li><li><a href="https://www.cnblogs.com/wonderlust/p/15767225.html">Spectral Normalization 谱归一化-原理及实现</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>theory</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LSTM</title>
    <link href="/machine-learning/lstm/"/>
    <url>/machine-learning/lstm/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>最近用到的 ASP-MTL 模型中使用 LSTM 作为特征提取器。自己对于 RNN 的认知很不成体系，在此进行一个梳理。对 LSTM 来做一个学习，主要针对结构和预测两方面。</p><span id="more"></span><h2 id="RNN">RNN</h2><p>Recurrent Neural Networks（RNN）指循环神经网络，用来处理序列数据。每一个时刻的输出或中间信息会被传递到下一个时刻作为一部分输入，以保留时序信息。具体模式如下图所示。</p><div style="width:80%;margin:auto"><img src="/machine-learning/lstm/RNN-unrolled.png" class="" title="一个 RNN 示例"></div><p>其中处理以往和当前信息的结构十分简单，以一个 tanh 来合并。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/simpleRNN.png" class="" title="简单 RNN 内部结构示例"></div><h2 id="LSTM">LSTM</h2><p>经典的 RNN 存在难以解决长距离依赖（long-term dependency）的问题，即时序上距离过远的相关信息难以被学到。于是 LSTM 模型被提出，其包含了一个记录长效信息的模块。LSTM 的结构如下图所示。最主要的核心观点是维护一个 cell state（细胞状态），以使得信息跨时序传输。当然这里个人认为翻译成“牢房”更为贴切。不同于简单的 RNN 中只有一个神经网络，LSTM 中含有四个主要的神经网络（门结构）。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/lstm.png" class="" title="LSTM 内部结构示例"></div><p>遗忘门决定要从细胞状态中舍弃什么信息。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/LSTM3-focus-f.png" class="" title="遗忘门"></div><p>输入门决定保存哪些新信息进入细胞状态。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/LSTM3-focus-i.png" class="" title="输入门"></div><p>旧的状态 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">C_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 先 forget 再 input 得到新的状态 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">C_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/LSTM3-focus-C.png" class="" title="细胞状态更新"></div><p>输出一个“过滤”后的细胞状态。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/LSTM3-focus-o.png" class="" title="输出门"></div><h3 id="模型训练">模型训练</h3><p>先由正向传播，算出最终的损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span>，再反向计算梯度即可。详细的正向过程可见【2】。反向过程可见【3】。值得注意的是，反向过程的梯度更新需要考虑每一个时间步的输出。</p><h2 id="Reference">Reference</h2><ol><li><a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">Understanding LSTM Networks</a></li><li><a href="https://zhuanlan.zhihu.com/p/83496936">人人都能看懂的LSTM介绍及反向传播算法推导 - 陈楠的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/54775438">RNN之随时间反向传播BPTT推导细节，从公式中理解RNN梯度消失与梯度爆炸原因 - 塞巴斯万隆的文章</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>rnn</tag>
      
      <tag>lstm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>神经网络计算复杂度与硬件算力</title>
    <link href="/machine-learning/computational-complexity/"/>
    <url>/machine-learning/computational-complexity/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>深度学习计算量/复杂度相关知识。个人在此方面的知识较少，导致上周高性能计算的讲座好多都没有听懂，在此做一个学习。</p><span id="more"></span><h2 id="一些基础概念">一些基础概念</h2><p>首先介绍一些概念：</p><ul><li>FLOPS：floating point operations per second 的缩写，意指每秒浮点运算次数，理解为计算速度，是衡量硬件性能的指标。（常与 FLOPs 混淆）</li><li>FLOPs：floating point operations 的缩写，意指浮点运算数，理解为计算量，可以用来衡量算法/模型的复杂度。</li><li>MACs：multiply–accumulate operations，意为乘加计算数，通常与 FLOPs 存在一个两倍的关系。</li></ul><p>关于什么是浮点数可以看这篇文章【2】，个人觉得深入浅出写的比较清晰。</p><h2 id="如何计算">如何计算</h2><p>其实就是计算有多少次运算，对于不同的模型结构计算数目不同。此处不涉及具体公式，仅介绍 FLOPs 计算思路，MACs（又乘又加）的话通常为 FLOPs 的两倍左右。</p><ol><li>卷积层：在卷积层参数数目的基础上乘以输出的 feature map 大小（输出的每一个 feature 都是通过一次卷积层得到的）。</li><li>全联接层：即为全联接层参数数目。</li><li>激活层：不同激活函数的计算量不同。通常来说不重点计算。</li></ol><h2 id="Reference">Reference</h2><ol><li><a href="https://www.zhihu.com/question/65305385/answer/451060549">CNN 模型所需的计算力（flops）和参数（parameters）数量是怎么计算的？ - 泓宇的回答</a></li><li><a href="https://www.zhihu.com/question/425741425/answer/2584045783">浮点数浮点型到底是什么，能说的简单一点吗，就是用高中生能理解的语言。它们的作用是什么？ - 木木的回答</a></li><li><a href="https://blog.csdn.net/weixin_39833897/article/details/105807172">CNN的参数量、计算量（FLOPs、MACs）与运行速度</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>deep-learning</tag>
      
      <tag>high-performance-computing</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>再次学习强化学习的笔记</title>
    <link href="/machine-learning/re-learn-RL/"/>
    <url>/machine-learning/re-learn-RL/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>距离上一次学习强化学习已经很久了。最近由于 learning to optimize 用到了很多强化学习的知识，猛的一看发现又不太懂，于是这里进行对于强化学习的再学习。上一次对强化学习的学习见<a href="/machine-learning/reinforcement-learning/" title="这一篇帖子">这一篇帖子</a>。</p><span id="more"></span><p>总的来说，上次对于强化学习的理解过于浅薄，而且并没有从一个系统性和直观的角度进行理解，导致抄了一堆公式也是白抄。本文主要以一个直观的角度来对一个重要算法在整个体系中存在的位置做一个定位，不会过多陷入数学计算。</p><h2 id="什么是强化学习？（一些基础知识）">什么是强化学习？（一些基础知识）</h2><p>强化学习目标是学到一个对于目标任务的策略 policy (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span>)，给定一个当前的状态 state (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>)，策略可以给出当前应该执行的策略 action (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>) 以获得最大收益。</p><p>此外还有以下一些概念：</p><ul><li>Value 价值：一般单独提到时指的是当前状态的价值。</li><li>Q-value 动作价值：指在某一个状态 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 下实施动作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> 所能收获的收益。</li><li>Model 模型：指状态转移的模式，即环境对于特定的动作如何反应。</li><li>Return 回报：指在整个交互结束之后能收到的总奖励。</li></ul><h2 id="最初的方法：-Q-Leaning-Policy-Gradient">最初的方法： Q-Leaning &amp; Policy Gradient</h2><p>我们这里还是更多的介绍一下 model-free 的场景。具体来说，我们对环境提供的状态转移无知，并且我们不对其进行建模。在这种情况下，我们想要学习一个策略，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>→</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">\pi(s)\rightarrow a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>，可以有两种方式：</p><ol><li>学习不同状态下的 Q-value，并对其进行建模。建模成功之后即可选取在当前 state 下 Q-value 最大的 action 实施。</li><li>直接学习策略 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span>，则可直接输入 state，得到 action。</li></ol><p>那么两者各有什么特点呢？</p><ol><li>Q-learning 以值为基础，可以使用时序差分（temporal-difference）的思路，使效用估计朝着理想均衡方向调整，可以进行单步更新。但是由于其离散化的特点，如果在连续空间中进行选择，则会瘫痪。</li><li>Policy gradient 可以在毫不费力地在连续空间中进行选择，但是因为其是基于 Monte-Carlo 采样得到的评估，必须等一个回合结束后才可以更新，学习效率低。</li></ol><div style="width:90%;margin:auto"><img src="/machine-learning/re-learn-RL/TD_MC_backups.png" class=""></div><h2 id="结合两者的优点-Actor-Critic">结合两者的优点 Actor-Critic</h2><p>Policy gradient 使用现实中的奖惩来更新 actor。此时的梯度可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><msub><mi>E</mi><mrow><mi>τ</mi><mo>∼</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo fence="true">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla \bar{R}_\theta=E_{\tau \sim p_\theta(\tau)}\left[R(\tau) \nabla \log p_\theta(\tau)\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701em;vertical-align:-0.15em;"></span><span class="mord">∇</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mord">∇</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span></span></p><p>这个 reward 奖惩信息 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 可以被学出来，作为一个 critic 来来指导 actor 训练。Critic 可以看到当前所处状态动作的潜在奖励，所以可以使得 actor 每一步都在更新，而不是到回合结束才能更新。AC 中的梯度可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>n</mi></msub></munderover><msup><mi>Q</mi><msub><mi>π</mi><mi>θ</mi></msub></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo>∣</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla \bar{R}_\theta=\frac{1}{N} \sum_{n-1}^N \sum_{t=1}^{T_n} Q^{\pi_\theta}\left(s_t^n, a_t^n\right) \nabla \log p_\theta\left(a_t^n \mid s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701em;vertical-align:-0.15em;"></span><span class="mord">∇</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1649em;vertical-align:-1.3254em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3254em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><h2 id="A2C-和-A3C">A2C 和 A3C</h2><h3 id="Advantage-Actor-Critic-A2C">Advantage Actor-Critic (A2C)</h3><p>AC 中使用 Q-value，方差大，梯度差异较大训练不稳定。PG 中同样有这种问题，它的解决方式是引入一个 baseline，用累计奖励 Gain 减去 baseline，可以使梯度减小，训练平缓。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>n</mi></msub></munderover><mrow><mo fence="true">(</mo><mi>G</mi><mi>a</mi><mi>i</mi><msub><mi>n</mi><mi>t</mi></msub><mo>−</mo><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo>∣</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla \bar{R}_\theta=\frac{1}{N} \sum_{n=1}^N \sum_{t=1}^{T_n}\left(Gain_t - baseline(s_t)\right) \nabla \log p_\theta\left(a_t^n \mid s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701em;vertical-align:-0.15em;"></span><span class="mord">∇</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1065em;vertical-align:-1.2671em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">G</span><span class="mord mathnormal">ai</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">ba</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">in</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>A2C 中，认为对于 Q-value $Q^{\pi_\theta}\left(s_t^n, a_t^n\right) $ 一个自然的 baseline 选择是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><msub><mi>π</mi><mi>θ</mi></msub></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">V^{\pi_\theta}\left(s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>。于是可以构造优势函数 advantage function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A(s_t,a_t) = Q(s_t,a_t)-V(s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。其可以通过近似计算得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>r</mi><mi>t</mi><mi>n</mi></msubsup><mo>+</mo><msup><mi>V</mi><mi>π</mi></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo fence="true">)</mo></mrow><mo>−</mo><msup><mi>V</mi><mi>π</mi></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">A(s_t,a_t) = r_t^n+V^\pi\left(s_{t+1}^n\right)-V^\pi\left(s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9114em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3064em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>。所以可以仅用一个网络来估计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 值而不用评估 Q-value。可以说 A2C 解决的是梯度方差大，训练不稳定的问题。</p><p>A2C 中的梯度可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>n</mi></msub></munderover><msup><mi>A</mi><msub><mi>π</mi><mi>θ</mi></msub></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo>∣</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla \bar{R}_\theta=\frac{1}{N} \sum_{n=1}^N \sum_{t=1}^{T_n} A^{\pi_\theta}\left(s_t^n, a_t^n\right) \nabla \log p_\theta\left(a_t^n \mid s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701em;vertical-align:-0.15em;"></span><span class="mord">∇</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1065em;vertical-align:-1.2671em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>除了方差大，AC 还存在的问题：两个网络交替训练，critic 和 action 强相关，有着很强的时序关联，只能探索到有限的状态和动作空间。为了打破经验耦合，需要采用 experience replay，使得 agent 在后续训练可以访问到以前知识（例如 DQN 和 DDPG（DQN+AC）这类基于值的方法）。但是策略类的方法，经验都是以 episode 形式获得，用完即弃。</p><p>在此情况下使用并行架构，不同的 worker 与环境进行交互，得到独立的采样经验。即每轮训练中，Global network 都会等待每个 worker 各自完成当前的 episode，然后把这些 worker 上传的梯度进行汇总并求平均，得到一个统一的梯度并用其更新主网络的参数，最后用这个参数同时更新所有的 worker。可以说 A2C 也解决了经验耦合的问题。</p><h3 id="Asynchronous-Advantage-Actor-Critic-A3C">Asynchronous Advantage Actor-Critic (A3C)</h3><p>A3C 相对于 A2C 使用了异步经验更新。没有等待所有 worker 完成当前 episode 并汇总的过程。</p><blockquote><p><strong>各个 worker 都分别使用着一套不同的策略</strong>，独立的跟自己的环境交互。而主网络保持着最新的策略，各 worker 跟主网络同步的时间也是不一样的，只要有一个 worker 完成当前episode，主网络就会根据它的梯度进行更新，并不影响其它仍旧在使用旧策略的 worker。这就是异步并行的核心思想。</p></blockquote><p>但是研究者们逐渐发现A3C主要优势在于采用了“并行训练”的思想，而不一定要“异步地并行训练”。异步更新并没有使训练效率和性能取得显著提高【3】，A2C 表现更好（A2C 是在 A3C 后面出现的）。</p><h2 id="结语">结语</h2><p>本文并没有深入技术细节，而是从强化学习（在这几个方法上）的演变角度，简单的记录了不同方法的 intuition。比之前的学习笔记或许在问题定义上清晰了一些。</p><h2 id="Reference">Reference</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/25831658">什么是 Actor-Critic (强化学习) - 莫烦的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/478709774">深入理解强化学习（七）- Actor-Critic - 莫冉的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/148492887">深度强化学习 – 进击的 Actor-Critic（A2C 和A3C） - Quantum cheese的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/51645768">强化学习AC、A2C、A3C算法原理与实现！ - 梁勇的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/161839383">Actor-Critic的变体 - heaven的文章</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>reinforcement-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Attention 和 Transformer</title>
    <link href="/machine-learning/attention/"/>
    <url>/machine-learning/attention/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>注意力机制和 Transformer 在神经网络应用中已经取得了良好的表现，此处做一个简要的学习。因为在自己的工作中并不会用到，所以此处更注重一些逻辑上的思路，以加强直观上的理解，具体细节有需要的时候再进行补充。（题外话，翁小姐的博客简直是 GPT 的技术栈。）</p><span id="more"></span><blockquote><ul><li>2023-11 更新：增加代码理解。</li><li>2023-11 更新：描述准确性提升，修改了一些错误。</li></ul></blockquote><h1>Attention</h1><h2 id="Sequence-to-sequence-是什么？">Sequence to sequence 是什么？</h2><p>首先需要介绍序列到序列（Seq2seq）建模。一般来说存在一个 encoder 和一个 decoder：</p><ul><li>Encoder 将序列数据（一个个排列整齐的 embedding/vectors）编码成一个隐向量（期望含有所有的输入信息）。可以写作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_t=f\left(h_{t-1}, x_{t}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为隐向量，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为输入序列的第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 个元素。</li><li>Decoder 将 encoder 传来的隐向量解码成一个序列，即目标任务的输出。可以写作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mi>g</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_t=g\left(y_{t-1}, h_{t-1}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为输出序列的第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 个元素，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为隐向量。这个过程通常需要贪心重复，直到输出停止。</li></ul><p>这种模式在机器翻译、语音识别、文本摘要等任务中都有应用。通常来说，encoder 会使用 RNN，decoder 会使用 RNN 或者 CNN（根据不同的下游任务）。</p><h2 id="Attention-机制是什么？">Attention 机制是什么？</h2><p>Attention 面对的是 seq2seq 中长程梯度消失的问题。其关键是允许模型在序列的任何位置直接访问其他位置的信息，从而解决了长距离依赖问题，有着参数少速度快效果好的优点。具体来说，在 seq2seq 中 attention 是在 decoder 中的一个模块，其将 encoder 中的信息加权求和成为一个背景信息向量（context vector），作为 decoder 每次预测的附加输入。</p><p>Attention 做的事情简单来说就是“加权求和”：</p><ul><li><strong>对什么加权？</strong> 一般来说是对隐含状态加权 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><msub><mi>h</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>h</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>h</mi><mi>T</mi></msub><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(h_1, h_2, \ldots, h_T\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>。</li><li><strong>权重是多少？</strong> 权重为一个 attention 分布，而不是固定值，可以写作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>α</mi><mi>t</mi></msub><mo stretchy="true">→</mo></mover><mo>=</mo><mi mathvariant="normal">softmax</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mover accent="true"><msub><mi>e</mi><mi>t</mi></msub><mo stretchy="true">→</mo></mover><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\overrightarrow{\alpha_t}=\operatorname{softmax}\left(\overrightarrow{e_t}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1026em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9526em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.4306em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span class="mord mathrm">softmax</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9526em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.4306em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span>，基于当前输出位置和之前输入位置的关联性 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>e</mi><mi>t</mi></msub><mo stretchy="true">→</mo></mover></mrow><annotation encoding="application/x-tex">\overrightarrow{e_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1026em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9526em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.4306em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>，其每个元素为一个评分。</li><li><strong>求和得到什么？</strong> 背景向量（context vector），<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>c</mi><mi>t</mi></msub><mo stretchy="true">→</mo></mover><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>α</mi><mrow><mi>t</mi><mi>j</mi></mrow></msub><msub><mi>h</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\overrightarrow{c_t}=\sum_{j=1}^T \alpha_{t j} h_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1026em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9526em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.4306em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.417em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></li><li><strong>得到之后怎么用？</strong> 将背景向量作为 decoder 的输入，得到当前位置的状态 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">s_t=f\left(s_{t-1}, y_{t-1}, c_t\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>，以及该位置的输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>∣</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo fence="true">)</mo></mrow><mo>=</mo><mi>g</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">p\left(y_t \mid y_1, \ldots, y_{t-1}, \vec{x}\right)=g\left(y_{i-1}, s_i, c_i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></li></ul><div style="width:80%;margin:auto"><img src="/machine-learning/attention/knowledge_is_power.gif" class="" title="一个翻译任务的例子"></div><p>一些需要注意的点：</p><ul><li>Decoder 预测目标翻译的时候可以看到 encoder 的所有信息，而不仅局限于原来模型中定长的隐藏向量（例如 RNN 的中间向量），这样不会丧失长程的信息。</li><li>这个加权求和的过程不可以看作一个全连接层，因为全连接层的权重是固定的，而 attention 的权重是可学习的。</li><li>全连接的作用是对一个实体进行从一个特征空间到另一个特征空间的映射，而注意力机制是要对来自同一个特征空间的多个实体进行整合。</li></ul><h2 id="Self-Attention-数学形式">Self-Attention 数学形式</h2><div class="note note-primary">            <p>An attention function can be described as mapping a query and a set of key-value pairs to an output, where the query, keys, values, and output are all vectors. The output is computed as a weighted sum of the values, where the weight assigned to each value is computed by a compatibility function of the query with the corresponding key.【4】</p>          </div><p>以下是 “Attention Is All You Need”【4】这篇重磅论文中给出的 attention 数学定义。虽是针对于文中的 scaled dot-product attention，但是大部分 attention 都是一个逻辑，所以下式可以拿来作为一个整体的广义定义。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Attention</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">softmax</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">\operatorname{Attention}(Q, K, V)=\operatorname{softmax}\left(\frac{Q K^T}{\sqrt{d_k}}\right) V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">Attention</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4684em;vertical-align:-0.95em;"></span><span class="mop"><span class="mord mathrm">softmax</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em;"><span style="top:-2.2528em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8572em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8172em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1828em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span></p><p>虽然理解分析的时候时我们使用的是向量，但考虑到整个序列，我们可以使用矩阵来同时处理多个向量。先通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">Q K^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> 得到关系矩阵，再通过归一化得到概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">softmax</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{softmax}\left(\frac{Q K^T}{\sqrt{d_k}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span class="mord mathrm">softmax</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0895em;"><span style="top:-2.5864em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1778em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Q</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9191em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span> 对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 进行重采样。过程可见下图（摘自台大李宏毅老师课件）：</p><div style="width:80%;margin:auto"><img src="/machine-learning/attention/self-attention-1.png" class="" title="自注意力运行方式"></div><div style="width:80%;margin:auto"><img src="/machine-learning/attention/self-attention-2.png" class="" title="自注意力矩阵形式"></div><p>对于提到的符号标记：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 为查询矩阵，用来描述当前位置。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> 为键矩阵，表示输入中的每个位置。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 为值矩阵，表示输入中的每个位置的值。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为键矩阵和查询矩阵的维度，此处用来缩放权重。</li></ul><p>需要注意的点：</p><ul><li>在自注意力中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi mathvariant="normal">/</mi><mi>K</mi><mi mathvariant="normal">/</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">Q/K/V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 通常由相同的向量经过不同的线性变换得到。</li><li>关系矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">Q K^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> 可以认为是 attention 的核心，其直接影响到权重，其计算方式有很多种，这里的点乘只是其中一种。</li><li>这里的 attention 对应到上一小节可以理解为 context vector（同样为一个向量）。</li></ul><h2 id="Multi-Head-Attention">Multi-Head Attention</h2><p>简单来说是将多个 scaled dot-product attention 的值拼接，再通过线形结合输出。使用多个 head 是因为相关性可能不止一种，这样可以让模型学习到不同的关系。不同的 head 需要先进行不同的线性变换，然后再进行 attention。具体如下图所示。</p><div style="width:80%;margin:auto"><img src="/machine-learning/attention/multi-head-attention.png" class="" title="multi-head attention"></div><p>具体的，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">MultiHead</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>X</mi><mi>q</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Concat</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mrow><mi mathvariant="normal">head</mi><mo>⁡</mo></mrow><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo></mrow><mo separator="true">,</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mrow><msub><mrow></mrow><mi mathvariant="normal">h</mi></msub><mo fence="true">)</mo></mrow><msup><mi>W</mi><mi>O</mi></msup><mspace linebreak="newline"></mspace><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mspace width="1em"/><msub><mtext>head</mtext><mi>i</mi></msub><mo>=</mo><mi mathvariant="normal">Attention</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>X</mi><mi>q</mi></msub><msubsup><mi>W</mi><mi>i</mi><mi>Q</mi></msubsup><mo separator="true">,</mo><msub><mi>X</mi><mi>k</mi></msub><msubsup><mi>W</mi><mi>i</mi><mi>K</mi></msubsup><mo separator="true">,</mo><msub><mi>X</mi><mi>v</mi></msub><msubsup><mi>W</mi><mi>i</mi><mi>V</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{MultiHead}(X_q, X_k, X_v)=\operatorname{Concat}\left(\operatorname{head}_1, \ldots\right., head \left._{\mathrm{h}}\right) W^O \\where \quad \text{head}_i=\operatorname{Attention}\left(X_q W_i^Q, X_k W_i^K, X_v W_i^V\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop"><span class="mord mathrm">MultiHead</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">Concat</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mop"><span class="mop"><span class="mord mathrm">head</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">h</span><span class="mord mathnormal">ere</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord text"><span class="mord">head</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span class="mord mathrm">Attention</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9592em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p><p>其中：</p><ul><li>要对表征做线性变换，维度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>i</mi><mi>Q</mi></msubsup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mtext>model</mtext></msub><mo>×</mo><msub><mi>d</mi><mi>k</mi></msub></mrow></msup><mo separator="true">,</mo><msubsup><mi>W</mi><mi>i</mi><mi>K</mi></msubsup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mtext>model</mtext></msub><mo>×</mo><msub><mi>d</mi><mi>k</mi></msub></mrow></msup><mo separator="true">,</mo><msubsup><mi>W</mi><mi>i</mi><mi>V</mi></msubsup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mtext>model</mtext></msub><mo>×</mo><msub><mi>d</mi><mi>v</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">W_i^Q \in \mathbb{R}^{d_{\text {model}} \times d_k}, W_i^K \in \mathbb{R}^{d_{\text {model}} \times d_k}, W_i^V \in \mathbb{R}^{d_{\text {model}} \times d_v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2361em;vertical-align:-0.2769em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9592em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1078em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1078em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mi>O</mi></msup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>h</mi><msub><mi>d</mi><mi>v</mi></msub><mo>×</mo><msub><mi>d</mi><mtext>model</mtext></msub></mrow></msup></mrow><annotation encoding="application/x-tex">W^O \in \mathbb{R}^{hd_v \times d_{\text {model}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8804em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span> 为 head 的数目。</li><li>通常 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>q</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">X_q, X_k, X_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的维度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><msub><mi>d</mi><mtext>model</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n,d_{\text {model}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。</li><li>通常 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>d</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">d_k, d_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mtext>model</mtext></msub></mrow><annotation encoding="application/x-tex">d_{\text {model}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 之间存在比例关系，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>=</mo><msub><mi>d</mi><mi>v</mi></msub><mo>=</mo><msub><mi>d</mi><mtext>model</mtext></msub><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">d_k = d_v = d_{\text {model}}/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal">h</span></span></span></span>，以满足 concat 连接。</li></ul><h1>Transformer 结构</h1><p>模型结构如下图所示，包含 encoder 和 decoder 两部分，multi-head attention 是两者中的重要组成部分。在 attention 之外，样本的位置（顺序）信息使用 positional encoding 嵌入（因为不像 RNN 有顺序结构）。</p><div style="width:50%;margin:auto"><img src="/machine-learning/attention/transformer.png" class="" title="transformer"></div><h2 id="Encoder">Encoder</h2><div class="note note-primary">            <p>Encoder 本质上做的事情：输入一个 vector sequence，输出另一个 vector sequence。</p>          </div><p>Encoder 由 N 层 encoder layer 组成，每个 encoder layer 有两个 sub-layer，分别是 multi-head attention 和 feed-forward。</p><ul><li>原始输入是词向量组成的矩阵，维度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n,k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 为句子长度，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 为 embedding 的维度。</li><li>经过 positional encoding 嵌入，得到维度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n,d_{model})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 的矩阵。</li><li>对于每层 encoder layer：<ul><li>输入都先通过一个 multi-head attention layer，输入输出的维度都为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mtext>model</mtext></msub></mrow><annotation encoding="application/x-tex">d_{\text {model}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li><li>再做一次 residual connection 和 layer normalization，这一步之后输出的维度仍为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mtext>model</mtext></msub></mrow><annotation encoding="application/x-tex">d_{\text{model}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。Layer norm 是对每个样本而不是对 batch 进行，其原理与 batch norm 相似，仍具有可学习的缩放以及平移参数。</li><li>之后再通过一个 feed-forward layer，以及一次 residual connection 和 layer normalization，输入输出的维度应当也为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mtext>model</mtext></msub></mrow><annotation encoding="application/x-tex">d_{\text {model}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li></ul></li><li>在多次通过 encoder layer 之后，将原始数据编码到维度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><msub><mi>d</mi><mtext>model</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n,d_{\text {model}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 的矩阵。</li></ul><h2 id="Decoder">Decoder</h2><div class="note note-primary">            <p>Decoder 本质上做的事情：读入 encoder 的输出，输入 “BEGIN”，逐项输出一系列概率向量并指向一个字符。</p>          </div><p>Encoder 由 N 层 decoder layer组成，每个 decoder layer 有三个 sub-layer，分别是两个 multi-head attention 和 feed-forward。</p><ul><li>原始输入是原始的词向量组成的矩阵，以同样的方式经过 positional encoding 嵌入。</li><li>对于每层 decoder layer<ul><li>输入都先通过一个 masked multi-head attention layer，再做一次 residual connection 和 layer normalization。mask 屏蔽掉当前位置后面的词，仅计算之前的 attention。</li><li>再将输出再作为查询向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">X_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，将 encoder 中编码后的输入作为键值对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>X</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>v</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(X_k,X_v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，再通过一次 multi-head attention layer，再做一次 residual connection 和 layer normalization。</li><li>之后再通过一个 feed-forward layer，做一次 residual connection 和 layer normalization。</li></ul></li><li>将最终输出通过一个全连接层以及 softmax 得到概率输出，并得到输出的 token。</li></ul><p>需要注意的点：</p><ul><li>Decoder 通常遵循一种自回归的模式（autoregressive），即前一时刻的输出要放到下一时刻的输入来进行预测。</li><li>Decoder 必须自己决定何时停止输出，需要一个特殊的 token 来表示结束，可以 “END” 来表示。</li><li>在训练时，self-attention 的 mask 用来屏蔽掉当前时点后面的词，因为在预测时，后面的词是不可见的。</li><li>注意，encoder 和 decoder 的输入和输出都是一样的长度（词数）。</li></ul><h2 id="位置编码">位置编码</h2><p>在 Transformer 中，位置信息是通过 positional encoding 嵌入的。其原理是将位置信息转换为向量，然后将其与原始的词向量相加。给定一个位置 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">i=1,2,\dots,L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span></span></span></span> 和对应的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">\delta=1,2,\dots,d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span></span></span></span>，对应的 Positional Encoding <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>E</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">PE_{(i,j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span> is defined as:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">E</mi></mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>δ</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>sin</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mi>i</mi><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><msup><mi>δ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">/</mi><mi>d</mi></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>δ</mi><mo>=</mo><mn>2</mn><msup><mi>δ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mi>i</mi><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><msup><mi>δ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">/</mi><mi>d</mi></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>δ</mi><mo>=</mo><mn>2</mn><msup><mi>δ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\mathrm{PE}(i, \delta)= \begin{cases}\sin \left(\frac{i}{10000^{2 \delta^{\prime} / d}}\right) &amp; \text { if } \delta=2 \delta^{\prime} \\ \cos \left(\frac{i}{10000^{2 \delta^{\prime} / d}}\right) &amp; \text { if } \delta=2 \delta^{\prime}+1\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">PE</span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.5em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.492em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.016em' style='width:0.8889em' viewBox='0 0 888.89 16' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V16 H384z M384 0 H504 V16 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.016em' style='width:0.8889em' viewBox='0 0 888.89 16' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V16 H384z M384 0 H504 V16 H384z'/></svg></span></span><span style="top:-4.3em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8557em;"><span style="top:-2.5648em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932em;"><span style="top:-2.8931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.6068em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8496em;"><span style="top:-2.8496em;margin-right:0.1em;"><span class="pstrut" style="height:2.5556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4352em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8557em;"><span style="top:-2.5648em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932em;"><span style="top:-2.8931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.6068em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8496em;"><span style="top:-2.8496em;margin-right:0.1em;"><span class="pstrut" style="height:2.5556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4352em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><div style="width:100%;margin:auto"><img src="/machine-learning/attention/sinoidual-positional-encoding.png" class="" title="positional encoding"></div><h2 id="Transformer-训练">Transformer 训练</h2><p>和传统的机器学习没有本质的区别，同样是计算输出和 ground truth 的 cross-entropy，并最小化损失。</p><p>需要注意训练时 decoder 的输入是真实输出，而测试时 decoder 的输入是自己的输出。由于训练时 decoder 只看到正确的训练数据，所以一旦测试时有输出错误，就会步步错，这个现象叫做exposure bias。解决方式是训练时给 decoder 一些错误的答案（scheduled sampling），但是这样会伤害一些并行能力。</p><h2 id="Transformer-应用">Transformer 应用</h2><ul><li>基于编码器：Bert 作为特征提取器</li><li>基于解码器：GPT 系列大语言模型</li></ul><h1>代码理解</h1><p>目前较为著名的代码为哈佛 NLP 组基于 Pytorch 实现的，请见<a href="https://github.com/harvardnlp/annotated-transformer/blob/master/the_annotated_transformer.py">此链接</a>。代码整体通俗易懂，此处仅点名一些处理的比较好，或直观上不容易理解的地方：</p><ol><li>在 <code>MultiHeadedAttention</code> 中，使用 <code>self.linears = clones(nn.Linear(d_model, d_model), 4)</code> 来作为全连接层。与我们印象中的三组 <code>h</code> 个维度为 <code>(d_model, d_k)</code> 的全连接层不同，此处直接将其进行拼接，并在之后对得到的矩阵进行切分。此外多出的一个全连接层用于最后 concat 之后的映射。</li><li>注意位置编码中的维度。单数位和偶数位的维度是一样的，但是其值是不同的，因此需要分开处理再合并。此外为了适应批数据，需要在最外层通过 <code>unsqueeze(0)</code> 扩展维度。</li></ol><h1>其他变体与考虑</h1><h2 id="更长的文本？">更长的文本？</h2><h3 id="Memory">Memory</h3><p>目前 vanilla transformer 的长度是有限的，因为其 attention 机制是基于位置的。如果要处理更长的文本，可以使用加入 memory 的 transformer。记忆机制的思想是，将之前的信息存储起来，然后在当前的输入中使用。通常来说可以使用可微的记忆（Transformer-XL，类似 RNN 的循环）以及不可微的记忆（kNN）。此处因为暂时不太会用得上，需要的时候再进行学习。</p><h1>Reference</h1><ol><li><a href="https://www.zhihu.com/question/320174043/answer/651998472">深度学习中Attention与全连接层的区别何在？ - SleepyBag的回答 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/47063917">Attention机制详解（一）——Seq2Seq中的Attention</a></li><li><a href="https://www.zhihu.com/question/68482809/answer/1876764572">目前主流的attention方法都有哪些？ - 电光幻影炼金术的回答 - 知乎</a></li><li>Vaswani, Ashish, et al. “Attention is all you need.” Advances in neural information processing systems 30 (2017).</li><li><a href="https://zhuanlan.zhihu.com/p/600773858">OpenAI ChatGPT（一）：十分钟读懂 Transformer - 绝密伏击的文章 - 知乎</a></li><li><a href="https://lilianweng.github.io/posts/2023-01-27-the-transformer-family-v2/">The Transformer Family Version 2.0</a></li><li><a href="https://www.youtube.com/watch?v=N6aRv06iv2g">【機器學習2021】Transformer</a></li><li><a href="https://zhuanlan.zhihu.com/p/398039366">Transformer源码详解（Pytorch版本） - Codering的文章 - 知乎</a></li><li><a href="http://nlp.seas.harvard.edu/annotated-transformer/">The Annotated Transformer</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>attention</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Focal Loss</title>
    <link href="/machine-learning/focal-loss/"/>
    <url>/machine-learning/focal-loss/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>前几天听到一个关于元学习的报告，里面提到了一下 Focal Loss，意识到总是听人讲起却没有好好看过它到底是什么，于是这里做一个简短的学习。</p><span id="more"></span><h2 id="类别不平衡问题">类别不平衡问题</h2><p>Focal loss 是何恺明大神提出的，面向类别不平衡性能损失问题的一个思路。</p><p>通常情况下，面对类别不平衡，如果不加干预，模型则更倾向于对优势类有着更好表现。通常大家的解决思路是对不同类别的样本损失函数加权，降低优势类损失的权重，增强劣势类损失的权重，比例约为不同类别（正负样本）的数量比。</p><p>此处 focal loss 本质上也是一个对于 CEloss 的加权，但是它入手的角度是学习样本的难易程度。</p><h2 id="Focal-loss-具体形式">Focal loss 具体形式</h2><p>首先我们给出 focal loss 的表达式：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>f</mi><mi>l</mi></mrow></msub><mo>=</mo><mo>−</mo><msup><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mi>γ</mi></msup><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mspace linebreak="newline"></mspace><msub><mi>p</mi><mi>t</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mover accent="true"><mi>p</mi><mo>^</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi mathvariant="normal">y</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo>−</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext> otherwise </mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">L_{f l} =-\left(1-p_t\right)^\gamma \log \left(p_t\right)\\p_t = \begin{cases}\hat{p} &amp; \text { if } \mathrm{y}=1 \\ 1-\hat{p} &amp; \text { otherwise }\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0543em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathrm" style="margin-right:0.01389em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> otherwise </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>同理也有交叉墒损失函数的表达式:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>c</mi><mi>e</mi></mrow></msub><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">L_{ce}=- \log \left(p_t\right)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ce</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span><span class="mspace newline"></span></span></span></span></p><p>两者的主要区别在于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">log</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> 项之前的权重。直观上理解，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> 反应了分类的难易程度，分类的置信度越高，代表样本越易分；分类的置信度越低，代表样本越难分。因此focal loss相当于增加了难分样本在损失函数的权重，使得损失函数倾向于难分的样本，有助于提高难分样本的准确度。而通常情况下，样本较少的类别天然会难分一些。</p><h2 id="Reference">Reference</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/32423092">何恺明大神的「Focal Loss」，如何更好地理解？</a></li><li><a href="https://zhuanlan.zhihu.com/p/266023273">focal loss 通俗讲解</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>loss-function</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>论个人在历史上的作用问题</title>
    <link href="/reading-note/hero-in-history/"/>
    <url>/reading-note/hero-in-history/</url>
    
    <content type="html"><![CDATA[<p>普列汉诺夫（俄）所著，一本深刻的哲学书。一本王岐山送给 Ray Dalio 的书籍。</p><span id="more"></span><h2 id="作者">作者</h2><p>普列汉诺夫，组织了俄国历史上第一个马克思主义革命团体“劳动解放社”。发表了一系列政治哲学经济社科美学等方面的论著，捍卫论证发展了辩证唯物主义，特别是历史唯物主义的原理，培养了一大批年轻的革命骨干。他是第二国际的著名领袖，国际工人运动最杰出的领导人之一。他引导列宁走上正确的革命道路，帮助他接受辩证唯物主义和历史唯物主义，也是把列宁引入第二国际领导层的推介人。他之所以名垂青史，主要是作为博学的著作家、思想家、理论家。普列汉诺夫的文章流畅优美，旁征博引，极爱论战，文风清新，明晰泼辣，兼具法国式的奔放风趣，德国式的深邃思辨和俄国式的渊博简洁的特点，是著名的俄国散文家。</p><h2 id="极简简介">极简简介</h2><p>译者的引言说到：“我们确信只有用人类创造的全部知识财富来丰富自己的头脑，才能建成现代化的社会主义社会。”本书写于1898，提出了基本原理：杰出人物只能决定社会发展的个别外貌，不能决定社会发展的一般趋势，后者是有社会发展的一般原因（如生产力的状况和发展）决定的。这一基本原理的提出，彻底解决了“英雄造时势”和“时势造英雄”这样两种历史上长期对立的观点所产生的各种纠缠不清的问题。</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>这其实是一本我个人没有太看明白的书，并不是书不好，而是我的知识储备有限，很多哲学名词不是很能看懂。很多流派也没有什么了解，导致这本书看的比较浅。但是总的来说，这本书从头到尾围绕着一个问题“到底是英雄造时势还是时势造英雄”展开，并援引多个西方历史上的著名人物和事件加以解释，个人认为是十分翔实的。这是一本我一定还会看第二遍的书。</p><h3 id="缺点（喜爱挑毛病）">缺点（喜爱挑毛病）</h3><p>暂不评价，暂时还不配评价。</p><h3 id="感想-看法">感想/看法</h3><ol><li>历史学家在具体分析特定历史任务时的一项重要任务就是要善于分辨一般趋势在哪里结束，而个别外貌从何处开始。</li><li>事件的结局往往不仅取决于那些大事和一般原因，也取决于许许多多能引起蝴蝶效应的细枝末节。</li><li>时势造英雄。什么是英雄？英雄是那些可以更好的代表时代特征的人。</li><li>谷爱琳，就是在这个中国崛起文化自信路上的一个出名的“英雄”。</li><li>其实讲了很多社会微观上的自由和宏观上的必然，有点像物理学的宏观微观。</li><li>哪些观念在冲突中能获胜呢？或许是那些最不影响影响力最大阶层的经济利益的观念。</li><li>“替代者终是会出现的”对应到那些伟人的确有点难以查验。但是让我想到了中东那边的武装恐怖组织，一个头领被干掉，一个新头领站出来，或许可佐证这个说法。此外两个人没有同时站出来的的原因有点像量子力学中的坍缩，“观测到一个就难以观测到其他了”。</li><li>我看这本书，我看到的东西其实是带有 Bias 的，我看到的以为是我看到的但是其实是我的社会阅历社会经验所促使我着重注意到的。</li><li>今天阅读到毛主席抗美援朝的决定，也读到了苏联斯大林的“阳谋”，觉得毛主席出兵的决定十分正确，如果换一个领导者可能作出更差的结果。所以这个是英雄造时势还是时势造英雄呢？如果说是从“群众中来的英雄”，这里可能“时势造英雄”不再适用。如果将此刻的毛主席已经当成了“英雄”，那么他的确创造了时势，奠定了中国后来十几年的国际环境，但是这个“时势”可能并不指的是一个拥有新价值观或者新历史使命的新社会。所以可能这个“英雄时势”的问题，需要一个特定的场合来使用，在某些情况下，英雄终归是英雄？</li></ol><h1>按节讨论/摘录</h1><h3 id="正文">正文</h3><ol><li>一个人怎样，他的哲学也就怎样。</li><li>西梅尔说，自由总是摆脱什么东西的自由，自由若不理解为与受约束相反的东西，自由就没有意义。</li><li>深刻的定义不推翻粗浅的定义，而是补充他们，把它们保存在自身之中。</li><li>为了反题而牺牲正题，正如为了正题而忘记反题，同样是没有根据的。只有当我们善于把包含在他们中间的真理因素同意在合题中的时候才会找到正确的观点。</li><li>个人因其性格的某些特点能够影响社会的命运。有时他们的影响往往甚至是非常重大的，不过，无论是这种影响的可能性本身，还是影响的规模，都是由社会的组织，社会力量的对比来决定的。</li><li>偶然性是某种相对的东西，它只出现在诸必然过程的交会点上。</li><li>个人对社会的命运常常有重大的影响，不过这种影响是由社会的内部结构以及社会对其他社会的关系决定的。</li><li>有影响的人物由于自己的智慧和性格的种种特点，可以改变事变的个别外貌和事变的某些局部后果，但他们不能改变事变的总的方向，这个方向是由别的力量决定的。</li><li>在人类智慧发展史上，一个任务的成功妨碍另一个任务的成功的情形要稀少的多。</li><li>为了使一个拥有某种才能的人凭借这种才能获得对事变进程的重大影响，必须具备两个条件：他的才能应当使他成为比其他人更符合这个时代的社会需要；现存的社会制度不要阻碍具有恰恰是当时所需要和有益处的那种特点的任务的道路。</li><li>现实中出现的任何人才，即成为社会力量的任何人才，都是社会关系的产物。</li><li>有才能的人，只能改变事变的个别外貌，而不是事变的总趋势；他们本身只是凭借这种趋势才存在，没有这种趋势，他们永远也跨不过从可能进到现实的门槛。</li><li>这种进程的方向归根结底是有所谓的一般原因决定的，即事实上是由生产力的发展以及这种发展所决定的人们在社会经济的生产过程中的相互关系来决定的。</li><li>偶然的现象和著名任务的个人特点，比藏深的一般原因要显著的多。</li><li>如果人的本性恒久不变，那他就不能解释变化无穷的历史进程，而如果他是变化的，那么显然，他的变化本身就为历史运动所制约。</li><li>伟人正是创始者，因为它比别人看得远些，他的欲望比别人强烈些。他是个英雄。其所以是英雄，不是说他似乎能够阻止或者改变事物的自然进程，而是说他的活动是这个必然和无意识的进程的自觉和自由的表现。这就是他的全部意义之所在，这就是他的全部力量之所在。而这是一种极具大的意义、一种了不起的力量。</li><li>历史是由社会人造成的，社会人是历史的唯一“因素”。</li><li>任何伟人都不可能强迫社会接受已不适合生产力状况或者还不适合这一状况的那些关系。</li><li>伟大这个概念是相对的概念。在道德的意义上，每一个（用福音书上的话说）“为朋友舍命”的人都是伟大的。</li></ol><h3 id="附录">附录</h3><ol><li>事物的进程不取决于观念的进程，而取决于不以人意志为转移、又不为人所意识到的某种外来力量。人的任性而为和人的深思熟虑的偶然性让位于合规律性，从而也就是让位于必然性。</li><li>必然性向自由的过渡也是按照特定的规律进行的，这些规律能够而且应当为理论哲学所发现。</li><li>从“批判的批判”的观点来看，一切伟大的冲突都不外是观念的冲突。马克思指出，每当观念同作为那个时代历史进步的载体的那个社会阶层的现实的经济利益不相符合时，这些观念都“出了丑”。</li><li>发展人的意识就是善于独立思考的人物最伟大、最高尚的任务。</li><li>个人会给历史带进偶然性的因素。</li><li>援引偶然性是走向承认人类意识的发展取决于与人类意识无关的原因的最初的、无意识的和不由自主的一步。</li><li>当作结果考察的社会人，不能认为他是自由的活动者，因为那些决定他意志活动的情况不依赖于他的意志。</li><li>必然性乃是自由的保证。</li><li>恩格斯说：“在特定国家特定时间出现这样的人儿，而且是这个人而非别的人，——这当然是纯粹的偶然现象。但是如果我们把这个人除掉，那时就需要有人来替代他，而且替代者是会出现的，或好或坏，然而归根到底总是会出现的。”</li><li>自由的活动—意味着实现自己的目的，而不做达到别人目的的工具，仅此而已。</li><li>人的意志一旦确定下来，就会成为行动的源泉，也就成为社会现象的原因。</li><li>在实践中，人们的意志是改造历史存在的粗糙形式的必不可少的杠杆。</li><li>伟大诗人之所以伟大，只是因为他是社会历史发展中伟大时机的表现者。</li><li>一般来说，落后国家在若干时期内还将必然成就不大，因而先进国家的知识界对之完全没有，或者很少有兴趣。</li><li>落后国家的优秀人物入围在先进国家中得到承认，他们的同胞会对“土生土长”的力量抱有相当大的不信任（“我们哪能比得上啊！”）。</li><li>卓越的思想家的命运是由他们的祖国在人类文化发展过程中所起的作用来决定的。</li><li>人们是在力求满足自己的需要的过程中创造自己的历史的，而科学应当向我们说明，满足这些需要的各种方式怎样影响着人们的社会关系和他们的精神活动。</li><li>对于一切种类和变种的唯心主义者来说，经济关系是人的本性的函数；辩证唯物主义者们认为这些关系是社会生产力的函数。</li><li>所谓的思想体系不过是这个统一而不可分的历史在人们头脑中的反映。</li></ol>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>浪潮之巅</title>
    <link href="/reading-note/top-of-the-wave/"/>
    <url>/reading-note/top-of-the-wave/</url>
    
    <content type="html"><![CDATA[<p>一本介绍大型科技公司浪潮起落的书。</p><span id="more"></span><h2 id="作者">作者</h2><p>吴军</p><h2 id="内容简介">内容简介</h2><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>一本了解世界互联网产业发展的必读书籍。以浪潮反应产业的起伏，对于个人择业或者行业研究有着一定的参考价值。</p><h3 id="感想看法">感想看法</h3><ol><li>这本书还是有些过时，很多内容需要更新。比如微软和苹果公司的关系。</li><li>竟然还写了红杉资本的联系方式，有趣。</li><li>由于Google 很明智地没有在互联网泡沫高峰期疯狂地扩展，而是实实在在地、低调地做好自己的搜索引擎，因此它早期烧钱的速度非常之慢。2000 年的时候它没有急着上市，避免了绝大多数互联网公司大起大落并且最终关门的厄运，同时最早期的优秀人才没有拿了钱就走掉，因此Google 的骨干完好无损。感觉这个可以用来研究没来得及上市的蚂蚁金服的发展上。</li><li>制定规则的重要性一次次体现。</li><li>让人思考商业模式和技术的权衡，或许商业模式更加重要。</li><li>一个巨大的公司拓展新生代业务看起来还是比较难的。</li><li>与大学的合作研发看起来性价比极高，远高于自建独立实验室。</li><li>对于商业来说，技术并不是最重要的。</li><li>“存在即合理”，的确能不断的找到这句话的印证。</li><li>创业公司的员工或许都能以一当十？</li><li>其中有很多华为公司的部分，当时华为并不像现在一样人尽皆知，但是业内已经是名声响亮了。华为的成功有其必然性，其创办之初就剑指最先进的技术而不是二流技术。</li><li>流量并不是一切，很多中国的公司证明了这一点，无数次的烧钱没有转化为实际收入，都只是抱薪救火。所以说商业模式，预期产值或许更重要。</li><li>公司的掌舵人决策者实在是太为重要了。</li><li>技术并不是无敌的。</li><li>身体真的是创业者最大的本钱。今日孙剑博士去世，不由得重新感慨这一点。R.I.P.</li><li>业绩下滑时，裁员是很明智的决策。</li><li>革命是创业的重要部分，而不紧紧是“进化”。风投，或者说创业者（创业其实是在风投自己），要能准确的评估技术及其前景。</li><li>当公司已经足够大的时候，其市场占有率（增长前景）就难以翻番了。</li><li>斯坦福的校友组织的确比较有趣。</li><li>投资人对于公司的影响极大，公司总是要对股东负责。</li><li>2B 产品受经济大环境的影响太大，收入相对不如 2C 产品来得稳定。这个可能在经济周期中有一定的指导意义。</li><li>资金利用率&amp;自动化程度对企业的经济效益影响极大。</li><li>近期吹嘘了很多 web3.0 的概念，个人并不太知道这是什么。目测是一种元宇宙+数字货币+vr的一种缝合怪结合体？我们回顾 web2.0（打造通用平台，再由社会上的开发力量和广大用户补充内容），web3.0 的口号目前仍是以技术为导向还不是以问题和需求为导向，似乎就有一点像 web2.0 真正意义出现之前的那一波噱头了。那到底什么是 web3.0 呢？</li><li>个人一向推崇经济和金融的意义，因为他们对于实体经济起到了不可替代的资源调度作用。虽然还有很多逐利的资金追求泡沫和杀猪盘，但是仍然不能因此忽略它的绝大多数的积极意义。</li><li>当总有什么新词新指标来为新东西背书的时候，可能要留心这是不是一个泡沫了。</li><li>危机之下，求生或许是所有公司的本能，成功断臂求生可能才有未来的发展。</li><li>很多看似无关的技术都或许会因为一个产业结合在一起，整体还是要看产业对社会的效率有多大的提升。</li><li>有一些东西对用户而言的沉没成本极高，即使有更好用的新东西，也不会轻易转换。</li><li>有意思的是，作者指出“阿里巴巴只要它不犯大的错误，现在找不出一家公司可以挑战它的商业地位”。然后我们都知道，他犯了大的错误。然而这个错误真的是错误吗？见仁见智，只能说他过于自大却忘记了国内的监管环境，所以才有了后来的制裁。</li><li>“因果倒置”这种事情有时候还真的不一定能分辨出。所以马云的电子商务是因还是果呢？或许互为因果，但是很多时候要追究事物发生的原因。</li><li>不靠泡沫挣钱的时候，经济体才能繁荣发展。</li></ol><h1>内容摘录</h1><h2 id="ATT">ATT</h2><ul><li>ATT 不紧不慢地向上走过了百年，才爬到顶点，走下坡路却只要十年时间。（注：今天的 ATT 是由当年小贝尔公司之一的西南贝尔公司几次以小吃大合并出的类似于水电公司的设施服务公司，这类公司在美国统统称为 utility 公司，毫无技术可言。）</li><li>在很长的时间里，美国国际长途电话的价钱不是由市场决定的，而是由 ATT 和美国联邦通信委员会（FCC）谈判决定的</li><li>ATT 的总裁们并不真正拥有公司。他们之中不乏有远见者，但是根本左右不了董事会。</li><li>一般来讲，一个公司当前的股价，已经反映了当前和几年后的盈利能力。如果想让股价快速增长，公司的盈利就必须高于大家的预期</li><li>在工业史上，一种新技术代替旧的技术是不以人的意志为转移的。人生最幸运之事就是发现和顺应这个潮流。</li></ul><h2 id="IBM">IBM</h2><ul><li>IBM 公司可能是世界上为数不多的成功地逃过历次经济危机，并且在历次技术革命中成功转型的公司。</li><li>IBM 能成为科技界的常青树，要归功于它的二字秘诀——保守。毫无疑问，保守使得 IBM 失去了无数发展机会，但是也让它能专注于最重要的事，并因此而立于不败之地。</li><li>我们可以将第二次世界大战作为机械时代和电子时代的分水岭。</li><li>社会的需求对科技进步的作用要超过十所大学。计算机就是在这个背景下被发明的。美国研制计算机的直接目的是在第二次世界大战时为军方计算弹道的轨迹。在流体力学中，计算量常常大到手工的计算尺无法计算的地步，因此，对通用计算机的需求就产生了。</li><li>在我个人看来，小华生对世界最大的贡献不是将 IBM 变成一个非常成功的公司，而是将计算机从政府部门和军方推广到民间，将它的功能由科学计算变成商用。</li><li>IBM PC 第一年的营业额大约是两亿美元，只相当于 IBM 当时营业额的 1% 左右，而利润还不如谈下一个大合同。要知道，卖掉十万台 PC 可比谈一个大型机合同费劲儿多了。因此，IBM 不可能把 PC 事业上升到公司的战略高度来考虑。</li><li>因为 IBM PC 的主要部件，如处理器芯片、磁盘驱动器、显示器和键盘等等，或者本身是第三家公司提供的、或者很容易制造，而它的操作系统 DOS 又是微软的。因此，IBM PC 很容易仿制。IBM PC 唯一一个操作系统的内核 BIOS 是自己的，但是很容易地就被破解了。在短短地几年间， IBM PC 的兼容机入雨后春笋般地冒了出来。</li><li>盖茨可不是一般的人，他的心志非常高远，他不会允许别人动微机软件这块大蛋糕，虽然此时的微软的规模远没法和 IBM 相比。盖茨明修栈道，暗渡陈仓，一方面和 IBM 合作开发 OS/2 ，挣了一点短期的钱，另一方面下大力气开发视窗操作系统（Windows）</li><li>到八十年代末，由于微机性能每十八个月就翻一番，微机慢慢开始胜任以前一些必须要大型机才能做的工作。这样，微机开始危及到大型机的市场。 IBM 出现了严重的亏损，有史以来第一次开始大规模裁员。</li><li>1993 年，从未在 IBM 工作过的郭士纳受命危难，出任 IBM 的首席执行官。他成功地完成了 IBM 从一个计算机硬件制造公司到一个以服务和软件为核心的服务性公司的转变，复兴了这个百年老店，并开创了 IBM 的十年持续发展。他的第一招用他自己的话讲是将 IBM 溶解掉，通俗地讲，就是开源节流。他首先裁掉了一些冗余的部门和一些毫无前途的项目。</li><li>对比几乎同时代 ATT 将公司拆分的做法，郭士纳完全是反其道而行之。他的目的是打造一只 IT 服务业的航空母舰。在公司内部，它引入竞争机制，一个项目可能有多个组背靠背地开发。为了防止互相拆台、加强合作，郭士纳将每个人的退休金和全公司的、而不是以前的各部门的效益挂钩。</li><li>郭士纳砍掉了一些偏重于理论而没有效益的研究，并且将研究和开发结合起来。一旦一个研究项目可以实用了，他就将整个研究组从实验室挪到产品部门。到后期，他甚至要求 IBM 的所有的研究员必须从产品项目中挣一定的工资。这种做法无疑很快地将研究转化成产品。但是这样做无疑会影响 IBM 长线研究和基础研究，为了弥补这方面的损失，IBM 加强了和大学的合作，在几十所大学开展了科研合作或者是设立了奖学金。</li><li>今天，IBM 成为了世界上最大的开源操作系统 Linux 服务器的生产商。</li><li>IBM 就是这样，时不时地调整内部结构，将一些非核心的、长期效益不好的部门卖掉，同时扩大核心的利润高的生意。</li><li>今天，它仍然是世界上人数最多、营业额和利润最高的技术公司。在可以预见的未来，它会随着科技发展的浪潮顺顺当当地发展，直到下一次大的技术革命。</li></ul><h2 id="Apple">Apple</h2><ul><li>麦金托什是世界上第一种可以买得到的、拥有交互式图形界面并且使用鼠标的个人电脑。它的硬件部分性能略优于同期的 IBM PC 机，而它的操作系统领先当时 IBM-PC 的操作系统 DOS 整整一代。</li><li>苹果的股票九十年代开始是上升的，这就是电影中的阿甘觉得持有了苹果的股票就不用为钱发愁的原因。如果那个电影晚拍几年，导演就不得不找另一家公司的股票给阿甘了。</li><li>我和硅谷很多创业者聊过，发现他们对自己的公司，哪怕再小的公司，在感情上也象对自己的孩子一样亲。</li><li>他已经认识到了苹果封闭式的软硬件，从成本上讲，无法和微软加兼容机竞争，也无法为用户提供丰富的应用软件。乔布斯做了两件事，他在苹果的微机中逐渐采用了英特尔的通用处理器，同时采用 Free BSD 作新的苹果操作系统的内核。这样相对开放的体系使得全社会大量有兴趣的开源工程师很容易地为苹果开发软件。</li><li>乔布斯看到了两点最重要的事实，第一，虽然已经有了不少播放器，但是做的都不好，尤其是当音乐数量多了以后，查找和管理都很难。要知道，从一千首歌里面顺序找到自己想听的可能要花几分钟时间。另外，要把自己以前买的几十张 CD 上的歌倒到播放器上更是麻烦；第二，广大用户已经习惯戴着耳机从播放器中听歌而不是随身带着便携的 CD 唱机和几十张光盘。因此，它不需要花钱和时间培养出一个市场。基于这两点的考虑，乔布斯决定开发被称为 iPod 的音乐和录像播放器。</li><li>虽然它六百美元的价格实在贵了点，但是根据电器十八个月降一半价钱的规律，iPhone 很有可能成为今后普及的手机，成为苹果即 iPod 以后新的成长点，它甚至会冲击传统的手机行业。</li></ul><h2 id="计算机工业的生态链">计算机工业的生态链</h2><ul><li>现在，每十八个月，计算机等 IT 产品的性能会翻一番；或者说相同性能的计算机等 IT 产品，每十八个月价钱会降一半。虽然，这个发展速度令人难以置信，但几十年来 IT 行业的发展始终遵循着摩尔定理预测的速度。</li><li>个人电脑工业整个的生态链是这样的：以微软为首的软件开发商吃掉硬件提升带来的全部好处，迫使用户更新机器让惠普和戴尔等公司收益，而这些整机生产厂再向英特尔这样的半导体厂订货购买新的芯片、同时向 Seagate 等外设厂购买新的外设。在这中间，各家的利润先后得到相应的提升，股票也随着增长。各个硬件半导体和外设公司再将利润投入研发，按照摩尔定理制定的速度，提升硬件性能，为微软下一步更新软件、吃掉硬件性能做准备。华尔街的投资者都知道，如果微软的开发速度比预期的慢，软件的业绩不好，那么就一定不能买英特尔等公司的股票了。</li><li>反摩尔定理使得 IT 行业不可能像石油工业或者是飞机制造业那样只追求量变，而必须不断寻找革命性的创造发明。因为任何一个技术发展赶不上摩尔定理要求的公司，用不了几年就会被淘汰。</li><li>有些愿意冒风险而追求高回报的投资家将钱凑在一起，交给既懂得理财又懂得技术的专业人士打理，投给有希望的公司和个人，这就渐渐形成了美国的风险投资机制。办好一个高科技公司还需要有既志同道合又愿意承担风险的专业人才，他们对部分拥有一个公司比相对高的工资更感兴趣，因此就有了高科技公司员工的期权制度。</li></ul><h2 id="奔腾的芯：英特尔－Intel">奔腾的芯：英特尔－Intel</h2><ul><li>1981 年，IBM 为了短平快地搞出 PC，也懒得自己设计处理器，拿来英特尔的 8086 就直接用上了。这一下子，英特尔一举成名。</li><li>美国历史频道（History Channel）在节目中评论了中日甲午战争。美国的历史学家认为，这是两个不同时代军队之间的战争，虽然双方武器相差不多，战争的结果不会有任何悬念，因为一个在专制的农业时代后期的军队很难打赢一个兴起的工业化国家的军队。英特尔和摩托罗拉之间的竞争也是如此。</li><li>市场的倾向说明了用户对兼容性的要求比性能更重要。因此，英特尔在精简指令上推出 80960 后，就停止了这方面的工作，而专心做&quot;技术落后&quot;的复杂指令系列。在整个九十年代，工业界只有英特尔一家坚持开发复杂指令集的处理器，对抗着整个处理器工业。</li><li>总的来讲，英特尔并没有想彻底把 AMD 打死。因为留着 AMD 对它利大于弊。首先，它避免了反垄断的很多麻烦。</li><li>个人认为，在个人微机以外，今后最重要的市场是游戏机市场。现在的游戏机早已不单单是为玩游戏设计的了，它们成为每个家庭的娱乐中心。IBM 等公司至少在目前在这个领域是领先的。IBM 已经垄断了任天堂、Sony 和微软三大游戏机的处理器市场。</li><li>英特尔对世界最大的贡献在于，它证明了处理器公司可以独立于计算机整机公司而存在。在英特尔以前，所有计算机公司都必须自己设计处理器，这使得计算机成本很高，而且无法普及。</li></ul><h2 id="IT业的罗马帝国：微软－Microsoft">IT业的罗马帝国：微软－Microsoft</h2><ul><li>我在学校的老板贾里尼克院士以前在IBM当任要职，因此我们经常去IBM作报告，每次去以前贾里尼克都要确认我们报告的每一页内容是已经公开发表过的。原因很简单，IBM有世界上最好的科学家和工程师，他们可以用比你还快的速度将你没有发表的想法实现、申请专利并发表。</li><li>在这次双雄会上，乔布斯犯下的错误有两方面，首先，他自己没有意识到操作系统在今后整个微机工业中的重要性，否则他不会过早地给别人看他还没上市的设计；第二，也是更重要的，他给谁看都可以，就是不该给盖茨这个人看。</li><li>完成了在研发上的布局，盖茨要在市场上尽可能用它落后的DOS坚持到微软新一代操作系统开发出来。微软的做法概括起来是两句话，薄利多销和来者不拒。</li><li>但是，领先下的苹果犯了一个致命的错误–走封闭式道路和纯技术路线。当IBM因为反垄断的限制，不得不容忍兼容机厂家克隆自己的产品并抢走越来越多市场时，苹果正在为自己没有遇到同样的麻烦而高兴。</li><li>苹果既做硬件又做软件，很难平衡两者的速度。软件做得太快了硬件就跟不上，硬件做的太快了有没有合适的软件可用。在历史上，苹果有几款计算机一推出来时速度就已经落后了；还有几款比如早期PowerPC推出来时速度奇快但没有什么应用软件可用。</li><li>网景选择了和微软一拼，因为它觉得至少目前它还有技术和市场上的优势。后来证明这种技术上的优势根本不可靠，这也是我将技术排在形成垄断的三个条件之外的原因。</li><li>如果说乔布斯是锋芒毕露，聪明写在脸上；盖茨就是一个平衡木冠军，聪明藏在肚子里。</li><li>微软打败网景和Real Network等公司的绝招是免费提供和对手竞争的产品。但是这一招对雅虎不灵，因为雅虎的服务本身就是免费的。</li><li>公司增发期权不计入成本。因此，雅虎不断地增发期权给员工，而只需付给员工很少的现金工资。员工手中的股票期权，在华尔街的炒作下，以火箭速度往上涨</li><li>我非常喜欢黑格尔地一句话：凡是现实的都是合理的，凡是合理的都是现实的。(All that is real is rational; and all that is rational is real.)虽然这句话常常被误解成为当今不合理的现实来开脱，其实，如果我们动态地看待现实性和合理性，可以把这句话理解成，现在存在的现象，当初产生它的时候必然有产生它的原因和理由。如果这个理由将来不存在了，终究有一天它也会消亡。</li><li>进入新的世纪以来，微软的行动明显放慢，它的扩张一再受阻。但是，个人微机的这次浪潮还没有过去，处在其浪潮之巅的微软即使不做任何事，仍然是世界上最赚钱的公司。它始终是所有公司最可怕的竞争对手。它能否成功地第二次创业，很大程度上取决于客厅信息化是否能形成下一次技术革命的浪潮，而它又是否能在客厅争夺战中最终胜出。</li></ul><h2 id="互联网的金门大桥：思科">互联网的金门大桥：思科</h2><ul><li>一个成功的公司的早期员工是非常宝贵的财富。他们一般是一些非常爱冒险的人，否则他们不会选择加入新开办的甚至是还没有投资的小公司，他们技术和能力非常强，常常每个人可以独挡一面，因为早期的公司要求员工什么都得能干。</li><li>但是，他们也有他们的弱点。他们虽然善于开创，但不善于或者不愿意守成，而后者对于一个大公司发展至关重要。他们做事快，但是不够精细，因为在公司很小时，抢时间比什么都重要。</li><li>如何留住早期员工，并且调动他们的积极性，便成为了每一个上市的科技公司的难题。</li><li>华为公司比思科成立晚四年，早于 Juniper 八年。华为创办时起点就很高，当时邮电部下面的一些研究所还在和 ATT 等跨国公司谈二流技术的转让和合作，任正非直接就定位当时国际上最先进的技术，并且短短几年就开发出了当时具有国际先进水平的 08 程控交换机。</li><li>一旦一项产品可以由中国制造，那么它的利润空间就会薄到让美欧公司退出市场。现在，思科和华为的竞争就是在这种阴影笼罩下。</li></ul><h2 id="英名不朽：杨致远、菲洛和雅虎公司">英名不朽：杨致远、菲洛和雅虎公司</h2><ul><li>雅虎及其追随者们，不仅把互联网办成了开放、免费和盈利的，而且刺激了电子商务的诞生。</li><li>但是大多数创业者连产值都不考虑，觉得只有有了流量就有了一切，今天仍然有人持这种观点。</li><li>雅虎对网络泡沫的形成起到了推波助澜的作用。虽然它自己没有直接烧投资者的钱，但是无数小网络公司都是靠烧钱在维持，这如同抱薪救火，薪不尽火不灭。</li><li>到2000年大选后，终于没有新的投入进来了，互联网泡沫应声而灭。</li><li>一个技术公司，无论是过去的ATT，还是现在的Google，都会尽可能地采用技术而不是人工来解决问题，当然所有的技术都有自己的局限性和不足，一个崇尚技术的公司的态度是解决这些问题而不是倒退到手工操作。至今，雅虎仍然会手工地调整搜索结果，和Google完全用计算机排名不同。</li></ul><h2 id="硅谷的见证人：惠普公司">硅谷的见证人：惠普公司</h2><ul><li>虽然惠普从来没有领导过哪次技术革命的浪潮，但是作为硅谷最早的公司，惠普见证了硅谷发展的全过程，从无到有，从硬件到软件，惠普的历史从某种程度上讲就是硅谷历史的缩影。</li><li>这种现象在投资大师巴菲特看来是很荒唐的，安捷伦疯涨，说明惠普卖赔了，惠普应该跌才是。</li><li>惠普的墨盒和吉列的刀片有个很大的区别。刮胡子刀片是一分价钱一分货，吉列的刀片比廉价低质量的确实好不少，而且刮胡子刀片是一种特殊的商品，对它的马虎不得，用一个劣质刀片刮破脸可不是件好玩的事。</li><li>如果一个公司不能挑选好掌舵人，以后替换掉他成本也是很高的。</li></ul><h2 id="没落的贵族：摩托罗拉">没落的贵族：摩托罗拉</h2><ul><li>过分注重技术和品质使得摩托罗拉在商业上的灵活性远不如诺基亚和三星等竞争对手。</li><li>摩托罗拉对世界最大的贡献是它在八十年代初发明的民用蜂窝式移动电话，也就是早期说的大哥大，现在说的手机。</li><li>美国在标准之争上的失败间接影响的摩托罗拉手机今后的竞争力。</li><li>摩托罗拉长期以来都是一个了不起的技术公司，它长于技术，但是过分相信技术的作用。铱星计划在技术上是无与伦比的，但是，过于超前市场的技术不仅导致成本过高，而且维护费用也是巨大的。</li><li>摩托罗拉试图打造一个通用的操作系统作为它今后手机开发的统一的平台。这个想法本来不错，但是摩托罗拉选错了平台，选中了 Java 。</li></ul><h2 id="硅谷的另一面">硅谷的另一面</h2><ul><li>坦率地讲，我对这些沉溺于创业梦想的人泼凉水的时候多于鼓励的时候。虽然我知道他们更需要鼓励，但是在硅谷这个环境中，他们已经得到了无数的鼓励。</li><li>创业者还必须精力过人，因为他们必须能熬得住几年每天在简陋的车库里工作 16-20 小时的苦日子。他们又必须是多面手，因为在创业初期他们必须干所有的脏活。</li><li>但是光有好的团体和技术又远远不够，他们有商业头脑而且必须找到一个能盈利的商业模型（Business Model）</li><li>硅谷几十年经验证明，那些初出茅庐能干具体事情的年轻人，可能比一个经验丰富但是已经眼高手低的权威对公司更有用。</li><li>由于 FDA 的保护，创业的小公司要打破原有制药公司的垄断是件很难的是。这就是我们很难看到小的生物公司成功的原因。</li></ul><h2 id="短暂的春秋：与机会失之交臂的公司">短暂的春秋：与机会失之交臂的公司</h2><ul><li>太阳和微软之争，其实就是企业级的操作系统之争。对太阳来讲，取胜的关键在于是否能将它在 Unix 上的技术优势转换为市场优势。</li><li>太阳公司当时不自觉地满足于捏 SGI、DEC 和 HP 这些软柿子、并沉溺于在硬件市场上的胜利，忽视了来自微软的威胁。但当 2000 年互联网泡沫破碎时，它以服务器和工作站为主的硬件业务便急转直下。</li><li>施密特当时是太阳公司主管软件的副总裁，他从太阳失败的教训中总结出了反摩尔定理，我们已经介绍过。施密特认识到依靠硬件的利润是不断下降的，而 IT 服务业的利润则是恒定的（并随着通货膨胀而略有增加）。</li><li>当大量杰出人才离开、同时公司业绩大幅下滑时，马可尼里没有果断地大量裁员。他总给自己一个借口，我们好不容易招到这么多人（在网络泡沫时代，找工程师是很难的），如果现在裁掉冗员，万一市场好起来，我从哪里去招人。</li><li>这正应了茨威格的话，在命运降临的伟大瞬间，市民的一切美德——小心、顺从、勤勉、谨慎，都无济于事，它始终只要求天才人物，并且将他造就成不朽的形象。命运鄙视地把畏首畏尾的人拒之门外。命运——这世上的另一位神，只愿意用热烈的双臂把勇敢者高高举起，送上英雄们的天堂。</li><li>网景选择了和微软一拼，因为它觉得至少目前它还有技术和市场上的优势。后来证明这种技术上的优势根本不可靠，这也是我将技术排在形成垄断的三个条件之外的原因。在微软方面，它也正式向网景公司宣战。</li><li>网景公司在它的浏览器畅销到网络用户时，没有居安思危，它没有注意去控制互联网的内容，这样一来它失去了保护自己和反击微软的可能性。本来它最有可能成为雅虎。</li><li>即使最初网景看不到索引和组织互联网内容的重要性，但是到 1994 年底，当雅虎的流量首次达到一百万次访问时，网景也应该意识到这一点了。如果那时候网景公司走门户网站（Portal）之路，没有人能阻挡它成为后来的雅虎。</li></ul><h2 id="幕后的英雄：风险投资">幕后的英雄：风险投资</h2><ul><li>高回报的投资一定伴随着高风险，但反过来高风险常常并不能带来高回报。任何一种长期赚大钱的金融投资必须有它内在的动力做保证。风险投资也是一样，它内在的推动力就是科技的不断发展进步。</li><li>风险投资的关键是能够准确评估一项技术，并预见未来科技的发展趋势。</li><li>我通常把科技进步和新的商业模式分成进化（Evolution）和革命（Revolution）两种，虽然它们的英文单词只差一个字母，意义可差远了。创业必须要有革命性的技术或者革命性的商业模式。</li><li>风投公司介入一个新兴公司后的第一个角色就是做顾问。这个顾问不仅需要在大方向比如商业上给予建议，而且还要在很多小的方面帮助创始人少走弯路。</li><li>一个风投公司要想成功，光有钱，有眼光还很不够，还要储备许多能代表自己出去管理公司的人才。这也是著名风险投资公司比小投资公司容易成功的原因之一，前者手中攥着更多更好的管理人才。</li><li>越是成功的风投公司，投资成功上市的越多，它们以后投资的公司相对越容易上市、再不济也容易被收购。因此，大多数想去小公司发财的人，选择公司很重要的一个原则就是看它幕后的风投公司的知名度。</li></ul><h2 id="信息产业的规律性">信息产业的规律性</h2><ul><li>当某个领域发展成熟后（而不是群雄争霸时期），一般在全球容不下三个以上的主要竞争者。虽然每个领域的领头羊占得市场份额不尽相同，但是通常都是比其他所有公司的总和还多。</li><li>当市场上一旦诞生了一个新的猴王，它就成为了这个市场规则的制定者和解释者，这时，市场就不可逆转地向着有利于这个主导者的方向发展。其它公司即使在技术上、管理上或者其它方面有一点优势，都不足以抵消主导者在规则制定和解释方面的优势。靠着制定和解释规则，在很短的时间里这个王者就占了这个领域在全世界的大部分市场。</li><li>在通信领域，规则比技术更有利于一个公司占领市场。</li><li>为什么在信息产业的公司比传统工业的容易形成主导优势呢？这里面有两个关键的原因。首先是不同的成本在这两种工业中占得比例相差太大。传统行业研发成本低，但各种制造成本和销售成本是非常高的。研发成本可以通过规模经济来抵消，而制造成本则不能。</li><li>科技领域则大不相同，制造的成本只占营业额的很小一部分而研发成本占大多数。对微软和甲骨文来讲，制造一份软件拷贝的成本和一百万份没有什么区别。</li><li>虽然生物制药公司和信息科技公司一样有着低制造成本的特点，但是世界上没有一种万灵药能治所有的病，甚至对于同一种病也不存在一种药能医治所有的人，因此就有很多大的生物制药公司并存。它们每个公司专门研制针对不同疾病的药物。因此前面所讲的主导性的公司在生物制药领域并不存在。</li><li>一个主导者愿意强调自己是行业的领导者，这样可以给投资者和用户信心，但是永远会否认自己有垄断地位，以免给自己找麻烦。它们在提交到证监会和其它政府部门的官方文件中甚至会列举一些小的不能再小的竞争对手，表示自己在公平竞争。</li><li>诺威格定理：当一个公司的市场占有率超过 50% 后，就无法再使市场占有率翻番了。这几乎是任何人都懂的大白话，但是却道出了许多跨国公司兴衰的根源。</li><li>当它占领了大部分市场时，它的成长就受制于整个行业的发展了。而华尔街依然期望着这个新兴公司不断创造奇迹。这时候，该公司就必须寻找新的成长点，才能不断超越华尔街的预期，公司就不得不天天为营收忙碌</li><li>通用汽车失败的根源在它根深蒂固的思维方式：它一直认定自己是个汽车公司，一定就要以汽车公司为主。这好比在围棋盘上，通用汽车有一条经营了很长时间却已经没有气的大龙，和一片布局完美可扩展空间大的实空，通用汽车总是舍不得牺牲掉自己经营多年的大龙而错误地放弃前景看好的实空，最后满盘皆输。</li><li>严格地讲，苹果其实不能算是一个计算机公司，而是一个注重创新的消费电子公司。在苹果眼中，计算机不过是新的电子产品的一种，当然苹果要把它做得越新、越酷越好。</li><li>红杉风投认为一个公司的基因在创办的一个月内就定型了，这也许有些夸张，但是一个成型的公司改变基因的可能却是非常小。越是以前成功的公司越是容易相信自己固有的基因是最优秀的。</li></ul><h2 id="高科技公司的摇篮：斯坦福大学">高科技公司的摇篮：斯坦福大学</h2><ul><li>从斯坦福夫人身上我们看到一位真正慈善家的美德。慈善不是在富有以后拿出自己的闲钱来沽名钓誉，更不是以此来为自己做软广告，慈善是在自己哪怕也很困难的时候都在帮助社会的一种善行。</li><li>一旦某个项目有了商业价值，并且可以由公司资助时，政府会渐渐减少并且最终停止对这些课题的资助，因为政府（纳税人的代表）认为没有必要和工业界做重复的事，更没有必要和工业界竞争。在这一点上，美国政府和中国政府与日本政府有很大的不同。</li><li>只要一个教授能完成教学任务，并且发表足够多像样的论文，斯坦福并不限制它的教授到外面的公司兼职，甚至在一段时间里全时离开学校创办公司或者在公司里担任要职。</li><li>可以想象如果佩奇和布林不是斯坦福的研究生而是什么其它学校的，他们很难有机会直接向一位工业界领袖推销自己的发明。大家可以试想一下，在中国，一位普通的清华大学或者北京大学的研究生有没有可能通过学校直接见到华为的创始人任正非，斯坦福能做到这件事是它了不起的地方。</li></ul><h2 id="科技公司的吹鼓手：投资银行">科技公司的吹鼓手：投资银行</h2><ul><li>罗斯柴尔德家族十九世纪中后叶达到高峰，但是犯了几次致命的错误，又遇到几次灭顶之灾，便从此一蹶不振的。该家族犯的第一个错误就是低估了美国的发展。十九世纪后半叶，美国因为种族矛盾尖锐，后来又爆发了内战，罗斯柴尔德家族对美国不看好，撤走了在美国的大部分业务，失去了追随美国发展的大好时机。（我常常和别人讲，错过现在中国发展的快车，就像一百五十年前错过美国发展一样可惜。）</li><li>由于美国银行业的基础是私有银行，抵抗金融危机的能力就很有限，在 1907 年的金融危机中，美国的银行业几乎崩溃。这时，由著名银行家摩根发起，联合了各大银行，在总统威尔逊的支持下，美国建立了联邦储备银行系统（Federal Reserve System），简称美联储。</li><li>投资公司，虽然他们又称投资银行（Investment Bank），但是直到 2008 年 10 月，它们都不是真正意义上的银行，因为他们既不能接受存款，也不能向联邦储备银行借钱，它们是替别人买卖有价证券、期货、不动产和任何有价值的商品。</li><li>有人觉得雷曼和美林只要再坚持五天就可以逃过一劫，其实，只要它们两家公司一天不死，这个计划就不会从保尔森的口袋里拿出来。</li><li>摩根斯坦利是银行业中计算机化的先驱。早在 1962 年，它就通过计算机来分析股市并且建立了很多用于金融的数学模型（Quantitative Financial Analysis Model），并且获得了很大的成功。由于摩根斯坦利在金融界的影响力，其它金融公司也纷纷效仿，从此开创了一种用数学模型分析市场的新领域。这对八十年代后对冲基金的兴起起了先导作用。</li><li>和百度相反，中石油在香港的上市堪称败笔。首先它作为全球最大的融资行动，却选择了一家二流的承包商瑞士联合银行和不入流的中信。这两家承包商为中石油作出了天价的融资股价，以至于长期持有它的巴菲特马上套现。</li><li>融资过多和过少都是有危害的。过度的融资不仅导致原有股东的利益被压缩，而且由于在短时间里流入市场的股票太多，股价很难稳定。融资过少的危害也很明显，很多公司就是因为融资不足而在经济进入低谷时无资金摆脱困境而关门。</li><li>对于那些价值不大的科技公司，一旦它们未能达到预期，华尔街则会毫不留情的打压到底，以起到杀鸡示猴的作用。</li><li>要想不受华尔街的影响，唯一的办法就是不上市。这就是 Google 在盈利很久以后迟迟不肯上市的原因</li><li>金融业在整个经济活动中起着血液的作用。健康的金融环境和秩序可以帮助科技公司的成长。但是由于金融业和巨大的利益联系在一起，因此贪婪、投机甚至非法的欺骗行为是金融业永远也摆脱不了的阴影。</li></ul><h2 id="挑战者：Google-公司">挑战者：Google 公司</h2><ul><li>我们问佩奇是如何想到Page Rank算法的。他说&quot;当时我们觉得整个互联网就像一张大的图( Graph ) ,每个网站就像一个节点，而每个网页的链接就像一个弧。我想，互联网可以用一个图或矩阵描述， 我也许可以用这个发现做个博士论文。</li><li>虽然今天的Google 和其他搜索引擎相比当初的Google 已有了长足的进步，但是这种进步基本上属于量变。搜索引擎领域迄今为止的质变只有 Google 取代AltaVista 那一次。</li><li>佩奇知道，只有把互联网的内容送到千家万户就行了，至于互联网的内容是谁的并不重要。</li><li>巴菲特有一个最简单有效的选择股票的办法，就是到大小百货店、加油站和食品店看一看老百姓都在买什么，这比听华尔街分析师瞎掰乎要准确得多。巴菲特因此而选择了可口可乐、宝洁、强生、百威啤酒、沃尔玛和卡夫食品等公司技资，都获得了极高的回报。在巴菲特看来，广大消费者才是一切商业的衣食父母。佩奇和布林也深深体会到，广大最终的用户(网民和广告商)才是为Google 带来生意的人，因此， Google 的产品一直是针对广大用户，既非像IBM 那样针对企业，又非像苹果那样针对精英。</li><li>Google 在早期并没有刻意追求营业额和利润，而是想方设法扩大自己的用户群。除了在技术上要比对手做得好以外，还将自己的网页做得特别干净，这样在到处是铺天盖地的横幅广告和弹出式广告的互联网上，显得非常超凡脱俗，便吸引了很多用户。</li><li>由于Google 很明智地没有在互联网泡沫高峰期疯狂地扩展，而是实实在在地、低调地做好自己的搜索引擎，因此它早期烧钱的速度非常之慢。2000 年的时候它没有急着上市，避免了绝大多数互联网公司大起大落并且最终关门的厄运，同时最早期的优秀人才没有拿了钱就走掉，因此Google 的骨干完好无损。</li><li>他解释 Google 的人才战略时说，好的博士生不仅有创造力，而且有最高的自觉性。硕士生同样的聪明，但是主动性要差一些。硕士能把你领到别人到过的地方，而博士可以把你带到以前无人去过的地方。</li><li>Google 是一家思维方式与众不同的公司，它认为，杀鸡一定要用牛刀。一个本科生能完成的事，如果我能找到一个硕士生来做，那么一定比同类公司做得好! 在Google 里面实际上是贯彻一种&quot;瑞士制造&quot;的指导思想， Google 自己把它称为&quot;Google 的品质&quot; 。</li><li>随着自由派总统奥巴马的当选和任职，美国和中国的蜜月期终于过去了。自由派人士占主导的Google总部对中国的互联网管制方式一直难于接受，这中间的矛盾全压在李开复身上。终于有一天，他不堪重负，选择了离开。缺少了李开复这个润滑剂， Google 和中国的关系变得很难调和，最终导致了2010 年初Google 退出中国的事件。</li></ul><h2 id="成功的转基因：诺基亚、3M、GE">成功的转基因：诺基亚、3M、GE</h2><ul><li>芬兰政府给诺基亚的支持是在人才上的支持。芬兰在欧洲近乎于一个社会主义国家，它为民众提供从小学到大学全部的免费教育。这就为诺基亚提供了人才保障。同时，作为一个小国，芬兰政府知道它不可能在世界经济的方方面面都领先，因此全国只专注几个产业，当然，移动通信是一个。而在芬兰的大学和研究所里，也就很少看到跟它产业结构不太相关的专业。</li><li>到了数字手机时代，不同手机的话音质量相差不像以前那么大，这时手机的功能就变得非常重要了，再到后来手机的外观都变得重要起来。</li><li>诺基亚由一个地区性的木工厂发展到全球最大的手机厂商，原因可以简单概括为长期探索、抓住机遇和制定规则几个字。</li><li>3M 允许员工用 15% 的时间干任何自己喜欢做的事，后来这个做法被 Google 学去了，变成了 Google 的百分之二十项目。</li><li>3M 公司在适当的时候强制淘汰一些看似还在挣钱但是前景不是很好的产品。</li><li>因为企业级的产品和服务受经济大环境的影响太大，收入相对不如消费者产品来得稳定。</li><li>了解 GE 公司历史的人都知道这个充满传奇色彩的公司是由著名发明家爱迪生创立的，是将电最早介绍和普及到世界上的公司。</li><li>3M 是靠硬性的制度维持其创新，而 GE 是靠自己不断开创新的产业。</li></ul><h2 id="印钞机：最佳的商业模式">印钞机：最佳的商业模式</h2><ul><li>所有成功的大公司都有好的商业模式，很多大公司的兴起，不是靠技术的革新而是商业模式的转变。</li><li>在这台印钞机中，自动化程度必须到达一个阈值，它才能自动运转起来。而当它的自动化越高，成本就越低。</li><li>长城公司自己开发微机全部软硬件，自己在广东建厂，自己采购元器件，有自己的仓储，最后还发展了一大批批发和零售代理商。大家不难看到，长城公司处处走的是和戴尔公司相反的路线。当长城计算机公司很自豪地拥有了这一切时候，它的资金利用率已经比戴尔低了很多，而它的产品的价格却高了很多。</li></ul><h2 id="互联网-2-0">互联网 2.0</h2><ul><li>到2000年世界上流量最大的网站全部是门户网站，在美国是雅虎、MSN 和Excite 等在中国则是新浪、搜狐和网易三大门户网站。</li><li>互联网2.0的公司不应该过多主导内容和服务，不应该参与和用户的竞争。以YouTube 为例，它host 的内容是用户（包括个人和专业的传媒公司）提供，它自己并不制作和拥有内容， 与其他提供内容的用户竞争。</li><li>互联网2.0公司的一个普遍特点就是专注于打造通用的平台，而由社会上的开发力量和广大用户补充成完整的服务，从Wikipedia 到Facebook 都是如此，它们相当于软件时代的甲骨文和微软。</li></ul><h2 id="金融风暴的冲击">金融风暴的冲击</h2><ul><li>科技像是我们这个社会的大脑，而金融则是血液。没有了科技，这个社会就会是混混沌沌的，就像中世纪的欧洲；而没有了金融，这个社会就停止了运转。</li><li>金融危机的直接和表层的原因是次贷（Subprime Loan） 及与之相关的金融衍生物CDS ，而间接和深层的原因则是违反经济规律地只消费不创造，从而坐吃山空。</li><li>当人们为格林斯潘神奇的控制经济的能力叹服时， 实际上他是用一个更大的房市泡沫解决了相对小得多的互联网泡沫的问题。</li><li>金融危机首先将淘汰掉这些无法适应新环境的恐龙级的公司，因为这些长期部借新的贷款来偿还旧的贷款利息过活的跨国公司，现在已无法贷到新款，或者贷款的成本太高。</li><li>大量不健康的公司会使得整个社会的投资效率低下， 经济生活变得死气沉沉。这些公司的消失，为健康的公司腾出了宝贵的市场，健康而有活力的公司将成为未来直接的收益者。</li><li>金融危机使得以前一些不可能的兼并成为可能，并因此打造出一些竞争力更强的大型公司。</li><li>经济危机时，风险投资家们不得不主动收缩战线，弃卒保车。它们通常的做法是迅速关闭成活可能性小的公司，把资金集中投入给可以生存下去的公司中，保住一些重点投资。对于那些运营不错的公司，反而可能得到比宏观经济好的时期更多的资金，虽然它们日子也颇为艰难，却无疑是遇到了一个非常好的发展机会。</li><li>我的建议是，不求大的发展，但求生存。必须要保证12到18个月后还有资金，还活着。现在看来，能坚持一到两年的小公司，发展得都比金融危机前要好。</li><li>这些公司因为没有利润，甚至没有营业额，根本无法按照传统的市盈率（ P／E ） 比来估价，于是他们伙同华尔街发明了用股价／ 流量比来对这些网络垃圾估价。</li></ul><h2 id="云计算">云计算</h2><ul><li>在甲骨文的Network Computer 失败后， 第一次互联网的泡沫也破灭了，大家对互联网的作用也产生了怀疑，一切基于客户端的想法又占了上风，因此很长时间这种基于Web 应用的概念没有人提了。</li><li>亚马逊发现，它不仅仅可以为商家提供网站托管服务，还可以为任何需要建立网站的公司提供。这样，任何一个想通过互联网提供服务（包括电子商务） 的公司和个人都不需要自己建网站，而只要租用亚马逊的计算资源即可。这就是亚马逊理解的云计算，它和IBM 的理解完全不同，但是没有矛盾。</li><li>云计算本身是一个非常复杂的系统工程。它的普及首先离不开巨型数据中心的建设和全球高速光纤主干网的铺设，这就好比电的普及离不开发电厂和输电网一样。在Google，这些工程称为全球基础架构，它本身也需要很多关键技术，甚至一些看上去IT无关的技术，比如制冷技术。全球基础架构设计和实施的好坏可能会导致运营成本上成倍的差别。</li><li>云计算要想得到充分的发展和全世界计算机产业的认可，不是单凭任何一家公司的力量就能做到的.</li></ul><h2 id="下一个Google">下一个Google</h2><ul><li>很多公司靠炒作概念，而利润平平，在一段时间里，股价炒得很高，他们依靠发行新股获得了充足资金，然后盲目扩大业务。虽然风光一时，但光环迅速消失。</li><li>即使今天出现了一个比微软Windows 好一倍的操作系统，用户也没有要换操作系统的欲望，因为微软的够用了 。够用了这条很消极而枯燥的原则，让所有想通过做一个操作系统取代微软的努力都变得无效。</li><li>云计算不仅是今后最有希望的产业， 而且是上面很多产业，比如3G 移动通信的支柱。</li><li>可以毫不夸张地讲，阿里巴巴已经完全占领中同电子市场的制高点，而且只要它不犯大的错误，现在找不出一家公司可以挑战它的商业地位。</li><li>马云自己都认为是阿里巴巴开创了中同的电子商务市场。从效果上看这一点并不错，但是有些因果倒置。事实上是，中同非常糟糕的批发和零售商业环境，要求必须出现一家阿里巴巴这样让商业变得容易的公司。</li><li>腾讯的做法和Google 非常类似，通过一款产品抓住终端用户，然后通过一些服务从每一个用户身上挣钱。</li><li>美国取代英国成为世界第一强国的时候，依靠的不是任何资本泡沫，而是爱迪生和西屋（发明电和交流供电）、贝尔（发明电话）、福特（发明汽车）、怀特兄弟（发明飞机）等这样一大批在世界文明史上占有重要位置的发明家，以及洛克菲勒（石油）、卡内基（钢铁）、杜邦（ 化工）等搞实业的工业巨子。</li><li>当人们不再把房市、股市作为最快的挣钱手段时，就是中国可以诞生下一个Google 的时候了。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Awesome Active Learning</title>
    <link href="/machine-learning/awesome-active-learning/"/>
    <url>/machine-learning/awesome-active-learning/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>This is the introduction for the <a href="https://github.com/SupeRuier/awesome-active-learning">Awesome-Active-Learning</a> project.<strong>Hope you can find everything you need about active learning (AL) in this repository.</strong></p><p>这篇博文同样有一份<strong>中文版本</strong>: <strong><a href="/machine-learning/al-all-in-one/" title="主动学习，看这一篇就够了">主动学习，看这一篇就够了</a></strong>。</p><span id="more"></span><p>This is not only a curated list, but also a well-structured library for active learning.The whole repository is constructed in a <strong>problem-orientated</strong> approach, which is easy for users to locate and track the problem.At the mean time, the techniques are discussed under the corresponding problem settings.</p><p>Specifically, this repository includes:</p><ul><li><a href="#1-what-is-al">1. What is AL?</a></li><li><a href="#2-reviewssurveysbenchmarks">2. Reviews/Surveys/Benchmarks</a></li><li><a href="#3-problem-settings">3. Problem Settings</a><ul><li><a href="#31-basic-problem-settings-three-basic-scenarios">3.1. Basic Problem Settings (Three basic scenarios)</a></li><li><a href="#32-advanced-problem-settings">3.2. Advanced Problem Settings</a></li><li><a href="#33-tasks-in-other-ai-research-fields">3.3. Tasks in other AI Research Fields</a></li></ul></li><li><a href="#4-theoretical-support-for-active-learning">4. Theoretical Support for Active Learning</a></li><li><a href="#5-practical-considerations-to-apply-al">5. Practical Considerations to Apply AL</a></li><li><a href="#6-real-world-applications-of-al">6. Real-World Applications of AL</a></li><li><a href="#7-resources">7. Resources</a><ul><li><a href="#71-software-packageslibraries">7.1. Software Packages/Libraries</a></li><li><a href="#72-tutorials">7.2. Tutorials</a></li></ul></li><li><a href="#8-groupsscholars">8. Groups/Scholars</a></li></ul><p>The hierarchical structure of this repository is shown in the following figure, and <strong>you can find the paper-list in the corresponding sub-pages</strong>:</p><p><img src="repo-structure.png" alt="Repo Structure"></p><h3 id="Shortcuts"><strong>Shortcuts</strong></h3><p>These shortcuts could quickly lead you to the information you want.</p><table><thead><tr><th>Link</th><th>Note</th></tr></thead><tbody><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/pb_classification.md">Taxonomy of Strategies</a></td><td>The types of AL strategies, in general pool-based scenario.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md">AL Aids AI</a></td><td>Use AL under other AI research problems.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_applications.md">AL Applications</a></td><td>The scientific and industrial applications of AL.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/practical_considerations.md">Practical Considerations</a></td><td>The practical issues in applying AL when the assumptions change.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/intrinsic_issues.md">Intrinsic Issues in AL</a></td><td>The intrinsic issues of AL.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/deep_AL.md">Deep AL</a></td><td>AL with deep neural networks.</td></tr></tbody></table><h3 id="Contributing"><strong>Contributing</strong></h3><p>If you find any valuable researches, please feel free to <a href="https://github.com/SupeRuier/awesome-active-learning/pulls">pull request</a> or contact <a href="ruihe.cs@gmail.com">ruihe.cs@gmail.com</a> to update this repository.Comments and suggestions are also very welcome!</p><h1>1. What is AL?</h1><p>High labeling cost is common in machine learning community.Acquiring a heavy number of annotations hindering the application of machine learning methods.Active learning is one approach to relief this annotation burden.The intuition is that not all the instances are equally important to the desired task, so only labeling the more important instances might bring cost reduction.</p><p>It is very hard to find a formal definition of general AL within a single optimization function.It would be better to define specific AL under specific problem settings.Hence, we only point out the essences of AL in this section.<strong>When we talk about active learning, we talk about</strong>:</p><ul><li>an approach to reduce the annotation cost in machine learning.</li><li>the ways to select the most important instances for the corresponding tasks.</li><li>(in most cases) an interactive labeling manner between algorithms and oracles.</li><li>a machine learning setting where human experts could be involved.</li></ul><h1>2. Reviews/Surveys/Benchmarks</h1><p>There have been several reviews/surveys/benchmarks for this topic.They provided a good overview for the field.</p><p><strong>Reviews/Surveys</strong>:</p><ul><li>Active learning: theory and applications <a href="https://ai.stanford.edu/~koller/Papers/Tong:2001.pdf.gz">[2001]</a></li><li>Active Learning Literature Survey <strong>(Recommend to read)</strong><a href="https://minds.wisconsin.edu/handle/1793/60660">[2009]</a></li><li>A survey on instance selection for active learning <a href="https://link.springer.com/article/10.1007/s10115-012-0507-8">[2012]</a></li><li>Active Learning: A Survey <a href="https://www.taylorfrancis.com/books/e/9780429102639/chapters/10.1201/b17320-27">[2014]</a></li><li>Active Learning Query Strategies for Classification, Regression, and Clustering: A Survey <a href="https://link.springer.com/article/10.1007/s11390-020-9487-4">[2020]</a>[Journal of Computer Science and Technology]</li><li>A Survey of Active Learning for Text Classification using Deep Neural Networks <a href="https://arxiv.org/pdf/2008.07267.pdf">[2020]</a></li><li>A Survey of Deep Active Learning <a href="https://arxiv.org/pdf/2009.00236.pdf">[2020]</a></li><li>Active Learning: Problem Settings and Recent Developments <a href="https://arxiv.org/pdf/2012.04225.pdf">[2020]</a></li><li>From Model-driven to Data-driven: A Survey on Active Deep Learning <a href="https://arxiv.org/pdf/2101.09933.pdf">[2021]</a></li><li>Understanding the Relationship between Interactions and Outcomes in Human-in-the-Loop Machine Learning <a href="http://harp.ri.cmu.edu/assets/pubs/hil_ml_survey_ijcai_2021.pdf">[2021]</a>: HIL, a wider framework.</li><li>A Survey on Cost Types, Interaction Schemes, and Annotator Performance Models in Selection Algorithms for Active Learning in Classification <a href="https://arxiv.org/pdf/2109.11301.pdf">[2021]</a></li><li>A Comparative Survey of Deep Active Learning <a href="https://arxiv.org/pdf/2203.13450.pdf">[2022]</a></li></ul><p><strong>Benchmarks</strong>:</p><ul><li>A Comparative Survey: Benchmarking for Pool-based Active Learning <a href="https://www.ijcai.org/proceedings/2021/0634.pdf">[2021]</a>[IJCAI]</li><li>A Framework and Benchmark for Deep Batch Active Learning for Regression <a href="https://arxiv.org/pdf/2203.09410.pdf">[2022]</a></li></ul><h1>3. Problem Settings</h1><p>In this section, <strong>the specific problems which active learning is trying to solve are described</strong>.The previous works are organized in a problem-oriented order.The methods are categorized for the corresponding settings in the subpage.</p><p><strong>Three levels of problem settings</strong>:</p><ol><li>Basic Problem Settings<ul><li>Under the basic scenarios: Pool-based/Stream-based/Query synthesis</li><li>Under the basic tasks: Classification/Regression</li></ul></li><li>Advanced Problem Settings<ul><li>Under many variants of machine learning problem settings</li></ul></li><li>Tasks from other Research Fields<ul><li>With more complex tasks from other research fields</li></ul></li></ol><h2 id="3-1-Basic-Problem-Settings-Three-basic-scenarios">3.1. Basic Problem Settings (Three basic scenarios)</h2><p>There are three basic types of scenarios, almost all the AL works are build on these scenarios.The scenarios are different in where the queried instances are from:</p><ul><li><strong>pool-based</strong>: select from a pre-collected data pool</li><li><strong>stream-based</strong>: select from a steam of incoming data</li><li><strong>query synthesis</strong>: generate query instead of selecting data</li></ul><p>For the most basic AL researches, they usually study on two basic tasks:</p><ul><li>classification</li><li>regression</li></ul><p>The details and the list of works could see <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_problem.md"><strong>here</strong></a>.</p><h2 id="3-2-Advanced-Problem-Settings">3.2. Advanced Problem Settings</h2><p>There are many variants of machine learning problem settings with <strong>more complex assumptions</strong>.Under these problem settings, AL could be further applied.</p><ul><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MCAL.md">Multi-class active learning</a>: In a classification task, each instance has one label from multiple classes (more than 2).</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MLAL.md">Multi-label active learning</a>: In a classification task, each instance has multiple labels.</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MTAL.md">Multi-task active learning</a>: The model or set of models handles multiple different tasks simultaneously. For instance, handle two classification tasks at the same time, or one classification and one regression.</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MDAL.md">Multi-domain active learning</a>: Similar to multi-task, but the data are from different datasets(domains). The model or set of models handles multiple datasets simultaneously.</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MVAL.md">Multi-view/modal active learning</a>: The instances might have different views (different sets of features). The model or set of models handles different views simultaneously.</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MIAL.md">Multi-instance active learning</a>: The instances are organized into bags and training labels are assigned at the bag level.</li></ul><h2 id="3-3-Tasks-in-other-AI-Research-Fields">3.3. Tasks in other AI Research Fields</h2><p>In many AI research fields, the tasks can’t be simply marked as classification or regression.They either acquire different types of outputs or assume a unusual learning process.So AL algorithms should be revised/developed for these problem settings.Here we summarized the works which <strong>use AL to reduce the cost of annotation in many other AI research fields</strong>.</p><ul><li>Computer Vision (CV)</li><li>Natural Language Processing (NLP)</li><li>Transfer learning/Domain adaptation</li><li>Metric learning/Pairwise comparison/Similarity learning</li><li>One/Few/Zero-shot learning</li><li>Graph Processing</li><li>etc.(The full list of fields could see <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md"><strong>here</strong></a>)</li></ul><h1>4. Theoretical Support for Active Learning</h1><p>There have been many theoretical supports for AL.Most of them are focus on finding a performance guarantee or the weakness of AL selection.(This section has not finished yet.)</p><h1>5. Practical Considerations to Apply AL</h1><p>Many researches of AL are built on very idealized experimental setting.When AL is used to real life scenarios, the practical situations usually do not perfectly match the assumptions in the experiments.These <strong>changes of assumptions</strong> lead issues which hinders the application of AL.In this section, the practical considerations are reviewed under different assumptions.The details and the list of works could see <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/practical_considerations.md"><strong>here</strong></a>.</p><table><thead><tr><th>Assumption Type</th><th>Practical Considerations</th></tr></thead><tbody><tr><td>Data</td><td>Imbalanced data</td></tr><tr><td></td><td>Cost-sensitive case</td></tr><tr><td></td><td>Logged data</td></tr><tr><td></td><td>Feature missing data</td></tr><tr><td></td><td>Multiple Correct Outputs</td></tr><tr><td></td><td>Unknown input classes</td></tr><tr><td></td><td>Different data types</td></tr><tr><td></td><td>Data with Perturbation</td></tr><tr><td>Oracle</td><td>The assumption change on single oracle (Noise/Special behaviors)</td></tr><tr><td></td><td>Multiple/Diverse labeler (ability/price)</td></tr><tr><td>Workflow</td><td>Cold start</td></tr><tr><td></td><td>Stop criteria</td></tr><tr><td>Scale</td><td>Large-scale</td></tr><tr><td>Training cost</td><td>Take into account the training cost</td></tr><tr><td></td><td>Incrementally Train</td></tr><tr><td>Query types</td><td>Provide other feedbacks other than just labels</td></tr><tr><td>Performance metric</td><td>Other than the learning curves</td></tr></tbody></table><h1>6. Real-World Applications of AL</h1><p>We have introduced that AL could be used in many <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md">other AI research fields</a>.In addition, AL has already been used in many real-world applications.For some reasons, the implementations in many companies are confidential.But we can still find many applications from several published papers and websites.</p><p>Basically, there are two types of applications: <strong>scientific applications</strong> &amp; <strong>industrial applications</strong>.We summarized a list of works <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_applications.md"><strong>here</strong></a>.</p><h1>7. Resources</h1><h2 id="7-1-Software-Packages-Libraries">7.1. Software Packages/Libraries</h2><table><thead><tr><th>Name</th><th>Languages</th><th>Author</th><th>Notes</th></tr></thead><tbody><tr><td><a href="https://github.com/google/active-learning">AL playground</a></td><td>Python(scikit-learn, keras)</td><td>Google</td><td>Abandoned</td></tr><tr><td><a href="https://github.com/modAL-python/modAL">modAL</a></td><td>Python(scikit-learn)</td><td>Tivadar Danka</td><td>Keep updating</td></tr><tr><td><a href="https://github.com/ntucllab/libact">libact</a></td><td>Python(scikit-learn)</td><td>NTU(Hsuan-Tien Lin group)</td><td></td></tr><tr><td><a href="https://github.com/NUAA-AL/ALiPy">ALiPy</a></td><td>Python(scikit-learn)</td><td>NUAA(Shengjun Huang)</td><td>Include MLAL</td></tr><tr><td><a href="https://github.com/rmunro/pytorch_active_learning">pytorch_active_learning</a></td><td>Python(pytorch)</td><td>Robert Monarch</td><td>Keep updating &amp; include active transfer learning</td></tr><tr><td><a href="https://github.com/ej0cl6/deep-active-learning">DeepAL</a></td><td>Python(scikit-learn, pytorch)</td><td>Kuan-Hao Huang</td><td>Keep updating &amp; deep neural networks</td></tr><tr><td><a href="https://github.com/ElementAI/baal/">BaaL</a></td><td>Python(scikit-learn, pytorch)</td><td>ElementAI</td><td>Keep updating &amp; bayesian active learning</td></tr><tr><td><a href="https://github.com/IBM/low-resource-text-classification-framework">lrtc</a></td><td>Python(scikit-learn, tensorflow)</td><td>IBM</td><td>Text classification</td></tr><tr><td><a href="https://github.com/webis-de/small-text">Small-text</a></td><td>Python(scikit-learn, pytorch)</td><td>Christopher Schröder</td><td>Text classification</td></tr><tr><td><a href="https://github.com/PatrickZH/DeepCore">DeepCore</a></td><td>Python(scikit-learn, pytorch)</td><td>Guo et al.</td><td>In the coreset selection formulation</td></tr><tr><td><a href="https://github.com/RelationRx/pyrelational">PyRelationAL: A Library for Active Learning Research and Development</a></td><td>Python(scikit-learn, pytorch)</td><td>Scherer et al.</td><td></td></tr><tr><td><a href="https://github.com/SineZHAN/deepALplus/"> DeepAL+</a></td><td>Python(scikit-learn, pytorch)</td><td>Zhan</td><td>An extension for DeepAL</td></tr></tbody></table><h2 id="7-2-Tutorials">7.2. Tutorials</h2><table><thead><tr><th>Title</th><th>Year</th><th style="text-align:center">Lecturer</th><th>Occasion</th><th>Notes</th></tr></thead><tbody><tr><td><a href="https://github.com/Azure/active-learning-workshop">Active learning and transfer learning at scale with R and Python</a></td><td>2018</td><td style="text-align:center">-</td><td>KDD</td><td></td></tr><tr><td><a href="https://www.youtube.com/watch?v=_Ql5vfOPxZU">Active Learning from Theory to Practice</a></td><td>2019</td><td style="text-align:center">Robert Nowak &amp; Steve Hanneke</td><td>ICML</td><td></td></tr><tr><td><a href="https://jacobgil.github.io/deeplearning/activelearning">Overview of Active Learning for Deep Learning</a></td><td>2021</td><td style="text-align:center">Jacob Gildenblat</td><td>Personal Blog</td><td></td></tr></tbody></table><h1>8. Groups/Scholars</h1><p>We also list several scholars who are currently heavily contributing to this research direction.</p><ol><li><a href="https://www.csie.ntu.edu.tw/~htlin/">Hsuan-Tien Lin</a></li><li><a href="http://parnec.nuaa.edu.cn/huangsj/">Shengjun Huang</a> (NUAA)</li><li><a href="https://sites.google.com/site/drwuHUST/publications/completepubs">Dongrui Wu</a> (Active Learning for Regression)</li><li>Raymond Mooney</li><li><a href="http://ise.thss.tsinghua.edu.cn/MIG/gyc.html">Yuchen Guo</a></li><li><a href="https://scholar.google.com/citations?hl=zh-CN&amp;user=fEhNO7YAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">Steve Hanneke</a></li></ol><p>Several young researchers who provides valuable insights for AL:</p><ul><li>Jamshid Sourati [University of Chicago]: Deep neural networks.</li><li>Stefano Teso [University of Trento]: Interactive learning &amp; Human-in-the-loops.</li><li>Xueyin Zhan [City University of Hong Kong]: Provide several invaluable comparative surveys.</li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>active-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>主动学习(Active Learning)，看这一篇就够了</title>
    <link href="/machine-learning/al-all-in-one/"/>
    <url>/machine-learning/al-all-in-one/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>本文是对自己 <a href="https://github.com/SupeRuier/awesome-active-learning">Awesome-Active-Learning</a> 项目的一个宣传及简要介绍，不定期更新。</p><p>An <strong>English Version</strong> Of This Post: <strong><a href="/machine-learning/awesome-active-learning/" title="Awesome Active Learning">Awesome Active Learning</a></strong>.</p><span id="more"></span><h2 id="0-写在最前">0. 写在最前</h2><p>在自己对主动学习（Active Learning）的学习和研究过程中，一直断断续续收集整理了很多不同方向的文章和研究进展，日积月累，整理的内容开始完善和系统化，于是将其开源成 <a href="https://github.com/SupeRuier/awesome-active-learning">awesome active learning</a> 项目。</p><p>对于该项目，我的初衷是：维护一个<strong>包含主动学习方方面面的知识库</strong>，这样研究者和工程师可以较快锁定相关工作并展开科研。 同时，也由于个人的力量有限，希望大家可以一起对主动学习的相关进展进行追踪梳理和总结。如发现遗漏或错误，或想要增补一些新的内容，欢迎大家在该项目下 pull request 或者通过邮件 <a href="mailto:ruihe.cs@gmail.com">ruihe.cs@gmail.com</a> 联系我。知识库的整体结构如下图所示，希望大家能在这个知识库项目中找到你需要的关于主动学习的一切信息。</p><div style="width:100%;margin:auto"><img src="/machine-learning/al-all-in-one/repo-structure.png" class=""></div><p>​</p><h3 id="0-1-关于本文">0.1. 关于本文</h3><p>本文旨在对主动学习（AL）领域从一个<strong>以问题为导向</strong>的角度，展开阐述当前主动学习的研究和应用。 此处的以问题为导向包含两个方面，一是指主动学习期望解决的实际问题，二是指主动学习应用中的技术问题。 本文的重点是对这些问题进行基本的描述和文献总结，从而让大家对主动学习的适用场景有一定的认识。 一些关于理论和技术上的分类也会有所提及，但是详细内容不会在本文中展开。此外，本文不涉及列举具体场景下具体算法的文献，若阁下对所描述的问题场景有兴趣，可以移步 github 项目并查阅相关文献列表。</p><h3 id="0-2-推荐阅读的-Survey-Review">0.2. 推荐阅读的 Survey/Review</h3><p>作为一个相对成熟的领域，目前已有不少相关的文献综述和领域调研。 此处推荐以下两篇，其余的可以去我们的项目中查看完整的列表：</p><ul><li>Active Learning Literature Survey [<a href="https://minds.wisconsin.edu/handle/1793/60660">2012</a>]：作者为 Burr Settles。这是最著名也是相对较早的一篇调研，至今已有数千次引用，初步了解可以看这一篇。</li><li>A Survey on Active Deep Learning: From Model-Driven to Data-Driven [<a href="https://arxiv.org/pdf/2101.09933.pdf">2020</a>]：较新的一篇文章，主要是在技术角度对主动学习的方法进行分类，个人认为这篇文章需要在对具体问题有足够清晰地了解之后再看，否则过早陷入对技术的纠结其实不利于对领域的认知。</li></ul><h3 id="0-3-项目关键章节传送门">0.3. 项目关键章节传送门</h3><p>对于一些 <strong>AL 的关键方向</strong>，我们在此设立传送门，可以直达我们项目中的相关章节（英文版）。</p><ul><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/pb_classification.md">主动学习策略分类</a>：在 Pool-based 场景下的主要方法分类。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md">AI 中的 AL</a>：用主动学习来尝试解决 AI 各问题下的标注/查询成本昂贵问题。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_applications.md">AL 的应用方向</a>：<strong>科学研究应用</strong>和<strong>工业界应用</strong>两个方面。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/practical_considerations.md">AL 使用中的实际考虑</a>：当 AL 假设不完全成立时，或者遇到新的问题场景时如何解决。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/intrinsic_issues.md">AL 内在的问题</a>：AL 这种选取模式带来的不可避免的问题。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/deep_AL.md">深度主动学习</a>：如何在深度神经网络上使用主动学习。</li></ul><h2 id="1-什么是主动学习？（若已有背景知识可跳过）">1. 什么是主动学习？（若已有背景知识可跳过）</h2><p>监督学习问题中，存在标记成本较为昂贵且标记难以大量获取的问题。 针对一些特定任务，只有行业专家才能为样本做上准确标记。在此问题背景下，主动学习（Active Learning, AL）尝试通过选择性的标记较少数据而训练出表现较好的模型。下面是从 Burr 的 Survey 中选取的一个简单的例子，图©中使用主动学习策略仅选取30个样本作为训练集训练出的逻辑回归模型即可达到90%的准确率，而图(b)中随机选取的30个样本训练出的模型却相对表现较差。</p><div style="width:100%;margin:auto"><img src="/machine-learning/al-all-in-one/toy_example.jpg" class="" title="在一个人造数据集上主动学习策略与随机选取的对比"></div><p>从整个学习过程来看，在相同数目的标记样本下，主动学习选取的表现要好于随机选取的表现。这种可以描绘出整个学习过程的曲线也一般用于对主动学习方法进行评估。​</p><div style="width:80%;margin:auto"><img src="/machine-learning/al-all-in-one/learning_curve.jpg" class="" title="主动学习的学习曲线"></div><p>主动学习最重要的假设是不同样本对于特定任务的重要程度不同，所以带来的表现提升也不全相同。选取较为重要的样本可以使当前模型以较少的标记样本数得到较好的表现。在这一过程中，主动学习的本质是对样本的重要性（/信息度/期望带来的表现等）等进行评估。绝大多数的工作都是围绕如何评估样本来展开。</p><p>但是随着领域的发展，相关文献的增多，主动学习一词可能在强调不同的东西。<strong>总的来说，当我们谈起主动学习的时候，我们指的是</strong>：</p><ul><li>从<strong>问题</strong>的角度：通过以某种主动策略构建较小训练集来<strong>减少标记成本</strong>的机器学习方式。</li><li>从<strong>策略</strong>的角度：以某种方式对未标记<strong>样本重要性的评估</strong>。</li><li>从<strong>训练</strong>的角度：一种<strong>交互式</strong>的标记、训练、评估流程。</li></ul><h2 id="2-主动学习的问题-任务场景">2. 主动学习的问题/任务场景</h2><p>标记成本高昂的情况在很多任务下都存在，所以主动学习的潜在应用问题还是比较广泛的。本节，我们会对大部分主动学习涉及到的问题和任务场景进行简要介绍。</p><h3 id="2-1-基础问题场景">2.1 基础问题场景</h3><p>这里我们只讨论最基础的分类和回归问题。在这两类问题下，有着三种不同的主动学习场景：</p><ul><li>Pool-based scenario：此类场景通常提供一个未标记的数据池，主动学习策略在数据池中选取相应样本进行标记。</li><li>Stream-based scenario：此类场景中，数据以数据流的形式输入，主动学习策略需要确定对当前数据进行标记还是直接用现有模型预测。</li><li>Query synthesis scenario：此类场景较为少见，一个未标记的数据池通常也被提供，但是主动学习策略并不是在数据池中挑选样本进行查询，而是自行生成新样本进行查询。</li></ul><p>所以我们就有了如下几个子问题：</p><table><thead><tr><th></th><th>Pool-based</th><th>Stream-based</th><th>Query synthesis</th></tr></thead><tbody><tr><td>Classification</td><td>PB-classification (most works)</td><td>SB-classification</td><td>(rare)</td></tr><tr><td>Regression</td><td>PB-regression</td><td>SB-regression (rare)</td><td>(rare)</td></tr></tbody></table><p>其中目前据大多数的基础研究都是基于 pool-based classification，目前大多数的文献分类也是基于此问题而分类的。 此处我们以介绍清楚问题场景为主，具体对于每一个问题的具体方法，请参考：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_problem.md">Basic AL Problem Settings</a></p><h3 id="2-2-复杂问题场景">2.2 复杂问题场景</h3><p>此处的复杂主要是指任务相较于简单的分类回归任务复杂。在机器学习的领域中，有不少衍生问题，包括但不限于多分类问题，多标签问题，多任务问题。作为监督学习问题，这些问题同样可以使用主动学习来缓解标记压力：</p><ul><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MCAL.md">Multi-class active learning</a>: 在分类任务中，每个样本的标签取值可以从多种取值里选取（不小于两种）。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MLAL.md">Multi-label active learning</a>: 在分类任务中，每个样本可以同时存在多个标签。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MTAL.md">Multi-task active learning</a>: 多个任务需要被同时处理，比如同时进行两个分类任务，或同时进行一个分类和一个回归任务。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MDAL.md">Multi-domain active learning</a>: 与多任务学习较为相似，多领域学习则是在不同的领域（数据分布/数据集）上学习相同的任务。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MVAL.md">Multi-view/modal active learning</a>: 多视角或多模态学习中的样本可能会有不同形式的表征。比如不同角度拍摄的同一个物品，来源于同一视频的音轨和视轨等。</li></ul><p>针对这些问题，主动学习方法一般都会有特定的适配和修改，仅仅使用简单场景上的方法可能不会有较好的表现。</p><h3 id="2-3-与其他-AI-领域结合的问题场景">2.3 与其他 AI 领域结合的问题场景</h3><p>由于篇幅限制，主动学习与 AI 结合的领域和工作可以参见以下链接：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md">AL Aids AI</a>。</p><p>相较于之前提到的场景，AI 领域其实有不少更加复杂的问题。这些问题可能不能简单的用分类回归来表述，更多的时候是多种问题的结合。此类问题一般较为细致，定义也相对狭隘。针对这些具体问题，主动学习也有很多结合。 这些问题包括但不限于：</p><ul><li>Computer Vision (CV)<ul><li>Image Segmentation</li><li>Object Detection</li></ul></li><li>Natural Language Processing (NLP)<ul><li>Sentence Classification</li><li>Named Entity Recognition</li></ul></li><li>Domain adaptation/Transfer learning</li><li>Metric learning/Pairwise comparison/Similarity learning</li><li>One/Few/Zero-shot learning - Graph Processing</li><li>etc.</li></ul><h2 id="3-主动学习的技术角度的分类">3. 主动学习的技术角度的分类</h2><p>在上一节中我们以问题为导向介绍了绝大多数可以使用主动学习来解决的问题，可以说涵盖了大部分最重要的主动学习的相关工作。这一节的介绍并不是以问题为导向，而是从技术角度对现有方法进行分类。我们选用了两个角度：</p><ul><li>设计原理角度：希望读者对不同种策略有一定的认识。</li><li>适用模型角度：希望读者可以直接找到适用于自己模型的策略。</li></ul><h3 id="3-1-从设计原理上分类">3.1 从设计原理上分类</h3><p>这个角度是目前大部分 review/survey 的分类角度。由于很多小问题中的相关文献较少，在我们的项目中，我们在对应的问题介绍下直接对相应方法作了简要分类。本文中，我们的分类主要作用于最常见和最广泛的 Pool-based Classification 场景。绝大多数著名的主动学习工作都是在此场景下进行的。同样的，这里我们只简述设计原理，具体的文献列表参见我们项目中的<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/pb_classification.md">这一章节</a>。在这里，我们把主动学习的设计原理（i.e.主动学习对样本的评估方法）分为五大类：</p><table><thead><tr><th style="text-align:left">评估方法</th><th style="text-align:left">简述</th><th style="text-align:left">评论</th></tr></thead><tbody><tr><td style="text-align:left">Informativeness</td><td style="text-align:left">一般来说指模型对选取样本取值的不确信程度</td><td style="text-align:left">忽略了数据分布的影响</td></tr><tr><td style="text-align:left">Representativeness-impart</td><td style="text-align:left">考虑了选取样本是否可以对数据分布起到代表作用</td><td style="text-align:left">通常来说和informativeness一起使用，此类方法和批选取方法可能会有重叠</td></tr><tr><td style="text-align:left">Expected Improvements</td><td style="text-align:left">考虑选取样本能为当前模型带来多少性能提升</td><td style="text-align:left">此类评估通常较为耗时</td></tr><tr><td style="text-align:left">Learn to score</td><td style="text-align:left">不人为启发式地设计选取策略，而是学习一个选取策略</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">Others</td><td style="text-align:left">有一些工作较难分类到上述的类别中</td><td style="text-align:left"></td></tr></tbody></table><p>此处我们也列出这几类方法之下的小类：</p><ul><li>Informativeness<ul><li>Uncertainty-based sampling</li><li>Disagreement-based sampling</li></ul></li><li>Expected Improvements</li><li>Representativeness-impart sampling<ul><li>Cluster-based sampling</li><li>Density-based sampling</li><li>Alignment-based sampling</li><li>Expected loss on unlabeled data</li></ul></li><li>Learn to Score</li><li>Others</li></ul><p>此外，批选取的方法（batch active learning）也有众多研究，其与 representativeness-impart sampling 有一定的交叉，具体可以参阅以下链接：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/batch_mode.md">Batch mode</a></p><h3 id="3-2-从适用模型上分类">3.2 从适用模型上分类</h3><p>很多种主动学习选取策略都标榜自己是全模型通用（model-free）的，但是实际使用中，他们可能仅仅适用于一个或一类模型（model-dependent）。此处我们总结了一些 model-dependent 的策略在特定模型上的工作。由于业界的模型实在是过于多样，此处我们仅归纳了几类常用模型，且工作并不一定很全，之后这个章节也会更新。具体的文献列表请查阅我们项目中的<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_technique_models.md">这一章节</a>。</p><p>这里我们仅列出一些我们总结到的模型：</p><ul><li>SVM/LR</li><li>Bayesian/Probabilistic Models</li><li>Gaussian Progress</li><li>Decision Trees</li><li>Neural Network</li></ul><p>此外，如何设计适用于神经网络的主动学习策略和框架也是一个比较重要的问题。我们也对相关的深度主动学习进行了调研，详情请查阅以下链接：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/deep_AL.md">AL with Models</a></p><h2 id="4-将-AL-应用时的实际考虑">4. 将 AL 应用时的实际考虑</h2><p>我们之前讨论的是主动学习可以应用于什么问题场景，本节我们讨论的是实际应用主动学习的时候可能会遇到什么技术问题。具体的内容列表请查阅我们项目中的这一章节：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/practical_considerations.md">Practical Considerations</a></p><p>简要来说，大部分的主动学习工作对数据，标注专家，问题规模等都是有着一般性的假设。比如“在一个几千样本上的平衡分类问题中，可以通过询问一个准确率百分之百的标注专家来获得标注数据”。但是这些假设在实际运用中可能并不总能保真，所以本节我们纳入了很多对实际问题的考虑。</p><p>具体的考虑如下：</p><ul><li>Data (imbalanced, biased, feature missing, etc.</li><li>Oracles (multiple labeler, diverse labeler, etc.)</li><li>Scale (large-scale)</li><li>Workflow (cold start problem, stop criteria, etc.)</li><li>Model training cost</li><li>Query/feedback types</li><li>Performance metric</li><li>Robustness</li><li>More assumptions</li></ul><p>可以说在这些问题上的研究拉近了主动学习到实际运用的距离。</p><h2 id="5-AL-的实际应用">5. AL 的实际应用</h2><p>主动学习已经是一个较为成熟的技术，已经有很多研究工作将其应用于不同学科和领域。 这里我们将其分为两部分：科学研究应用和工业界应用。 具体的文献列表请查阅以下链接：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_applications.md">AL Applications</a></p><h3 id="5-1-科学研究应用">5.1 科学研究应用</h3><p>目前的工作主要聚焦于以下几个学科：</p><ul><li>Biology</li><li>Materials</li><li>Astronomy</li><li>Chemistry</li><li>Math and Statistics</li><li>Geology</li><li>Experiment Design / Experimental Condition Selection</li></ul><h3 id="5-2-工业界应用">5.2 工业界应用</h3><p>工业界应用相对较广泛，此处列举几个较为常用的领域，其他内容请参阅我们的项目。</p><ul><li>Remote Sensing</li><li>Medical Research</li><li>Drug Discovery</li><li>Labeling System</li><li>Spam Detection</li><li>etc.</li></ul><h2 id="6-相关资料">6. 相关资料</h2><h3 id="6-1-软件包">6.1 软件包</h3><p>在github上已经有不少基于Python的主动学习软件包：</p><table><thead><tr><th>Name</th><th>Languages</th><th>Author</th><th>Notes</th></tr></thead><tbody><tr><td><a href="https://github.com/google/active-learning">AL playground</a></td><td>Python(scikit-learn, keras)</td><td>Google</td><td>Abandoned</td></tr><tr><td><a href="https://github.com/modAL-python/modAL">modAL</a></td><td>Python(scikit-learn)</td><td>Tivadar Danka</td><td>Keep updating</td></tr><tr><td><a href="https://github.com/ntucllab/libact">libact</a></td><td>Python(scikit-learn)</td><td>NTU(Hsuan-Tien Lin group)</td><td></td></tr><tr><td><a href="https://github.com/NUAA-AL/ALiPy">ALiPy</a></td><td>Python(scikit-learn)</td><td>NUAA(Shengjun Huang)</td><td>Include MLAL</td></tr><tr><td><a href="https://github.com/rmunro/pytorch_active_learning">pytorch_active_learning</a></td><td>Python(pytorch)</td><td>Robert Monarch</td><td>Keep updating &amp; include active transfer learning</td></tr><tr><td><a href="https://github.com/ej0cl6/deep-active-learning">DeepAL</a></td><td>Python(scikit-learn, pytorch)</td><td>Kuan-Hao Huang</td><td>Keep updating &amp; deep neural networks</td></tr><tr><td><a href="https://github.com/ElementAI/baal/">BaaL</a></td><td>Python(scikit-learn, pytorch)</td><td>ElementAI</td><td>Keep updating &amp; bayesian active learning</td></tr><tr><td><a href="https://github.com/IBM/low-resource-text-classification-framework">lrtc</a></td><td>Python(scikit-learn, tensorflow)</td><td>IBM</td><td>Text classification</td></tr><tr><td><a href="https://github.com/webis-de/small-text">Small-text</a></td><td>Python(scikit-learn, pytorch)</td><td>Christopher Schröder</td><td>Text classification</td></tr><tr><td><a href="https://github.com/PatrickZH/DeepCore">DeepCore</a></td><td>Python(scikit-learn, pytorch)</td><td>Guo et al.</td><td>In the coreset selection formulation</td></tr><tr><td><a href="https://github.com/RelationRx/pyrelational">PyRelationAL: A Library for Active Learning Research and Development</a></td><td>Python(scikit-learn, pytorch)</td><td>Scherer et al.</td><td></td></tr><tr><td><a href="https://github.com/SineZHAN/deepALplus/"> DeepAL+</a></td><td>Python(scikit-learn, pytorch)</td><td>Zhan</td><td>An extension for DeepAL</td></tr></tbody></table><h3 id="6-2-Tutorials">6.2 Tutorials</h3><p>之前也有一些关于主动学习的研讨班内容：</p><ul><li><a href="https://github.com/Azure/active-learning-workshop">active-learning-workshop</a>: KDD 2018 Hands-on Tutorial: Active learning and transfer learning at scale with R and Python</li><li><a href="https://www.youtube.com/watch?v=_Ql5vfOPxZU">Active Learning from Theory to Practice</a>: ICML 2019 Tutorial.</li><li><a href="https://jacobgil.github.io/deeplearning/activelearning">Overview of Active Learning for Deep Learning</a>: Jacob Gildenblat.</li></ul><h3 id="6-3-领域内研究学者">6.3 领域内研究学者</h3><p>参见我们的<a href="https://github.com/SupeRuier/awesome-active-learning#8-groupsscholars">项目</a>，排名不分先后（有待补充）</p>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>active-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>世界简史</title>
    <link href="/reading-note/brief-world-history/"/>
    <url>/reading-note/brief-world-history/</url>
    
    <content type="html"><![CDATA[<p>通俗历史的高度概括，从空间时间的起源到世界政治与社会的重建。</p><span id="more"></span><h2 id="作者">作者</h2><p>H•G·韦尔斯（1866-1946），英国著名作家。早年在一家布店当过学徒，后毕业于英国皇家学院。曾尝试以教书为生，却以新闻和文学创作闻名于世。其所著《时间机器》、《隐身人》为现代科幻小说开山之作。一生涉猎甚广，虽不是历史学家，却以《世界史纲》跻身于史学大家之列。（摘自豆瓣）</p><h2 id="内容简介">内容简介</h2><p>《世界史纲》乃鸿篇巨制，煌煌近百万字，非一般读者所能吸纳。韦尔斯于1923年出版的这本包含着“崭新立意和写法”的《韦尔斯世界简史》，作为前者的普及版。作者以无比开阔的视界、轻快简洁的笔调将自生物起源以来的生物及人类历史，有条不紊地展现在读者面前，作者的目的不拘泥于考据，而在于给读者提供一个宏伟、宽广的大视野。（摘自豆瓣）</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>惊讶于二十世纪初作者对世界历史的了解。史实之外，作者还加入了很多对事件发展变迁的认识。帝国的此起彼伏、潮起潮落，在作者的笔下以平实的语言叙述出来，并且能直接地指出变迁的关键事件（原因），对于帮助认识历史有着极大的好处。本书跨度极大，从宇宙地球讲起，直到一战前的世界格局，从原始的部落社会，到后来的资本主义和社会主义，可以说是一本极好的科普书籍。</p><h3 id="感想看法">感想看法</h3><ul><li>这本书讲了很多生命起源，原始人什么的。对我而言很无趣且冗长。</li><li>讲了很多公元前的埃及巴比伦那边的人种，包含大量的地名人名，没有配合图片难以阅读。</li><li>发现对熟悉领域的扩展阅读似乎总是比不熟悉的领域要看得舒服一些。大量的欧洲史个人就觉得有点晦涩难懂。</li><li>有点感叹，在写成这本书的无互联网的年代，搜集到如此多的历史信息并成文是一件很不容易的事情。</li><li>一个国家的灭亡根本的原因会是什么呢？不得人心吗？还是经济无力支撑？</li><li>教皇原来曾经有这么大的影响力。十字军东征原来是教会扫除异教徒的行为。</li><li>蒙古人的西进并非人多势众野蛮暴烈，他们的行军很有战略规划和情报刺探。而基督教诸国却对自己的敌人一无所知。这对自己原来对蒙古领土横跨亚欧大陆的认识相差甚远，以前只是觉得可能蒙古人太骁勇了。</li><li>元朝看起来只是蒙古统治的一个分支。</li><li>教会压制了人们对自由科学的追求，教会发达的时候自然科学完完全全被压制。就让人想到中国的这些儒家文化道家文化，从来都是三纲五常，可能有着对人探索精神的压制，或许这也是中国自然科学没发展起来的原因之一。</li><li>原来是蒙古人把枪炮和火药带到的西方。</li><li>工业革命开始的这段科技发展的时间在历史长河中实在是过于的短暂，或许可以说这个是需求推动的科技发展？</li><li>其实对中华文明的概念越来越模糊，元朝算吗？清朝算吗？如果算的话，如果日本占领了全中国建立了满洲国，那满洲国算吗？感觉值得思考。</li><li>交通真的对稳定统治起到了极其重要的作用。</li><li>历史上撕毁协议的事情真的是屡见不鲜。</li></ul><h1>内容摘录</h1><p>本就是简史，此处不会详细记录，仅仅记录自己认为有趣的描述和事实。</p><ul><li>这本被后世基督徒称为《旧约》的，正是希伯来《圣经》，他大约成书于公元前400年或公元前500年。</li><li>《奥德赛》，这是一部历险记，主要内容说的是，希腊人英明的首领奥德赛从特洛伊返回自己的国家时，在漫长旅途中的冒险故事。</li><li>公元前六世纪，在人类历史上具有非同凡响的意义。当时，在希腊，哲学家们开始探讨人类在宇宙中的地位，在印度，释迦摩尼开始布道解惑，在中国，孔子和老子的学说广为流传。</li><li>一种盛行于雅典的高尚死法是苏格拉底的最终选择：在众目睽睽之下，喝下用有毒草类炮制而成的毒酒。</li><li>柏拉图是第一个向我们描绘“乌托邦”的人，那是一种不同于现有社会、比任何时代的社会更加美好的社会蓝图。《理想国》这本柏拉图早起的著作，讲述了一个共和主义贵族的梦想。</li><li>罗马和汉朝这两个处于同一时代的庞然大国，却对彼此一无所知。</li><li>罗马帝国之所以能崛起，主要是依仗着早期民权的意识团结了人民。罗马帝国之所以灭亡就在于他失去了意志。</li><li>公元751年中国人曾袭击撒马尔罕的阿拉伯人，然后被击败被俘获的中国人中有一批熟练的造纸行家，于是造纸的技术就这样传过来。</li><li>蒙古人对欧洲征服活动，极大的刺激了欧洲人的地理想象力。</li><li>等欧洲步入16世纪以后历史的兴趣，已经从王朝的更迭，转到了<strong>政治和社会组织实验的广泛性与多样性</strong>上。</li><li>枪炮和火药打破了住在城堡中的贵族和有城墙防护的城市的安全感，也彻彻底底地埋葬了封建制度。</li><li>一种对抗力量出现了，他避免了联邦的分裂，并在世界各地发挥着重要作用。这就是蒸汽轮船的发明以及铁路和电报的相继出现。他们拯救了美国，把分散的居民结合起来，使美国成为第一个现代化的国家。</li><li>从本质上来说，<strong>世界上任何政治协议都是暂时性的</strong>。</li><li>到了，19世纪的后半期德国科学领域的进展已经遥遥领先，每一位科研人员要是不想落伍，就一定得掌握德语，以便去进行学习。</li><li>到了19世纪以后，那些有头脑的人越来越清楚地意识到比起劳役苦工，一般平民更加可贵，必须要让他们接受教育，因为他们起码要知道自己在干什么，这样才能确保工作效率。</li><li>现在我们所说的社会主义实际上等同于一种集体主义，他允许私人占有相当数量的财产，但是教育运输矿山土地所有权重要物质的生产，则主张控制在具有高度组织性的国家手中。</li><li>为促进世界范围的繁荣十分有必要在全世界进行通畅的自由贸易，个人主义者对国家的敌意实际上就是对关税和国界设定的不满，就是对法定关税和国界限制了国际自由行为和运动的不满。</li><li>个人主义和社会主义这两个理论虽然立场完全相反，但他们共同探索着同一个问题，即为人们如何才能共同劳动这一问题找出建立在更广泛的社会和政治基础上的解决方案。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
      <tag>历史</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>富可敌国</title>
    <link href="/reading-note/more-money-than-god/"/>
    <url>/reading-note/more-money-than-god/</url>
    
    <content type="html"><![CDATA[<p>一本介绍对冲基金发展的书。</p><span id="more"></span><h2 id="作者">作者</h2><p>塞巴斯蒂安-马拉比，保罗•沃尔克时期对外关系委员会国际经济高级研究员，《华盛顿邮报》的专栏作家。他在《经济学人》杂志工作了13年，在《华盛顿邮报》编委会工作了8年，主要专注于经济全球化和政治经济领域。</p><h2 id="极简简介">极简简介</h2><p>一本权威的对冲基金发展史。本书作者对该行业进行了包括300个小时访谈和无数内部文件在内的深入调查，并在此基础上，讲述了关于对冲基金鲜为人知的故事。</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>首先作为一本纪实介绍类的书，人名太多了，对于不明所以的人来说有点难以阅读。但是讲述较为生动全面，个人认为还是比较有启发。当然全书的立意还是针对于对冲基金，说实话离大部分人都很遥远，当成故事书来说更为合适。作为一本故事书，其中的很多成功和失败案例能为自己的投资提到警示作用。</p><h3 id="感想看法">感想看法</h3><ol><li>人名儿太多了，难以阅读。</li><li>量子基金做空英镑的故事的确有趣，不像是那些鸡汤文或者财经文里面介绍的那么浅显，本书将前因后果和细节交代的十分到位。给我的感想就是，了解宏观经济十分重要，了解政治也十分重要。这并不只是一场经济游戏，里面也暗含了很多政客的小心思。各种基金一起做空英镑的场景让我联想到了翟老师讲的华尔街做空雷亚尔的故事，书中也写到“亚洲和拉丁美洲的新兴经济体卡在了盯住汇率政策上，这在未来十年给对冲基金创造了巨大的机会”。</li><li>很多无风险套利的机会是要通过大规模资金才能实现。比如影子银行，借入短期资金，贷出长期资金，例如最开始的支付宝。（原来支付宝之前玩的都是美国90年代玩剩下的）。</li><li>一方面，对冲基金可能会加快金融市场的传导机制（例如长短期利率），另一方面，对冲基金可能也被政府纳入了政策制定的考虑当中。</li><li>虽然都叫对冲基金，很多是很不一样的。当然也有很多名称不一样，但做的事情本质是一样的。</li><li>原来索罗斯在做空泰铢的8亿美元收益在做多印尼盾中几乎赔了进去，interesting。</li><li>机构投资者的高仓位可能暗示着强烈的抛压，而不是暗示着还将继续上涨。记住，继续买入才会引发上涨。</li><li>其实自己在买基金和股票的时候要考虑一下流动性风险，不是自己的流动性，而是机构的流动性，他们有没有对手盘来操作。</li><li>再次重复，人名儿太多了，难以阅读，有一种看外国小说的感觉。</li><li>你可以对冲价格风险，但是你无法对冲流动性风险。</li><li>其实不认为小到可以随便倒闭就是对冲基金适合去吸收风险的理由。因为可能多个基金加总，体量也会变大，这样总风险也会变大。</li><li>”这就意味着资本价格对于脚踏实地的公司来说过高，而对于华而不实的公司来说过低。成长的概念被滥用“不敢更赞同。</li><li>过早的正确就等于错误，择时！</li><li>流动性真的太重要了，参见近期的房地产，和一些远离成交价的期权。</li></ol><h1>内容摘录</h1><ul><li>有时CAPM模型不能解释市场异象，就是单纯考虑市场风险因素是有欠缺的。于是三因素，四因素，多因素模型提出，异象不复存在。</li><li>一方面有人认为有效市场的均衡状态永远不可能出现。另一方面，有人认为有效市场是一直存在的，只是没有找到正确的衡量风险的方法。</li><li>短期来看，市场中存在着大量的无效情况，这些无效情况可以提供无风险的套利机会。</li><li>货币会波动，利率会波动，越来越多的公司会发发行股票和债券。债务会被证券化。弄清楚什么样的金融机构能最吸收这些类型的风险将变得至关重要。这本书提供的答案是对冲基金会最好的完成这个任务。因为他们优越的激励机制，因为它们小到可以随意倒闭。因为他们可以比任何对手都更负责任的管理风险。</li><li>对冲基金并没有精确的定义，也不是所有的故事都和套期保值和杠杆效应有关。</li><li>天才并不是时刻都知道自己在干什么。</li><li>那些看上去不怎么样的价值型股票，相对于吹得天花乱坠的成长型股票来说，价值被低估。这就意味着资本价格对于脚踏实地的公司来说过高，而对于华而不实的公司来说过低。成长的概念被滥用。</li><li>他们时而被当作尽力是无效价格回归正常的稳定器而加以赞扬，时而又因其自身的不稳定性被视为威胁全球经济的因素而加以批判。</li><li>问题在于杠杆交易。杠杆效应使大额交易成为可能，因此使价格更有效，更稳定。但是杠杆效应也使得对冲基金在面对冲击时更加脆弱。</li><li>到底谁能比较好的管理风险，是那些我破产，要么靠政府埋单的商业银行和投资银行。还是一位兜售货币市场产品迫使政府支持的共同基金公司。是风险集中，使得纳税人也深陷其中的大银行，还是风险分散到从不指望政府救援的小规模对冲基金。</li><li>如果投资者是风险厌恶型，它就应该买最好的股票，但只用它继续的一部分。如果投资者是风险偏爱型，他应该购买完全一样的股票，并借钱了，卖更多。</li><li>所有新的市场首先都是低效的。这种效率，对最早顺应市场的人来说，则意味着利润。</li><li>当一种商品价格突破其一贯的价格区间，压错赌注的投资者就会出现大幅亏损，因为恐慌，他们将匆匆平仓使价格更加远离之前的价格区间。</li><li>索罗斯认识到了均衡理论无法解释实际中的货币波动，当热钱流入美国美元升值，而美元的升值又吸引了更多的投机者，使汇率更加远离均衡点。如果投机者是决定汇率水平的真正力量，那就意味着货币永远会出现先繁荣后萧条的过程。</li><li>索罗斯的投资决策往往是险中取胜，事实是，市场至少在一定程度上是有效的，所以大多数信息已经反映在价格中，投机的艺术就是看到其他人忽略的一个点，然后利用那一点小小的优势大量交易。</li><li>经验丰富的投资者也不是总能成功地纠正错误定价。</li><li>如果大交易商们已经满仓，这种消息几乎不会影响价格，但如果他们在等着进入，市场就会迅速上涨。</li><li>下跌的股票将引发投资组合保险人的抛售，而这种抛售将导致股票下跌更多。</li><li>市场可以脱离其基本价值，因为投资者缺乏挑战共识的实力，而这种趋势能持续到远远超出一个理性的点，但如果你比其他人更具备实力和勇气，你可以突然袭击，在市场毫无准备的情况下将其扰乱，因为你导致了一个新的趋势，你会是最先受益的。</li><li>进行基本面分析得知股票或债券的价值被高估了是一回事，知道什么时候市场会回归正常是另一回事，而图表则能暗示答案。</li><li>如果你了解市场上的其他玩家，你就可以找出那些非常吸引人的风险回报比的交易。</li><li>自从由于恶性通货膨胀帮助了希特勒崛起的那个时候起，德国人就十分注重货币的稳定。</li><li>当你确定自己是对的，就没有什么投注太多这样的说法，你会尽可能多的买入。</li><li>如果市场主要由追求最大利润的理性投资者控制，那么效率有可能会占上风；但如果市场由其他人驱动，那就没有理由期望有效定价。</li><li>当对冲基金通过积极购买较长期的国库券来响应美联储的低短期利率时，短期和长期利率之前的联系会更紧密。</li><li>不确定性意味着风险。</li><li>在一个券商的追加保证金就可能迫使杠杆式基金火速卖出的情况下，关键是要小心高负债的人集中的市场。</li><li>如果投机起到预警的作用而不是打击的作用的话，是让贫穷社会受益的。</li><li>当市场出现恐慌时，流动性溢价可能会增加：怯弱的投资者希望自己能迅速卖出债券，他们愿意为此付出代价。</li><li>自我纠正的趋势只是一种趋势，一个极端的事件可能会改变价格的惯常走势，这种改变可能会持续很长一段时间，甚至永远。</li><li>长期资本管理公司失败的真正教训不在于它衡量风险的方法过于简单，而是想要对风险准确衡量，这不可避免地要失败。</li><li>长期资本管理公司的失败表明没有后备资金而赌整个世界的稳定性是不理智的。</li><li>市场保持非理性的时间可能比你可持续的时间更长。过早但正确就等于错误，就像投资者多次发现的那样。</li><li>当市场价格不再具有指南作用时，你得根据一个资产所能产生的现金流量来决定购买该资产的投入。</li><li>对于一个资产以每4-5年增长一倍的基金来说，其内部专业知识的增长速度很难和拥入的资金增长同步。</li><li>在普通的具有流动性的市场，价格通常有效，预测他们是困难的。相比之下，在流动性不充分的市场会有大量便宜货，但是因为错误所付出的代价可能也会非常惨重。</li><li>对于流动性不充分资产的买家来说，最大的危险是在危机中这些资产崩溃的幅度会最大。</li><li>正是因为缺乏保密性，才使得一旦市场对他不利，它就容易成为被攻击的目标。</li><li>波动率低是因为世界上充斥着冒险资金，但充分的流动性让人误以为稳定是由金融体系的结构得到改善而带来的。</li><li>由于对冲基金习惯了自己做决定，不受监管和评级机构的干扰，他们往往表现较佳。</li><li>当交易员盲目降低负债率的时候，资本结构套利的原因就不再重要了。</li><li>政府的行动降低了“大而不倒”的机构冒险的代价，其结果就是更加冒险。</li><li>政府该如何促进能够很好的管理风险的“小到可以随意倒闭”的公司的发展呢？这是金融业未来的关键所在，而且部分答案是显而易见的：政府必须鼓励对冲基金发展。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>先进树模型库学习</title>
    <link href="/machine-learning/tree-libs/"/>
    <url>/machine-learning/tree-libs/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>本文介绍 XGBoost、LightGBM、CatBoost 等树模型库，他们考虑到许多实际运用中的需求和限制。因为这些库的使用场景距离自己比较遥远未必会用到，本文不会太多的讨论技术细节，仅以了解为主，日后若有需要再深度更新。</p><span id="more"></span><p>本文大面积参考这篇文章： <a href="https://zhuanlan.zhihu.com/p/87885678">【机器学习】决策树（下）——XGBoost、LightGBM（非常详细） - 阿泽的文章 - 知乎</a></p><h2 id="XGBoost">XGBoost</h2><p>XGBoost 是大规模并行 boosting tree 的工具。XGBoost 和 GBDT 两者都是 boosting 方法，除了工程实现、解决问题上的一些差异外，最大的不同就是目标函数的定义。GBDT 仅针对一阶导数，而 XGBoost 对一阶导数和二阶导数都进行了优化，此外 XGBoost 还加入了正则项，防止过拟合。XGBoost 不止支持决策树，还支持线性模型，此处我们主要介绍决策树。</p><h3 id="基础知识">基础知识</h3><p>目标函数可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>O</mi><mi>b</mi><msup><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>l</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msubsup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><mi>t</mi></msubsup><mo fence="true">)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><mi mathvariant="normal">Ω</mi><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>l</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msubsup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo>+</mo><msub><mi>f</mi><mi>t</mi></msub><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><mi mathvariant="normal">Ω</mi><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}Obj^{(t)} &amp; =\sum_{i=1}^n l\left(y_i, \hat{y}_i^t\right)+\sum_{i=1}^t \Omega\left(f_i\right) \\&amp; =\sum_{i=1}^n l\left(y_i, \hat{y}_i^{t-1}+f_t\left(x_i\right)\right)+\sum_{i=1}^t \Omega\left(f_i\right)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.7165em;vertical-align:-3.1082em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6082em;"><span style="top:-5.6082em;"><span class="pstrut" style="height:3.7806em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.7806em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1082em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6082em;"><span style="top:-5.6082em;"><span class="pstrut" style="height:3.7806em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8436em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7806em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.7806em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.433em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.267em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7806em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1082em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">\hat{y}_i^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0522em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span> 是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 次迭代的预测值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">f_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 次迭代的模型，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Ω</span></span></span></span> 是正则项。对该式求解可以利用到泰勒展开 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow></mrow><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac><msup><mrow><mo fence="true">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mi>i</mi></msup><mo>+</mo><msub><mi>R</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)=\sum_{i=0}^n \frac{f^{(i)}\left(x_0\right)}{i !}\left(x-x_0\right)^i+R_n(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.5067em;vertical-align:-0.345em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1617em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9667em;"><span style="top:-2.9667em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9646em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>。那么对于一个函数在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 处的二阶展开可以写作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo stretchy="false">)</mo><mo>≈</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">f(x+\Delta x) \approx f(x)+f^{\prime}(x) \Delta x+\frac{1}{2} f^{\prime \prime}(x) \Delta x^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>。那么目标函数可以重写为：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>O</mi><mi>b</mi><msup><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">[</mo><mi>l</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msubsup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>g</mi><mi>i</mi></msub><msub><mi>f</mi><mi>t</mi></msub><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>h</mi><mi>i</mi></msub><msubsup><mi>f</mi><mi>t</mi><mn>2</mn></msubsup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><mi mathvariant="normal">Ω</mi><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">O b j^{(t)}=\sum_{i=1}^n\left[l\left(y_i, \hat{y}_i^{t-1}\right)+g_i f_t\left(x_i\right)+\frac{1}{2} h_i f_t^2\left(x_i\right)\right]+\sum_{i=1}^t \Omega\left(f_i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.433em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.267em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.0582em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7806em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分别是损失函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>（而不是目标函数）关于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\hat{y}_i^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1311em;vertical-align:-0.2769em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span> 的一阶和二阶导数。又由于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msubsup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">l\left(y_i, \hat{y}_i^{t-1}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2042em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span> 是一个常数，不会对优化目标产生影响，所以</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>O</mi><mi>b</mi><msup><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>≈</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">[</mo><msub><mi>g</mi><mi>i</mi></msub><msub><mi>f</mi><mi>t</mi></msub><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>h</mi><mi>i</mi></msub><msubsup><mi>f</mi><mi>t</mi><mn>2</mn></msubsup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><mi mathvariant="normal">Ω</mi><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">Obj^{(t)} \approx \sum_{i=1}^n\left[g_i f_t\left(x_i\right)+\frac{1}{2} h_i f_t^2\left(x_i\right)\right]+\sum_{i=1}^t \Omega\left(f_i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.0582em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7806em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>所以我们只需要求出每一步损失函数的一阶导和二阶导的值（两个值就是常数），然后优化目标函数，就可以得到每一步的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">f_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p><h3 id="与决策树一起使用">与决策树一起使用</h3><p>定义决策树为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub><mrow><mo fence="true">(</mo><mi>x</mi><mo fence="true">)</mo></mrow><mo>=</mo><msub><mi>w</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">f_t\left(x\right)= w_{q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span>, 其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 是叶子节点的索引，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">w_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 是叶子节点的取值（权值）。对于决策树来说，复杂度可以用叶子节点的个数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> 来表示，此外叶子结点的权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">w_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 也是需要优化的参数，所以正则项可以写作</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Ω</mi><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mi>γ</mi><mi>T</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>λ</mi><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msubsup><mi>w</mi><mi>j</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\Omega\left(f_t\right)=\gamma T+\frac{1}{2} \lambda \sum_{j=1}^T w_j^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.2421em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>那么，目标函数可以写作</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left right" columnspacing="0em 1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>O</mi><mi>b</mi><msup><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≈</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">[</mo><msub><mi>g</mi><mi>i</mi></msub><msub><mi>f</mi><mi>t</mi></msub><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>h</mi><mi>i</mi></msub><msubsup><mi>f</mi><mi>t</mi><mn>2</mn></msubsup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow><mo>+</mo><mi mathvariant="normal">Ω</mi><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">[</mo><msub><mi>g</mi><mi>i</mi></msub><msub><mi>w</mi><mrow><mi>q</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>h</mi><mi>i</mi></msub><msubsup><mi>w</mi><mrow><mi>q</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><mn>2</mn></msubsup><mo fence="true">]</mo></mrow><mo>+</mo><mi>γ</mi><mi>T</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>λ</mi><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msubsup><mi>w</mi><mi>j</mi><mn>2</mn></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mrow><mo fence="true">[</mo><mrow><mo fence="true">(</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>I</mi><mi>j</mi></msub></mrow></munder><msub><mi>g</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><msub><mi>w</mi><mi>j</mi></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true">(</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>I</mi><mi>j</mi></msub></mrow></munder><msub><mi>h</mi><mi>i</mi></msub><mo>+</mo><mi>λ</mi><mo fence="true">)</mo></mrow><msubsup><mi>w</mi><mi>j</mi><mn>2</mn></msubsup><mo fence="true">]</mo></mrow><mo>+</mo><mi>γ</mi><mi>T</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mrow><mo fence="true">[</mo><msub><mi>G</mi><mi>j</mi></msub><msub><mi>w</mi><mi>j</mi></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true">(</mo><msub><mi>H</mi><mi>j</mi></msub><mo>+</mo><mi>λ</mi><mo fence="true">)</mo></mrow><msubsup><mi>w</mi><mi>j</mi><mn>2</mn></msubsup><mo fence="true">]</mo></mrow><mo>+</mo><mi>γ</mi><mi>T</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}O b j^{(t)} &amp; \approx \sum_{i=1}^n\left[g_i f_t\left(x_i\right)+\frac{1}{2} h_i f_t^2\left(x_i\right)\right]+\Omega\left(f_t\right) \\&amp; =\sum_{i=1}^n\left[g_i w_{q\left(x_i\right)}+\frac{1}{2} h_i w_{q\left(x_i\right)}^2\right]+\gamma T+\frac{1}{2} \lambda \sum_{j=1}^T w_j^2 \\&amp; =\sum_{j=1}^T\left[\left(\sum_{i \in I_j} g_i\right) w_j+\frac{1}{2}\left(\sum_{i \in I_j} h_i+\lambda\right) w_j^2\right]+\gamma T&amp; =\sum_{j=1}^T\left[G_j w_j+\frac{1}{2}\left(H_j+\lambda\right) w_j^2\right]+\gamma T\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.6712em;vertical-align:-5.0856em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5856em;"><span style="top:-7.9842em;"><span class="pstrut" style="height:4.05em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-4.5782em;"><span class="pstrut" style="height:4.05em;"></span><span class="mord"></span></span><span style="top:-0.8144em;"><span class="pstrut" style="height:4.05em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.0856em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5856em;"><span style="top:-7.9842em;"><span class="pstrut" style="height:4.05em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-4.5782em;"><span class="pstrut" style="height:4.05em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.428em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.447em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.8144em;"><span class="pstrut" style="height:4.05em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.875em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='3.600em' viewBox='0 0 875 3600'><path d='M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189l0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4917em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.875em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='3.600em' viewBox='0 0 875 3600'><path d='M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558l0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.875em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='3.600em' viewBox='0 0 875 3600'><path d='M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189l0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4917em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">λ</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.875em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='3.600em' viewBox='0 0 875 3600'><path d='M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558l0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.0856em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-1.1856em;"><span style="top:-0.8144em;"><span class="pstrut" style="height:4.05em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">λ</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.0856em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">I_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 是叶子节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 中的样本索引集合, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">G_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">H_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 分别是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">I_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 中样本的一阶导数和二阶导数之和。此时是一个二次规划问题，将目标函数对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">w_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 求导，并令其为 0，可以得到</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msubsup><mi>w</mi><mi>j</mi><mo>∗</mo></msubsup><mo>=</mo><mo>−</mo><mfrac><msub><mi>G</mi><mi>j</mi></msub><mrow><msub><mi>H</mi><mi>j</mi></msub><mo>+</mo><mi>λ</mi></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}&amp;w_j^*=-\frac{G_j}{H_j+\lambda}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.6324em;vertical-align:-1.0662em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5662em;"><span style="top:-3.5662em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0662em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5662em;"><span style="top:-3.5662em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0662em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>所以目标函数可以简化为以下形式，这个值越小，代表这个树的结构越好。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>O</mi><mi>b</mi><mi>j</mi><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mfrac><msubsup><mi>G</mi><mi>j</mi><mn>2</mn></msubsup><mrow><msub><mi>H</mi><mi>j</mi></msub><mo>+</mo><mi>λ</mi></mrow></mfrac><mo>+</mo><mi>γ</mi><mi>T</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}&amp;Obj=-\frac{1}{2} \sum_{j=1}^T \frac{G_j^2}{H_j+\lambda}+\gamma T\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.5421em;vertical-align:-1.5211em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0211em;"><span style="top:-4.0211em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5211em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0211em;"><span style="top:-4.0211em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.05724em;">bj</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5989em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7848em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5211em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="使用时的具体考虑">使用时的具体考虑</h3><p>之后的问题就是如何找到最优的结构，使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>b</mi><mi>j</mi></mrow><annotation encoding="application/x-tex">Obj</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.05724em;">bj</span></span></span></span> 最小。需要考虑到的问题有：</p><ol><li>如何选取特征切分节点：一般来说有两种方法，一种是贪心算法（类似普通决策树，遍历特征和分裂点，记录收益），一种是近似算法（针对数据量过大无法读入内存的情况，对于每个特征只考察候选分位点可以减少计算复杂度）。</li><li>加权分位数缩略图：不是简单地按照样本个数进行分位，而是以二阶导数值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 作为样本的权重进行划分。（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 可以看作平方损失函数中样本的权重）</li><li>稀疏感知算法：XGBoost 在构建树的节点过程中只考虑非缺失值的数据遍历，同时为每个节点增加了一个缺省方向，当样本相应的特征值缺失时，可以被归类到缺省方向上。（缺省方向可以从数据中学到，可以通过枚举特征缺省样本归为左右分支之后的增益。）</li></ol><p>工程实现上的考虑：</p><ol><li>训练决策树时对特征的值排序十分耗时。XGBoost 在训练之前对根据特征对数据进行了排序，然后保存到块结构中，并在每个块结构中都采用了稀疏矩阵存储格式进行存储，后面的训练过程中会重复地使用块结构，可以大大减小计算量。</li><li>在对节点进行分裂时需要选择增益最大的特征作为分裂，这时各个特征的增益计算可以同时进行，这也是 Xgboost 能够实现分布式或者多线程计算的原因。</li><li>每个特征会存储指向样本梯度统计值的索引，方便计算一阶导和二阶导数值。为了解决缓存命中率低的问题，XGBoost 提出了缓存访问优化算法：为每个线程分配一个连续的缓存区，将需要的梯度信息存放在缓冲区中，这样就是实现了非连续空间到连续空间的转换，提高了算法效率。</li><li>XGBoost 独立一个线程专门用于从硬盘读入数据，以实现处理数据和读入数据同时进行。</li></ol><h3 id="特性">特性</h3><ol><li>块结构：XGBoost 采用了块结构，可以大大减小计算量。</li><li>精度更高：GBDT 只用到一阶泰勒展开，而 XGBoost 对损失函数进行了二阶泰勒展开。</li><li>正则化：正则项有效的控制了模型的复杂度，防止过拟合。</li><li>列抽样：XGBoost 借鉴了随机森林的做法，支持列抽样，不仅能降低过拟合，还能减少计算。</li><li>缺失值处理：XGBoost 使用稀疏感知算法。</li><li>可以并行化操作：块结构可以很好的支持并行计算。</li></ol><h2 id="LightGBM">LightGBM</h2><p>LightGBM 是轻量级（Light）的梯度提升机（GBM），其相对 XGBoost 具有训练速度快、内存占用低的特点。</p><h3 id="模型训练：GOSS-算法">模型训练：GOSS 算法</h3><p>使用单边梯度抽样算法（Gradient-based One-Side Sampling, GOSS）对样本进行抽样，减少了大量梯度小的样本，极大的减少了计算量。GOSS 保留了梯度大的样本，并对梯度小的样本进行随机抽样，为了不改变样本的数据分布，在计算增益时为梯度小的样本引入一个常数进行平衡。</p><div style="width:80%;margin:auto"><img src="/machine-learning/tree-libs/GOSS.jpg" class="" title="GOSS"></div><p>我们可以看到 GOSS 事先基于梯度的绝对值对样本进行排序（无需保存排序后结果），然后拿到前 a% 的梯度大的样本，和总体样本的 b%，在计算增益时，通过乘上 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>1</mn><mo>−</mo><mi>a</mi></mrow><mi>b</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1-a}{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 来放大梯度小的样本的权重。一方面算法将更多的注意力放在训练不足的样本上，另一方面通过乘上权重来防止采样对原始数据分布造成太大的影响。</p><h3 id="特征离散化：直方图算法">特征离散化：直方图算法</h3><p>将连续的特征离散化为 k 个离散特征，同时构造一个宽度为 k 的直方图用于统计信息（含有 k 个 bin）。利用直方图算法我们无需遍历数据，只需要遍历 k 个 bin 即可找到最佳分裂点。虽然将特征离散化后无法找到精确的分割点，可能会对模型的精度产生一定的影响，但较粗的分割也起到了正则化的效果，一定程度上降低了模型的方差。同时对稀疏特征进行优化，仅使用非零特征构建直方图。</p><h3 id="互斥特征捆绑算法">互斥特征捆绑算法</h3><p>高维特征往往是稀疏的，而且特征间可能是相互排斥的，即两个特征不同时取零（非零）值。可以用互斥率表示互斥程度。互斥特征捆绑算法（Exclusive Feature Bundling, EFB）指出如果将一些特征进行融合绑定，则可以降低特征数量。则需要讨论，哪些特征可以绑定？以及绑定之后如何确定特征的值？</p><p>问题一可以用一个加权无向图表示，转化为一个图着色算法。其中节点表示特征，边表示两个特征之间的互斥程度，边的权重表示互斥程度。根据节点的度进行降序排序，度越大，与其他特征的冲突越大。遍历每个特征，将它分配给现有特征包，或者新建一个特征包，是的总体冲突最小。</p><p>问题二其关键在于原始特征能从合并的特征中分离出来。（特征合并算法这里不详细展开）</p><h3 id="基于最大深度的-Leaf-wise-的垂直生长算法">基于最大深度的 Leaf-wise 的垂直生长算法</h3><p>对于建树的策略而言，XGBoost 采用 Level-wise 的增长策略，方便并行计算每一层的分裂节点，提高了训练速度，但同时也因为节点增益过小增加了很多不必要的分裂，降低了计算量。LightGBM 采用 Leaf-wise 的增长策略减少了计算量，配合最大深度的限制防止过拟合，由于每次都需要计算增益最大的节点，所以无法并行分裂。</p><h3 id="类别特征最优分割">类别特征最优分割</h3><p>决策树中对于类别特征通常不推荐 one-hot 编码，因为切分收益很少（在一个均匀的多分类中，只有少量为 1，多数为 0）。此外在这些离散的小空间上统计信息可能不准确，学习效果变差。</p><p>LightGBM 原生支持类别特征，采用 many-vs-many 的切分方式将类别特征分为两个子集，实现类别特征的最优切分。Many-vs-many 的切分方式是将类别特征的所有类别分为两个子集，然后计算每个子集的增益，最后选择增益最大的子集进行切分。(具体选取子集的方式这里不详细展开）</p><h3 id="特征并行和数据并行">特征并行和数据并行</h3><p>传统的特征并行算法在于对数据进行垂直划分，然后使用不同机器找到不同特征的最优分裂点，基于通信整合得到最佳划分点，然后基于通信告知其他机器划分结果（因为对数据进行垂直划分，每台机器所含数据不同）。此处的通信增加了额外的复杂度。LightGBM 则不进行数据垂直划分，每台机器都有训练集完整数据，在得到最佳划分方案后可在本地执行划分而减少了不必要的通信。</p><p>传统的数据并行策略主要为水平划分数据，然后本地构建直方图并整合成全局直方图，最后在全局直方图中找出最佳划分点，这种数据开销过大。LightGBM 采用分散规约（Reduce scatter）的方式将直方图整合的任务分摊到不同机器上，从而降低通信代价，并通过直方图做差进一步降低不同机器间的通信。</p><h3 id="LightGBM-特点">LightGBM 特点</h3><ol><li>内存更小。<ol><li>使用直方图将特征值离散化，减少了内存占用。</li><li>同时采用了互斥特征捆绑算法，减少了特征数量。</li></ol></li><li>速度更快。<ol><li>遍历样本转化为便利直方图</li><li>GOSS 过滤了梯度小的样本</li><li>采用了 Leaf-wise 的增长策略，减少了计算量。</li><li>使用了优化的特征并行和数据并行算法，减少了通信代价。</li><li>对缓存也进行了优化，提高了命中率。</li></ol></li></ol><h2 id="Reference">Reference</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/87885678">【机器学习】决策树（下）——XGBoost、LightGBM（非常详细） - 阿泽的文章 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/72686522">大战三回合：XGBoost、LightGBM 和 Catboost 一决高低 - AI科技大本营的文章 - 知乎</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>tree-models</tag>
      
      <tag>liborary</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>树模型知识小结</title>
    <link href="/machine-learning/tree-models/"/>
    <url>/machine-learning/tree-models/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>之前对于树模型仅停留在普通的树 + 一些简单的 bagging 方法。这里对树模型做一个学习总结，包含决策树以及其集成化的方法。本文不涉及一些先进的计算库，这些将在后续的文章中介绍。</p><span id="more"></span><h2 id="决策树-Decision-Tree">决策树 Decision Tree</h2><p>这是一个比较熟的模型，通过递归的方式来构建一棵树，每个节点都是一个特征，每个分支都是一个特征的取值。最终的叶子节点是一个类别。构建决策树的关键是如何选择每个节点的特征。通常来说，特征的选择需要通过一系列的信息度量。</p><h3 id="信息度量">信息度量</h3><p>可以使用熵来衡量一个特征的信息量。若选择一个特征，使得熵下降最多，则可以认为这个特征最富含信息量，也就是最适合作为节点的特征。这个下降的量称为信息增益。这个是 <strong>ID3 算法</strong>的思路。</p><p>但是，ID3 倾向于选择取值较多的特征，因为熵的计算中包含了特征的取值个数。于是，<strong>C4.5 算法</strong>引入了信息增益率来衡量特征的信息量。即在信息增益的基础上，除以特征的取值个数。</p><p>C4.5 算法仍然存在一个问题，即当特征的取值个数较多时，信息增益率会很小。于是，<strong>CART 算法</strong>引入了基尼指数来衡量特征的信息量。基尼指数衡量一个集合（类别上）的纯合度，取值越小，集合越纯。因此，CART 算法选择基尼指数下降最多（使得子集合更纯的）的特征作为节点的特征。</p><h3 id="其他考虑">其他考虑</h3><p><strong>连续情况</strong>：在上述信息度量时，我们大多考虑的是离散的特征。对于连续的特征，通常需要将连续的特征离散化，然后再使用上述的信息度量方法。即可以将连续值其离散化为多个区间。二分法是一种常用的离散化方法，即将连续值分为两个区间（仅有两种取值的特征）。</p><p><strong>回归情况</strong>：CART 决策树也可以用于回归问题。在回归问题中，输出是一个连续值，但是决策树的叶子节点通常是一个类别（离散值）。回归树中，叶子结点的值是该叶子结点中所有样本的平均值或中位数。分割的时候通常使用均方误差（MSE）或者平均绝对误差（MAE）或者均方差来定义分割的好坏。</p><p><strong>剪枝情况</strong>：如果树足够深，树的叶子节点多，很可能导致过拟合。因此，需要对树进行剪枝以提高泛化能力。主要有两种方式，一种是预剪枝，即在树构建的过程中，就对树进行剪枝。通常可以通过限制树的最大深度，或者限制叶子节点的最小样本数。另一种是后剪枝，即在树构建完成后，再对树进行剪枝。</p><h2 id="Bagging-of-Trees">Bagging of Trees</h2><p>单个决策树通常具有较高的方差，因此可以通过 bagging 的方式来降低方差。即通过构建多个决策树，然后对这些决策树的结果进行投票，来得到最终的结果。构建过程使用的是 bootstrap 抽样，即从训练集中随机抽取样本，有放回的抽取。这样可以保证每个决策树的训练集都是不同的，使得基模型具有“多样性”。</p><h2 id="Random-Forest">Random Forest</h2><p>随机森林是一种基于Bagging思想的集成学习算法。在构建决策树的过程中，在 bootstrap 之外还引入了特征随机选择的策略，进一步提高了模型的性能和泛化能力。特征的随机选取通常发生在节点的特征选择过程中。即划分节点时，只选择部分特征（通常为特征数目的平方根），然后在这些特征中选择最优的特征。实际应用中，随机森林通常比单独的决策树和Bagging of trees具有更好的性能。</p><h2 id="Adaboost">Adaboost</h2><p>Adaboost (Adaptive Boosting)是一种基于Boosting思想的集成学习算法。其不仅可以使用在决策树上，也可以使用在其他模型上。Adaboost的思想是通过迭代的方式来构建弱分类器，然后将这些弱分类器进行加权求和，得到最终的分类器。每次迭代，都会对上一次迭代中被错误分类的样本进行加权，使得这些样本在下一次迭代中更加重要。后面的弱分类器更加关注那些被前面的弱分类器错误分类的样本，这样最终的强分类器可以更好的对这些样本进行分类。</p><p>本质上，Adaboost 的优化目标是降低指数损失函数的值。指数损失函数是指对于每个样本，如果被错误分类，则损失为指数级别的增长。对于一个 adaboost 模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mi mathvariant="normal">sign</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>α</mi><mi>k</mi></msub><msub><mi>h</mi><mi>k</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">h=\operatorname{sign}\left(\sum_{k=1}^K \alpha_k h_k\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span class="mord mathrm">sign</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span>，指数损失如下式所示。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>α</mi><mi>k</mi></msub><msub><mi>h</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">E=\frac{1}{n} \sum_{i=1}^n \exp \left(-y_i \sum_{k=1}^K \alpha_k h_k\left(\mathbf{x}_i\right)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1304em;vertical-align:-1.3021em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是样本的真实标签，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_k(\mathbf{x}_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 个弱分类器对样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的预测结果，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 个弱分类器的权重。此时，假设前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 个弱分类器和权重已经确定，那么第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 个弱分类器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_k(\mathbf{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span> 和权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 可以通过最小化以下指数损失求解。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>E</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>α</mi><mi>j</mi></msub><msub><mi>h</mi><mi>j</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>α</mi><mi>j</mi></msub><msub><mi>h</mi><mi>j</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>α</mi><mi>k</mi></msub><msub><mi>h</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>α</mi><mi>k</mi></msub><msub><mi>h</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}E &amp; =\frac{1}{n} \sum_{i=1}^n \exp \left(-y_i \sum_{j=1}^k \alpha_j h_j\left(\mathbf{x}_i\right)\right) \\&amp; =\frac{1}{n} \sum_{i=1}^n \exp \left(-y_i \sum_{j=1}^{k-1} \alpha_j h_j\left(\mathbf{x}_i\right)\right) \exp \left(-y_i \alpha_k h_k\left(\mathbf{x}_i\right)\right) \\&amp; =\sum_{i=1}^n w_k(i) \exp \left(-y_i \alpha_k h_k\left(\mathbf{x}_i\right)\right)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.3288em;vertical-align:-4.9144em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.4144em;"><span style="top:-7.4144em;"><span class="pstrut" style="height:3.8361em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span><span style="top:-3.8645em;"><span class="pstrut" style="height:3.8361em;"></span><span class="mord"></span></span><span style="top:-0.4994em;"><span class="pstrut" style="height:3.8361em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.9144em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.4144em;"><span style="top:-7.4144em;"><span class="pstrut" style="height:3.8361em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span><span style="top:-3.8645em;"><span class="pstrut" style="height:3.8361em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-0.4994em;"><span class="pstrut" style="height:3.8361em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.9144em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w_k(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> 是样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 次迭代中的权重。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>α</mi><mi>j</mi></msub><msub><mi>h</mi><mi>j</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_k(i)=\frac{1}{n} \exp \left(-y_i \sum_{j=1}^{k-1} \alpha_j h_j\left(\mathbf{x}_i\right)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2499em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>样本的权重可以写成递归的形式，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mspace width="1em"/><mtext> and </mtext><mspace width="1em"/><msub><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>α</mi><mi>k</mi></msub><msub><mi>h</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_1(i)=\frac{1}{n} \quad \text { and } \quad w_{k+1}(i)=w_k(i) \exp \left(-y_i \alpha_k h_k\left(\mathbf{x}_i\right)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord"> and </span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>那么优化目标可以写成</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>E</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>α</mi><mi>k</mi></msub><msub><mi>h</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>e</mi><msub><mi>α</mi><mi>k</mi></msub></msup><munder><mo>∑</mo><mrow><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo>∈</mo><mi>M</mi></mrow></munder><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><munder><mo>∑</mo><mrow><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo>∈</mo><mi>T</mi></mrow></munder><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">(</mo><msup><mi>e</mi><msub><mi>α</mi><mi>k</mi></msub></msup><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><mo fence="true">)</mo></mrow><munder><mo>∑</mo><mrow><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo>∈</mo><mi>M</mi></mrow></munder><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><munder><mo>∑</mo><mrow><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo>∈</mo><mi>M</mi></mrow></munder><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><munder><mo>∑</mo><mrow><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo>∈</mo><mi>T</mi></mrow></munder><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">(</mo><msup><mi>e</mi><msub><mi>α</mi><mi>k</mi></msub></msup><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><mo fence="true">)</mo></mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mi>δ</mi><mrow><mo fence="true">(</mo><msub><mi>h</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo mathvariant="normal">≠</mo><msub><mi>y</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}E &amp; =\sum_{i=1}^n w_k\left(\mathbf{x}_i\right) \exp \left(-y_i \alpha_k h_k\left(\mathbf{x}_i\right)\right) \\&amp; =e^{\alpha_k} \sum_{\mathbf{x}_i \in M} w_k\left(\mathbf{x}_i\right)+e^{-\alpha_k} \sum_{\mathbf{x}_i \in T} w_k\left(\mathbf{x}_i\right) \\&amp; =\left(e^{\alpha_k}-e^{-\alpha_k}\right) \sum_{\mathbf{x}_i \in M} w_k\left(\mathbf{x}_i\right)+e^{-\alpha_k} \sum_{\mathbf{x}_i \in M} w_k\left(\mathbf{x}_i\right)+e^{-\alpha_k} \sum_{\mathbf{x}_i \in T} w_k\left(\mathbf{x}_i\right) \\&amp; =\left(e^{\alpha_k}-e^{-\alpha_k}\right) \sum_{i=1}^n w_k\left(\mathbf{x}_i\right) \delta\left(h_k\left(\mathbf{x}_i\right) \neq y_i\right)+e^{-\alpha_k} \sum_{i=1}^n w_k\left(\mathbf{x}_i\right)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:11.947em;vertical-align:-5.7235em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.2235em;"><span style="top:-8.2235em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span><span style="top:-5.5958em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"></span></span><span style="top:-2.8514em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"></span></span><span style="top:0.4944em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.7235em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.2235em;"><span style="top:-8.2235em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-5.5958em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-2.8514em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:0.4944em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.7235em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> 是被错误分类的样本集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> 是被正确分类的样本集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span> 是指示函数。式中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">e^{-\alpha_k} \sum_{i=1}^n w_k\left(\mathbf{x}_i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> 项和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><msup><mi>e</mi><msub><mi>α</mi><mi>k</mi></msub></msup><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(e^{\alpha_k}-e^{-\alpha_k}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> 项与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_k(\mathbf{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span> 无关。所以优化目标可以写成</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>h</mi><mi>k</mi><mo>∗</mo></msubsup><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><msub><mi>h</mi><mi>k</mi></msub></munder><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mi>δ</mi><mrow><mo fence="true">(</mo><msub><mi>h</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo mathvariant="normal">≠</mo><msub><mi>y</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_k^*=\arg \min _{h_k} \sum_{i=1}^n w_k\left(\mathbf{x}_i\right) \delta\left(h_k\left(\mathbf{x}_i\right) \neq y_i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9857em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.858em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>此外，通过损失函数对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 求导求极值，可以得到</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>α</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mrow><mo fence="true">(</mo><msup><mi>e</mi><msub><mi>α</mi><mi>k</mi></msub></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mi>δ</mi><mrow><mo fence="true">(</mo><msubsup><mi>h</mi><mi>k</mi><mo>∗</mo></msubsup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo mathvariant="normal">≠</mo><msub><mi>y</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mfrac><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><mrow><msup><mi>e</mi><msub><mi>α</mi><mi>k</mi></msub></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mi>δ</mi><mrow><mo fence="true">(</mo><msubsup><mi>h</mi><mi>k</mi><mo>∗</mo></msubsup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo mathvariant="normal">≠</mo><msub><mi>y</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>k</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></mfrac><mo>=</mo><msubsup><mi>ϵ</mi><mi>k</mi><mo>∗</mo></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">(</mo><msup><mi>e</mi><msub><mi>α</mi><mi>k</mi></msub></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup><mo fence="true">)</mo></mrow><msubsup><mi>ϵ</mi><mi>k</mi><mo>∗</mo></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>ϵ</mi><mi>k</mi><mo>∗</mo></msubsup><mo fence="true">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>α</mi><mi>k</mi></msub></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>ϵ</mi><mi>k</mi><mo>∗</mo></msubsup><msup><mi>e</mi><msub><mi>α</mi><mi>k</mi></msub></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>e</mi><mrow><mn>2</mn><msub><mi>α</mi><mi>k</mi></msub></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msubsup><mi>ϵ</mi><mi>k</mi><mo>∗</mo></msubsup></mrow><msubsup><mi>ϵ</mi><mi>k</mi><mo>∗</mo></msubsup></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>α</mi><mi>k</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.5</mn><mi>log</mi><mo>⁡</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msubsup><mi>ϵ</mi><mi>k</mi><mo>∗</mo></msubsup></mrow><msubsup><mi>ϵ</mi><mi>k</mi><mo>∗</mo></msubsup></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\frac{\partial E}{\partial \alpha_k}=\left(e^{\alpha_k}+e^{-\alpha_k}\right) &amp; \sum_{i=1}^n w_k\left(\mathbf{x}_i\right) \delta\left(h_k^*\left(\mathbf{x}_i\right) \neq y_i\right)-e^{-\alpha_k} \sum_{i=1}^n w_k\left(\mathbf{x}_i\right)=0 \\\frac{e^{-\alpha_k}}{e^{\alpha_k}+e^{-\alpha_k}}&amp;=\frac{\sum_{i=1}^n w_k\left(\mathbf{x}_i\right) \delta\left(h_k^*\left(\mathbf{x}_i\right) \neq y_i\right)}{\sum_{i=1}^n w_k\left(\mathbf{x}_i\right)}=\epsilon_k^* \\e^{-\alpha_k}&amp;=\left(e^{\alpha_k}+e^{-\alpha_k}\right) \epsilon_k^* \\\left(1-\epsilon_k^*\right) e^{-\alpha_k}&amp;=\epsilon_k^* e^{\alpha_k} \\ e^{2 \alpha_k}&amp;=\frac{1-\epsilon_k^*}{\epsilon_k^*} \\ \alpha_k&amp;=0.5 \log \frac{1-\epsilon_k^*}{\epsilon_k^*}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:14.3331em;vertical-align:-6.9165em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.4165em;"><span style="top:-9.4165em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-6.3449em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4483em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5904em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6973em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.2009em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.7009em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-0.6752em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:1.9778em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.9165em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.4165em;"><span style="top:-9.4165em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-6.3449em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.494em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.2009em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7009em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-0.6752em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3657em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6705em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9873em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:1.9778em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0.5</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3657em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6705em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9873em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.9165em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>至此，我们已经得到了第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 个弱分类器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_k(\mathbf{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span> 和权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的表达式。以及样本的权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w_k(\mathbf{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span> 的递归表达式。那么，我们可以通过迭代的方式，不断地更新弱分类器和样本的权重，直到满足某个条件为止。此外，为了防止过拟合，我们可以对弱分类器的数量进行限制，即限定迭代最大次数。</p><p>Adaboost 分类精度高；可以用各种回归分类模型来构建弱学习器，非常灵活；不容易发生过拟合。但是对异常点敏感，异常点会获得较高权重。</p><h2 id="GBDT">GBDT</h2><p>GBDT（Gradient Boosting Decision Tree）是一种基于决策树的集成学习算法。其包含三个主要概念：回归树（Regression Decision Tree）、梯度迭代（Gradient Boosting），和缩减（Shrinkage）。</p><p>不同于 Adaboost 对样本进行加权，GBDT 以之前树得到的残差作为新的目标函数，然后拟合新的回归树。模型的预测值表示为：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>f</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_k(x)=\sum_{i=1}^k f_i(x)=F_{k-1}(x)+f_k(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1138em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p><p>这样每次只训练一个基模型，使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_k(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 尽量接近真实值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>。这个残差其实是最小均方损失函数关于预测值的反向梯度，也就是说，预测值和实际值的残差与损失函数的负梯度相同。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mrow><mo fence="true">(</mo><mi>y</mi><mo>−</mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mn>2</mn></msup><mo fence="true">)</mo></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>F</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>y</mi><mo>−</mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">-\frac{\partial\left(\frac{1}{2}\left(y-F_k(x)\right)^2\right)}{\partial F_k(x)}=y-F_k(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.126em;vertical-align:-0.936em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em;"><span style="top:-2.464em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.19em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p><p>但要注意，基于残差 GBDT 容易对异常值敏感，所以一般回归类的损失函数会用绝对损失（L1 损失）或者 Huber 损失函数（一定范围内平方误差，超出范围绝对误差）来代替平方损失函数。</p><p>此外，为了避免过拟合，可以使用和 Adaboost 中相似的方法。Shrinkage 不直接用残差修复误差，而是每次走一小步逐渐逼近结果而不是每次迈一大步很快逼近结果。本质上 Shrinkage 为每棵树设置了一个 weight，累加时要乘以这个 weight，当 weight 降低时，基模型数会配合增大。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>μ</mi><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="1em"/><mo stretchy="false">(</mo><mn>0</mn><mo>&lt;</mo><mi>μ</mi><mo>≤</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_i(x)=F_{i-1}(x)+\mu f_i(x) \quad(0&lt;\mu \leq 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">μ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p><h2 id="Reference">Reference</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/86263786">【机器学习】决策树（中）——Random Forest、Adaboost、GBDT （非常详细） - 阿泽的文章 - 知乎</a></li><li>Intelligent Data Analysis (SUSTech CSE5002) Lecture 6: Multiple Classiﬁer Systems</li></ol>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>tree-models</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>集成学习复习总结</title>
    <link href="/machine-learning/ensemble-learning/"/>
    <url>/machine-learning/ensemble-learning/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>集成学习的一个复习总结。主要记录一些个人认为比较重要的细节。此博文不涉及到具体模型以及数学定义。</p><span id="more"></span><p>集成学习是一个“元”学习方法，其整体思想是利用一系列的弱学习器来构建一个强学习器。通常来说，弱学习器的表现要比强学习器差，但是它们的表现要比随机猜测要好。集成学习的思路分为两类，bagging 和 boosting。</p><h2 id="Bagging">Bagging</h2><p>Bagging 是 bootstrap Aggregating 的缩写，通常通过多次采样构建一系列的弱学习器，再将这些弱学习器的结果进行整合。</p><h3 id="构建弱学习器">构建弱学习器</h3><p>通常使用不同的子训练集来并行构建不同的弱学习器。子训练集可以使用 bootstrap 的方式来构建，即有放回地从原始训练集中采样，每次采样的样本数目和原始训练集的样本数目相同。</p><h3 id="整合弱学习器">整合弱学习器</h3><p>最简单的方法是对每个弱学习器的结果进行平均。平均的方式有很多种，比如平均值（回归任务）投票（分类任务）等等。</p><h3 id="Bagging-的特点">Bagging 的特点</h3><ul><li>通过整理合并一系列 high variance &amp; low bias 的弱学习器，可以得到一个 low variance 的强学习器（因为使用了平均）。</li><li>较好的并行计算性能。</li><li>对 Bias 影响较小，所以适用于用于本来就 low bias 的模型。</li></ul><h2 id="Boosting">Boosting</h2><p>Boosting 的思路是构建一系列弱学习器，并通过加权求和的方式来整合这些弱学习器。</p><h3 id="构建弱学习器-2">构建弱学习器</h3><p>Boosting 通常使用串行的方式来构建弱学习器。每个弱学习器都是基于上一个弱学习器的结果来构建的。换句话说，就是希望新训练的学习器能够更好地拟合训练集中没有被上一个学习器拟合的部分。这个可以通过对错分样本加权，或者计算残差来实现。这样随着学习器的增多，我们就能够逐渐地拟合整个训练集。</p><h3 id="整合弱学习器-2">整合弱学习器</h3><p>Boosting 通常使用加权求和的方式来整合弱学习器。权重通常与子分类器构建的过程有关。例如 adaboost 基于每个学习器的表现来确定的，该学习器目前的表现越好，那么它的权重就越大。</p><h3 id="Boosting-的特点">Boosting 的特点</h3><ul><li>通过整理合并一系列 high bias 的弱学习器，得到一个 low bias 的强学习器。</li></ul><h2 id="个人看法">个人看法</h2><p>某种程度上来说，不论是 bagging 还是 boosting 集成学习具有一定的可解释性。因为每个弱学习器都是基于上一个学习器的结果来构建的，所以我们可以通过观察每个学习器的结果来了解整个集成学习的结果。对于 bagging 来说，我们可以通过观察每个弱学习器的结果来了解模型对于不同部分的拟合情况。对于 boosting 来说，我们可以通过观察每个弱学习器的结果来了解每个学习器对于解决该问题的重要性。</p>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>ensemble-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>分布间距离度量</title>
    <link href="/math/distribution-distance/"/>
    <url>/math/distribution-distance/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>对常用的分布间距离度量进行一个学习和复习。本文仅为初稿，日后随着理解的加深应该会进行修改和填补。</p><span id="more"></span><ul><li><a href="#kullbackleibler-divergence-kl-divergence">Kullback–Leibler Divergence (KL-Divergence)</a></li><li><a href="#jensen-shannon-divergence-jsd">Jensen-Shannon Divergence (JSD)</a></li><li><a href="#maximum-mean-discrepancy-mmd">Maximum Mean Discrepancy (MMD)</a></li><li><a href="#wasserstein-distance">Wasserstein Distance</a><ul><li><a href="#%E4%B8%80%E7%BB%B4%E5%88%86%E5%B8%83%E4%B8%8B%E7%9A%84%E8%AE%A1%E7%AE%97">一维分布下的计算</a></li></ul></li><li><a href="#bhattacharyya-distance">Bhattacharyya Distance</a></li><li><a href="#mahalanobis-distance">Mahalanobis Distance</a></li></ul><hr><p>正式开始之前，我想先总结一下为什么我们需要分布距离的度量。首先这里的距离并不是指我们常见的欧式距离，而是某种分布间的差异或者相似度。在我朴素的视角看来，它能为我们解答的最直观的问题是：</p><ul><li>这两个分布是不是同一个分布？</li><li>已知一个分布，另一个分布需要多少额外的信息？</li></ul><p>这些度量一般需要满足一些性质：正定（大于等于零，且可以取到0），对称，满足三角不等式。以下就是一些常见的度量。</p><hr><h2 id="Kullback–Leibler-Divergence-KL-Divergence">Kullback–Leibler Divergence (KL-Divergence)</h2><p>对于分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span>，已知其交叉熵，可以得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 相对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 的相对熵：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo stretchy="false">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>x</mi></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">D_{\mathrm{KL}}(p \| q) = H(p, q) - H(p) =-\sum_{x} p(x) \log \frac{q(x)}{p(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">KL</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.677em;vertical-align:-1.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>相对熵又称为 KL 散度，是两个概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 差别的一种非对称性度量，严格意义上不能理解为距离。其表示使用基于分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 的编码表来编码服从分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 的样本（相比起用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 自己的分布来编码）所需的额外的平均比特数。在 KL 散度的基础上可以定义交叉墒，参见我们的<a href="#">Post not found: machine-learning/cross-entropy 另一条博文</a>。</p><p>KL 散度的一些特征：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 概率更大的匹配区域更加重要（一个更大的权重）。</li><li>不对称性。</li><li>不满足三角不等式。</li></ul><h2 id="Jensen-Shannon-Divergence-JSD">Jensen-Shannon Divergence (JSD)</h2><p>JSD 解决了 KL-Divergence 非对称的问题。其形式为两个 KL-Divergence 之和。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mrow><mi mathvariant="normal">J</mi><mi mathvariant="normal">S</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>D</mi><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mi>q</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>D</mi><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow></msub><mo stretchy="false">(</mo><mi>q</mi><mi mathvariant="normal">∥</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mi>q</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_{\mathrm{JS}}(p \| q) = \frac{1}{2}D_{\mathrm{KL}}(p \| \frac{p+q}{2}) + \frac{1}{2}D_{\mathrm{KL}}(q \| \frac{p+q}{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">JS</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">KL</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">KL</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord">∥</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><p>其同样可以推广到多分布情况，在每个分布的权重为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\pi_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的情况下。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mrow><mi mathvariant="normal">J</mi><mi mathvariant="normal">S</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>P</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>π</mi><mi>i</mi></msub><msub><mi>D</mi><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>P</mi><mi>i</mi></msub><mi mathvariant="normal">∥</mi><mi>M</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo><mo>−</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>π</mi><mi>i</mi></msub><mi>H</mi><mo stretchy="false">(</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mo separator="true">,</mo><mi>M</mi><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>π</mi><mi>i</mi></msub><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">D_{\mathrm{JS}}(P_1, P_2,...,P_n) = \sum_{i} \pi_{i} D_{\mathrm{KL}}(P_i \|M) = H(M) - \sum_{i} \pi_{i} H(P_i)\\where, M = \sum_{i} \pi_{i} P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">JS</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">KL</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">h</span><span class="mord mathnormal">ere</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>JS 距离的一些特征：</p><ul><li>在以2为底的情况下，JSD的值域为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>。</li></ul><h2 id="Maximum-Mean-Discrepancy-MMD">Maximum Mean Discrepancy (MMD)</h2><p>迁移学习中常用的损失函数，用来描述两个分布差别。首先通过一个连续函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> 将随机变量映射到高阶，再求其期望之差的上界，定义如下：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>M</mi><mi>M</mi><mi>D</mi><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">∥</mo><msub><mi>E</mi><mrow><mi>X</mi><mo>∼</mo><mi>P</mi></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><msub><mi>E</mi><mrow><mi>Y</mi><mo>∼</mo><mi>Q</mi></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><msub><mo stretchy="false">∥</mo><mi mathvariant="script">H</mi></msub></mrow><annotation encoding="application/x-tex">MMD(P, Q) = \lVert E_{X \sim P}[ f(X) ] - E_{Y \sim Q}[ f(Y) ]\rVert _\mathcal{H}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">MM</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">Y</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight">Q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)]</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>又由于均值是期望的无偏估计，我们用均值替代:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>M</mi><mi>M</mi><mi>D</mi><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">∥</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mo stretchy="false">∥</mo><mi mathvariant="script">H</mi></msub></mrow><annotation encoding="application/x-tex">MMD(P, Q) = \lVert \frac{1}{n} \sum_{i=1}^{n}f(x_i) -\frac{1}{m} \sum_{j=1}^{m}f(y_j) \rVert _\mathcal{H}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">MM</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mopen">∥</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.0652em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>当映射函数仅仅为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">f(x)=x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 时，MMD 表示两个分布均值点的距离。而当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 为无穷维时，我们无法直接计算，此时可以使用核技巧，等号两边同时平方，定义核函数来计算（常用高斯核）。</p><h2 id="Wasserstein-Distance">Wasserstein Distance</h2><p>又被称为推土机距离 Earth Mover’s Distance，来表述把一堆土堆成另一堆土的形状所需要的最小代价。在连续条件下可以写成如下形式：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>W</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>μ</mi><mo separator="true">,</mo><mi>ν</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><msup><mrow><mo fence="true">(</mo><munder><mrow><mi>inf</mi><mo>⁡</mo></mrow><mrow><mi>γ</mi><mo>∈</mo><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>μ</mi><mo separator="true">,</mo><mi>ν</mi><mo stretchy="false">)</mo></mrow></munder><msub><mo>∫</mo><mrow><mi>M</mi><mo>×</mo><mi>M</mi></mrow></msub><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mi>p</mi></msup><mtext> </mtext><mi mathvariant="normal">d</mi><mi>γ</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>p</mi></mrow></msup></mrow><annotation encoding="application/x-tex">W_{p}(\mu ,\nu):=\left(\inf _{\gamma \in \Gamma (\mu ,\nu )}\int _{M\times M}d(x,y)^{p}\,\mathrm {d} \gamma (x,y)\right)^{1/p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">μ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.6982em;vertical-align:-0.9703em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.309em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span><span class="mrel mtight">∈</span><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">μ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.4336em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">d</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.7279em;"><span style="top:-3.9029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1/</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span> 是一个边缘分布分别为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi></mrow><annotation encoding="application/x-tex">\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span></span></span></span> 的联合概率分布，称作 coupling。</p><p>Wasserstein Distance 具有的优点：</p><ul><li>可以衡量离散和连续分布间的距离</li><li>即使两个分布没有重叠，也可以反映他们的远近</li><li>考虑到概率分布的几何特性</li><li>可以体现如何从一个分布转换为另一个分布</li><li>这个距离是平滑的，可以提供梯度信息</li></ul><h3 id="一维分布下的计算">一维分布下的计算</h3><p>对于两个分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>∈</mo><msub><mi>P</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi mathvariant="double-struck">R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu _{1},\mu _{2}\in P_{p}(\mathbb {R} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbb">R</span><span class="mclose">)</span></span></span></span> 和他们的 CDF <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>F</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_1(X), F_2(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>，和对应的 inverse-CDF <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msubsup><mi>F</mi><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_1^{-1}(X), F_2^{-1}(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>，有：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>W</mi><mi>p</mi></msub><mo stretchy="false">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mrow><mo fence="true">∣</mo><msubsup><mi>F</mi><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>−</mo><msubsup><mi>F</mi><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow><mi>p</mi></msup><mtext> </mtext><mi mathvariant="normal">d</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">W_{p}(\mu _{1},\mu _{2})=\int _{0}^{1}\left|F_{1}^{-1}(q)-F_{2}^{-1}(q)\right|^{p}\,\mathrm {d} q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.476em;vertical-align:-0.9119em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.333em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.200em' viewBox='0 0 333 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4436em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2564em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4436em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2564em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.333em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.200em' viewBox='0 0 333 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9184em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span></p><p>这可以看作分布间差异的的横向求和，可以理解为在 x 维度上对沙土的搬运。此外，当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 时，可以看作分布间差异的纵向求和：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>W</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∫</mo><mi mathvariant="double-struck">R</mi></msub><mrow><mo fence="true">∣</mo><msub><mi>F</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>F</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow><mtext> </mtext><mi mathvariant="normal">d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">W_{1}(\mu _{1},\mu _{2})=\int _{\mathbb {R} }\left|F_{1}(x)-F_{2}(x)\right|\,\mathrm {d} x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2719em;vertical-align:-0.9119em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.4297em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbb mtight">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">d</span><span class="mord mathnormal">x</span></span></span></span></span></p><p>在运用 Wasserstein 距离的 WGAN中，在对 W 距离进行优化的时候，可以转化为对以下 Loss 进行优化，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">P_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">P_g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 分别是真实分布和生成分布：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>x</mi><mo>∼</mo><msub><mi>P</mi><mi>r</mi></msub></mrow></msub><mo stretchy="false">[</mo><msub><mi>f</mi><mi>w</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>x</mi><mo>∼</mo><msub><mi>P</mi><mi>g</mi></msub></mrow></msub><mo stretchy="false">[</mo><msub><mi>f</mi><mi>w</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">L = \mathbb{E}_{x \sim P_r} [f_w(x)] - \mathbb{E}_{x \sim P_g} [f_w(x)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0973em;vertical-align:-0.3473em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span></span></span></span></span></p><p>在这个简化的数学形式下，和 MMD 十分相似。</p><h2 id="Bhattacharyya-Distance">Bhattacharyya Distance</h2><p>巴式距离，很好理解，看公式一目了然。需要注意的是其并不满足三角不等式。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>B</mi><mi>C</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo>∫</mo><msqrt><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msqrt><mtext> </mtext><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">BC(p,q)=\int {\sqrt {p(x)q(x)}}\,dx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2222em;vertical-align:-0.8622em;"></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9839em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-2.9439em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067l0 -0c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60zM1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2561em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span></span></p><h2 id="Mahalanobis-Distance">Mahalanobis Distance</h2><p>这个其实不是分布间距离的度量，而是与欧式距离曼哈顿距离同一个层级的概念。主要是每天听 dzy 说这个距离，就顺便看一眼。</p><p>首先要提到欧式距离的缺点：</p><ul><li>不同维度等同对待，哪怕单位不同</li><li>不考虑维度的相关性（非独立同分布）</li><li>举例：身高体重，量纲不同，两者相关</li></ul><p>马氏距离的主要思想在于使用主成分分析中的主成分来进行标准化。由主成分分析可知，由于主成分就是特征向量方向，每个方向的方差就是对应的特征值，所以只需要按照特征向量的方向旋转，然后缩放特征值倍即可。当个维度独立同分布，则变为欧式距离。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mi>M</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msup><mi mathvariant="normal">Σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></msqrt></mrow><annotation encoding="application/x-tex">D_{M}(x, y)=\sqrt{(x-y)^{T} \Sigma^{-1}(x-y)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.5475em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2925em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span style="top:-3.2525em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.88em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90l0 -0c4,-6.7,10,-10,18,-10 H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5zM1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5475em;"><span></span></span></span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span> 是多维随机变量的协方差矩阵。</p><hr><p>参考：</p><ol><li><a href="https://en.wikipedia.org/wiki/Statistical_distance">Statistical distance</a></li><li><a href="https://en.wikipedia.org/wiki/Jensen%E2%80%93Shannon_divergence">Jensen–Shannon divergence</a></li><li><a href="https://lilianweng.github.io/posts/2017-08-20-gan/">From GAN to WGAN</a></li><li><a href="https://zhuanlan.zhihu.com/p/25071913">令人拍案叫绝的Wasserstein GAN</a></li><li><a href="https://en.wikipedia.org/wiki/Wasserstein_metric">Wasserstein metric</a></li><li><a href="https://zhuanlan.zhihu.com/p/163839117">MMD Maximum Mean Discrepancy 最大均值差异</a></li><li><a href="https://zhuanlan.zhihu.com/p/46626607">马氏距离(Mahalanobis Distance)</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Math</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>distribution</tag>
      
      <tag>KL-divergence</tag>
      
      <tag>JS-divergence</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dancing With The Dragon - China - Friend or Foe?</title>
    <link href="/economy-finance/seminar-talks/dance-dragon/"/>
    <url>/economy-finance/seminar-talks/dance-dragon/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>牛津大学的辩论，关于中国是敌是友。<a href="https://youtu.be/nEchkn3unl8">原视频链接</a></p><span id="more"></span> <h1>写在最前</h1><p>其实他们的辩论还是比较逻辑清晰，相信在国外高知中具有一定的代表性，此处总结一些论据，最后加一丢丢个人的看法。</p><p>之前在抖音和B站看过一些关于这个辩论的精彩节选，当然这些节选只包含了“能给中国人看的”或者“中国人喜欢看的”部分（全部都是“友”这一方向的辩词）。本着看事情看全面的态度，特意去油管找了全视频，正反方都来看看。</p><h2 id="辩论双方">辩论双方</h2><table><thead><tr><th>立场</th><th>姓名</th><th>简介</th></tr></thead><tbody><tr><td><strong>Friend</strong></td><td>Ser Vince Cable，文斯·凱布爾爵士</td><td>英國自由民主黨籍政治家和經濟學家</td></tr><tr><td><strong>Foe</strong></td><td>Michael Pillsbury，白邦瑞</td><td>美國國防政策顧問，前美國聯邦政府官員，中國問題作家</td></tr></tbody></table><h1>内容摘录</h1><h2 id="Round-One：辩论环节">Round One：辩论环节</h2><h3 id="Foe">Foe</h3><ol><li>过去大家总认为是美国打开了中国的国门，但是其实现在来看更像是中国打开了美国，并且吸纳了种种的好处。</li><li>在联合国知识产权组织的领导者竞选中，一个中国人，党员，脱颖而出而即将赢得竞选。辩手谴责了这一现象，一个著名的知识产权的盗贼国，却即将赢得竞选，这很荒谬。（当然竞选最终被一个新加坡人赢走了）</li><li>中国存有的的人权问题，审查制度，一党制，白色恐怖让中国显得像是“西方将中国拉入西方世界”这场游戏的胜者。</li><li>中国的野心不是纳粹那样，也不是日本那样的东亚共荣圈。而是重新恢复往日荣光。习需要有第三个任期来完成复兴之路。</li></ol><h3 id="Friend">Friend</h3><ol><li>四十年前，仅通过简单的算术就可以判断中国会成为最大的经济体。四倍的美国人口，意味着中国只要达到四分之一的美国人生活水准，将会达到相同的经济总量。中国将贫困人群的生活水准提高，这是我们非常乐意看到的。（当然印度也有潜力）</li><li>英国人用了一百年习惯了 slipping down the big table 的这种落差。而美国却还没能适应这种现象（中国将进入整个世界的运转规律，而这之前是由美国主导的）。</li><li>中国模式有两个很清晰的原则：<strong>稳定和安全</strong>（在百年的混乱革命内战等等之后），<strong>提高中国的国民待遇</strong>（引入市场经济，卓有成效，虽然也存在一些问题，比如欠消费和企业负债等）</li><li>如果中国的模式没有成功，那我们不会关注他。但是问题是，如果中国的模式持续成功了，我们该如何看待和相处，对于这种社会主义市场经济和一党制。我们承认接受不同体制的存在。</li><li>香港问题，我们对看到香港很多人入狱，甚至报纸被关停十分愤怒。但是中国对香港的红线问题十分清晰。中国本可以排支军队收复香港，就像很多其他国家一样，但是它没有，它看到了一个独立的实体可能带来的好处。 你可以言论自由，但是如果暴乱，秩序被破坏，他们会阻止。那些香港人，以言论自由和民主为名，袭击警察，破坏立法会，尽自己所能杀死了香港的民主。</li><li>关于外交关系：习主席将他的施政方针在十年前就展示的很清晰。如果你想和中国保持好的关系，你需要尊重他们的原则：主权和领土完整，不干涉内政。</li><li>新疆问题，我确信那里的人权遭到了破坏，但是西方在这一问题上的立场过于强硬。明确的是，很多其他国家，包括很多重要的穆斯林国家，都站着中国那一边。你想和中国相处，要意识到他们有着不同的体系，不要干涉他们的内政。</li><li>对于英国来说，和中国合作经济上有益。比如电动车产业，路虎的利润，阿斯利康疫苗公司的利润，英国大学的学费等等。</li><li>中国实际上平衡了全球的财政制度，虽然很多人指责中国在破坏这些制度，但是其实特朗普才是破坏全球财政制度的那个人（取消对 WTO 的支持等）。</li><li>知识产权方面，日本，韩国，台湾，甚至是美国（对于最初的英国），都是在偷窃知识产权上建立起来的。这就是世界如何运行的。</li><li>国家间是需要合作的，从疫情就可以看出。以气候问题为例，我们不能寄希望于在没有中国合作的情况下解决气候问题。中国的确意识到气候问题，他们也做出了努力：碳排放交易，最大的可再生能源，新能源汽车。你不能在一个冷战背景下解决类似这样的大问题。</li><li>中国对很多拥核国有着影响力，如朝鲜，伊朗，巴基斯坦等。中国仍在扩充核武，尽管他们承诺不先使用。但是也只有和平交流才能保证安全。</li></ol><h2 id="Round-Two：主持人提问环节">Round Two：主持人提问环节</h2><h3 id="What-would-you-say-is-the-clearly-defined-role-that-china-ought-to-have-in-its-region-and-beyond-globally-Micheal">What would you say is the clearly defined role that china ought to have in its region and beyond globally? (Micheal)</h3><ul><li>用英国和当时的希特勒举例。一些英国人认为希特勒是合法的，甚至他可以做得更极端（这显然是错的，因为生灵涂炭）。</li><li>对于中国来说，我们的期望是：停止对维族人的种族灭绝，控制核武器问题。</li><li>英国当过老大，美国也当过，但是让中国当是一件危险性极大的事情。</li><li>（但是发言中，他对于这个问题并没有一个清晰的回答。）</li></ul><h3 id="Isn’t-part-of-the-problem-that-people-have-assessing-how-to-engage-with-china-Not-just-we-have-to-engage-with-china-but-actually-we-don’t-agree-with-their-vision-of-the-internet-for-instance-we-don’t-agree-with-militarization-of-the-South-China-Sea-and-these-are-matters-us-Vince">Isn’t part of the problem that people have assessing how to engage with china? Not just we have to engage with china but actually we don’t agree with their vision of the internet for instance we don’t agree with militarization of the South China Sea and these  are matters us. (Vince)</h3><ul><li>首先（对于 Micheal 的回答）我觉得用纳粹来类比中国是一件很 offensive 的事情，这种言语或许会毒害整个辩论并让其看起来不正确。我们讨论的起点是经济关系，但是总讨论新疆，其实解释了我们为什么总是会走到这种冷战的环境中。</li><li>（名场面）如果中国说，我们将不和美国贸易，除非你们废除宪法第二修正案（民众持枪），因为我们中国人觉得这带来的杀害侵犯了人权。如果总是以自己的角度定义人权，那将不会开始进行交流，这显然终止了讨论。中国至少是这个世界系统中的一部分，他们必须被接纳。</li><li>中国用2%的 GDP 来做军费支出，这和北约的英国一样多，他不像苏联一样致力于军事化建设。从国际扩张角度来看，美国可能有200个国际基地（表示对此没有意见），中国有2个，一个在巴基斯坦，一个在（实在是听不清）。这并不是国际军事扩张。</li><li>他们想成为国际经济的一部分，我们需要找一种方式来接纳他们。</li></ul><h3 id="Belt-and-Road-brings-infrastructures-to-the-place-where-the-west-hasn’t-provided-a-sensible-response-to-Why-doesn’t-the-west-have-a-better-answer-to-those-perfect-legitimate-questions-e-g-we-want-5G-which-Chinese-are-answering-Micheal">Belt and Road brings infrastructures to the place where the west hasn’t provided a sensible response to. Why doesn’t the west have a better answer to those perfect legitimate questions (e.g. we want 5G) which Chinese are answering? (Micheal)</h3><ul><li>一带一路本身并不邪恶。但是一带一路可能会带来主权问题。</li><li>中国在推广他的模式，很多人喜爱中国的模式，这是我们不能接受的。</li><li>如果种族灭绝发生，你肯定不能把这个政府当成正常的政府看待。</li><li>（总体上仍然是回避了问题）</li></ul><h3 id="Essentially-the-price-of-doing-a-trade-deal-with-china-is-essentially-that-you-have-to-shut-up-about-china-if-you’re-not-gonna-say-something-nice-Vince">Essentially the price of doing a trade deal with china is essentially that you have to shut up about china if you’re not gonna say something nice. (Vince)</h3><ul><li>如果我们想和有相同观念的国家在一起，我们会和欧洲在一起（然而我们事实上已脱欧）而不是中国。事实上，我们并没有很多选择，我们只能和这些新兴的快速成长的经济体合作。我们需要更务实（pragmatic）。</li><li>我有机会和中国总理谈论人权，你们是一个社会主义国家，但是你们的劳工都没有权利罢工。我们邪恶（wicked）的资本主义国家至少还有工会等等。我们详谈了一个半小时。</li><li>我不知道新疆确实发生了什么，我读了文献，那里可能的确有一些不合适的行为，但是我们绝对不应该用“种族灭绝”这样的词汇，这是很不合适的。当蓬佩奥开始使用这样的词汇时，他的律师与他撇清了关系，如果那里真的很邪恶，请我们使用正确的语言来描述它。</li></ul><h1>观后感</h1><h2 id="对于辩论整体">对于辩论整体</h2><ul><li>在不考虑观点论据正确性、真实性的情况下，明显能感觉到凯布尔爵士和白邦瑞两个人的语言逻辑完全不同，甚至可以说，两个人一个是在辩论，另一个更像是在做政治宣传（当然辩论也是传播思想的主要途径之一，在此不做评价）。</li><li>对于 Foe 方，在阐述过程中，白邦瑞多次使用没有论据支撑的论点，以假设语气反复强调某一论点，并且时常跑题。在提问环节中，从不正面回答问题，反而呈现的是特朗普政府那一套顾左右而言他的政客话术，个人感觉难以从他的谈吐中学到东西。</li><li>对于 Friend 方，凯布尔爵士将朋友（dance with dragon）和合作交换了概念，毕竟合作不一定需要是朋友。他的整个阐述逻辑都是围绕合作展开，个人认为这个逻辑替换还是相对可以接受。在他的小论点下（反驳目前的很多西方指责的点），他摆出了很多事实论据作为支撑，也包含他在与中国实际接触中的例子。总体的陈述方面，他先点明大原则，再在此之下展开讨论，逻辑清晰。在问答方面，个人认为他也有一些跑题，但是总体上还是围绕问题展开，也举了很多有趣的例子，我觉得还是比较不错的。</li></ul><h2 id="对于辩论内容">对于辩论内容</h2><p>当然屁股决定脑袋，我的屁股站中国，我的脑袋也一定是站中国。其实不论他们两个人的立场（不管是个人立场还是辩论立场），我们可以从他们展现或挖掘出来的信息里看到很多东西。</p><p><strong>白邦瑞</strong>：</p><ul><li>首先最明显的一点，这个人在整个辩论过程中都充满了对自己新书的推销。甚至话说一半，剩下的“可以去我的书里找”。这或许能代表很大很大一部分美国退休政客的退休生活。</li><li>我的直观印象来看，他和特朗普在表达上有着很大的相似之处，最主要的一点在于演讲性和煽动性。对于这些性质，之前读《乌合之众》时也有一点感想，说服一群人有时候并不需要举证，举出一个观点并调动大家的情绪（威胁论，迫害论）可能就足够了。但是这是在辩论场，而且是在 Oxford Union 的辩论场，我怀疑这样是否有效，同时也觉得这样可能给他败了一波好感。</li><li>从他的发言来看，美国人最不爽的其实是“中国打开国门之后变得很好”。他们存在这么多问题但是经济还很好，所以引发了对中国体制和政党的口诛笔伐。同时也能看出来他们对于 C party 的敌意。</li><li>当他用纳粹和中国类比的时候我惊呆了，没有想到美国的高层会对中国有这样的认知，不论是否有普遍性，这种观点的产生其实足够让人思考。（当然他们很多是以新疆为论据，这个我未做调研，但是我的屁股坚定的坐在中国这一边）</li><li>个人觉得，他们是有一个中国过于强大的预期，但是他们并不满意于中国现在的一些行为方式、体制、施加影响的方式，（在不考虑“不愿意让出老大地位”的这个事实下）假设有朝一日他们愿意把老大让给中国，他们是不希望这些他们不喜欢的行为方式、体制、施加影响的方式作用在他们身上。</li></ul><p><strong>凯布尔爵士：</strong></p><ul><li>首先我认为，凯布尔爵士作为一位的确与中国有过沟通交流的政治家，经济学家，他的发言相对客观及有理有据，而且透露着一种礼貌谦逊，虽然还是有着“号召者”的那种气场（国家地位不允许），但是总体来说还是让人觉得舒服且信服的。</li><li>他说的英国已经习惯了这种从世界中心滑落的落差，而美国没有，我觉得是十分有趣的一点。这让我觉得美国当前的敌对行为是合理的，没有人愿意看到自己的相对衰落，如果真的发生，那么唯一能做的就是阻止和拖延，直到不可挽回躺平。</li><li>他能看到事情发展的两面，比如香港问题，他提到了一些对一些事件的惋惜，但是同样的，他也对香港暴徒进行了指责，我认为这是十分客观的。</li><li>他的回答很大程度上是从经济角度来看（包含 ESG），在这种情况下，他提到的合作带来的益处显而易见，这应该是无法反驳的。</li><li>从核问题角度来看，他的回答的确体现了如何从政治上进行权衡，和平的交流对中方施加善意，中方也会利用自己的影响力向其他反对西方的拥核国施加压力。而白邦瑞的态度则截然不同，他的观点更在于对抗。这就让我想起了发言人华春莹的那句话，“有没有想过把一个大国逼到绝境的后果？”</li><li>知识产权方面，的确人间清醒，这种事过去在发生，现在在发生，未来也会发生，这就是事物发展的趋势无法阻挡。我十分认同，但是我也十分支持知识产权的保护，我认为两者并不冲突。</li><li>气候问题方面，他的回答展示出很多西方高层的确看到了中国对 ESG 方向的努力，我认为这个一定程度上能体现一部分西方高层对华某些方面由衷的褒奖。</li><li>在凯布尔爵士的回答中，两次对白邦瑞的用词进行了批判。一是“纳粹”类比，二是“种族灭绝”。通过他的反驳，我对这个人肃然起敬，我觉得能为他人受到的不公发声是一件很优雅且很有勇气的事情。</li><li>对于新疆问题，他直言“我不知道新疆确实发生了什么”。我觉得其实绝大部分人，新疆人，外国人，中国人，包括我自己都不知道那里真的发生了什么，所以其实绝大部分人无证据的谈论都是毫无意义的，只能徒增吵架的材料。</li><li>在他的回答中，多次提到了接纳、融入、思考在一个有中国的体系中如何做。这是很务实且很善意的行为，我个人觉得十分欣赏。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
    <tags>
      
      <tag>辩论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>中美关系、人民体系与未来起点收入</title>
    <link href="/economy-finance/seminar-talks/future-start-income/"/>
    <url>/economy-finance/seminar-talks/future-start-income/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>翟东升2021年12月中旬于财科院演讲。</p><span id="more"></span> <h2 id="1-中美关系当前态势与未来趋势">1. 中美关系当前态势与未来趋势</h2><p>当前中美关系：</p><ul><li>2021年上半年斗争为主</li><li>下半年互相让步</li><li>美方主动缓和，中方两手准备</li><li>2021年11月双方开会会谈，无人知道结果。（谈的好才保密，谈的差必然宣布“英勇斗争”）</li></ul><p>拜登政府对华特点：</p><ul><li>前倨后恭</li><li>受限于国内反华民意，力求平衡</li><li>经济困境：债务上限、高通胀</li><li>华尔街对白宫影响部分恢复</li><li>白宫对各个部门影响力有限</li><li>国内支持率低，已经弃疗，重心转向历史遗产<ul><li>众议院领先、参议院有略微优势</li><li>中期选举参议院必丢、众议院也会丢（目前领先5，平均丢27.5席位）</li></ul></li></ul><p>7.31号美国债务上限恢复，于是八月份拜登宣布在阿富汗撤军。</p><p>中美关系走向预判：</p><ul><li>中期选举之后横盘，否则会有来源于国会的压力。</li><li>三年后可能再次下跌。</li><li>特朗普在干什么？（下次竞选代表共和党可能性较大）。</li></ul><h2 id="2-如何用“人民体系”替代布雷顿森林体系及其衍生物">2. 如何用“人民体系”替代布雷顿森林体系及其衍生物</h2><p>三个强盗分金沙：</p><ul><li>两个人分：先分后挑</li><li>前一个人分，下一个人如果认为多了，减沙自取</li><li>和平的无政府博弈的关键在于：<ul><li>权力和责任要匹配：美国获得货币特权，却不愿意承担逆差的结果。</li><li>原则理念与现实手段要匹配</li></ul></li></ul><p>怀特和凯恩斯的辩论：</p><ul><li>怀特的理论有内在缺陷：例如特里芬难题（一国货币成为国际储备货币）</li><li>盖恩斯的理论更为完善</li><li>怀特计划形成布雷顿森林体系<ul><li>GATT 关税贸易总协定</li><li>世界银行</li><li>金汇兑本位制：美金可以换黄金，其他货币不能换黄金。（戴高乐发债换美元赎黄金再用黄金抵押发债）</li></ul></li></ul><p>“人民体系”：以全世界人民为中心而不是以金融资本为中心（资本相对劳动占据优势地位）</p><ul><li>原有体系受益者是资本拥有者（印钱推动资产上升）</li><li>为什么全世界绝大多数国家会乐意参与这个新体系？</li><li>分配方式：由新的全球央行通过购买各国国债来为各国提供资金</li></ul><p>布雷顿森林体系根本困境：</p><ol><li>权责不对等导致现行秩序合法性权威性缺失。</li><li>特里芬难题，美元作为国内货币主权性和作为国际货币的超主权性的矛盾。</li><li>基于英美谈判，难以反映现今国际政治经济权利格局。</li><li>自由贸易成为冲突之源。</li></ol><p>需求：</p><ul><li>一个权责匹配的，正确反映当前国际权力格局和时代挑战的国际经济新秩序</li><li>中美欧应当就21世纪货币金融贸易产业等国际规则展开谈判，寻求顶层规划，设计公平合理可持续的“人民体系”，以取代布雷顿森林体系和牙买加体系。</li></ul><p>“人民体系”（翟东升，嵇先白）：</p><ol><li>基本平衡的贸易 Balanced Trade：而不是自由贸易</li><li>超越主权的货币 World Currency：而不是主权货币<ul><li>这种国际货币需要<strong>锚定一揽子商品</strong>。</li></ul></li><li>绿色普惠的金融 Responsible Finance：ESG为主，而不是利润最大化导向</li></ol><p>如何把这套体系变成现实：</p><ol><li>中美谈判难以成功。将欧洲纳入。人民体系一定程度上是欧洲一体化经验教训的全球版。（但是非平衡贸易，商品服务不能自由流通。）</li><li>短期难以谈成，但是可以先下手为强，抢占制度变革的话语权。</li><li>有可能将世界分为两个平行的国际体制。</li></ol><h2 id="3-如何用“未来起点收入”推进共同富裕和内循环">3. 如何用“未来起点收入”推进共同富裕和内循环</h2><p>如果美方不接受2中的体系，或者我方没有下定决心进行改革，那么就需要在内部搞共同富裕。</p><p>民粹主义两大支柱：</p><ul><li>数据信息传播模式发生变化。</li><li>贫富分化。</li></ul><p>为什么必须搞共同富裕？</p><ul><li>避免民粹主义和政治动荡。（避免出现落第秀才）</li><li>共同富裕撬动消费和投资的增长，实现内循环为主的双循环</li><li>增加国民福利，让中国人投入更有意义的工作和学习，实现高质量发展</li></ul><p>合成谬误：每个人都是有道理的，但是合在一起起到了颠覆性的效果。</p><h3 id="共同富裕：北欧的例子">共同富裕：北欧的例子</h3><p>黄文政：推动计划生育变革、哈佛教统计学、颠覆统计学底层逻辑、华尔街对冲基金、未加入美国国籍、致力于拯救中华民族（游说改变计划生育政策）、《新时代中国特色社会主义道路下的全民基本收入》：未来起点收入（给年轻人发钱）</p><p>北欧：</p><ul><li>税全球最高</li><li>人均GDP最高</li><li>亿万富翁密度最高</li></ul><h3 id="如何做？谁得利？谁受损？">如何做？谁得利？谁受损？</h3><ul><li>中央地方的财权、事权和债务再分配</li><li>区域再分配：转移支付</li><li>代际再分配：让中老年人向年轻人让利</li><li>行业再分配：挤压原本比较肥的行业（金融、电力）</li><li>国际再分配：央行资产负债表的替代</li><li>阶层再分配：反腐、扶贫、医疗教育住房</li><li>人民币汇率水平适当高估，从长期巨额顺差变成大体平衡略有逆差。</li><li>“未来起点收入方案”：补贴年轻人，促进机会平等、提高人口素质、增强我国人口竞争力。</li></ul><h3 id="钱从哪来？">钱从哪来？</h3><ul><li>税收：查税，警税合作，藏富于民</li><li>富人的税收是小头，大头来自于国债扩张（现代货币理论）</li></ul><h3 id="社会结构转型带来巨大内循环商机">社会结构转型带来巨大内循环商机</h3><ul><li>懂得资产配置，将能从共同富裕中获利</li><li>从金字塔社会向橄榄形社会的转变将带来中产阶级和国内消费市场的快速扩大。（富人消费市场大还是中产消费市场大？）</li><li>如果共同富裕能实现，中国国内市场规模等于美欧日之和。</li><li>新增中产主要在哪里？</li></ul><p>新中产的形成与未来商机：</p><ul><li>哪些生意的市场规模扩张到十倍以上？哪些商品和服务？</li><li>汽车动力电池需求；富贵病医疗需求；高铁航空出行需求；旅游度假需求；优质教育；线下消费；养宠物情感需求；优质高端养老服务需求</li><li>这些需求扩张未必带来利润率大幅上升，因为多数供给也会随之扩张。</li><li>需求上涨而供给无法扩张的东西，价格会有明显上涨：如茅台，顶级医疗</li><li>劳动力更贵，机器人普及</li><li>旅游业</li></ul>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
    <tags>
      
      <tag>翟东升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>乌合之众</title>
    <link href="/reading-note/the-crowd/"/>
    <url>/reading-note/the-crowd/</url>
    
    <content type="html"><![CDATA[<p>《乌合之众》古斯塔夫·庞勒（1841-1931），法国社会心理学家。</p><span id="more"></span><h2 id="极简简介">极简简介</h2><p>这是一本百年前对群体心理学研究的书籍。主要介绍了三个方面：群体的心理与特征，群体意见信念及形成原因和演变，群体的分类与特点。作为参考，豆瓣上有一份个人认为比较全面且简略的<a href="https://book.douban.com/review/5204395/">内容梗概</a>。</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>这是一本能帮我们意识到群体具有其独特性质的书，一定程度上可以让我们对生活中一些事件有一些初步的认知，比如说：</p><ol><li>可以以此分析EDG夺冠后群体的不合理发泄的合理性（即群体的一般特征）。</li><li>1989的事件，群体的煽动性和不可控性展现的淋漓尽致。</li><li>翟老师对于之前美国通胀的表述，人民群众起义抵抗。</li><li>长津湖观影时觉得士兵慷慨赴死，体现了群体道德的一部分。</li></ol><p>但总体而言，书还是过于老旧，启发式作用远大于知识性作用，读来涨见识不错，实际运用的话还是缺少很多证据支持及实操手段，相信后人也有着更加细致的研究。</p><h3 id="缺点（喜爱挑毛病）">缺点（喜爱挑毛病）</h3><ol><li>虽然结论很精彩，但论述也很薄弱（多用例证法，虽然这已经在当时是比较好的论述方式了）。的确此书指出了很多群体中出现的现象，也分析了一些原因等，但是其并没有一些指导性的建议缓解群体的这些缺点。</li><li>如今看来政治十分不正确。本书多次提到了女性和孩童容易走向极端和性格反复感情用事。同时也提到拉丁族裔的狭隘。也将种族作为一个影响群体意见的很大因素。</li></ol><h3 id="感想-看法">感想/看法</h3><ol><li>“乌合之众”，何为“众”，其实是一个值得定义的东西。虽然书中列举了一些群体，但是我觉得还是过于宏观，或许不能一概而论。而且不同的粒度下或许群体性质会有改变。</li><li>作为管理者的话，此书或许较为重要，可以帮助理解群体的思维方式，但是具体如何管理，还是需要参考其他的著作。</li><li>“为公众留下深刻印象的不是事实，而是事情发生并引起注意的方式。”认为这句话说的很对，例如最近的一系列小作文事件。如何博眼球，如何娱乐化，如何占据道德的制高点，显得比事实更加重要。</li><li>罗伯特•墨顿的序“勒庞《乌合之众》的得与失”写得很好，他提到一点，“《乌合之众》的当代意义，在于它发现问题的功能而非解决问题的功能。”（摘自<a href="https://book.douban.com/review/5204395/">此链接</a>）。</li></ol><h1>按节讨论/摘录</h1><h2 id="引言">引言</h2><ul><li>文明更新过程中，仅有的重大变化就是受其影响的观念理念和信念的变化。</li><li>人们的行为从来都不是建立在纯粹理性之上的。</li></ul><h2 id="第一卷-群体心理">第一卷 群体心理</h2><h3 id="第一章-群体的一般特征">第一章 群体的一般特征</h3><ul><li>集体心理使他们的感受思想和行为方式与其作为独立个体时的感受思想和行为方式有着很大的不同。</li><li>不同的原因造成群体的新特征<ul><li>构成群体的个体在考虑事情是时从数量方面出发，他们会感受到一种无敌的力量，并因此形成一种本能。当他们独自一人时，则必须克制这种本能。群体是无名的，因此也无需承担责任，然后一直控制着个体的那种责任感便完全消失。</li><li>传染决定着群体特殊特征的表现。个体的受到传染后，很容易会被集体利益，而牺牲个人利益。这种能力有违个体的本性，而且除非作为群体的一部分，否则一个人很少能做到这一点。</li><li>在暗示的影响下，个体将会在不可抵抗的冲动的支配下，完成某些行为。</li></ul></li><li>群体在治理方面总是劣于其独立个体，但是从群体所引发的个体感受和行为的观点来看，根据不同的环境，群体可能会优于或劣于其个体。</li><li>群体通常都是犯罪性的，但英雄性群体是同样存在的。</li></ul><h3 id="第二章-群体的情感和道德">第二章 群体的情感和道德</h3><ul><li>独立的个体具有支配其反射作用的能力，而群体则不具备这种能力。</li><li>群体的多变性使得他们难以管辖。尽管群体的愿望十分狂热，但是这些愿望仍不会长久，因为群体既没有能力，也没有意愿为任何事做长久打算。</li><li>群体并不准备承认任何事都或成为其欲望和欲望实现之间的阻碍，由于感觉到人多势众所赋予的不可抵抗的力量，所以群体没有能力理解这种阻碍。</li><li>群体会永远徘徊在无意识的边陲地带，迅速屈服于所有的暗示，游泳所有无法上溯至理性影响的生命体所特有的暴力感受，同时失去所有批判能力，而且除了过度轻信意外再无其他能力。</li><li>对于一个群体而言，不可能的事是不存在的。</li><li>通常来说，如果一件事得到了成千上万的目击者的证实，那么事情的真实情况一定与大家所说的情况存在较大差异。</li><li>不管群体展现出来的情感是好是坏，他们都展现出了双重性格，简单与夸张。<ul><li>在群体中，愚蠢、无知和有嫉妒心的人感受不到他们的毫无意义和无能为力。</li><li>群体愈加夸张的去时通常会施加于坏情绪上（作为个体对惩罚的恐惧迫使其竭力控制坏情绪这种本能），因此群里很容易会导致坏的过激行为的发生。</li><li>这并不意味着在受到巧妙的影响下不能表现出英雄主义以及成为最高美的标准的证明。</li></ul></li><li>如果一位演说家要感染一个群体，那他必须粗暴地使用激烈的言论，必须通过夸张、断言或依靠与重复，而且永远不要试图通过推理的方式来证明任何事。</li><li>群体会夸大对英雄的情绪。</li><li>个体成为群体的一部分之后，他的治理标准就会立即大幅度降低。</li><li>群体只知道简单和极端两种情绪；他们将所受到的观点想法和性能作为一个整体而接受或拒绝，而且会将他们看作绝对真理或绝对错误。</li><li>个体可能会接受矛盾并进行讨论，但是群体将永远不会这么做。</li><li>群体会对强势力量“俯首称臣”，而且很少会被善良所打动，因为善良对于他们而言不过是一种软弱的表现。他们从来不会同情随和的人，但却会同情极力压迫他们的暴君。群体所欣赏的那类英雄总是会与凯撒有相似之处，他的徽章吸引着他们，他的权利震慑着他们，他的利剑让他们对其充满恐惧而又敬畏。</li><li>群体的光荣、名誉和爱国主义情感尤其可能会对其中的个体产生影响，而且个体通常也会在这种影响的作用下献出生命。</li></ul><h3 id="第三章-群体的观念、理性思考能力和想象力">第三章 群体的观念、理性思考能力和想象力</h3><ul><li>观念只能以群体所假定的简单形式才会被群体所接受，而且通常必须要经过最彻底的转变才能变得流行。</li><li>群体理性思考能力的特征就是仅在表面上相互关联的不同事物之间的结合，而且那些特定情况立即就会变的一般化。那些知道如何管理群体的人总是会向群体展示这种论证。</li><li>争取切法理性思考能力的人一样，群体的想象力是非常有利、非常积极，且容易受到强烈影响的。这就是为什么能让群体留下深刻印象的事总是那些不可思议和充满传奇色彩的事。</li><li>当我们对一种文明进行分析时，我们会看到，真正支撑文明的就是那些不可思议和充满传奇色彩的事。在历史上，表现总比现实发挥着更重要的作用，而不真实总是比真实更加有力。</li><li>每一个时代、每一个国家的伟大政治家，包括绝对专制的君主，他们都非常重视大众的想象，而且将此作为权利的基础并在对大众进行统治期间从未尝试反对他们的这些想象。（举了拿破仑天主教徒、伊斯兰教徒、教皇权力主义者的例子）</li><li>安东尼并非是利用花言巧语才成功让平民们反抗凯撒并谋杀了他；而是通过向大众宣读凯撒的遗嘱并抬出了他的尸体。</li><li>事情必须以整体的方式呈现在群体面前，而且不能告诉他们事情的起源。</li><li>为公众留下深刻印象的不是事实，而是事情发生并引起注意的方式。</li></ul><h3 id="第四章-群体信仰的宗教形态">第四章 群体信仰的宗教形态</h3><ul><li>群体在受到适当的影响之后会准备为他们所激发出来的理想而奉献自己。</li><li>宗教情绪的特点非常简单，比如对想象中的高级生命体的崇拜、对其权力的恐惧、对其命令的盲目尊从、不具备讨论起教条的能力，以及将不接受这些教条的人看作敌人的倾向。</li><li>所有宗教或政治信条的的创始人之所以能够成功，是因为他们都通过那些狂热的情绪极大地鼓舞了民众，而这些情绪则使得人们在崇拜中找到了幸福，并且他们愿意且已准备好为他们的理想而献身。</li></ul><h2 id="第二卷-群体的观点与信念">第二卷 群体的观点与信念</h2><h3 id="第一章-群体观点与信念的间接因素">第一章 群体观点与信念的间接因素</h3><ul><li>决定群体的观点和信念有两种因素，间接因素和直接因素，间接因素中存在着一些一般属性，而这些属性就是群体所有信念和观念的基础。这些属性就是：种族、传统、时间、制度和教育。</li><li>种族的力量就在于在不经历最深刻变革的情况下，任何要素都不能在种族之间进行传播。</li><li>如果一个民族允许其风俗习惯变得根深蒂固，那么这些传统将不再发生变化，而且就像中国一样，这个民族就不再拥有改进与提高的能力。在这种情况下，暴力革命是没有任何作用的，因为其结果无非是那些被打碎的束缚再一次拼凑在一起，并且让过去的帝国原封不动地重现，接下来就是残余的历史碎片很快会破碎，然后陷入无尽的混乱。</li><li>一些重要因素的形成是依赖于时间的，比如种族，如果没有时间，种族便无法形成。</li><li>一个民族无法按照自己的意愿选择题制度，就像他们不能选择自己头发和眼睛的颜色一样，制度和政府都是种族发展的产物。他们并不是时代的造物主而是时代造就了他们。</li><li>制度并没有固有美德，就制度本身而言，他们没有好坏之分。那些良好的制度，是指在既定时间内对既定人群无害的制度，但是对于其他民族而言，这种制度可能会是另一个极端。</li><li>教育使得一个国家的年轻人可以了解这个国家的未来。</li></ul><h3 id="第二章-群体观点的直接因素">第二章 群体观点的直接因素</h3><ul><li>词语的力量与他们所唤起的图像有密切的联系，而且不受其真正意义的支配。有时候意义最不明确的词语反而拥有最大的影响力。</li><li>语言所包含的词语在时代的发展过程中变化的非常缓慢，但是这些词语所唤起的图像或者它们的意义却在不停的变化。</li><li>政治家最基本的职能之一就是，无论如何都要经得住流行用语以及群体无法忍受其原有名称词语的考验。</li><li>在一个同样的社会中，同样的词语对于不同的社会阶层有着不同的含义，他们表面是使用同样的词语，实际上他们所说的是不同的语言。</li><li>无论是谁，只要能为他们带来幻想，这个人就会轻易成为它们的领袖；无论是谁，只要试图毁灭他们的幻想，这个人就会成为他们的受害人。</li></ul><h3 id="第三章-群体的领袖及他们的说服方法">第三章 群体的领袖及他们的说服方法</h3><ul><li>领袖的行动方法：断言、重复和传染</li><li>对于一个人而言，如果模仿是十分容易的，那么模仿是必然的。</li><li>人们会把从高位跌落的英雄看成与他们平等的人，而且还会对这位不再有任何优越性的人采取报复行动。</li><li>从威望遭受质疑的那一刻起，，威望便不再有任何威力。如果要得到群众的仰慕，威望的载体就必须与他们保持距离。</li></ul><h3 id="第四章-群体观点与信念可变性的局限性">第四章 群体观点与信念可变性的局限性</h3><ul><li>真正广义信念的数量是非常有限的。他们的出现和消亡都来自于历史上每一个种族历史的巅峰时刻，它们构成了文明的真正框架。</li><li>一般来说想要改变一种信念就必须要以暴力革命为代价。事实上，一场革命的开始就是一种信念的结束。</li><li>一种伟大信念开始衰败的精确时刻是很容易辨认的，就是当人们开始质疑其价值的时候。</li><li>现在一种观点在被大众普遍接受并成为一种普遍观点之后就已经消亡了。</li></ul><h2 id="第三卷-不同群体的分类和描述">第三卷 不同群体的分类和描述</h2><h3 id="第一章-群体的分类">第一章 群体的分类</h3><ul><li>由于种族的精神力量十分强大，因此群体的劣质特征并不占据重要比重</li></ul><h3 id="第二章-犯罪群体">第二章 犯罪群体</h3><ul><li>通常群体犯罪动机是一种强烈的暗示，而且参与犯罪的个体在事后坚信他们的所作所为是遵从义务，这与普通的犯罪情况相去甚远。</li></ul><h3 id="第三章-刑事陪审团">第三章 刑事陪审团</h3><ul><li>展示出易受暗示的特征，但是他们却几乎没有能力进行理性思考。容易受到群体领袖的影响，而且还主要收到无意识情绪的引导。</li><li>群体的力量是令人敬畏的，但是某些社会等级群体的力量是更加令人恐惧的。群体还有被说服的可能，但是那些社会等级群体则永远没有这种可能。</li></ul><h3 id="第四章-选民群体">第四章 选民群体</h3><ul><li>头等重要的是，候选人必须要想有威望，而这种威望能迫使选民们没有异议地支持自己。</li><li>拥有威望还不足以确保候选人能获得成功，选民们特别重视别人对其贪婪和虚荣的恭维。</li><li>对于社会问题，由于其数量是未知的，所以人从本质上来讲都是同样无知的。</li></ul><h3 id="第五章-议会">第五章 议会</h3><ul><li>在群体中最重要的特征就是他们观点的简单化。到目前为止，这种群体的不变趋势就是通过最简单的抽象原则和适用于所有情况的普通法律来解决最复杂的问题。</li><li>通常情况下，议会的投票只代表少数人的观点。</li><li>领袖应该掌握一种特殊的雄辩术，包括有力的肯定，无需证据证明，以及令人印象深刻的形象，同时伴随非常简明扼要的论证。</li><li>所谓自由的增加，必定紧随着实际自由的减少。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>人工智能中的逻辑</title>
    <link href="/artificial-intelligence/ai-logic/"/>
    <url>/artificial-intelligence/ai-logic/</url>
    
    <content type="html"><![CDATA[<p>将逻辑作为基于知识的 Agent 的一类通用表示，这样的 Agent 通过对信息的组合和再组合以适应各种用途。本文一部分参考了这位同学的<a href="https://blog.csdn.net/rectsuly/article/details/73104723">笔记</a>。</p><span id="more"></span><p>Logics: formal languages for representing knowledge to extract conclusions</p><h1>基于知识的 Agent</h1><ul><li>知识库（KB）：基于知识的 Agent 的核心部件。是一个“语句”集合。</li><li>语句（sentence）：用知识表示语言表达，表示了关于世界的某些断言。</li><li>公理：当某语句是直接给定而不是推导得到的时候，我们将其称为公理。</li></ul><p>每次调用 Agent 程序，他做三件事：</p><ol><li>Agent TELL 知识库他所感知到的内容。</li><li>Agent ASK 知识库应该执行什么行动。<ul><li>在此过程中可能会对于世界的当前状态，可能行动队列进行大量推理。</li></ul></li><li>Agent TELL 知识库他采取的行动，并执行该行动。</li></ol><h1>逻辑知识与概念</h1><p>逻辑：一种形式语言，可以表示能得出结论的信息</p><ul><li>语法（Syntax）：定义了语言中的句子</li><li>语义（Semantics）：定义了句子的意思，即语义定义了每个语句关于每个可能世界的真值</li></ul><p>蕴涵（Entailment）</p><ul><li>蕴涵意为一个语句逻辑上跟随另一个语句而出现：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>B</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">KB |= \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></li><li>知识库 KB 蕴涵句子 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> 当且仅当在 KB 为真的每个世界中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>也为真</li><li>蕴涵是句子间的关系，其基于语义。</li><li>例如，x=0 蕴含 xy=0。</li></ul><p>逻辑推理（inference）：</p><ul><li>如果推理算法 i 可以根据 KB 导出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，我们表示为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>B</mi><mi mathvariant="normal">∣</mi><msub><mo>−</mo><mi>i</mi></msub><mi>α</mi></mrow><annotation encoding="application/x-tex">KB |-_{i} \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mbin">−</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，读为“i 从 KB 导出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>”</li><li>KB的所有推论集合是一个干草堆，α是针，蕴含=干草堆里的针，推理=找到它</li><li>对于推理算法 i：<ul><li>可靠性 Sound：不会虚构事实，只导出语义蕴涵句。</li><li>完备性 Completeness：可以生成任一蕴涵句。</li></ul></li></ul><h1>命题逻辑</h1><p>Syntax 语法：</p><ul><li>原子语句：命题符号P1，P2等是句子，代表一个或为真或为假的命题</li><li>复合句：<ul><li>如果S是一个句子，则┐S也是一个句子（negation 非，否定式）</li><li>如果S1和S2是句子，则S1∧S2是句子（conjunction 与，合取式）</li><li>如果S1和S2是句子，则S1∨S2是句子（disjunction 或，析取式）</li><li>如果S1和S2是句子，则S1=&gt;S2是句子（implication 蕴涵，蕴涵式）</li><li>如果S1和S2是句子，则S1&lt;=&gt;S2是句子（biconditional 当且仅当，双向蕴涵式）</li></ul></li></ul><p>语义：</p><ul><li>定义了判定特定模型中语句真值的规则。</li><li>可以用真值表总结</li></ul><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-logic/truth-table.png" class=""></div><p>其中=&gt;的真值表比较令人困惑。</p><ul><li>不要用如果 P 那么 Q的思路来理解。<ul><li>命题逻辑不要求 P/Q 间的相关性或因果关系。</li></ul></li><li>以“如果 P 为真，那我主张 Q 为真，否则无可奉告”来理解。<ul><li>前提为假的任意蕴含都为真。</li><li>该语句为假的唯一条件是 P 为真而 Q 为假。</li></ul></li></ul><p>算符具有一定的运算性质（逻辑等价）：</p><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-logic/property.png" class=""></div><p>Implication 的几形式变换，真值可能会发生变换：</p><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-logic/implication.png" class=""></div><h2 id="推导和证明">推导和证明</h2><p>下列表示意为，给定任何形式的上方语句，就可以推导出下方语句：</p><ul><li>Modus Ponens: 假言推理原则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>α</mi><mo>⇒</mo><mi>β</mi><mo separator="true">,</mo><mspace width="1em"/><mi>α</mi></mrow><mi>β</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{\alpha \Rightarrow \beta, \quad \alpha}{\beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4133em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mrel mtight">⇒</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:1.4286em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>Modus Tollens: 假言推理原则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>α</mi><mo>⇒</mo><mi>β</mi><mo separator="true">,</mo><mspace width="1em"/><mi mathvariant="normal">¬</mi><mi>β</mi></mrow><mrow><mi mathvariant="normal">¬</mi><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\alpha \Rightarrow \beta, \quad \neg \beta}{\neg \alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2772em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">¬</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mrel mtight">⇒</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:1.4286em;"></span><span class="mord mtight">¬</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>Addition: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>α</mi><mrow><mi>α</mi><mo>∨</mo><mi>β</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\alpha}{\alpha \vee \beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1765em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mbin mtight">∨</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>Simplification/And-Elimination: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>α</mi><mo>∧</mo><mi>β</mi></mrow><mi>β</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{\alpha \wedge \beta}{\beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4133em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mbin mtight">∧</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>Disjunctive-syllogism: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>α</mi><mo>∨</mo><mi>β</mi><mo separator="true">,</mo><mspace width="1em"/><mi mathvariant="normal">¬</mi><mi>α</mi></mrow><mi>β</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{\alpha \vee \beta, \quad \neg \alpha}{\beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4133em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mbin mtight">∨</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:1.4286em;"></span><span class="mord mtight">¬</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>Hypothetical-syllogism: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>α</mi><mo>⇒</mo><mi>β</mi><mo separator="true">,</mo><mspace width="1em"/><mi>β</mi><mo>⇒</mo><mi>γ</mi></mrow><mrow><mi>α</mi><mo>⇒</mo><mi>γ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\alpha \Rightarrow \beta, \quad \beta \Rightarrow \gamma}{\alpha \Rightarrow \gamma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4133em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mrel mtight">⇒</span><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mrel mtight">⇒</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:1.4286em;"></span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="mrel mtight">⇒</span><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul><p>Search for proofs is a more efficient way than enumerating models:</p><ul><li>Truth tables have an exponential number of models.</li><li>The idea of inference is to repeat applying inference rules to the KB.</li><li>Inference is sound, but how about completeness?</li></ul><h2 id="如何来保证完备性？">如何来保证完备性？</h2><ul><li>Proof by resolution</li><li>Forward or Backward chaining</li></ul><h3 id="归结（Resolution）">归结（Resolution）</h3><p>类似于 Disjunctive-syllogism。如果两个中必存在一个，而又不是第一个，则是第二个。</p><p>单元归结（Unit resolution）</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><msub><mi mathvariant="normal">ℓ</mi><mn>1</mn></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><msub><mi mathvariant="normal">ℓ</mi><mi>k</mi></msub><mspace width="1em"/><mi>m</mi></mrow><mrow><msub><mi mathvariant="normal">ℓ</mi><mn>1</mn></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><msub><mi mathvariant="normal">ℓ</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∨</mo><msub><mi mathvariant="normal">ℓ</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><msub><mi mathvariant="normal">ℓ</mi><mi>k</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\ell_{1} \vee \cdots \vee \ell_{k} \quad m}{\ell_{1} \vee \cdots \vee \ell_{i-1} \vee \ell_{i+1} \vee \cdots \vee \ell_{k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2658em;vertical-align:-0.8943em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>全归结（Full resolution）</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><msub><mi mathvariant="normal">ℓ</mi><mn>1</mn></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><msub><mi mathvariant="normal">ℓ</mi><mi>k</mi></msub><mspace width="1em"/><msub><mi>m</mi><mn>1</mn></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><msub><mi>m</mi><mi>n</mi></msub></mrow><mrow><msub><mi mathvariant="normal">ℓ</mi><mn>1</mn></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><msub><mi mathvariant="normal">ℓ</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∨</mo><msub><mi mathvariant="normal">ℓ</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><msub><mi mathvariant="normal">ℓ</mi><mi>k</mi></msub><mo>∨</mo><msub><mi>m</mi><mn>1</mn></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><msub><mi>m</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∨</mo><msub><mi>m</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><msub><mi>m</mi><mi>n</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\ell_{1} \vee \cdots \vee \ell_{k} \quad m_{1} \vee \cdots \vee m_{n}}{\ell_{1} \vee \cdots \vee \ell_{i-1} \vee \ell_{i+1} \vee \cdots \vee \ell_{k} \vee m_{1} \vee \cdots \vee m_{j-1} \vee m_{j+1} \vee \cdots \vee m_{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3435em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">ℓ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\ell_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">m_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 是互补文字。</p><h3 id="合取范式（CNF）">合取范式（CNF）</h3><p>以子句的合取式表达的语句被称为合取范式或者 CNF， 合取式不易阅读，但其将成为归结过程的输入：</p><ul><li>消去等价词</li><li>消去蕴含次</li><li>否定词只出现在文字前边（而不是括号前面）</li></ul><h3 id="归结算法">归结算法</h3><p>为了证明 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>B</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">KB |= \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，需要证明 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>K</mi><mi>B</mi><mo>∧</mo><mi mathvariant="normal">¬</mi><mi>α</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(KB \wedge \neg\alpha)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span>是不可满足的，通过推倒矛盾来证明。</p><ul><li>先将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>K</mi><mi>B</mi><mo>∧</mo><mi mathvariant="normal">¬</mi><mi>α</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(KB \wedge \neg\alpha)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span> 转化为 CNF。</li><li>对子句运用归结规则，产生新子句，如果其尚未出现过，则将其加入子句集，直到：<ul><li>没有可以添加的新语句。</li><li>两个子句归结出空子句，等价于 False。（函数返回 True）</li></ul></li></ul><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-logic/pl-resolution.png" class=""></div><blockquote><p><strong>基本归结定理</strong>：如果子句集是不可满足的，那么这些子句的归结闭包包含空子句。</p></blockquote><h3 id="Forward-or-Backward-chaining">Forward or Backward chaining</h3><p>前向链接 Forward Chaining：</p><ul><li>判断单个命题词是否被限定子句的知识库所蕴含。</li><li>这个算法运行的时间是线性的。</li><li>data-driven</li></ul><p>反向链接 Backward Chaining：</p><ul><li>从查询开始进行推理，如果查询为真则停止，否则，从知识库寻找以 q 为结论的蕴含式，如果前提都为真，则为真。</li><li>这个算法运行的时间也是线性的。</li><li>goal-driven</li></ul><h3 id="DPLL-Algorithm">DPLL Algorithm</h3><ul><li>Check the satisfiablity of a sentence in propositional logic.</li><li>类似 backtracking 但是运用了很多启发式的技术，例如早停、纯符号启发式、单元子句启发式等。</li></ul><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-logic/DPLL.png" class=""></div><h1>一阶逻辑 First Order Logic（FOL）</h1><p>可以作为 Propositional Logic 的替代。（命题逻辑表达能力很弱。）</p><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-logic/FOL.png" class=""></div><h1>总结 Summary</h1><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-logic/summary.png" class=""></div>]]></content>
    
    
    <categories>
      
      <category>Artificial Intelligence</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI</tag>
      
      <tag>logic</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>国际经济形势与中美关系</title>
    <link href="/economy-finance/seminar-talks/china-us-relationship/"/>
    <url>/economy-finance/seminar-talks/china-us-relationship/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>翟东升 2021-10-28 于海南讲座。</p><span id="more"></span> <p>本次讲座涉及四个 Topic。</p><h2 id="1-疫情冲击何时结束">1. 疫情冲击何时结束</h2><ul><li>疫情传播似乎更加普及，但是疫苗的使用下，死亡率重症率下降。</li><li>11月8日开始世界大国开始放开人员往来。</li><li>中国可能在较长一段时间保持是否开门的难题。</li><li>由于疫情，东亚供应链可能重新收缩为中国供应链，一部分产能试图回中国，但是目前看来我们也不愿意接受。</li></ul><h2 id="2-美联储是否有能力加息缩表">2. 美联储是否有能力加息缩表</h2><ul><li>美国当前通胀率很高。</li><li>70年代中后期，婴儿潮，美国通胀率也高。美国政府主要挑战就是国内控制通胀。控制通胀的目的是来打击国内左翼激进工会势力。</li><li>长周期十年国债收益率大方向可以测，由人口结构预测。</li><li>以前08年也大量印钞票但没有使通胀大幅上升，因为钱没有进老百姓口袋。</li><li>这次疫情很多资金直接进入了老百姓口袋，零售急速上升，供给跟不上，直接导致通胀。</li><li>美国上升，其他地方也会上升，我们也会，只是暂时还没传导到下游消费。</li><li>每天嚷嚷的缩表只是象征性的，不断印钱才是常态。</li><li>主流流氓国家国债总量指数上升（尽管美国有扩有缩）。</li><li>央行独立性不能迷信。</li><li><strong>明年一月份，美联储大概率换人，鲍威尔不连任</strong><ul><li>未来两个月加息缩表会比较严重</li><li>但是明年二月开始政策会继续宽松，原因因为疫情还不是个头</li></ul></li></ul><h2 id="3-中美关系未来走向">3. 中美关系未来走向</h2><ul><li>目前是暴跌之后的小反弹，可能四年。<ul><li>高盛前总裁桑顿去新疆参观。</li><li>戴琦说不脱钩，要重新挂钩，务实坦率。</li></ul></li><li>中国应对美国策略，合作进化，tit for tat新型大国关系。</li><li>中美安全领域互信重建困难。</li><li>近期拜登对华态度软化（背景是拜登上台七个月民意死亡交叉）<ul><li>过去四年一群成人哄老小孩玩，现在一个老头带大家玩</li><li>现在拜登懂政治且固执，手段足够，且拜登中期选举必输。</li></ul></li><li>目前美国政治形式拜登参议院50+1对50，众议院民主党领先8票。<ul><li>中期选举众议院执政党一定会丢掉一些票，平均丢27.5，众议员管钱，丢掉众议院意味着大规模财政开支基建计划全部完蛋。</li><li>大概率参议院众议院全丢，所以真正有效执政只有是前两年。</li><li>拜登意识到这一点已经放弃连任幻想，按照自己的想法实施，需要立自己的历史遗产。</li></ul></li><li>三年机会之窗，新型大国关系，平等不冲突<ul><li>现在中国也硬了，现在有机会窗口</li><li>民主党2024可能出大事，共和党重来，中美关系暴跌</li></ul></li></ul><h2 id="4-海南自贸港建设的前瞻和思考">4. 海南自贸港建设的前瞻和思考</h2><ul><li>冻结的人与人交流即将放开，海南可以争取放开的优先权，外国人进入中国的缓冲通道。</li><li>争取建立多个领馆。</li><li>高端服务业来海南。</li><li>推进金融开放。</li><li>吃海外人员回流福利。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
    <tags>
      
      <tag>翟东升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>距离矩阵</title>
    <link href="/machine-learning/distance-matrix/"/>
    <url>/machine-learning/distance-matrix/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>在看 k-center 的时候发现自己对其距离矩阵的计算不是很清楚，于是在此记录。</p><span id="more"></span><h2 id="距离矩阵的计算及-Python-实现">距离矩阵的计算及 Python 实现</h2><p>给定 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">X = [x_1, x_2,...,x_n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>，这里第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 列向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 维向量，任务是计算出一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 矩阵，使得：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">D_{ij}=||x_i-x_j||^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1002em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>。</p><p>具体的，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mi>j</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mn>2</mn><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>j</mi></msub><mo>+</mo><msubsup><mi>x</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">D_{ij} = (x_i - x_j)^T(x_i-x_j)=x^T_ix_i-2x^T_ix_j+x^T_jx_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1274em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1274em;vertical-align:-0.2861em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2361em;vertical-align:-0.3948em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。</p><p>用 Gram Matrix 表示，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>G</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>−</mo><mn>2</mn><msub><mi>G</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>G</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{ij}=G_{ii}-2G_{ij}+G_{jj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ii</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">jj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。</p><p>放在矩阵的尺度来看，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mi>H</mi><mo>+</mo><mi>K</mi><mo>−</mo><mn>2</mn><mi>G</mi></mrow><annotation encoding="application/x-tex">D = H + K -2G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">2</span><span class="mord mathnormal">G</span></span></span></span>。其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>G</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo separator="true">,</mo><msub><mi>K</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>G</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_{ij} = G_{ii}, K_{ij} = G_{jj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ii</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">jj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。</p><p>根据最后一个式子，计算的时候可以避免循环：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_dist_matrix</span>(<span class="hljs-params">X</span>):<br>  m,n = X.shape<br>  G = np.dot(X.T, X)<br>  H = np.tile(np.diag(G), (n, <span class="hljs-number">1</span>)) <span class="hljs-comment"># Construct an array by repeating the number of times.</span><br>  <span class="hljs-keyword">return</span> H + H.T - <span class="hljs-number">2</span>*G<br></code></pre></td></tr></table></figure><p>Reference:</p><ul><li><a href="https://zhuanlan.zhihu.com/p/21341296">斯坦福CS231N课程笔记（三）-距离矩阵的计算方法</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>原则读书笔记</title>
    <link href="/reading-note/principles/"/>
    <url>/reading-note/principles/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>《原则》  Ray Dalio</p><span id="more"></span><h2 id="极简简介">极简简介</h2><p>桥水基金创始人 Ray Dalio 在本书中向我们介绍了其多年的人生经历，并由此引出他的主要观点----原则的建立和使用。书中极其详细的分条陈述了 Ray 的生活原则和工作原则。在展示原则之外，Ray 希望本书促使读者以最合适的方式发现改进反思自己的原则，这将有助于做出更好的决定，并让别人更好理解你。</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>这本书断断续续看了一个多月吧。是冲着 Ray 的名气买的，读完之后确实受用。受限于目前的阅历和社会分工，其实很多要点暂时还离我比较遥远，以后一定是会重读此书的。</p><ol><li>个人觉得这本书最厉害的一点不是给我们展现 Ray 的厉害的原则，而是在对他的原则进行阐述和解释过程中，教导我们原则的重要性以及如何构建自己的原则，这是最有价值的地方。</li><li>这本书更像是一本人生说明书或者指导手册，以一本工具书的形式，提出了大道理，也提出了很多解决方案。</li><li>我认为处于社会不同位置的人都能从此书中学到不少东西。首先是作为一个“自然人”对自己的管理，要用原则规范提升自己。其次是作为一个“社会人”在工作岗位中作为管理者或者被管理者，如何基于原则高效的沟通和行动。</li><li>本书也在很多阐述的地方不经意的提起一些很常见的思维误区，有利于大家反思自己的思维方式。</li><li>这本书不仅是 Ray 的人生准则，其实也包含很多他相信的“道理”，需要批判看待。</li></ol><h3 id="自己的感想">自己的感想</h3><ol><li>原则构建<ol><li>要清楚的知道自己的原则。</li><li>清楚原则还不够，需要“知行合一”。如果存在矛盾，则需要记录，并改进原则。</li></ol></li><li>个人成长<ol><li>使自己“可信”，首先要把事情做成功。</li><li>不固执己见，客观看待自己以及其他人，否则会一次次的栽在自己或其他人的弱点上。</li><li>历史在不停地重现，只是可能不重现在你的身上。性价比高的做法是从他人身上学习，这就需要头脑开放。</li></ol></li><li>对待问题<ol><li>对问题准确的定义十分重要。</li><li>不能容忍问题，否则前功尽弃。</li><li>在团队工作中，Ray 有一个非常好的诊断问题的流程值得学习。包括但不限于问题是哪来的，有多严重，谁该负责，如何改进，甚至包括对问题的诊断应该进行到什么程度。我觉得这一部分其实可以单独写一篇博客来学习一下。</li></ol></li><li>团队管理<ol><li>在团队管理中，很需要对成员开放式思考进行构建。</li><li>分清建议和批评的区别。</li></ol></li></ol><h3 id="有趣的发现">有趣的发现</h3><ol><li>历史真的是在不断重复。<ul><li>例如1982年墨西哥违约，债务危机，美联储增加货币供给，美国大通胀。但是经济没有崩溃，通胀率下降同时经济增长加速。这是因为资金撤出借债国，回流美国，美元升值，通缩压力。所以美联储可以在不加剧通胀的情况下降息。（我指的是资金回流美国这一点重复，例如2020新冠疫情。）</li></ul></li><li>Ray对王岐山有着极高的评价，两人似乎很熟，有空可以八卦一下。</li></ol><hr><h1>Ray 的原则</h1><h3 id="导言">导言</h3><ol><li>独立思考并决定：你想要什么？事实是什么？面对事实，你如何实现自己的愿望？请保持谦逊和心胸开阔，以便你能动用自己的最佳思维。</li><li>以可信度加权的方式做决定。</li><li>遵照原则做事。</li><li>以系统化的方式来做决策。考察影响你的那些事物的规律，从而理解其背后的因果关系，并学习有效应对这些事务的原则。</li></ol><h3 id="生活原则">生活原则</h3><p>此处仅记录一些相对较大的条目：</p><ul><li><strong>拥抱现实，应对现实：</strong>做一个超级现实的人；真相（对现实的准确理解）是任何良好结果的根本依据；做到头脑极度开放、极度透明；观察自然，学习现实规律；进化是生命最大的成就和回报；理解自然提供的现实教训；痛苦+反思=进步；考虑后续与再后续的结果；接受结果；从更高的层次俯视机器。</li><li><strong>用五步流程实现你的人生愿望：</strong>有明确的目标；找出问题，并且不容忍问题；诊断问题，找到问题的根源；规划方案；坚定的从头至尾执行方案；谨记：如果你找到了解决方案，弱点是不重要的；理解你和其他人的“意境地图”与谦逊性。</li><li><strong>做到头脑极度开放：</strong>理解你的两大障碍；奉行头脑极度开放；领会并感激：深思熟虑的意见分歧；和可信的、愿意表达分歧的人一起审视你的观点；识别你应当注意的头脑封闭和头脑开放的不同迹象；理解你如何做到头脑极度开放。</li><li><strong>理解人与人大不相同：</strong>明白你与其他人的思维方式能带来的力量；有意义的工作和有意义的人际关系不仅是我们做出的美好选择，而且是我们天生的生理需求；理解大脑里的主要斗争，以及如何控制这些斗争；认识自己和他人的特性；无论你要实现什么目标，让合适的人各司其职以支持你的目标是成功的关键。</li><li><strong>学习如何有效决策：</strong>要认识到：影响好决策的最大威胁是有害的情绪；决策是一个先了解后决定的两步流程；综合分析眼前的形势；综合分析变化中的形势；高效地综合考虑各个层次；综合分析现实、理解如何行动的最好工具是逻辑、理性和常识；根据预期价值计算做决策；比较更多信息带来的价值和不做决定造成的成本，决定优先顺序；简化；使用原则；对你的决策进行可信度加权；把你的原则转换成算法，让计算机和你一起决策；在深刻理解人工智能之前不要过度信赖它。</li></ul><hr><h1>按节讨论/摘录</h1><p>以下是大篇幅的摘抄，取自文章中的三个大章节。不能保证重要信息全记录。摘抄的原因是看到这些话的时候有一星半点的赞同或感触。此处的摘录比较糙，以后有空重读的话可以精炼消化一下。</p><h3 id="1-我的历程">1. 我的历程</h3><ul><li>不管我一生中取得了多大的成功，其主要原因都不是我知道多少事情，而是我知道在无知的情况下自己应该怎么做。</li><li>不幸的是，大多数的人并不能清楚地解释他们的原则。</li><li>尽管使用他人的原则不一定是一件坏事，但不假思索地采用他人的原则有可能将你置于风险之中。</li><li>“正确的失败”：痛苦的失败中获得教训。“错误的失败”：因为失败而被踢出局。</li><li>当政府决策者向你承诺他们不会允许货币贬值发生时，不要相信他们。</li><li>拥有有意义的工作和人际关系要比赚钱好得多。有意义的工作是一项我能全身心投入的使命；有意义的人际关系是指我既深深的关心对方，对方也深深的关心我。</li><li>把赚钱作为你的目标是没有意义的，因为金钱并没有固定的价值，金钱的价值来自他能买到的东西，但是金钱并不能买到一切。</li><li>要一个孩子是我迄今做过的最艰难的决定，因为当时的我显然不知道养孩子将是一种个什么样的经历，而且这个决定是不可撤回的。但事实证明这是我做出的最好的决定。</li><li>每当出现收益率曲线倒挂，对冲通胀的资产价格都会下跌，经济下滑。</li><li>以一国货币计价的债务，可以在该国政府的帮助下成功重组，而且在各国央行同时提供刺激时，通胀和通缩能够互相对冲。</li><li>我学到了一种很好的恐惧犯错的意识，这把我的思维定式从认为“我是对的”变成了问自己“我怎么知道我是对的”。</li><li>使人们相互对立的观点公开化，并对其进行分析，让我对人们的思考方式有了更多的了解。通常我们遵循我们的自然秉性做事时，考虑不到自身的弱点，走向失败，成功的人改变他们的做法，使他们能够继续利用优势，并弥补自身的不足，而不成功的人则不会这样做。</li><li>只有当你能承认甚至接受自身弱点是，你才能做出对自身有益的改变。</li><li>面对你都需要胆识看起来相互矛盾的东西时，耐心地做出选择。</li><li>“靠水晶球谋生的人注定要吃碎在地上的玻璃”：最重要的事不是预知未来，而是知道在每一个时间点上如何针对可获得的信息做出合理的回应。</li><li>确立一个“风险中性”的基准仓位，在进行慎重的冒险时偏离这个仓位。</li><li>我从来不愿仅仅因为投资产品会买的好就去设计他们，尤其是常规投资产品，我想要的只是进行市场交易，建立人际关系，设身处地地为我们的客户服务。</li><li>成熟意味着你可以放弃一些好的选择，从而追求更好的选择。</li><li>所有了不起的投资者和投资策略都是有弱点的，在弱点呈现时就对其失去信心是一种常见的错误，就像在其有效时对其过于迷恋一样。</li><li>拥有吧事情探究明白的能力，要比拥有某件事的具体知识更重要。</li><li>追求商业卓越和追求个人价值的实现，不一定是相互排斥的，而是可以相辅相成的。</li><li>一个管理者能够实现的最大成功就是能够阻止他人在没有你的情况下把事情做好。次好的情况是你自己能把事情做好。最糟糕的事连你自己都做不好。</li><li>我问他在火箭学方面有没有背景，他说没有。“我刚开始读这方面的书。”他说。这就是塑造者典型的思考和行为模式。</li><li>王岐山：“有能力的人居安思危。安然无忧的是愚人。假如冲突能在变得尖锐之前被解决的话，世界上就不会有英雄了。”</li><li>当我就权力制衡这个问题询问他时，他以尤里乌斯·凯撒推翻罗马元老院和共和国为例，说明确保任何人的权利都不能凌驾于制度之上是多么重要。</li><li>发现自己的性格，过与性格相适应的生活，才是最幸福的。</li></ul><h3 id="2-人生原则章节">2. 人生原则章节</h3><ul><li>创造伟大事物的人不是空想者，而是彻底地扎根于现实。</li><li>不要固守你对事物“应该”是什么样的看法，这将使你无法了解真实的情况。</li><li>通过快速试错以适应现实是无价的。</li><li>你的未来取决于你的视角。你在一生中取得什么样的成就，取决于你如何看待事物，以及你关心什么人、什么东西（你的家庭、社区、国家、人类、整个生态系统）。</li><li>没有痛苦就没有收获。</li><li>大多数人在痛苦时不愿反思，而一旦痛苦消失他们的注意力就会转移，所以他们难以通过反思得到教益。</li><li>不管在生活中遇到什么情况，如果你能负起责任，进行良好的决策，而不是抱怨你无法控制的东西，你将更有可能成功并找到幸福。</li><li>对人来说，最难做的事情之一是客观地在自身所处环境（即机器）中看待自身，从而成为机器的设计者和管理者。</li><li>大部分人犯下的最大错误是不客观看待自己以及其他人，这导致他们一次次的栽在自己或其他人的弱点上。</li><li>在你不擅长的领域请教擅长的其他人，这是一个你无论如何都应该培养的出色技能，这将帮你建立安全护栏，避免自己做错事。</li><li>不要混淆你的愿望和事实。</li><li>不要为自身形象而担心，只需要关心能不能实现你的目标。</li><li>不要把不好的结果归咎于任何人，从自己身上找原因。</li><li>5个步骤：目标、问题、诊断、方案、践行。你要成功就必须做好每一步，而且按照顺序一步一步来。这个过程是层层递进的：认真做好每一步，你将获得必须的信息，以便进行到下一步并将其做好。</li><li>你只需要知道什么时候需要这些技能，你能从哪里学到这些技能。</li><li>尽管你几乎可以得到你想要的任何东西，但不可能得到你想要的所有东西。</li><li>不要混淆目标和欲望（不要拿欲望当目标）。</li><li>不要把成功的装饰误认为成功本身。</li><li>在逆境中，你的目标应该是守住自己的成绩，尽量减少损失，或者直面不可挽回的损失。</li><li>承认弱点并不是像弱点投降，而是克服弱点的第一步。</li><li>要精准的找到问题所在。如果问题的原因是某种固有的弱点，你也许需要寻求他人的帮助，或者改变你扮演的角色。</li><li>不要把问题的某个原因误认为问题本身。</li><li>容忍问题和找不到问题一样。只要你没有战胜问题的意志，你就处于毫无希望的境地。你必须养成一种对任何性质的恶习都绝不容忍的习惯，无论其是重是轻</li><li>把你的方案写下来，让所有人都能看到，并对照方案执行。</li><li>建立清晰的衡量评估标准来确保你在严格执行方案。理想的做法是让其他人客观评估并报告你的进度。</li><li>每个人都至少有一个最大的弱点阻碍其成功，找到你的这个弱点并处理它。</li><li>成功有两条路：（1）自己拥有成功所需的要素，（2）从其他人那里得到成功所需的要素。</li><li>要有效行事，你就绝不能允许“想要自己正确”的需求压倒“找出真相”的需求。</li><li>很自然，人们无法理解自己看不到的东西。</li><li>当你住处某个人的心里弱点时，对方的反应通常像你指出他的身体缺陷一样感到不舒服。</li><li>出现意见分歧的各方通常始终坚信自己是对的，而且往往以彼此发怒而告终。</li><li>亚里士多德把悲剧定义为：人的致命缺陷导致的可怕结果。在我看来，自我意识和思维盲点这两大障碍就是人的致命缺陷。</li><li>听听其他人的观点并加以考虑，绝不会削弱你独立思考、自主决策的自由，只会让你在决策时有更宽广的视角。</li><li>要做到头脑开放，你必须高度接受自己错了的可能性，可以鼓励其他人告诉你错在哪里。</li><li>谨记，你是在寻找最好的答案，而不是你自己能得出的最好的答案。最好的答案不一定是你想出来的。</li><li>我定义的“可信”的人有两个特征：曾反复的在相关领域成功找到答案（三次），在被问责的情况下能对自己的观点做出很好的解释。</li><li>当两个人的观点截然相反时，很有可能一个人是错的。搞明白是不是你错了，对你有好处。深思熟虑的意见分歧中，你的目标并不是让对方相信你是对的，而是弄明白谁是对的，并决定应该怎么做。</li><li>你应该考虑和思索各种互相冲突的可能性，也应根据了解到的情况，随时迅速地调整自己的想法，接受可能正确的东西。一种检验你做的好不好的方式是，把和你有分歧的人的观点，向对方复述一遍，瑞过他觉得你服输的对，就说明你做的很好。</li><li>很多人都会和你产生分歧，但你不应该考虑所有人的观点。跟任何人都头脑开放不一定有好处，你应该花时间和你能找到的最可信的人探讨观点。</li><li>头脑封闭的人<ul><li>不喜欢看到自己的观点被挑战。他们通常会因无法说服对方而沮丧，而不是好奇对方为什么看法不同。</li><li>喜欢做陈述而不是提问</li><li>更关心是否被理解，而不是理解其他人</li><li>经常说“我可能错了，但这是我的观点”，暗示自己是开明的</li><li>阻挠他人发言</li><li>难以同时持有两种想法，使自己的观点独大</li><li>缺乏深刻的谦逊意识</li></ul></li><li>头脑开放的人<ul><li>更想了解为什么会出现分歧</li><li>真诚地相信自己可能是错的，提出真诚的问题</li><li>经常觉得有必要从对方的视角看待事物</li><li>知道何时做陈述，何时提问</li><li>喜欢倾听而不是发言，鼓励其他人表达观点</li><li>考虑其他人观点的同时保留自己深入思考的能力</li><li>时刻在心底担忧自己是错的</li></ul></li><li>假如你是一个头脑封闭的人，又在自己有盲点的领域形成了一种观点，结果可能是致命的。</li><li>重视证据，并鼓励其他人也这么做。</li><li>知道什么时候应当停止为自己的观点辩护，信任自己的决策程序。</li><li>如果你不了解人（包括你自己）的特性就对他们抱有期待，你肯定会遇到麻烦。</li><li>当我的潜意识给我想法和提示时，我不是马上按照其行动，而是先用我的理性意识去分析他们。</li><li>你能做的最重要的决定之一是决定问谁。</li><li>不要听到什么信什么，要区分事实和观点。</li><li>所有东西都是放在眼前看更大，所以你应该跳出去以看到全局，有时候可以过一段时间再做决定。</li><li>“当你问一个东西对不对而对方告诉你并不完全对时，那它大致是对的。”</li><li>不要做完美主义者。完美主义者花太多时间关注边缘性的微小因素，影响对重大因素的考虑。</li><li>用“基线以上”和“基线以下”来确定谈话位于哪一层。当一段分析混乱，令人迷惑时，通常是因为谈话者限于基线以下的细节之中，而没有重新把细节与要点联系起来。</li><li>知道什么之后不要去押注，和知道什么注值得押同样重要。</li><li>先把你的“必做之事”做完，再做你的“想做之事”。</li></ul><h2 id="3-工作原则章节">3. 工作原则章节</h2><ul><li>创意择优：1. 开诚布公的亮出你的观点。2. 针对分歧认真讨论。3. 遵循所形成的共识，消除过去的分歧。</li><li>为人要正直，也要求他人保持正直</li><li>若不想当面议论别人，背地里也不要说，要批评别人就当方面指出来。</li><li>大多数人做工作都希望出最少的里而赚尽可能多的钱。</li><li>学校里学习最好的学生可能往往是那些最不善于从错误里学习的人，因为他们已经习惯把做错题当成失败的代名词，而不是把犯错看成学习的机会。</li><li>不要纠结于一时的成败，要放眼于达成目标。不要纠结于“埋怨”还是“赞美”，而要专注于“准确”还是“不准确”。</li><li>没有人能客观的看待自己。</li><li>问题一般源自两个主要原因：简单的误解和根本上存在分歧。求取同步就是以开放而自信的心态修正双方立场的过程。</li><li>知道怎样求取共识和掌控分歧<ul><li>把可能的分歧摆到桌面上</li><li>区别苍白的抱怨和有助于改进工作的诉求</li><li>要记住每个故事都有另一面</li></ul></li><li>保持开放的心态，同时也要坚定果断<ul><li>区别心态开放和封闭的人</li><li>远离心态封闭的人，不管他们知道多少，心态封闭的人都会浪费你的世界。如果你必须与他们打交道，要注意除非他们变得开明，否则无任何裨益。</li><li>提防那些羞于承认自己无所不知的人。他们可能更关注外在形象，而不是达成目标。</li><li>确保工作负责人以开放的心态对待问题和他人的意见。</li><li>意识到求取共识是双向的责任。通常沟通困难在于人们的思维方式不一样。<ul><li>有一些简单的技巧会很有用，比如重复以便你刚听到的别人的观点，确保你理解正确。</li><li>假设你自己或者是没有沟通好，或是没听清，为不实先去责怪对方。要吸收自己沟通不理的教训，避免再犯。</li></ul></li><li>实质重于形式：问题重于沟通方式。</li><li>自己要通情达理，也期待别人通情达理。</li><li>其建议、提问题与批评是不一样的，别混淆<ul><li>提建议并未下结论说有错误，只是想确保考虑了风险，有没有疏忽（并不是真的忽略）</li><li>有人把建设性问题当成职责，反弹强烈，这是不对的。</li></ul></li></ul></li><li>如果由你主持会议，应把握好会话<ul><li>明确主持人和会议的服务对象，如果没有明确的主持人，可能会陷入丧失方向和低效的境地。</li><li>表达清晰，以免造成困惑。</li><li>根据目标和优先次序决定采用什么样的沟通方式。</li><li>谨防“跑题”，列出议程让大家看到进展。</li><li>坚持对话的逻辑性。</li><li>不要因集体决策而丧失个人责任。对个人职责的分派要十分明确。</li><li>你必须让人用两分钟不受打扰地解释自己观点，再插话表达自己意见。</li><li>当心讲起话来不容置疑的“快嘴王”，你的责任是讲清楚事情，有一点没讲清楚都不要继续往下降。作为主持人可以说“抱歉我比较迟钝，希望你慢点说”</li><li>让对话慎始善终，进行总结，结束讨论。同时，人们不必对任何事情都意见一致。</li><li>运用沟通手段，分出优先次序。</li></ul></li><li>3-5人的效率高于20人。边际效益递减。</li><li>珍惜志同道合者，既然有人在你最重要的方面价值观相同，也与你有实践价值观的相同做法，就要确保与这些人为伍。</li><li>如果你发现自己无法调和相互间的主要分歧—尤其是价值观层面的—要考虑是否值得维持这种关系。</li><li>最佳决策应该是创意择优中按观点的可信度高低得出来的。有可信度的观点来自多次成功解决了相关问题的人，能够有逻辑地解释结论背后因果关系的人。</li><li>如果你自己无法成功完成某件事，就不要想着知道别人如何完成。</li><li>关注可信度最高，与你观点不一致的人，尽量理解其推理过程。<ul><li>若某人并无经验，但是所讲道理符合逻辑且可以经受压力测试，一定要试一试。</li><li>关注推理过程而非结论。</li><li>没经验的人也不乏好点子，不会限制在过去的套路。</li></ul></li><li>考虑你要扮演老师、学生、同事中的哪个角色？说教、提问还是辩论？<ul><li>学生理解老师比老师理解学生更重要。</li></ul></li><li>要了解人们提出意见的过程和逻辑<ul><li>要仔细考虑向谁提问，问可信度强，准备好的人。如果自己可信度不强，不要分享自己的观点。</li><li>让每个人都可以肆意评论其他人的观点，此举低效且浪费时间。</li><li>梳理员工工作记录。</li></ul></li><li>每个人都有权利和义务去设法了解重要的事情。</li><li>要关注决策机制是否公允，而非是否如你自己所愿。</li><li>相互达成协议时不能忽略原则。</li><li>不要吧发牢骚、提建议、公开辩论的权力与决策权混淆</li><li>不要对重大分歧不闻不问<ul><li>别被小事烦扰</li><li>不要被分歧束缚：提交上级、或者投票</li></ul></li><li>一旦做出决定，所有人必须服从，即便有不同意见。</li><li>在一家健康的机构中，应该是员工与低层次的自我进行竞争，而不是员工与员工互相竞争。</li><li>你最重要的决策是选好工作的责任人<ul><li>最重要的责任人是在高层负责订立目标、规划成果和组织实施的人</li><li>负最终责任的人应是对行为后果承担责任的人。</li><li>确保每个人都有上级领导，要有人对他问责。</li></ul></li><li>学习成绩不能充分证明这个人是否具备你想要的价值观和能力<ul><li>评估常识、眼界、创造力、决事能力，学习成绩价值有限。</li></ul></li><li>警惕不切实际的理想主义者</li><li>考虑薪酬时，要提供稳定性，也要让人看到机会<ul><li>依人发薪，而不是依工作岗位发薪</li><li>想着把蛋糕做大，而不是给自己把蛋糕切大。</li></ul></li><li>准确评价人，不做好好先生。</li><li>对人的观察不要讳莫如深。开诚布公的考察他们。</li><li>评估人时，你可能犯的两个最大错误是：对自己的评估过于自信，无法取得共识。</li><li>换岗是为了人尽其才，有利于整个团队。</li><li>不断把结果和你的目标进行对照。制定量化评价工具。</li><li>应对每个问题的手段都要服务于两种目的：让你与目标更为接近，能够对机器进行培训和测试。</li><li>如果出现问题，要在两个层面进行讨论：机器层面为什么，案例层面怎么办。</li><li>管理者必须确保自己负责的领域运转有效。他可以通过以下方式：把员工管理好；或者下沉去做本不该自己做但下属做不好的工作；把管理不好的领域提交给上级管理。</li><li>出售管理者的标志是他不必亲自做任何事。管理者应视自己陷入细枝末节为不良信号。</li><li>了解员工及其工作的动力，因为人是你最重要的资源。</li><li>明确职责。记住谁付什么责任，防止角色错位。如果问题出乎你的意料，可能是因为你远离了你的下属和工作流程或者你对下属和留存可能导致的不同后果缺乏足够认识。</li><li>让问责过程透明，而非私下问责。同时欢迎别人问着你，因为没有人能客观看待自己。</li><li>像公司的拥有者那样思考，要求你的同事也这样做。</li><li>不要担心你的员工是不是喜欢你，不要让他们告诉你如何做事，你要操心的是尽可能的做出最佳决策，因为不管你做什么很多人都会说你做得不对。</li><li>不要发号施令让别人服从你，要努力为人所理解，并理解他人，以达成共识。</li><li>当心那些混淆目标和任务的人，因为如果他们分不清楚就不能信任他们并给他们委派职责。</li><li>在无法充分完成时，这时将问题提交给上级解决，把问题提交给上级并不意味着失败而是一种责任。</li><li>在分析问题时要非常具体不要泛泛而谈，不要用我们他们这种不指名道姓的说法，掩盖个人责任。每个人都必须有一位有可信度的热情，高标准的人来监督。</li><li>每个人都必须有一位有可信度的，奉行高标准的人来监督。</li><li>不要仅盯着你自己的工作，还要关注如果你不在场工作会如何展开？</li><li>如果某些职位不是全职的，且需要高度专业化的知识，我宁愿交给顾问或者外部人。</li><li>描绘一幅金字塔形的组织架构，图任何两条有塔顶向下连接塔底的线不应产生交叉。遇到跨部门或附属部门的问题是让金字塔交汇点上的人处理。</li><li>保持适当的监控让谎言没有可乘之机。</li><li>要不断思考如何产生以小搏大的杠杆效应，我一般在工作中运用50:1的杠杆，意思是说，每当我用一个小时与下属讨论工作，他们都要花大约50个小时的推进相关项目。</li><li>几乎做每件事所花费的时间和资金都比你预期的要多。</li><li>给人员分配任务是最好把各项任务记在检查清单上。完成的任务划掉，这可以做任务的提醒也可以做任务的确认，但是每个人不是只是完成在检查清单上的任务。</li><li>为了促进真正的行为改变，必须内化学习或养成习惯。</li><li>把原则阐述清楚，运用各种工具和行为准则来推进实施，形成信任公平的氛围，使任何结论都可以通过跟踪其背后的逻辑和数据来加以评估。</li><li>为了取得成功，所有机构都必须建立制衡机制。要确保公司里没有任何人比体系更强大，也没有任何人重要到不可替代。</li><li>在所有决策方法中，构建创意择优是最佳的方法。让创意择优发挥作用，人们需要做三件事：坦承自己最诚实的想法；让大家公开讨论理性的表达分歧，以便大家进行高质量的辩论，拓展思路，尽量形成最优的集体决策；用创意择优来处理所有不同意见。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ray-Dalio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>约束满足问题（CSPs）</title>
    <link href="/artificial-intelligence/ai-csp/"/>
    <url>/artificial-intelligence/ai-csp/</url>
    
    <content type="html"><![CDATA[<p>人工智能中的约束满足问题（Constraint Satisfaction Problems 问题）学习笔记。</p><span id="more"></span><h1>约束满足问题</h1><p>约束满足问题的目标是在一定的约束下，寻找符合条件的状态。这种问题在生活中比较常见，以大学排课为例，已知教授的授课可以授课的时间，寻求满足所有教授时间的排课课程表。常见的一些约束满足问题有：</p><ul><li>八皇后问题</li><li>图着色问题</li><li>填字游戏</li><li>数独</li></ul><h2 id="问题定义">问题定义</h2><p>CSPs 包含以下三个要素：</p><ul><li>A set of variables（变量）, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>X</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">X=\{X_{1},\ldots ,X_{n}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></li><li>A set of domains （值域） for each variable: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>D</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>D</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">D=\{D_{1},\ldots ,D_{n}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></li><li>A set of constraints <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>C</mi><mi>m</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">C=\{C_{1},\ldots ,C_{m}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> （限制条件） that specify allowable combinations of values. Every constraint <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>j</mi></msub><mo>∈</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">C_{j}\in C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> is in turn a pair <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><msub><mi>t</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>R</mi><mi>j</mi></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle t_{j},R_{j}\rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span></span></span></span> , where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub><mo>⊂</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">t_{j}\subset X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> is a subset of k variables and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">R_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> is a k-ary relation (among k variables) on the corresponding subset of domains <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">D_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>.</li></ul><p>问题的状态由对部分或者全部变量的定值（assignment）来确定：</p><ul><li>如果定值不违反任何的限制条件，我们说他是无矛盾的（consistent）</li><li>如果定值包含了所有的变数，我们说他是完备的（complete）</li><li>如果定值是无矛盾的且完备的，我们说这个定值是一个解（solution），这样的定值就是 CSP 的解。</li></ul><p>一个图着色问题的例子：</p><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-csp/map-color.png" class=""></div><p>一个八皇后问题的例子：</p><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-csp/eight-queen.png" class=""></div><p>一般来说 CSPs 使用的都是绝对约束，如果是非绝对的约束（偏好性），这样的问题称为约束优化问题（COP），在此不做讨论。</p><h1>求解 CSPs</h1><h2 id="CSPs-形式化的优点">CSPs 形式化的优点</h2><ol><li>快速消减庞大的搜索空间</li><li>发现某部分不是解迅速丢弃，直观看到哪一部分变量赋值违反约束。</li><li>CSP 具有可交换性（commutative）</li></ol><h2 id="CSPs-中的局部相容性（consistency）">CSPs 中的局部相容性（consistency）</h2><p>在 CSPs 中，算法可以<strong>搜索</strong>，也可以做一种称作约束传播的<strong>推理</strong>。推理的目的是用约束减小一个变量的合法取值范围。可以把推理作为搜索前的预处理步骤。核心思想是增强局部相容性，使不相容的结点取值被删除。</p><ul><li>节点相容（Node-consistency）：来自节点本身的一元约束</li><li>弧相容（Arc-consistency）：某变量所有取值满足该变量所有的二元约束。<ul><li>最流行的算法是 AC-3，维护一个弧相容队列。<ul><li>从队列弹出一条弧，使其一个节点弧相容，如果其值域无变化，则处理下一条弧。</li><li>如果其值域发生变化，那么每个指向这个节点的弧必须重新插入队列准备检验。</li></ul></li></ul></li><li>路径相容（Path-consistency）：通过观察变量得到隐式约束并以此来加强二元约束。<ul><li>比如说有三个连接节点，却只有两种颜色。</li><li>所有的 n-ary 约束都可以转换为 binary 约束。</li></ul></li></ul><h2 id="具体解法：回溯搜索">具体解法：回溯搜索</h2><p>仍然使用搜索来求解，一般来说使用 Backtracking Search（BTS）回溯搜索。用于深度优先之中，每次为一个变量选择一个赋值，当没有合法的值时就回溯。由于可交换性，我们只用搜索组合而不是排列，所以叶节点个数至多为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">d^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>个（不回溯的情况）。</p><p>在回溯搜索中，也需要考虑如下问题来对搜索进行改进：</p><ul><li>下一步给哪个变量赋值？对于所选变量，选用怎样的赋值顺序？</li><li>每步搜索应该进行怎样的推理？是否能预见失败？</li><li>当我们搜索到某赋值违反约束时，搜索本身能避免重复这样的失败吗？</li></ul><h3 id="1-下一步给哪个变量赋值？对于所选变量，选用怎样的赋值顺序？">1. 下一步给哪个变量赋值？对于所选变量，选用怎样的赋值顺序？</h3><p>选取变量：</p><ul><li>最少剩余值启发式 Minimum Remaining Value (MRV)，选择合法取值最少的变量赋值。这样通过早期有效剪枝有助于最小化节点数。</li><li>对于第一个节点而言，最小剩余值相同，应该选用度启发式，选择与其他未赋值变量约束最多的变量来试图降低未来的分支因子。</li></ul><p>选取赋值：</p><ul><li>最小约束值 Least Constraining Value (LCV)，试图为剩余变量赋值留下最大的空间。这里只需要找到一个解，所以优先考虑最可能的值。</li></ul><h3 id="2-每步搜索应该进行怎样的推理？是否能预见失败？">2. 每步搜索应该进行怎样的推理？是否能预见失败？</h3><p>搜索和推理应当交替进行。推理的目的是减小值域，减小搜索空间。当我们决定给某个变量某个值时，都有机会推理其邻接变量的值域空间。</p><ul><li>最简单的形式是向前检验 Forward Checking（FC）。跟踪维护所有为选取变量的可能取值，当任何一个变量没有合法取值时结束。联合使用 MRV 和前向检验，很多问题的搜索将更有效。但是前向检验只使当前变量弧相容，却不向前看使其他变量弧相容。</li><li>MAC 维护弧相容，递归传播约束。对一个变量赋值后，使用 AC-3，从临接的未赋值变量开始进行约束传播，如果值域为空，则调用失败立即回溯。</li></ul><h3 id="3-当我们搜索到某赋值违反约束时，搜索本身能避免重复这样的失败吗？">3. 当我们搜索到某赋值违反约束时，搜索本身能避免重复这样的失败吗？</h3><ul><li>简单的时序回溯。退回到上一个变量</li><li>冲突指导的回溯。退回到可能解决当前问题的变量（因为上一个变量可能无力于解决当前冲突）。构建一个冲突集，回溯到冲突集中时间最近的赋值。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Artificial Intelligence</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI</tag>
      
      <tag>search</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>对抗搜索问题和 Minimax 算法</title>
    <link href="/artificial-intelligence/ai-adversarial-search/"/>
    <url>/artificial-intelligence/ai-adversarial-search/</url>
    
    <content type="html"><![CDATA[<p>人工智能中的对抗搜索学习笔记。</p><span id="more"></span><h1>对抗搜索问题</h1><p>对抗搜索其实可以看作游戏场景，存在一个我们不能控制的对手。相比于搜索，我们不是要找一个值或一系列序列，而是要找一个策略（strategy/policy）来对对手的行为进行反馈。而游戏是人工智能中一个比较难的方向，它可以分为以下几类。</p><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-adversarial-search/game-types.png" class=""></div><h2 id="正式化-Formalization">正式化 Formalization</h2><p>将对抗搜索的问题抽象化，正式化，我们会得到以下要素：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>: state, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>∈</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">s \in S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>∈</mo><mi>P</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p \in P(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span>, defines which <strong>player</strong> has the move in state <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>. Usually taking turns.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>: <strong>action</strong>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>∈</mo><mi>A</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a \in A(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span>, returns the set of legal moves in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>×</mo><mi>A</mi><mo>→</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">S \times A \rightarrow S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>, <strong>transition function</strong>, defines the result of a move.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">u(s,p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>: <strong>utility function</strong> or objective function for a game that ends in terminal state s for player p. It describes the earning at the end of the game.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>:</mo><mi>S</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\pi(s): S  \rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>, <strong>strategy</strong>, output an action given a state.</li></ul><h1>Minimax 算法</h1><p>这里很多内容参考了 <a href="https://yzhang-gh.github.io/notes/others/minimax.html#%E9%97%AE%E9%A2%98%E5%AE%9A%E4%B9%89">Yu Zhang 的笔记</a>。</p><h2 id="问题背景">问题背景</h2><p>这里不再是广义的游戏背景，一般来说做出了一些限制。Minimax 算法常用于**「有限状态，零和，完全信息，两个玩家（Max/Min）」**博弈问题，比如棋类。</p><h2 id="算法概要">算法概要</h2><p>存在两个玩家，Max（希望最大化自己的收益），Min（希望最小化 Max 的收益）。从初始状态开始，通过两个玩家选用不同动作交替操作，可以形成一个树，树中的每一个节点都代表一个状态<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>。我们的目标是找到一个给 Max 的最优策略，使在游戏结束时的状态拥有最大的效用函数，这是一个在树中搜索的问题。</p><p>在 minimax 算法中，我们认为每一个状态 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 都拥有一个 minimax 值（递归得到）。这个值表示从当前状态 s 开始，<strong>双方均采取最优策略直至游戏结束</strong>时玩家 Max 的<strong>效用值</strong>具体到计算过程中，如果状态为终止状态，那么它就是当下的效用值；如果是中间状态，则是子状态 minimax 值中的（最大值，Max 操作，目的最有利于自己；最小值，Min 操作，目的最不利于 Max）：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>minimax</mtext><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.25em" columnalign="right left right left" columnspacing="0em 1em 0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>u</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mtext>Max</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>if GameOver</mtext><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi>a</mi><mo>∈</mo><mi>A</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></munder><mtext>minimax</mtext><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>if Max’s turn</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>a</mi><mo>∈</mo><mi>A</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></munder><mtext>minimax</mtext><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>if Min’s turn</mtext></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{minimax}(s)=\left\{     \begin{aligned}     &amp;u(s, \text{Max})                   &amp; &amp; \text{if GameOver}(s) \\     &amp;\max_{a \in A(s)}\text{minimax}(T(s,a)) &amp; &amp; \text{if Max&#x27;s turn}\\     &amp;\min_{a \in A(s)}\text{minimax}(T(s,a)) &amp; &amp; \text{if Min&#x27;s turn}    \end{aligned} \right. </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">minimax</span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:5.712em;vertical-align:-2.606em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-1.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.592em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.916em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.916em' style='width:0.8889em' viewBox='0 0 888.89 916' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V916 H384z M384 0 H504 V916 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.916em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.916em' style='width:0.8889em' viewBox='0 0 888.89 916' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V916 H384z M384 0 H504 V916 H384z'/></svg></span></span><span style="top:-5.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.106em;"><span style="top:-5.106em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3.606em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.606em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.106em;"><span style="top:-5.266em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">Max</span></span><span class="mclose">)</span></span></span><span style="top:-3.766em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em;"><span style="top:-2.309em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight">A</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">minimax</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">))</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.309em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight">A</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">minimax</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.606em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.106em;"><span style="top:-5.106em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3.606em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.606em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.106em;"><span style="top:-5.266em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">if GameOver</span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span><span style="top:-3.766em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">if Max’s turn</span></span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">if Min’s turn</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.606em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>对于算法的解释</p><ul><li>对于游戏树的 DFS 搜索，从终点回推过程节点的 minimax 值。</li><li>最优/最终的节点可以出现于任何深度。</li><li>在 Max 使用最优策略的情况下：<ul><li>如果对手 Min 使用最优策略，那么一个节点只要计算出了 minimax 值，就已经看到了游戏的结局（效用值）。</li><li>如果对手 Min 不使用最优策略，那么 Max 的最终效用只会更高。</li></ul></li></ul><p>一个简单的例子，自下而上的递归推导。</p><div style="width:80%; margin:auto"><img src="/artificial-intelligence/ai-adversarial-search/minimax-example.png" class=""></div><h2 id="Alpha-Beta-剪枝">Alpha-Beta 剪枝</h2><p>假设 game tree 的深度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>，每个节点有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> 种走法，则该算法的时间复杂度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>b</mi><mi>m</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(b^m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，在实际情况中是不现实的。相应的，其空间复杂度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>b</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(bm)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">bm</span><span class="mclose">)</span></span></span></span>。哪怕是在最简单的一字棋（tic-tac-toe）游戏中，这个数量级也相对较大：存在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn><mo stretchy="false">!</mo><mo>=</mo><mn>362880</mn></mrow><annotation encoding="application/x-tex">9!=362880</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">9</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">362880</span></span></span></span> 个终止节点。</p><p>所以我们必须要进行一定的手段来对搜索空间进行限制，来保证搜索的实际可行性。具体的思路是，我们其实不必要遍历所有的点，因为很多点是必然不会经历/不需要考虑的。例如下图，虚线框的值不必考虑，因为 C 节点的 minimax 值必然小于 2（Min 只会选取最小节点），所以在 A 节点上选取是必然不会考虑 C 节点。</p><div style="width:100%; margin:auto"><img src="/artificial-intelligence/ai-adversarial-search/ab-example.png" class=""></div><p>所以，在此算法上：</p><ul><li>对于每一个节点，我们维护一组上下限 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>α</mi><mo separator="true">,</mo><mi>β</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\alpha, \beta]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">]</span></span></span></span>，表示在当前节点 Minimax 值的范围，初始设置为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-\infty, \infty]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∞</span><span class="mclose">]</span></span></span></span>。[Max 至少能实现的收益, Max 最多能实现的收益]</li><li>对于一个 Max 节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，我们向上更新他的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> 值，将其子节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\beta(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 值与当前的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> 做比较：<ul><li>如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">\beta(m) \leq \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，则后续分支可以剪掉（直接 return）。<ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 的一个子节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 上，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">\beta(n) \leq \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\beta(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 必然小于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>。</li></ul></li><li>对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">\beta(m) &gt; \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，则需要更新 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 上的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> 值。</li></ul></li><li>对于一个 Min 节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，我们向下更新他的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> 值，将其子节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\alpha(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 值与当前的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> 做比较<ul><li>如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>≥</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\alpha(m) \geq \beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>，则后续分支可以剪掉（直接 return）。<ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 的一个子节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 上，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>≥</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\alpha(n) \geq \beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\alpha(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 必然不小于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>。</li></ul></li><li>对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\alpha(m) \lt \beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>，则需要更新 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 上的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> 值。</li></ul></li><li>对于叶节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mi>β</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>utility</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\alpha(k) = \beta(k) = \text{utility}(k, p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">utility</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></li></ul><blockquote><p><strong>TIP</strong></p><p>即使使用了 alpha-beta 剪枝，在实际中也基本不可能搜索到游戏结束，这就需要使用启发式评估函数 (heuristic evaluation function) 来代替游戏结束时的效用函数，来对一些较深层的状态进行评估，这里不再展开。</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Artificial Intelligence</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI</tag>
      
      <tag>search</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>排序算法</title>
    <link href="/computer-science-engineering/sorting/"/>
    <url>/computer-science-engineering/sorting/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>最近看了一篇比较有趣的文章<a href="https://mp.weixin.qq.com/s/_N_vbYEisNJ7yddaRjgZdQ">《比冒泡算法还简单的排序算法：看起来满是bug的程序，居然是对的》</a>，看了半天才看懂。发现自己其实已经不太记得各种排序方法了，此处做一个复习总结。（给自己看的笔记也不会很详细，毕竟大部分也都实现过，这里主要记录intuition。）主要参考了这篇知乎的博文，<a href="https://zhuanlan.zhihu.com/p/335048580">《八大经典排序算法详解》</a>。</p><span id="more"></span><h2 id="鸽巢排序">鸽巢排序</h2><ul><li>基本思想：空间换时间，建立一个足够长的数组，按照数值的大小放到相应的位置，最后遍历删除空位置。</li><li>时间复杂度为 O(n)。但是如果需要排序的数中有特别大的，则数组需要建立的特别大，不方便使用。</li></ul><h2 id="桶排序">桶排序</h2><p>上述鸽巢排序可以看作一种极端的（桶数很多的）桶排序：</p><ul><li>基本思想：空间换时间，将待排序的序列分到若干个桶中（桶具有顺序），每个桶内的元素再进行基于比较的排序。</li><li>时间复杂度为 O(k+n)，k 为最大值。</li><li>是稳定的排序方法。</li><li>限制比较多：只能int，空间消耗大，只有对于均匀数列效果好</li></ul><h2 id="插入排序">插入排序</h2><ul><li>基本思想：将待插入样本按其值的大小插入前面已经排序的文件中适当位置上，直到全部插入完为止。</li><li>时间复杂度为 O(n^2)。</li><li>是稳定的排序方法。</li></ul><h2 id="快速排序">快速排序</h2><ul><li>基本思想：在待排序的元素任取一个元素作为基准(通常选第一个元素，称为基准元素），将待排序的元素进行分块，比基准元素大的元素移动到基准元素的右侧，比基准元素小的移动到作左侧，从而一趟排序过程，就可以锁定基准元素的最终位置，对左右两个分块重复以上步骤直到所有元素都是有序的（递归过程）。</li><li>快速排序平均时间复杂度为 O(nlogn)，最坏情况为 O(n^2)，n越大，速度越快。</li><li>不是稳定的排序算法。</li></ul><h2 id="选择排序">选择排序</h2><ul><li>基本思想：每一次从待排序的数据元素中选出最小的一个元素，存放在序列的起始位置，直到全部待排序的数据元素排完。</li><li>时间复杂度 O(n^2)。</li><li>选择排序是不稳定的排序方法。（存在不相邻元素的互换）</li></ul><h2 id="希尔排序">希尔排序</h2><ul><li>基本思想：设置一定的步长序列 [a,b,c,1]（最后一个需要为1），然后根据步长来构建分组（以 a 为例，每个分组中都是相隔为a的一组样本：i, i+a, i+2a…），然后对分组里的样本进行排序，之后合并为新序列。a 步长进行完之后，在新的序列上使用下一个步长 b 得到下一个序列，如此往复。最后一个步长需要为1。</li><li>时间复杂度 平均时间 O(nlogn) 最差时间O(n^2)</li><li>是不稳定的排序方法。</li></ul><h2 id="堆排序">堆排序</h2><ul><li>基本思想：利用最大堆或最小堆，先将所有值放入堆中储存，再一一取出，则排好序。</li><li>堆排序是一种选择排序,其时间复杂度为 O(nlogn)。堆排序是不稳定的</li></ul><h2 id="归并排序">归并排序</h2><ul><li>基本思想：将待排序的数组分成前后两个部分，再递归的将前半部分数据和后半部分的数据各自归并排序，得到的两部分数据，然后使用merge合并算法将两部分数据合并到一起。</li><li>最好、最坏和平均时间复杂度都是 O(nlogn)，空间复杂度是 O(n)。</li><li>是稳定的排序算法。</li></ul><h2 id="冒泡排序">冒泡排序</h2><ul><li>基本思想：持续比较相邻的元素。如果第一个比第二个大，就交换他们两个。直到没有任何一对数字需要比较。</li><li>冒泡排序最好的时间复杂度为 O(n)，冒泡排序的最坏时间复杂度为 O(n^2)，因为循环轮数不确定。因此冒泡排序总的平均时间复杂度为 O(n^2)。</li><li>算法适用于少量数据的排序。</li><li>是稳定的排序方法。</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span> to n <span class="hljs-keyword">do</span><br><span class="hljs-keyword">for</span> j = i + <span class="hljs-number">1</span> to n <span class="hljs-keyword">do</span><br><span class="hljs-keyword">if</span> A[i] &gt; A[j] then<br>swap A[i] and A[j]<br></code></pre></td></tr></table></figure><h2 id="Bug-满满的“数组升序排序”">Bug 满满的“数组升序排序”</h2><p>这个方法第一次见于<a href="https://mp.weixin.qq.com/s/_N_vbYEisNJ7yddaRjgZdQ">《比冒泡算法还简单的排序算法：看起来满是bug的程序，居然是对的》</a>。伪代码如下。这个代码相对于冒泡排序看起来有两个地方写错了，一个是判断时的小于号，一个是第二个 for 循环中的开始项。但是这个算法竟然可以惊讶地得到正确的结果。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span> to n <span class="hljs-keyword">do</span><br><span class="hljs-keyword">for</span> j = <span class="hljs-number">1</span> to n <span class="hljs-keyword">do</span><br><span class="hljs-keyword">if</span> A[i] &lt; A[j] then<br>swap A[i] and A[j]<br></code></pre></td></tr></table></figure><p>本质上是一种插入排序，即把第 i 位的数插入到前 i-1 位的数中，使得前 i 位的数有序。不同于经典的插入排序是直接插，此处是进行交换插入。</p>]]></content>
    
    
    <categories>
      
      <category>Computer Science and Engineering</category>
      
    </categories>
    
    
    <tags>
      
      <tag>algorithms</tag>
      
      <tag>sorting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Contrastive Learning 学习记录</title>
    <link href="/machine-learning/contrastive-learning/"/>
    <url>/machine-learning/contrastive-learning/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>之前总是会断断续续看到一些自监督学习的工作/想法。同时也总是看到对比学习这个词，不明所以，所以对此进行一个简单的学习。本文可以看作对<a href="https://zhuanlan.zhihu.com/p/367290573">《对比学习（Contrastive Learning）:研究进展精要》</a>这篇知乎文章的阅读笔记。</p><span id="more"></span><h1>背景</h1><p>自监督学习有着从无标记样本中学习表征的能力。比较出名的是自然语言模型 Bert 的预训练。对比学习是一种自监督学习的方式，主要用在图像领域。</p><p>目前，对比学习貌似处于<strong>无明确定义、有指导原则</strong>的状态，它的指导原则是：通过自动构造相似实例和不相似实例，要求习得一个表示学习模型，通过这个模型，使得相似的实例在投影空间中比较接近，而不相似的实例在投影空间中距离比较远。</p><p>对比学习的关键点：</p><ul><li>如何构造相似实例，以及不相似实例</li><li>如何构造能够遵循上述指导原则的表示学习模型结构</li><li>以及如何防止模型坍塌(Model Collapse)</li></ul><p>目前的对比学习方法分类</p><ul><li>基于负例的对比学习方法</li><li>基于对比聚类的方法</li><li>基于不对称网络结构的方法</li><li>基于冗余消除损失函数的方法</li></ul><h1>几种分类</h1><h2 id="基于负例：SimCLR">基于负例：SimCLR</h2><p>首先我们需要构建正例和负例。负例的话，同一个 batch 的其他样本可以当作此样本的负例。正例的话一般通过图像增强来实现，如下图所示。</p><div style="width:100%;margin:auto"><img src="/machine-learning/contrastive-learning/augmentation.jpg" class=""></div><p>模型层面，SimCLR 具有上下两个 Branch，通过学到的表征来计算 Similarity。需要注意的是，相似度计算需要正则化。</p><div style="width:100%;margin:auto"><img src="/machine-learning/contrastive-learning/SimCLR.jpg" class=""></div><p>其中的相似度损失使用 infoNCE，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">τ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span>为温度参数：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo separator="true">,</mo><msubsup><mi>z</mi><mi>i</mi><mo>+</mo></msubsup><mo stretchy="false">)</mo><mtext>⁄</mtext><mi>τ</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><munderover><mo>∑</mo><mrow><mo stretchy="false">(</mo><mi>j</mi><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mi>K</mi></munderover><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mtext>⁄</mtext><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L_i=-log (exp(S(z_i,z_i^+ )⁄τ)/∑_{(j=0)}^Kexp(S(z_i,z_j )⁄τ) )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.3443em;vertical-align:-1.516em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-2.433em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.267em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">⁄</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mord">/</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">⁄</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">))</span></span></span></span></span></p><p>温度接近0的时候，该损失基本退化为 Triplet（对很相似样本的区分）。</p><p>为什么 SimCLR 投影操作要做两次非线性变换，而不是直接在Encoder后，只经过一次变换？</p><ul><li>在 Moco 中并没有 Projector，在 SimCLR 加入 projector 后效果提升明显。</li><li>SimCLR 论文中表示，Encoder后的特征表示，会有更多包含图像增强信息在内的细节特征，而这些细节信息经过Projector后，很多被过滤掉了。</li></ul><h3 id="Triplet-Loss">Triplet Loss</h3><p>此处对 triplet loss 做一个相关学习。这项损失目的也是将正样本距离拉近，负样本距离拉远（但是对于一些难负样本，似乎还是主要拉近正样本）。其形式如下：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">margin</mi><mo>⁡</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L=\max (d(a, p)-d(a, n)+\operatorname{margin}, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">margin</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 分别为正负样本。Margin 是一个大于零的数，希望与正样本的距离至少比负样本的距离小一个 margin。这种 loss 一般用于人脸识别，细粒度分类等这种训练样本差异较小的个体识别任务。</p><h2 id="基于负例：Moco-V2">基于负例：Moco V2</h2><div style="width:100%;margin:auto"><img src="/machine-learning/contrastive-learning/moco-v2.jpg" class=""></div><p>其有以下特点：</p><ul><li>相比于 Moco 增加了 projector。</li><li>相比于 SimCLR，从整个未标记数据集选取负例。</li><li>上分枝反向传播，下分枝使用移动平均机制更新参数。</li></ul><h2 id="基于对比聚类：SwAV">基于对比聚类：SwAV</h2><p>通过上分枝预测下分枝打出的类别伪标记（由聚类得来），同时也要用下分枝预测上分枝。具体损失函数采用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">z_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和聚类 Prototype 中每个类中心向量的交叉熵表示。</p><div style="width:100%;margin:auto"><img src="/machine-learning/contrastive-learning/SwAV.jpg" class=""></div><h2 id="基于不对称结构：BYOL">基于不对称结构：BYOL</h2><div style="width:100%;margin:auto"><img src="/machine-learning/contrastive-learning/byol.jpg" class=""></div><p>Target 分枝结构类似 Moco V2对应下分枝的 Moving Average 动量更新方式。Predictor 的存在保证了模型不坍缩（具体为何没有定论）。</p><h2 id="基于冗余消除：Barlow-Twins">基于冗余消除：Barlow Twins</h2><div style="width:100%;margin:auto"><img src="/machine-learning/contrastive-learning/barlow-twins.jpg" class=""></div><p>Barlow Twins 并没有去除向量的长度因素，它在Batch维度，对 Aug1 和 Aug2 里的正例分别做了类似 BN 的正则。之后，顺着 Batch 维，对 Aug1 和 Aug2 两个正例表示矩阵做矩阵乘法，求出两者的互相关性矩阵（cross-correlation matrix），其损失函数定义在这个互相关矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>上。希望互相关矩阵为对角元素为1的单位矩阵，增强元素间的独立性。</p><h1>现状与展望</h1><h2 id="现状">现状</h2><p>BYOL，SwAV，DeepCluster-v2 都在 many-shot（ImageNet上学，再迁移到其他数据集） 和 few-shot 上取得了比较好的表现。其中在 many-shot 上甚至超过有监督。数据来源于这篇论文，“How Well Do Self-Supervised Models Transfer?”。</p><h2 id="问题">问题</h2><ol><li>数据偏置问题：ImageNet 相对于普通网上能获取的数据还是太干净了。</li><li>正例构建问题：除了图像遮挡不变性和颜色不变性，对于其它的常见不变性，比如视角不变性、照明不变性等，对比学习模型的效果要明显弱于监督学习。</li><li>对于复杂任务缺乏像素级学习能力：当下都是采用判别模型。</li></ol><h2 id="我的看法">我的看法</h2><p>其实从2019年就已经陆陆续续见过很多自监督学习的工作了，一直也没有静下心来学习一下。这次通过对这篇介绍性博文的学习，加上之前一些自己的见闻，也算是对这个自监督学习方向有了一个粗浅的理解。</p><p>总的来说，自监督学习是希望在完全无标记的样本集中学习一个富有信息的表征。由于无标记，所以在学习表征的过程中，我们需要创建一些辅助任务来帮助学习表征。这些辅助任务包括但不限于：</p><ul><li>某种填空（类似 bert 的预训练，图像中的补全）</li><li>某种相似度量（对比学习）</li><li>etc.</li></ul><p>所以自监督学习问题的关键其实在于如何构建这个辅助任务：</p><ul><li>从当下的了解来看，判别式的方法是主流，都是通过生成正负样本来构建辅助任务。</li><li>在我的角度看，知乎这篇文章的分类，除了 BYOL 之外，还都是通过正负样本的判别来实现的，只是如何判别略有不同，但还是在一个范式下面。</li><li>这种基于判别的辅助任务其实是很简单的（同时在简单的分类问题上起到了很好的表现），但这种基于简单任务学到的表征在复杂任务上的适用性还不清楚（或许不太好，文章中提到的“像素级构建能力”）。</li><li>或许设计更加复杂但是可行的辅助任务，能提取到更为合适且富含信息的表征。</li></ul><p>与其他领域的关系：</p><ul><li>背景上：自监督学习的出现背景还是存在大量未标记数据，其实也是在标记数据不足这个局限性下做的尝试。</li><li>目的上：与其他研究领域尝试学模型不同，自监督学习的主要目的是在学表征。</li></ul><p>总的来说，我第一次见到这类方法的时候就觉得很直观且很巧妙，经过近年的发展，它的可用性已经得到了验证，个人认为在表征学习的这个道路上，自监督学习还是比较靠谱的。但是放到具体的下游任务上，面临标记数据的匮乏时，用主动学习选取标注才是合理之选。或许将来的可以实用的大模型都会包含一个离线的自监督学习表征模块，和一个在线的主动学习模块。这样既可以缓解主动学习在深度表征上的乏力，也可以高效的在表征确定的时候找到目标模型。</p><h1>Reference</h1><ul><li><a href="https://zhuanlan.zhihu.com/p/367290573">《对比学习（Contrastive Learning）:研究进展精要》</a></li><li><a href="https://zhuanlan.zhihu.com/p/462539667">【对比学习】| Triplet loss</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>contrastive-learning</tag>
      
      <tag>self-supervised-learning</tag>
      
      <tag>triplet-loss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>人工智能的中的搜索</title>
    <link href="/artificial-intelligence/ai-search/"/>
    <url>/artificial-intelligence/ai-search/</url>
    
    <content type="html"><![CDATA[<p>人工智能中关于搜索的一些最基础的知识。</p><span id="more"></span><h2 id="AI-中的搜索">AI 中的搜索</h2><p>对于一个 goal-based agent，搜索是使其找到一个动作或者一系列动作来达到目标。有很多例子，比如走迷宫，寻路问题，8-queen 问题等。一般来说包含树搜索和图搜索等。</p><h2 id="对于考虑路径的搜索而言">对于考虑路径的搜索而言</h2><p>评估策略需考虑以下四个维度：</p><ul><li>Completeness: Does it always find a solution if it exists?</li><li>Time complexity: # nodes generated/expanded.</li><li>Space complexity: maximum # nodes in memory.</li><li>Optimality: Does it always find the least-cost solution?</li></ul><p>存在两类搜索策略：</p><ul><li>Uniformed<ul><li>Breadth-first search (BFS): Expand shallowest node</li><li>Depth-first search (DFS): Expand deepest node</li><li>Depth-limited search (DLS): Depth first with depth limit</li><li>Iterative-deepening search (IDS): DLS with increasing limit</li><li>Uniform-cost search (UCS): Expand least cost node (the cost could be the length between nodes)</li></ul></li><li>Informed<ul><li>Greedy best-first search: Expand the node that appears to be closest to goal</li><li>A* search: Minimize the total estimated solution cost (to middle node + node to goal；f=g+h). BFS mode.</li><li>IDA*: IDS + A*. DLS mode. The cost of space is lower than A*.</li></ul></li></ul><p>对于 A* 中启发式策略而言（h）：</p><ul><li>A good heuristic must be admissible.</li><li>An admissible heuristic never overestimates the cost to reach the goal, that is it is optimistic</li><li>For admissible <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">h_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>(s) ≥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">h_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>(s) for ∀𝑠 ⇒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> dominates <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">h_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and is more efficient for search.</li></ul><p>UCS vs Greedy Best First vs A*:</p><ul><li>UCS：f(n) = g(n)</li><li>Greedy Best First: f(n) = h(n)</li><li>A*: f(n)=g(n)+h(n)</li></ul><h2 id="对于不考虑路径的搜索">对于不考虑路径的搜索</h2><p>Local search: the path doesn’t matter</p><ul><li>Hill climbing</li><li>Genetic algorithms</li><li>Simulated Annealing: Given a chance to jump out the local minimum</li></ul>]]></content>
    
    
    <categories>
      
      <category>Artificial Intelligence</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI</tag>
      
      <tag>search</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Matplotlib 学习笔记</title>
    <link href="/programming/matplotlib/"/>
    <url>/programming/matplotlib/</url>
    
    <content type="html"><![CDATA[<p>这里是个人的 Matplotlib 学习笔记。记录一些作图的过程。</p><span id="more"></span><h1>用法</h1><h2 id="减小空白边界">减小空白边界</h2><p>由于使用 Latex 排版时需要严格控制图片位置、大小、排布方式，所以任何冗余的空间都是需要极力避免的。在做图的时候可以直接将图片空白边界抹去。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">plt.savefig(<span class="hljs-string">&#x27;test.png&#x27;</span>, bbox_inches=<span class="hljs-string">&#x27;tight&#x27;</span>)<br></code></pre></td></tr></table></figure><p>但是这个方法有一个问题就是多个图片的留白可能不一致，导致如果多子图放置于 latex 文档中会出现排版无法对齐的情况。此时需要手动对边界进行设置。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">plt.subplots_adjust(left=<span class="hljs-number">0.12</span>, right=<span class="hljs-number">0.97</span>, top=<span class="hljs-number">0.98</span>, bottom=<span class="hljs-number">0.1</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Matplotlib</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>人工智能的基本概念</title>
    <link href="/artificial-intelligence/ai-basics/"/>
    <url>/artificial-intelligence/ai-basics/</url>
    
    <content type="html"><![CDATA[<p>人工智能基础知识和一些概念。</p><span id="more"></span><h2 id="AI-是什么？">AI 是什么？</h2><p>其实很多地方都给出了不同角度的定义，此处仅记录自己的看法。</p><blockquote><p>AI 是承载于机器或程序，人为设计或训练，并可以解决特定或一些列特定问题的能力。</p></blockquote><p>其涵盖多个计算机领域：机器学习/优化/搜索/etc.</p><h2 id="智能体">智能体</h2><p>AI 承载于智能体（Agent），即我的定义中的机器或程序。</p><blockquote><p>Agent = Architecture + Program</p></blockquote><p>在解决问题的过程中，智能体通过传感器（Sensors）接受外界环境（Environment）的信号，并自我处理信息，之后作出相应行动（Action）。于是在对一个智能体进行定义时，通常要考虑 <strong>PEAS</strong>：</p><ul><li>Performance</li><li>Environment</li><li>Actuators</li><li>Senors</li></ul><h2 id="环境">环境</h2><p>环境有很多重要的类别：</p><ul><li>Fully observable (vs. partially observable)</li><li>Deterministic (vs. stochastic)</li><li>Episodic (vs. sequential)</li><li>Static (vs. dynamic)</li><li>Discrete (vs. continuous)</li><li>Single agent (vs. multi-agent)</li><li>Known (vs. Unknown)</li></ul><p>下面是一些具体的例子。</p><table><thead><tr><th>Environment</th><th>Observable</th><th>Agents</th><th>Deterministic</th><th>Static</th><th>Discrete</th></tr></thead><tbody><tr><td>8-puzzle</td><td>Fully</td><td>Single</td><td>Deterministic</td><td>Static</td><td>Discrete</td></tr><tr><td>Chess</td><td>Fully</td><td>Multi</td><td>Deterministic</td><td>(Semi)Static</td><td>Discrete</td></tr><tr><td>Poker</td><td>Partially</td><td>Multi</td><td>Stochastic</td><td>Static</td><td>Discrete</td></tr><tr><td>Backgammon</td><td>Fully</td><td>Multi</td><td>Stochastic</td><td>Static</td><td>Discrete</td></tr><tr><td>Car</td><td>Partially</td><td>Multi</td><td>Stochastic</td><td>Dynamic</td><td>Continuous</td></tr><tr><td>Cleaner</td><td>partially</td><td>Single</td><td>Stochastic</td><td>Dynamic</td><td>Continuous</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Artificial Intelligence</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>有趣的事物</title>
    <link href="/interesting-stuff/interesting-stuff/"/>
    <url>/interesting-stuff/interesting-stuff/</url>
    
    <content type="html"><![CDATA[<p>一些有趣的东西。</p><span id="more"></span><ul><li><a href="https://csunplugged.org/en/">Computer Science without a computer</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Interesting Stuff</category>
      
    </categories>
    
    
    <tags>
      
      <tag>interesting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Batch Normalization</title>
    <link href="/machine-learning/batch-normalization/"/>
    <url>/machine-learning/batch-normalization/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>此处记录对于 Batch Normalization 的学习。</p><span id="more"></span><h2 id="神经网络中存在的-ICS-问题">神经网络中存在的 ICS 问题</h2><p>深度学习中存在 Internal Covariate Shift (ICS) 的问题。类比迁移学习中的 Covariate Shift 指源领域和目标领域数据 marginal distribution 的偏移。这里 ICS 指神经网络中，由于参数的变化，引起的每一层输出分布的差异变化，换句话说之后下一层的输入在参数变化后，可能基于了另一个分布。所以下一层在训练过程中就需要不断的去适应这种变化。</p><p>于是带来了以下问题：</p><ul><li>后面一层的参数需要适应不断变化的分布，训练效率降低。</li><li>对于饱和非线性激活函数，例如 sigmoid 和 tanh，容易落入饱和区。饱和区是指由于输入值极度偏离0点，导致梯度计算接近于0，从而难以起到学习效果。</li></ul><h2 id="如何解决-ICS-问题">如何解决 ICS 问题</h2><p>此类由于分布变化带来不良影响的问题，最 naive 的解决方式一般来说都是对分布进行限制。就比如在迁移学习中，会将源域和目标域的样本来做一个统一（减小分布差异）。在 ICS 问题中，也可以对分布进行限制。</p><p>最初，白化（whitening）被提出，一般来说采用 <a href="http://ufldl.stanford.edu/tutorial/unsupervised/PCAWhitening/">PCA</a> 或者 ZCA 的方法，使所有特征分布均值为0，方差为1（PCA）或相同（ZCA）。白话的目的是去除数据特征之间相关性（独立），同时使其具有相同均值和方差（同分布）。这样每一层网络的输入分布被固定，加速网络收敛。</p><p>但是白化也存在一些问题：</p><ul><li>计算成本高</li><li>改变数据表达能力，一些参数信息会被丢失</li><li>不可微，难以通过反向传播训练</li></ul><p>所以说我们期望有一种计算代价低廉，且能使标准化的数据尽可能保有表达能力的方法。这就是 Batch Normalization 提出的背景。</p><h2 id="什么是-Batch-Normalization">什么是 Batch Normalization</h2><p>主要思路：</p><ul><li>既然白化计算过程比较复杂，那我们就放松限制一点，尝试只单独对每个特征进行标准化，使其均值为0，方差为1。</li><li>既然类白化操作减弱了网络中每一层输入数据表达能力，那再加入线性变换操作，让这些数据再能够尽可能恢复本身的表达能力，使其不因规范化而下降。</li></ul><p>通用变换框架如下所示，包含两次平移和伸缩变换，在使用 BN 之后，每层神经元输入的样本的均值仅由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">b</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span></span> 决定，而不像之前由前面一层神经网络复杂的参数决定：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold-italic">g</mi><mo>⋅</mo><mfrac><mrow><mi mathvariant="bold-italic">x</mi><mo>−</mo><mi mathvariant="bold-italic">μ</mi></mrow><mi mathvariant="bold-italic">σ</mi></mfrac><mo>+</mo><mi mathvariant="bold-italic">b</mi><mo fence="true">)</mo></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">h=f\left(\boldsymbol{g}\cdot\frac{\boldsymbol{x}-\boldsymbol{\mu}}{\boldsymbol{\sigma}}+\boldsymbol{b}\right)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">σ</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span><span class="mspace newline"></span></span></span></span></p><p>但是好像这个第二次的仿射变换在理论上是否有用，需不需要用还有争议，日后可以再仔细看一下。（挖坑）</p><p>同时 BN 有一些变体，在这里不展开了：</p><ul><li>纵向规范化（最基础）</li><li>横向规范化</li><li>参数规范化</li><li>余弦规范化</li></ul><h2 id="如何使用-Batch-Normalization">如何使用 Batch Normalization</h2><p>适用场景：</p><ul><li>每个 mini-batch 比较大，数据分布比较接近。</li><li>在进行训练之前，要做好充分的 shuffle， 否则效果会差很多。</li><li>因此不适用于 动态的网络结构 和 RNN 网络</li></ul><p>测试阶段：</p><ul><li>保留训练时每一个 batch 的统计量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mu_{batch}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mrow><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma^2_{batch}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0972em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4169em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">h</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span>。</li><li>使用整个样本的统计量来对Test数据进行归一化，具体来说使用均值与方差的无偏估计。<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub><mo>=</mo><mi mathvariant="double-struck">E</mi><mo stretchy="false">(</mo><msub><mi>μ</mi><mrow><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu_{test}=\mathbb{E} (\mu_{batch})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">es</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mrow><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><mn>2</mn></msubsup><mo>=</mo><mfrac><mi>m</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi mathvariant="double-struck">E</mi><mo stretchy="false">(</mo><msubsup><mi>σ</mi><mrow><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2_{test}=\frac{m}{m-1}\mathbb{E}(\sigma^2_{batch})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">es</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2174em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathbb">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4169em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">h</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li></ul><p>构建阶段：</p><ul><li>置于 Conv 层或全连接层之后</li><li>对于饱和非线性激活函数而言，BN 层需要放到 activation 之前。Dropout 则应当置于 activation layer 之后.</li><li>对于 ReLU 而言，目前并没有定论，不管是实验还是理论争论都比较多，目前看来 BN 放在 ReLU 之后可能表现更好，但是放在 ReLU 前的可能更多一些（BN 原论文是放在了前面）。（<strong>大误</strong>）</li></ul><h2 id="在-Pytorch-中的-Batch-Normalization">在 Pytorch 中的 Batch Normalization</h2><p>在 Pytorch 的实现中，BN 也包含两次平移和伸缩变换，其中第二次变换可以通过调整仿射变换参数 <code>affine=True</code> 选择是否打开。这里可能也体现了这个仿射变换是否有必要的争议。</p><h2 id="Reference">Reference</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/33173246">详解深度学习中的Normalization，BN/LN/WN - Juliuszh的文章 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/34879333">Batch Normalization原理与实战 - 天雨粟的文章 - 知乎</a></li><li><a href="https://www.zhihu.com/question/318354788/answer/640006790">Batch Normalization 和激活函数的使用顺序是什么，神经元的饱和指的又是什么？ - 无双谱的回答 - 知乎</a></li><li><a href="https://pytorch.org/docs/stable/generated/torch.nn.BatchNorm2d.html">https://pytorch.org/docs/stable/generated/torch.nn.BatchNorm2d.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Latex 图片表格排版记录</title>
    <link href="/programming/latex/"/>
    <url>/programming/latex/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>此处记录一些 Latex 的用法。</p><span id="more"></span><h2 id="图片排版">图片排版</h2><h3 id="子图排版">子图排版</h3><p>涉及子图的图片排版可以参考<a href="https://blog.csdn.net/a6822342/article/details/80533135">此链接</a>。在此就不再赘述。</p><h3 id="将图片放置于表格中">将图片放置于表格中</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs LaTeX"><span class="hljs-keyword">\begin</span>&#123;table&#125;<br>   <span class="hljs-keyword">\centering</span><br>   <span class="hljs-keyword">\caption</span>&#123;The table of figures&#125;<br>   <span class="hljs-keyword">\hspace</span>*&#123;-0.15<span class="hljs-keyword">\linewidth</span>&#125;<br>   <span class="hljs-keyword">\begin</span>&#123;tabular&#125;&#123;cM&#123;0.25<span class="hljs-keyword">\linewidth</span>&#125;M&#123;0.25<span class="hljs-keyword">\linewidth</span>&#125;M&#123;0.25<span class="hljs-keyword">\linewidth</span>&#125;M&#123;0.25<span class="hljs-keyword">\linewidth</span>&#125;&#125;<br>      <span class="hljs-keyword">\toprule</span><br>        <span class="hljs-built_in">&amp;</span> A                                              <span class="hljs-built_in">&amp;</span> B                                              <span class="hljs-built_in">&amp;</span> C                                              <span class="hljs-built_in">&amp;</span> D                                              <span class="hljs-keyword">\\</span><br>      <span class="hljs-keyword">\midrule</span><br>      K <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-keyword">\\</span><br>      L <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-keyword">\\</span><br>      M <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-keyword">\\</span><br>      N <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-built_in">&amp;</span> <span class="hljs-keyword">\includegraphics</span>[width=<span class="hljs-keyword">\linewidth</span>]&#123;figure.png&#125; <span class="hljs-keyword">\\</span><br>      <span class="hljs-keyword">\bottomrule</span><br>   <span class="hljs-keyword">\end</span>&#123;tabular&#125;<br>   <span class="hljs-keyword">\label</span>&#123;table:table-of-figures&#125;<br><span class="hljs-keyword">\end</span>&#123;table&#125;<br></code></pre></td></tr></table></figure><h3 id="子图超出行宽强制不换行">子图超出行宽强制不换行</h3><p>这个需求是因为在写文章时有时模版会在子图间加距离，导致按比例设置大小的子图超出行距换行。另一种情况就是有时我们需要稍外超出一些行距来使图片更大一些。一般来说这里需要使用到 <code>\makebox</code> 命令。</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs LaTeX"><span class="hljs-keyword">\begin</span>&#123;figure&#125;<br>   <span class="hljs-keyword">\centering</span><br>   <span class="hljs-keyword">\makebox</span>[<span class="hljs-keyword">\textwidth</span>][c]&#123;<br>   <span class="hljs-keyword">\subfigure</span>[Caption A]&#123;<br>      <span class="hljs-keyword">\begin</span>&#123;minipage&#125;[b]&#123;0.3<span class="hljs-keyword">\linewidth</span>&#125;<br>         <span class="hljs-keyword">\includegraphics</span>[width=1<span class="hljs-keyword">\textwidth</span>]&#123;figure/digit<span class="hljs-built_in">_</span>best.png&#125;<br>      <span class="hljs-keyword">\end</span>&#123;minipage&#125;<br>   &#125;<br>   <span class="hljs-keyword">\hspace</span>&#123;-0.05<span class="hljs-keyword">\linewidth</span>&#125;<br>   <span class="hljs-keyword">\subfigure</span>[Caption B]&#123;<br>      <span class="hljs-keyword">\begin</span>&#123;minipage&#125;[b]&#123;0.3<span class="hljs-keyword">\linewidth</span>&#125;<br>         <span class="hljs-keyword">\includegraphics</span>[width=1<span class="hljs-keyword">\textwidth</span>]&#123;figure/amazon<span class="hljs-built_in">_</span>best.png&#125;<br>      <span class="hljs-keyword">\end</span>&#123;minipage&#125;<br>   &#125;<br>   <span class="hljs-keyword">\hspace</span>&#123;-0.05<span class="hljs-keyword">\linewidth</span>&#125;<br>   <span class="hljs-keyword">\subfigure</span>[Caption C]&#123;<br>      <span class="hljs-keyword">\begin</span>&#123;minipage&#125;[b]&#123;0.3<span class="hljs-keyword">\linewidth</span>&#125;<br>         <span class="hljs-keyword">\includegraphics</span>[width=1<span class="hljs-keyword">\textwidth</span>]&#123;figure/office<span class="hljs-built_in">_</span>best.png&#125;<br>      <span class="hljs-keyword">\end</span>&#123;minipage&#125;<br>   &#125;<br>   <span class="hljs-keyword">\hspace</span>&#123;-0.05<span class="hljs-keyword">\linewidth</span>&#125;<br>   <span class="hljs-keyword">\subfigure</span>[Caption D]&#123;<br>      <span class="hljs-keyword">\begin</span>&#123;minipage&#125;[b]&#123;0.3<span class="hljs-keyword">\linewidth</span>&#125;<br>         <span class="hljs-keyword">\includegraphics</span>[width=1<span class="hljs-keyword">\textwidth</span>]&#123;figure/imageCLEF<span class="hljs-built_in">_</span>best.png&#125;<br>      <span class="hljs-keyword">\end</span>&#123;minipage&#125;<br>   &#125;&#125;<br>   <span class="hljs-keyword">\caption</span>&#123;A box of figures.&#125;<br>   <span class="hljs-keyword">\label</span>&#123;fig:box-figures&#125;<br><span class="hljs-keyword">\end</span>&#123;figure&#125;<br></code></pre></td></tr></table></figure><h3 id="子图引用">子图引用</h3><p>如果是单张子图，可以直接引用 <code>Fig.~\ref&#123;子图&#125;</code>。如果是多张子图，可以使用 <code>Fig.~\ref&#123;主图&#125;\subref&#123;子图1&#125;\subref&#123;子图2&#125;</code> 来进行引用。（但是这个方法无法放到同一个括号里。）</p><h2 id="表格排版">表格排版</h2><h3 id="竖排表格中的文本">竖排表格中的文本</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs LaTeX"><span class="hljs-keyword">\rotatebox</span>&#123;90&#125;&#123;some rotated text&#125;<br></code></pre></td></tr></table></figure><h3 id="表格中文本加粗">表格中文本加粗</h3><p>通常情况下加粗后会使文本变宽，导致表格无法对齐。<a href="https://blog.csdn.net/a411358606/article/details/120121332">前人</a>也遇到过这个问题，并尝试了了不同的加粗命令，发现使用<code>\pmb</code>可以避免文本变宽情况出现。</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>latex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>中国为什么有前途</title>
    <link href="/reading-note/china-bold-future/"/>
    <url>/reading-note/china-bold-future/</url>
    
    <content type="html"><![CDATA[<p>《中国为什么有前途》 翟东升老师</p><span id="more"></span><hr><h2 id="极简简介">极简简介</h2><p>此处以两版的前言的节选来作简介。</p><h3 id="第三版前言">第三版前言</h3><p>本书有2009年开始做了第一版，迄今为止已有第三版（2019年）。本书的若干语言和预警都得以兑现：</p><ul><li>2010年第一版提出逆全球化的风险</li><li>2015年第二版（撰写于2014年）预警美元强势周期导致人民币汇率下跌和资本外逃的恶性循环</li></ul><h3 id="第二版前言">第二版前言</h3><p>宏观来看，中国的国际地位提高。但是微观来看，生活中的困境压的普通人喘不过气来。看整体国势，中国好像很有前途；但是看自己身边，好像又问题很大。写这本书是为了告诉读者，做一个21世纪的中国人，是艰辛却又令人骄傲的。</p><p>本书向读者指出一些基本事实和历史轨迹，包括：</p><ul><li>世界历史演进的趋势</li><li>当代中国体制的特质</li><li>中国已经具备巨大潜能</li></ul><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>这是一本全面的书，其以中国改革开放以来的政治经济为主线，涵盖货币，安全，投资，援助等方面，对认识中国当下经济政治政策的形成过程可以起到帮助作用。</p><p>这同样也是一本乐观的书，乐观地总结了中国从上世纪70年代以来的经济货币等政策变动，并乐观的展望了未来中国发展的趋势。为何说这本书乐观？是因为其总能从正反两面考虑过去的政策，甚至是“不那么好的政策”，并提取出有价值的经验。同时又通过分析历史和总结，在考虑到很多政策潜在弊端的情况下，对未来政策提出相对优良一些的改进或优化。</p><h3 id="感想-看法">感想/看法</h3><p>本人从这本书收益良多，翟老师在自己的知识框架下对中国过去的走势和未来的发展做出了分析总结。对我个人而言，由于之前知识体系尚未构建，所以对翟老师的观点以认同居多，或许将来在不断学习后，可以更加批判看待书中观点。</p><p>仅从书中总结的事实来看，我个人对中国近年来的发展持乐观态度。可以从书中清晰地看到国内政策的调整与转变，尽管政策或许尚有不足，但是不断完善，向科学完备发展。</p><p>有一个明显有趣的点，就是可以看出翟老师的一些“双标”，总的来说就是我们察觉到了美国的货币霸权，不公平的优先发展权等，对其进行批判，但是我们的目标也是获得这一些权利。还有就是一些政策在我们国家使用的时候可以明显看出利弊，但是宣传给其他国家使用相同政策时则强调好处。这其实无可厚非，“人不为己，天诛地灭”，当然我还是更愿意相信当中国作为一个体系更中心的国家时，能更多的承担一些国际责任，可能要好于多数的民主大国。</p><p>在对外投资和援助上，我以前其实一直没搞清楚必要性重要性和利弊。这里看来或许翟老师已经一一阐述，之后可以新开一个 post 来做一下总结。但是总的来说，能说和不能说的好处都是存在的。此时就有涉及到另一个也很有趣的话题----“师出有名”。为自己的政策和潜在利益作出令人无法反驳的解释，还是很重要的。</p><p>还有一点就是这本书其实强化了一个我的认识。就是金融的本质，或者说最重要的点，是为社会活动提供资金，尤其是优化资金配置。以前我对这一认识并不清晰，觉得金融可能主要在于套利，或者保证市场有效（当然这个也很重要），所以一度觉得金融很虚，甚至有时会存在对其嗤之以鼻但又羡慕人家利润的看法。尤其是之前觉得很多金融人士致力于杀猪盘割韭菜，更是让我这行业持轻视态度（可能是吃不到葡萄说葡萄酸）。但是这本书在国家投资，主权基金，国企民企的陈述中，反复展现了优化资金的配置对于行业，对于国家的重要性，让我强化了金融这个行业负担起优化资本配置责任和义务的认知。所以个人认为，金融，尤其是中国金融，脱虚向实还是很有必要的。当然要能干的了实事，也得能抵御国外的金融攻击。（外行人的见解。）</p><p>其实书中大部分内容，翟老师在政经启翟中都有提到。这里只是在中国发展的维度进行展开。但是总的来说跳不出“人本主义政治经济学”的框架。本人虽然见识的社会比较少，但是对“人才是最重要的财富”深以为然。最后以 Ray Dalio 最近说的一番话结束这番感想。</p><blockquote><p>I encourage you to look at the trends and not misunderstand and over-focus on the wiggles.To understand what’s going on you need to understand that China is a state capitalist system which means that the state runs capitalism to serve the interests of most people and that policy makers won’t let the sensitivities of those in the capital markets and rich capitalists stand in the way of doing what they believe is best for the most people of the country.</p></blockquote><hr><h1>按节讨论/摘录</h1><h2 id="第一章：世界市场体系的中央与外围">第一章：世界市场体系的中央与外围</h2><p>四类国家：</p><ul><li>中央国家：依靠信心生活，美国</li><li>准中央国家：依靠理性生存，欧日</li><li>外围工业国家：依靠勤劳谋生，中国，印度，东亚，中东欧</li><li>原料提供国家：依靠运气生存，中东，拉美，非洲，东欧，中亚</li></ul><p>四类国家间主要存在<strong>两种关系</strong>：</p><ul><li>贸易关系：材料和产品的流动</li><li>融资关系：美元霸权</li></ul><p>世界市场体系的<strong>基本特点</strong>：</p><ul><li>无远弗届：很少有国家可以孤立于世界市场之外。</li><li>非常不公平的体系：中央国家比起外围国家更富有和稳定。<ul><li>“中央国家掌握自己的货币政策，外围国家难以掌握自己的货币政策。”–索罗斯</li><li>铸币税：信用货币与真实价值；外围投资与美元贬值。</li></ul></li><li>要素流动的选择性：不同要素流动程度不同，信息观念到商品服务到技术到人力资源流动程度递减。</li><li>自我强化功能：中心外围固化，强者恒强，弱者恒弱。（中短期效应）</li><li>周期的自我更新：伊利比亚半岛国家（葡萄牙和西班牙），荷兰，英国，美国<ul><li>人口规模越来越大：当大家都掌握了新的财富与权势要素，规模（人口，幅员）重新变得重要。</li><li>短期内“劫贫济富”，长期“损有余而补不足”。</li></ul></li><li>结构的鲁棒性：<ul><li>利益分布不均衡但是博弈论意义均衡。</li></ul></li></ul><p><strong>中央国家收益、代价和条件</strong>：</p><ul><li>获得的<strong>收益</strong>：<ul><li>提高人均财富拥有量。</li><li>提供对全球经济波动节奏的掌握和调控能力。</li><li>融资和负担转嫁能力。</li><li>语言、人才、政治自信、号召力。</li></ul></li><li>获取和保有中央地位的<strong>条件</strong>：<ul><li>货币霸权（参考如何成功开办和经营一家商业银行。）</li><li>资本实力</li><li>控制商业活动以自己货币进行</li><li>维系重要国家的关系获得支持</li><li>发行金融产品满足外围国家偏好</li><li>存款通过投资转化为资本<ul><li>自己的跨国公司有明显经营优势</li><li>全球市场开放性</li></ul></li></ul></li><li>中央国家承担的<strong>成本</strong>：<ul><li>产业外移，长期逆差，去工业化</li><li>控制战略地区的安全成本的</li></ul></li></ul><p><strong>外围国家发展道路上的常见陷阱</strong>：</p><ul><li>资源诅咒陷阱</li><li>欲速不达的赶超陷阱</li><li>发展过程中的政治陷阱</li></ul><p>寥寥几个外围国家<strong>逆袭</strong>的成功者，<strong>都符合以下特征</strong>：</p><ul><li>极度缺乏自然资源</li><li>人口增速适中</li><li>紧紧依附西方市场</li><li>政府对权力控制牢固</li></ul><h2 id="第二章：中国在体系中的足迹">第二章：中国在体系中的足迹</h2><p>从人均角度来看，中国的<strong>比较优势</strong>不在于原材料而在于<strong>劳动力</strong>。改革开放以来实现**“三外路线”**：对外贸易、引进外资（外国直接投资）、对外货币安排。20世纪80年代，中国由外围原料出口国演变为外围工业国。2019年中国即将从外围工业国转变为中央工业国的临界区域（地位等同欧日）。</p><p>**“三外路线”**的政策组合，形成了官方巨大的外汇储备：</p><ul><li>人民币大幅贬值锚定美元</li><li>引进外资</li><li>鼓励出口</li><li>经常项目人民币可兑换</li><li>强制结售汇</li></ul><p>“三外路线”的<strong>利弊</strong>：</p><ul><li>“三外路线”的利：<ul><li>就业、工业化、资本积累、对改革的推动、和平。</li></ul></li><li>“三外路线”的弊：<ul><li>本土工业形成挤压、环境资源代价、对外部资本及市场依赖、地区部门阶层间分配失衡</li><li>对中央国家的实质性纳贡，外商利用外汇在中国收益10%以上的年华，而中国用外汇投资收益接近0。</li><li>不可持续性：中国生产美国消费，中国放贷美国借债的循环模式不可持续。</li></ul></li></ul><p>“三外路线”的<strong>修正</strong>：</p><ul><li>科学发展观：以福利而不是 GDP 衡量政策成就。</li><li>外商回归国民待遇，招商引资到招商选资。</li><li>人民币渐进升值过程。</li><li>强调自主创新，培育自身<a href="/economy-finance/seminar-talks/xiaogang/" title="多层次资本市场">多层次资本市场</a>。</li><li>启动内需，减轻外部依赖。</li><li>对国有企业的扶持。</li></ul><p>“三外路线”在中国<strong>何以实现</strong>：</p><ul><li>工业化和现代化的历史使命：发挥比较优势，发展市场上有竞争力的产业，才能顺利实现工业化。</li><li>体制根源：国家权力彻底渗入动员和改造了中国社会，中央地方关系也同样重要。</li><li>思潮和意识形态因素：引入西方经济学，“科学发展观”。</li><li>要素禀赋，人口与资源：规模是竞争优势，也有着巨大的内需市场潜力。</li></ul><p>“三外路线”兴衰<strong>对中国外交的影响</strong>：</p><ul><li>20世纪90年代低调对外，“韬光养晦”。</li><li>2004年后，对西方依赖程度在逐步减轻，西方却更依赖中国。</li><li>2005年来，在联合国使用或声称使用否决权来迫使议案调整。</li><li>2012年以来，走出韬晦。</li></ul><h2 id="第三章：“三外路线”下的对外贸易">第三章：“三外路线”下的对外贸易</h2><blockquote><p>即将到来的中国对外产业转移，需要我们思考这样一个问题：如何发展出一种独特的产业链编辑能力，以便尽可能按照我们的政治经济利益塑造地区乃至全球性的地缘经济和地缘政治格局。</p></blockquote><p><strong>中国对外贸易发展的轨迹</strong>：</p><ul><li>外贸惊人增长：<ul><li>贸易收支平衡方面持续顺差</li><li>外贸总量大幅升高和出口总量全球第一</li></ul></li><li>外贸结构改善：<ul><li>商品：原材料到劳动/资源密集型工业制成品到高新技术出口品</li><li>贸易性质：加工贸易比例先上升后下降。2005年之后，落后外资撤出，加工贸易下降，长期来看仍会下降。</li><li>出口目的地：从出口中央国家到出口目的地多元化。对外围地区的出口商由中资企业为主。</li><li>出口企业性质：外资比例稳步回落。</li></ul></li></ul><p><strong>中国对外贸易发展的动能</strong>：</p><ul><li><strong>观念</strong>的变迁：<ul><li>从使用苏联模式到接受西方自由主义经济学并成为主流。</li><li>进口替代型发展战略到出口导向型（不强调建立自己的完整产业体系），但是未极端化而是渐进融合。</li><li>比较优势和“竞争优势”。</li></ul></li><li><strong>制度</strong>的变迁：<ul><li>外贸管理体制市场化、国际化、法律化。</li><li>企业内部治理模式改革。</li><li>外贸经营权放开和扩大。</li></ul></li><li>鼓励出口的政策组合：<ul><li>外汇留成制度和人民币贬值</li><li>出口退税政策促进出口</li></ul></li></ul><p><strong>国际体系环境</strong>：</p><ul><li>日本产业转移，四小龙诞生</li><li>美国限制进口增速</li><li>中国招商引资</li><li>所以对美出口绕行到中韩台地区。</li></ul><h3 id="贸易、产业与地缘政治经济">贸易、产业与地缘政治经济</h3><p>回答此章开头的问题。<code>对外贸易是否可以塑造一个有力的地缘政治经济环境？</code>基本思路在于培育“产业链编辑能力”。</p><blockquote><p>所谓产业链编辑能力（capacity of industrial chain editing, CICE），是指大国依靠<strong>资深市场规模</strong>以及<strong>对某些关键性生产要素的掌控</strong>而获得的一种特殊能力，借此可以在一定程度上按照自身国家利益的需要来<strong>主动调整地区性的甚至全球性的产业地理分布</strong>，以便从国家间不对称的相互依赖中获得优势和权利。</p></blockquote><p>今天，经济成长，吐故纳新，顺比较优势，我们之前的劳动力成本和环境成本不应该是优势了。</p><blockquote><p>用国内消费取代外需和投资拉动经济成长的中国经济转型，既是应对全球金融危机和经济衰退的必要举措，也是建设国内和谐社会和可持续发展的内在要求。</p></blockquote><p>所以产能向哪里转移？怎么转移？</p><ol><li>可以推动他国市场内在趋势加速，但是不能改变内在趋势。（斯里兰卡、缅甸、巴基斯坦、孟加拉转移纺织化工。）</li><li>集中力量深度介入少数经济体的经济建设和国家发展。</li><li>对周边单个国家依赖最小化，并让他们对我们依赖最大化。</li><li>中国已有的确保有效的编辑产业链的资源：<ul><li>部分产业的控制权</li><li>技术资本积累</li><li>越来越大的本土市场规模</li><li>政府高调控管治能力</li><li>巨大国家资本积累</li><li>未来国际大国的国际信用</li></ul></li></ol><blockquote><p>新问题：当替他大国也拥有上述资源和条件时，并试图运用这些资源实现与我们目标抵牾的地缘经济政治构造时，会发生什么情况？如何应对？</p></blockquote><h2 id="第四章：外商直接投资与中国的经济安全">第四章：外商直接投资与中国的经济安全</h2><p>招商引资与<strong>缺口论</strong>：中国为什么要吸引外资？</p><ul><li>资金缺口论：缺钱。这是没有解释力的，不论是外汇还是储蓄。</li><li>技术缺口论：资金本身不是资本，只有资金与特定行业的技术、管理、营销能力结合在一起的时候才成为资本。但是仍没有解释力，技术并未转移。</li><li>制度缺口轮：中国对民营资本的歧视，而对外资无影响，形成外资对内资明显的竞争优势。</li></ul><blockquote><p>中国吸引外资并非政策成就，而是中国经济体制缺陷的症状表现。</p></blockquote><p><strong>渐变的外资政策</strong>：</p><ul><li>地缘上：点到线到面</li><li>行业上：出口加工到一般制造到服务业</li><li>引资方式：合资、合作、外资企业等方式</li><li>引资政策背后导向：进口替代到鼓励出口到促进产业结构升级和调整</li></ul><p><strong>外资的贡献</strong>：</p><ol><li>协助中国转变在全球分工中的角色。</li><li>帮助缓解就业和大城市挑战。</li><li>帮助积累外汇。</li><li>提升中国的技术能力和产业层次。<ul><li>竞争效应</li><li>示范模仿效应</li><li>联系效应</li><li>培训效应</li></ul></li></ol><h3 id="关于外资的争论：“恐外症”“崇外症”及其本质">关于外资的争论：“恐外症”“崇外症”及其本质</h3><p>本质是带有非理性的思维特征，对中国企业中国人的特质与潜能缺乏最起码的信心。谈论这个问题首先要搞清楚：“谁是外资”、“什么是国家经济安全”、“什么是垄断”。</p><p><strong>恐外症</strong>：</p><ul><li>中国外资依存度过高（考虑实际使用外资规模总额/GDP）<ul><li>我们只算了直接投资，算上间接投资的话，依赖程度并不高</li><li>压低人民币价格情况下计算的GDP是有问题的。</li><li>有根据的统计数据是外资的对外出口占中国出口量的比重。</li></ul></li><li>“斩首策略”：独资企业或者控股合资，进入市场时，将中方品牌束之高阁取而代之。<ul><li>市场的首席裁判员应该是价格而不是政治，被斩首说明产业出了问题。</li></ul></li><li>诉诸情感和道德而不是理性和法理。</li></ul><p><strong>崇外症</strong>：</p><ul><li>外资的优越性和价值被捧得太高，反过来支撑着这个优势。</li><li>对外资迷信的背后，是部分人不愿正视历史和现实，不愿向事实低头，不愿承认中国民营资本的实力和潜力。</li></ul><h3 id="外资政策的未来趋势及政治和战略潜力">外资政策的未来趋势及政治和战略潜力</h3><p><strong>未来的调整方向</strong>：</p><ul><li>取消外资超国民待遇</li><li>将国内市场吸引力而不是廉价要素作为吸引外国直接投资的核心竞争力：中国从全球生产基地转变为一个全球最大市场。</li><li>积极参与甚至推动国际多边投资规则的制定。</li><li>平衡的吸收外国直接投资和间接投资资金。</li></ul><p><strong>产业升级</strong>：</p><ul><li>产业升级难以靠外资实现，高价值就业机会是世界各国政府努力竞争、想尽办法留在本国的东西，在国际市场上本来就稀缺。</li><li>政府及其资本触角在推动中国产业赶超和升级过程中扮演了很重要的角色，但是不同行业中政策绩效存在明显差别。</li></ul><p>案例中的<strong>教益</strong>：</p><ul><li>面向家庭个人的消费品，向民营资本开放越早越彻底，创新能力越强。国企改革适合扮演财务投资者角色，从管资产到管资本。</li><li>中国最大的优势在于中国的市场规模。我们应该把产业发展的希望主要寄托在别国国民和家庭（而非政府）能主导的行业中。</li><li>政府官员要相信本国私人企业家的潜能和潜力，要意识到自己能力有限。政府需要做的是意识到哪些产业出现问题，哪些地方资源配置效率低，并为生产力提升打开空间。<strong>一个好政府的主要任务是，确保没有人能不劳而获，让人民都劳有所得。</strong></li></ul><h2 id="第五章：人民币汇率于人民币国际化">第五章：人民币汇率于人民币国际化</h2><h3 id="汇率的政治经济学">汇率的政治经济学</h3><p>一般观点：<strong>货币即是权力</strong>，即使是和平时期，金融业也是受制于政治需要的。</p><p><strong>不可能三角</strong>：</p><ul><li>资本流动、固定汇率、货币政策独立性三者不能同时成立。</li><li>固定汇率制度下财政政策有效，浮动汇率政策下货币政策有效。</li></ul><p><strong>不同立场的汇率偏好</strong>：</p><ul><li>出口海外投资型偏好汇率稳定，依靠国内市场的则更希望货币政策独立。</li><li>生产贸易品部门偏好固定汇率，生产非贸易品（金融业）部门偏爱浮动汇率。</li><li>中右翼政党更厌恶通货膨胀，左翼更关心失业率。</li><li>执政稳定政党汇率偏向弹性和高估（长远经济目标低通胀），执政不稳政党偏向干涉本币维持低估。</li></ul><h3 id="人民币汇率波动后的政治">人民币汇率波动后的政治</h3><p><strong>人民币汇率制度的改革</strong>：</p><ul><li>1981-1984：盯住一揽子货币，双轨制，汇率下跌，扶持出口。</li><li>1985-1993：双轨外汇制度，管理浮动，汇率持续下跌，恶化国内通胀。</li><li>1994-2005：盯住美元，汇率长期稳定，促进经济发展。但是前期合理后期僵化，入世后应做调整。</li><li>2005-2013：盯住一揽子货币浮动管理，目标维持出口和就业稳定减少顺差，对美元稳定升值，导致套利行为，助长本土资本泡沫。</li><li>2013之后：参照一揽子货币双向波动，从汇率干预中逐步淡出，目标从被全球流动性绑架的货币政策中解放出来，波动性扩大但是保持强势和稳定，有助于打击套利，热钱流入减少。</li></ul><p><strong>对应的政治</strong>：</p><ul><li>1972-1980：人民币高估不利于出口，贬值又会在非贸易项目吃亏，于是双轨制，贸易非贸易采用不同汇率。</li><li>1985之后：中央地方博弈，政府企业博弈，官方汇率和市场汇率并存。</li><li>1997 亚洲金融危机宣布不贬值，考虑国际形象和香港金融的稳定，同时当时外汇储备高，中央财政资源增强。这一行为奠定了中国在争取东亚地区领导地位的国家信用基础。</li><li>1998年之后盯住美元，不愿意恢复弹性，是在当下结构性失业背景下提出的。</li><li>2005年之后发现汇率低估不利于产业升级，所以开始稳步升值。</li></ul><h3 id="人民币国际化">人民币国际化</h3><blockquote><p>一个经济强国的货币在实现了自由兑换后，被其他国家接受，成为国际支付和处置手段，我们称这种货币为国际货币。</p></blockquote><p>人民币国际化的<strong>利弊</strong>衡量：</p><ul><li>好处：铸币税、节约外汇储备成本、降低汇率风险、扩大贸易投资、可以对外转移宏观经济风险。</li><li>负面代价和风险：<ul><li>低端产业挤出效应。</li><li>经济泡沫化风险（吸引巨量游资）。</li><li>放大汇率波动（大量流入流出）。</li><li>货币政策会收到海外存量货币的影响。</li></ul></li></ul><p>人民币国际化并不难，向外“送钱”即可。难的是让它的<strong>负面代价最小化</strong>。日本国际化就是我们的反面教训。</p><p>人民币国际化的<strong>机遇</strong>：</p><ol><li>2008年之后全球货币结构的动荡。</li><li>中国积累了足够的经济实力，且有良好的工业基础。</li><li>美欧亚并驾齐驱，但是在亚洲日元难堪重任。</li></ol><p>人民币国际化的进展：</p><ul><li>2012年人民币国际化指数0.56到15年3.91，18年4.84，在震荡中增长。</li><li>政府管制方式重大变化，顺应市场需求政革放权。</li><li>2013开始跨境结算支付规模上升，2017年下降至2012年来最低水平。</li><li>涉外部门统计和管理中人民币计价。</li><li>海外人民币清算行。</li><li>人民币跨境支付系统 CIPS。</li></ul><h3 id="人民币国际化和资本项目放开的政策辩论">人民币国际化和资本项目放开的政策辩论</h3><p>央行支持主张放开。一部分经济学家，包括社科院北大的学者提出批判质疑，反对放开。两者展开了辩论：</p><ol><li>从利弊上看：<ul><li>支持者认为放开的好处：<ul><li>更多融投资机会，优化资源配置</li><li>创造非政府部门资本流出途径，避免实体经济硬着陆</li><li>倒逼国内改革</li></ul></li><li>反对者的焦虑：<ul><li>资金外流对国内产业负面冲击</li></ul></li></ul></li><li>从开放和改革的顺序上看<ul><li>央行认为可以同步审慎进行</li><li>一部分学者认为先改革再开放</li></ul></li><li>开放倒逼改革的理念<ul><li>反对者认为以外促内风险性高，历史上不乏失败案例</li></ul></li><li>要不要公布开放时间表<ul><li>反对者认为给出开放时间表不如给出推动国内结构性改革时间表</li><li>支持者认为时间表有必要。因为开放的实际利益受损者是权力部门，让受损者制定开放的方案推动起来会很难</li></ul></li></ol><p>辩论的<strong>三个特点</strong>：</p><ol><li>对风险的认知和态度存在很大差异。</li><li>双方都是列举归纳，缺乏整体主义视角。不完全归纳无法说服对方。需要有整体视角，用演绎法而不是归纳法。</li><li>双方对“应然”和“实然”的侧重。</li></ol><h3 id="国际化的条件和战略">国际化的条件和战略</h3><p>阶段：</p><ol><li>区域性国际化，东亚与部分发展中国家展开。</li><li>成为国际金融活动媒介和国际金融资产。可以使用美元当年“先挂钩后脱钩”的策略来获取信心。</li></ol><p>步骤：</p><ol><li>国内多层次资本市场和银行体系改革</li><li>升级产业结构和提高技术能力</li><li>全球资产投资和并购渠道的建设</li></ol><h2 id="第六章：外汇管理政策与外汇储备">第六章：外汇管理政策与外汇储备</h2><p><strong>外汇储备实际上是替外资保管的金银细软</strong>。但是也是一种前所未有的对外政策工具，政治上实现了“金融恐怖平衡”，大大弥补了中国整体国力尤其是军事能力方面的弱势。</p><h3 id="外汇管理制度的改革与储备的形成">外汇管理制度的改革与储备的形成</h3><blockquote><p>外汇储备：当局（不包含民间）能够有效控制并可随时动用的对外资产。</p></blockquote><p>中国的外汇储备是在“强制结售汇政策”，“银行外汇周转头寸限制”，“盯住美元汇率政策”三位一体的制度安排下形成的。以10%的复合收益率估算，我们外汇储备规模远远小于外资在中国经济体内部的资产积累。</p><p><strong>之后外资撤出大量挤兑时怎么办？</strong>市场有风险，买卖自愿，人民币可以接受一定程度的本币贬值。</p><h3 id="外汇储备的经济含义">外汇储备的经济含义</h3><ol><li><strong>为什么</strong>要积累巨额外汇储备？<ul><li>底部贸易赤字、保证偿付的外汇需求、维护汇率稳定、灾难时的战略储备。</li></ul></li><li>到底应该<strong>如何看待</strong>中国的外汇储备？<ul><li>外汇储备的高速不平衡增长源于国内金融体系的功能缺陷，效率低下，无法将储蓄转化为有效投资。</li><li>只要我国国内金融体系与国际金融体系存在较大的效率差异，我国就只能通过这种“体外”资本循环方式支持国内经济增长。</li><li>导致了巨大的机会成本</li></ul></li><li>中国积累多少外汇储备合适？外储如何实现<strong>保值升值</strong>？<ul><li>维持正常的需求，7000亿之内。</li><li>国债投资转为优质企业股权投资（例如淡马锡、阿布扎比投资局、挪威养老基金）。</li></ul></li><li>如何<strong>控制</strong>外汇储备的过度增长？<ul><li>改善国内金融市场，民间金融合法化</li><li>拓宽对外直接投资的空间</li><li>加大人民币汇率弹性，减少游资套利空间</li></ul></li></ol><h3 id="外汇储备与“中国-美国”">外汇储备与“中国-美国”</h3><p>中国明知持有的美元存在贬值倾向，但是不能卖出，因为如果卖出美元，那么美元将出现恐慌性贬值，导致自己手中剩余的美元资产缩水。中国所能做的就是与美国政府谈判，警告他们不要做出背叛的行为，否则两败俱伤。</p><blockquote><p><strong>金融恐怖平衡</strong>：我们（美国）依赖的是他国不对美国赤字融资所需偿付的代价，（也即）他国一旦停止融资需要偿付的代价（是如此之大），确保了他国将继续融资。</p></blockquote><p>中美之间数十年相对成熟稳定的主要原因是因为存在“核恐怖平衡”和“金融恐怖平衡”。平衡中中国处于相对弱势。随着中国新世纪出口多元化，对美依赖减轻，谈判地位强弱之势悄然异位。</p><p>中国意识到这种关系不可持续，所以逐步从“三外路线”循环中脱离。中美关系少了重要的稳定器，如何维持一个较低成本的可持续和平环境？并且全球经常项目和资本项目顺差在中国周边大规模聚集是存在安全和政治前提的，就是东亚和平与稳定。</p><blockquote><p>由于美国目前仍然主导着东亚地区的和平与安全格局，那就潜在的出现了一个巨大的套利机会：跳起某个地区性的冲突并放手升级之，结果将是东亚资本的极速外逃，美国的融资问题一夜间获得解决，尽管这是一种杀鸡取卵的不可持续的解决方法。</p></blockquote><h3 id="储备多元化及其政策后果">储备多元化及其政策后果</h3><p>中国持有大量美元，但其实是美元的<strong>空头</strong>，而不是多头。华尔街跟庄，中国外汇储备增大时，他们就做空美元做多欧元，减小时就相反。那常识为什么错了？外管局结售汇过程中收入的资产重新配置为美元资产和非美元资产。就是买入外汇资金然后配置。买入端美元比例极高（例如80:20）（由于美元可获得性高），然后配置时比例（50:50），其实是在卖出美元，买入非美货币。所以当资产配置在美元上绝对数目多时，其实已经售出了大量的美元。</p><p>作为美元的空头，中国外汇储备面临何种风险？当然是美元上升周期。</p><ul><li>外汇储备名义价值下降，欧日元资产贬值。</li><li>金融系统投入矿业和原油的信贷将面临风险。</li><li>不能陷入被逼空的状态。</li></ul><p><strong>美元的上行一般由以下因素驱动</strong>：</p><ul><li>美国经济领先于日欧复苏</li><li>失业率下跌到6.5%以下</li><li>美国能源独立导致逆差减少</li><li>中国因素（空头力量其实在衰减）</li></ul><p>被<strong>全面逼空</strong>的前提条件：</p><ol><li>美元超级强势周期</li><li>巨额资本逃离</li><li>出现新制造业大国</li><li>国内通胀高企，人民币没有贬值空间</li><li>中国产业转型面临失败</li></ol><h2 id="第七章：中国对外资本输出">第七章：中国对外资本输出</h2><p>中国正在从一个（产业）资本净输入国变成净输出国。</p><h3 id="中国企业“走出去”">中国企业“走出去”</h3><p>中国企业“走出去”对提升巩固中国在世界市场体系中的地位具有重大意义。政府也改革投资体制，鼓励本地企业国际直接投资。</p><p>“走出去”的<strong>动机</strong>：</p><ul><li>获得市场</li><li>获得外部生产要素：能源、原材料、技术、研发能力、品牌</li><li>往返程投资：打扮成外资回归</li></ul><p>“走出去”的<strong>问题和挑战</strong>：</p><ul><li>国有企业的体制问题：监管不到位容易贪污和资本外逃</li><li>民营企业融资担保和保险问题</li><li>企业和个人要在行为方式上严格约束自己，要合规合法道德</li><li>企业对外直接投资的政策体系和服务体系不完善</li></ul><p>自主品牌国际推广过程为<strong>中国国际公关提供政策杠杆</strong>：成为西方媒体的大客户，则会拥有对他们施加压力的重要杠杆，他们在报道中国的时候会有所顾忌。</p><h3 id="中国资本输出的现状和未来">中国资本输出的现状和未来</h3><p>输出的现状：</p><ul><li>1978-2000：建立经济特区吸引资本</li><li>2001-2012：加入 WTO 引入输出并重，央企海外并购</li><li>2013-至今：输出为主，兼顾引入</li></ul><p>输出的<strong>主体</strong>：</p><ul><li>国有企业为主：效率低下，动机模糊，意识形态上被怀疑</li><li>民营企业很少：天赋惊人，家族地缘为基础信用网络融资，但是目光短视</li></ul><p><strong>战略方向和地缘空间</strong>：</p><ul><li>金砖体系、一带一路</li><li>西南西北产业聚集带</li><li>西部大开发升级</li></ul><h2 id="第八章：国际投资规则的制定权争夺">第八章：国际投资规则的制定权争夺</h2><h3 id="主权财富基金的发展及其投资规则之争">主权财富基金的发展及其投资规则之争</h3><p>主权财富基金是一种政府金融投资工具。与外汇储备不同，它偏好更高收益率。从资金来源看，主权财富基金可以分为三类：</p><ul><li>贸易外汇盈余</li><li>资源出口外汇盈余</li><li>国际援助</li></ul><p>2007年开始，西方政界开始担心主权投资中钱的所有者之意图和潜能，担心出于政治和战略目的而不是商业盈利目的的大规模买卖。所以下方一直主张制定一些“国际制度”来约束我们。<strong>西方国家一方面想要这个资金，另一方面又害怕金融核武器。</strong>目前来看，国际新规者制定主导权基本掌握在美欧手中。但是其实美欧之间，各大经济体内部也存在分歧。但是仍有一些<strong>共同诉求</strong>：</p><ul><li>通过非正式国际立法来约束和规范主权基金，并将规则的制定权和监督过程掌握在美欧控制的 IMF 和 OECD 手中。</li><li>从道义上贬低、法律上禁止实践中防范各国主权基金出于政治与安全动机的投资行为。</li><li>要求主权基金提高透明度。</li><li>在此前提下，维持各国资本市场的开放。</li></ul><p>于是美欧采取了一些明确的策略和措施：</p><ol><li>以美欧主导的多边经济组织作为工具，制定规则，拉拢引诱世界各国接受作为未来谈判的基础。</li><li>制造国际舆论并炒作形成国际共识</li><li>分而治之，压迫小国主权基金满足规范，塑造国际惯例。</li></ol><blockquote><p>我们在贸易、裁军、气候变迁等各种全球治理问题谈判中，已经反复得到如下经验和教训：参与到国际规则的制定中是维护国家利益的第一步，也往往是最关键的一步。</p></blockquote><p><strong>中方立场</strong>：</p><ol><li>鼓励而不是禁止出于政治目的的投资</li><li>提高透明度应该是在坚持联系原则和自主原则两大基本前提下进行。</li><li>维持美欧资本市场开放下是对主权基金东道国的合理补偿，也是维持全球金融经济秩序稳定可持续的基本前提。</li></ol><p>当越来越多的资产和股权被划为非卖品的时候，他们所支撑的货币将会不可挽回的越来越疲软。</p><h3 id="当前谈判地位和可选策略">当前谈判地位和可选策略</h3><p>当前逆来顺受，被动妥协。</p><p>措施和策略：</p><ol><li>搞一个功能性同盟，把有共同利益的国家拉到一起，成立一个新的投资者俱乐部。团结有大量资本的依附性小国。</li><li>扶持急需外来投资的中小国，塑造我们的国际惯例。</li><li>自主研讨会，探讨全球主权基金投资规则。</li><li>假如能团结几大主权基金，则在谈判桌上能制定有利于资方的规则。</li></ol><h3 id="国际投资法与中国的选择">国际投资法与中国的选择</h3><p>世界范围<strong>投资法的发展</strong>：</p><ul><li>多边国际投资法尝试，但是普遍失败</li><li>双边投资条约的发展</li></ul><p>中国处于一个吸收投资和资本输出的双重身份中。但是大背景是投资规模会超过吸纳投资：所以中国新世纪以来的投资协定，采纳了类似美式范本的高标准投资保护机制。</p><h2 id="第九章：超越“能源安全”">第九章：超越“能源安全”</h2><p>不论是从人均还是未来前景看，中国都缺能源。国际能源炒家以能源安全剥削中国。但是高油价也许并非坏事，中国进口量远小于体系中央国家。如果油价使中央财富流向边缘，那么可以通过对边缘国家的出口把钱赚回来。所以要跳出有人营造的恐慌情绪，跳出那些直接的局部的利益得失，才能冷静的全面辩证看待能源在中国国家战略中的意义。</p><h3 id="能源问题的若干基本常识">能源问题的若干<strong>基本常识</strong></h3><ol><li>能源生产消费在地域分布上严重失衡。</li><li>能源结构走向多元化，化石能源仍是主体。</li><li>能源是世界上贸易规模最大的大宗商品。</li><li>能源问题被高度政治化。</li></ol><h3 id="中国的能源安全">中国的能源安全</h3><p>什么是能源安全？狭义：可以安全供应，是可以充分稳定经济的获取发展所需要的能源。</p><p>中国的能源安全可以分解为<strong>四个环节</strong>：</p><ol><li>能源供给安全：有时是非卖品，所以需要同时使用市场和外交两种手段</li><li>能源价格安全：并不是越廉价越好</li><li>能源运输安全：防范被截断</li><li>能源消费安全：环境气候危害</li></ol><p>中国的能源缺口是常见的夸大之处，其实缺口不大，有时甚至供大于求。能源安全运输也被夸大，马六甲海峡其实可以替代。</p><h3 id="高油价利于中国崛起">高油价利于中国崛起</h3><blockquote><p>为了中国整体国家利益的最大化，中国在适当的时候有必要托起石油价格。</p></blockquote><ol><li>较高油价可以维持有利于中国的全球战略平衡。<ul><li>我们希望确保美国在任何时候都无法集中足够的力量、意志和盟友资源对华实施战略摊牌。</li><li>能源价格越高，中东地区财政力量越强，越有能力为美国及其盟友制造麻烦。</li><li>如果能源价格暴跌，很多国家包括俄罗斯都会陷入财政困境。</li></ul></li><li>托举油价在经济上也是合算的<ul><li>油价维持较高位置，有利于中国扩大对外围体系国家出口投资，将托市成本赚回来。</li><li>适度托举油价有利于提升中国在国际能源市场上的定价权。</li><li>拥有巨额石油储备之后，可以避免逼空。</li></ul></li><li>熨平能源价格波动是大国的国际责任<ul><li>帮助发展中国家应对能源诅咒</li><li>我们的战略储备基地已经竣工</li></ul></li></ol><h2 id="第十章：原材料市场中国的定价权">第十章：原材料市场中国的定价权</h2><h3 id="原材料市场的三个关键问题">原材料市场的三个关键问题</h3><ol><li>市场结构与定价权。即便我们在生产规模和莫呕血消费规模上是最大的，但是如果市场分散无序，在国际市场上仍不会有定价权。所以对国内市场整合，用国内的联合协作对付国际上跨国公司的联合垄断，才能扭转地位。</li><li>资源配置到底应该以价格还是权力为杠杆？以价格为杠杆可以让整体福利和效率最大化。但是国际市场非充分开放。中国应该用现实主义确保自己的安全利益，再用理想主义去推动开放。</li><li>资源能源与金融和货币关系。一个国家在拥有国际影响力的大宗交易产品市场，那么该国在争夺相关商品全球定价权时便获得了不可小视的技术型便利。</li></ol><h3 id="开放经济环境下的中国粮食安全">开放经济环境下的中国粮食安全</h3><p>粮食具有作为重要战略资源的政治经济特性。其需求刚性生产周期性，价格弹性小。</p><blockquote><p>当前分工：外围国家从美国及其盟友进口粮食，自己则专门生产经济作物。当年管仲所用的战略模式，今天在体系大国和外围小国之间悄悄重演。</p></blockquote><p>对中国人来说，中国人什么都吃，是这个民族历史上所受苦难的遗迹和明证。目前来看，从供求关系来看，中国粮食自给有余，基本平衡；从战略态势来看，中国是在勉强防守，态势堪忧。</p><p>当前的平衡能维持，是因为中央政府比较富裕。如果不能维持，则要内部深度挖掘潜力，等待人口总量下降。但是未来三十年，我们<strong>通过内部挖潜维持平衡的难度将越来越大</strong>：</p><ol><li>人民币汇率上涨，粮食美元计价成本高，维持粮食产量则需要增大补贴（杠杆成倍放大补贴）。</li><li>工业化城市化，精耕细作失去其劳动力基础。</li><li>水资源匮乏限制粮食增长。</li></ol><p><strong>对于全球粮食格局的三个基本判断</strong>：</p><ol><li>全球人口增加将为粮食安全带来巨大挑战，为美国国家权势反弹埋下伏笔。</li><li>世界不缺耕地，也不缺潜能，缺的是耕地与高科技农业劳动力的错配。</li><li>粮食安全不能单纯依赖市场，必须有大国出来平抑粮价。</li></ol><p>中国未来粮食安全的长期<strong>解决出路</strong>是大规模农业资本输出：</p><ol><li>政府出面包租购买土地。出资本管理技术，粮食按比例分成。</li><li>合同由政府签，经营由市场吸引国内农业企业承包。</li><li>控制中方农技人员数量与东道国结合。</li><li>中方企业粮食分成由中国官方投资机构保价收购，返销国内，或者在其他地区建立储备库用于平抑波动。</li><li>国内建立更大规模粮食储备能力。</li></ol><h3 id="疯狂的石头：铁矿石进口及其谈判">疯狂的石头：铁矿石进口及其谈判</h3><p>乌克兰中国铁矿石储量大，但是贫矿多富矿少，含铁量低。从铁产量上来看，澳大利亚和巴西是最主要的两个铁矿石生产大国。世界最大的铁矿石厂商位于巴西的淡水河谷，86亿吨高品位铁矿石储量。铁矿石主要进口方是中日韩欧。</p><p>在铁矿石价格谈判中，中方2003年开始参与。宝钢作为代表参与谈判。宝钢在谈判中没有考虑到其他钢企的利益。2009年宝钢退出谈判，中钢协接手。他们站在维护国家整体利益的立场谈判，“宁可谈判破裂也不妥协”，但是对于企业实际需求和市场谈判经验不足。2010年，宝钢重新占据谈判主导权。2012年初，铁矿石现货交易平台启动。2012年以来进口地区经济增长放缓，铁矿石产量却屡创新高，价格走低，转变为买方市场。2014年，我国开始涉足铁矿石期货的金融服务，旨在推动人名币计价、清算和结算铁矿石，是金融市场的创新，也满足实体经济套期保值的需求。</p><p>中国决策者意识到美元存款的不可靠和矿藏价格低迷的机遇。于是鼓励国企央企走出国门收购海外矿山资源。2009中国铝业收购力拓赔了夫人又折兵。五矿收购 OZ Minerals 旗下核心资产则获得良好收益。</p><p>有专家认为，如果要改善目前处境则需要在内部贸易和公平性下功夫，改变国内钢企一盘散沙的局面。也有学者提出取消钢铁产品出口退税。</p><h3 id="稀土">稀土</h3><p>我国稀土储量占全球71.1%，产量95%。却不能像石油和铁矿一样控制全球价格，这是因为企业互相杀价，导致价格低位运行。（其实国外也有大量的未开采稀土矿，因为其相对于中国稀土不经济所以仍未开采。）</p><p>中国政府试图实现稀土行业全行业整合。2009年对我国储量产量第一的三种矿保护性开采。并鼓励企业走出去收购国际重要稀土矿资源。对保护性开采，西方国家强烈反对。但是这并没有违背国际贸易准则，且符合国际惯例。</p><blockquote><p>联合国《建立新的国际秩序宣言》：每个国家对自己的自然资源和一切经济活动拥有充分的永久主权。为了保卫这些资源，每个国家都有权采取适合自己的手段，对本国资源及其开发实行有效控制…任何一国都不应遭受经济、政治或其他形式的协迫，以致不能自由地和充分地行使这一不容剥夺的权利。</p></blockquote><p>中国稀土政策的若干选项：</p><ol><li>提高关税，控制出口配额：有利于内外价差，和新能源产业的先手。</li><li>对矿企征收高额环境税和资源税：利益留在中国，抬高全球价格，但是没有保护国内科技企业利益。</li><li>稀土金融化、货币化、储备化（像黄金一样）：财富增值，但是降低其使用价值。</li></ol><h2 id="第十一章：中国的对外援助">第十一章：中国的对外援助</h2><h3 id="中国援外的历史和现实">中国援外的历史和现实</h3><ol><li>新中国成立后30年：<ul><li>中国对外经济技术援助八项原则</li><li>大力援外并不是过度承担国际义务，影响自身发展，而要与当时冷战的背景结合理解。（但是这里也没说怎么理解。）</li><li>第一代领导人，世界革命的背景</li><li>谋势，用较小成本获得国家声望</li></ul></li><li>“三外路线”下的援外<ul><li>随着人民币贬值，受援国感到援助力度减小</li><li>自身经济扩张，援助占本国财政份额下降</li><li>第二代领导人，优先本国经济发展</li><li>无偿援助变贴息贷款，大型项目变中小型项目等</li><li>谋利，不求改变体系而是融入体系</li></ul></li><li>援外工作新高潮<ul><li>为了确保能源原材料供给，重新活跃</li><li>与西方国家口惠而不实形成对比</li><li>强调双赢</li><li>美欧认为中国援助：<ul><li>涉及一些对专制政权的援助</li><li>不干涉内政不利于改善全球治理水平</li><li>利用援助做为争夺原材料的辅助手段</li><li>很少雇佣当地人，不利于当地经济发展</li></ul></li></ul></li></ol><h3 id="构建中国特色援外理论">构建中国特色援外理论</h3><p>自利利人的<strong>审慎道德</strong>原则：重塑对外援助的政治伦理基础</p><ul><li>援助宣传中的道德主义是一种陷阱，大家的援助都被诟病的原因在于，大家普遍使用很高的道德标准来要求和评价援助行为。</li><li>援助和意识形态的捆绑，无益于国家间的稳定和良性互动。</li><li>国家的对外援助不是慈善活动，而是理性的广义的国家利益拓展的需要。</li><li>审慎性道德准则：用人的标准来要求而不是神的标准来要求人，不通过损害他人以自利。</li><li>审慎道德标准低调可行可持续。</li><li>中国援助行为的特点：心理上平等，事理上互利。</li><li>中国人明白：对于落后者而言，尊严往往比五斗米更值得珍惜。</li></ul><p>在符合审慎道德原则下，<strong>国际援助的必要性</strong>：</p><ol><li>增进国家人民间信任友谊和认同，利于体系持久和平。</li><li>有殖民原罪的国家，有义务提供援助：假如先辈犯罪而获得好处至今仍为当代人享用，那么赎罪是援助不单是消除负罪感，更是一种政治和道德的必须。</li><li>全球市场中心的大国，发达国家从风险收益不对称获利巨大，代价由外围国家承担，补贴外围国家是平衡体系内生的不公平。</li><li>贫困和混乱会溢出到其他国家和地区，影响富国的长期利益。</li></ol><p>干涉与良治：援助中的主权问题：</p><ul><li>用财力逼他人就范，实际也是一种专制</li><li>任何人手中都不拥有绝对真理</li><li>在一国经济技术水平和社会结构非常落后情况下，强求发展民主可能是拔苗助长的做法。</li><li>援助者不应随意对他国家庭内部事务发表见解。</li></ul><h3 id="改进中国的援外政策">改进中国的援外政策</h3><ol><li>重视人的作用<ul><li>争取当地民心，不能只惠政府</li><li>重视人员交流，服务民生</li></ul></li><li>改革援外决策和管理机制<ul><li>缺乏协调统一的高于各部委的决策部门</li><li>随意性较大缺乏论证</li><li>权利竞争，责任推诿</li><li>未纳入法制化轨道</li><li>企业和非政府组织的高效对外援助还有很大空间</li><li>应该争取本国民众理解</li></ul></li><li>集中援助树“典型”<ul><li>“撒胡椒面”难以产生强大的初始动能</li><li>评估上来说如果该国更依赖中国市场而不是中国政府，则援助成功</li><li>对其他国家对华政策产生诱导作用</li><li>安哥拉模式就是很好的例子</li></ul></li><li>援外和资本输出结合<ul><li>形成合力，良性循环</li><li>滚动发展，使对外援助在中国内部具有经济效益上的可持续</li><li>这种援助某种意义是一种投资</li><li>在和美元脱钩后，我们需要使对外援助在中国对外经济关系中具有不可替代性，要让其真实成本降低。</li><li>援助形成的友好氛围，基础设施可以为投资创造条件和抬高收益率</li><li>土地矿权股权有获得资本增值机会</li><li>金融危机救援，救急不救穷，别人做不了的事情往往最有利可图</li></ul></li><li>改进对援外事物的宣传<ul><li>拿出少量美元储备以贷款方式援助是出于对国家利益的整体长远考虑</li><li>民众认为政府拿着本来属于自己的财富白送给别人，这反映出：<ol><li>货币知识的缺失：美元不能用在国内，不用掉只能躺在美元债券，不能支付国内贫困学生的学费或者为苦难群众造房子。</li><li>民生问题关注度高</li><li>宣传技巧有进一步提升空间</li></ol></li></ul></li></ol><h2 id="第十二章：结论：中国对外经济关系的潜能和风险">第十二章：结论：中国对外经济关系的潜能和风险</h2><h3 id="关于两组关系的探讨">关于两组关系的探讨</h3><ol><li>国家与市场间的关系<ul><li>国家很重要，但是如果光靠国家控制，没有市场来配置资源，那么经济必然缺乏活力，最终国家力量也会衰竭。市场的确很高效，但是离开了国家力量的规范和约束，市场秩序和市场结构难以自我维持。</li><li>为了在全球市场获取超额利润，内部非市场化往往是一种必须，有选择有分寸的搞些政府管制，尽管会不可避免的导致资源配置效率损失，但是由于这种管制获得了外部博弈的优势，那么超额利润可能足够弥补内部损失。</li></ul></li><li>中国与体系间的关系<ul><li>哪个国家越能够全面彻底有效地把人类整合到全球性的交易分工和要素流动中来，就越能得到“天命”的资助。（世界市场体系对各地区各文明的吞噬消化和整合。）</li><li>我们将用什么办法来实现比美国时代更加全面深入有效的整合全球的经济要素？</li><li>我们如何在主导权更替的过程中尽可能实现和平禅让而不是物理决斗？</li></ul></li></ol><h3 id="“三外路线”是否可以向外围国家推广">“三外路线”是否可以向外围国家推广</h3><ol><li>“三外路线”的<strong>普适性</strong>：<ul><li>体系外围国家：资本缺乏，工业技术能力落后，层次较低，人才匮乏，制度落后，国内治理混乱。互为因果互相牵制。</li><li>三外路线使中国一下子摆脱了资本匮乏，也让其他方面逐步改善。同时快虚积累外汇储备，增强了抵御系统性风险的能力。</li><li>三位路线可以看成一种融资模式，向他国（产业资本）融资，向未来融资，从而在特定地域和时间点上集中足够密集的资本规模，实现发展的突破，开启发展的正循环。</li></ul></li><li>“三外路线”的<strong>推广</strong>：<ul><li>向一部分发展中国家推荐，对中国有以下好处：加速产业升级和对外转移趋势，减少美欧贸易顺差但是不会损减整体福利，出口数量损失换来的是质量提升，在国家间形成不对称依赖，符合人民币国际化内在需求。</li><li>美欧应该不会反对此路线</li><li>适用性前提：<ol><li>资源富集劳动力匮乏就不适用</li><li>要求政府对社会有很强的渗透控制能力</li><li>出口加工工业的地理要求</li><li>民族文化对勤劳节俭的鼓励（较容易改变，例如70年代被认为懒惰，90年代勤奋。）</li><li>竟然制度变迁可以大幅度改造中国民众的生活方式，为什么对非洲或者其他地区人民持悲观态度呢？</li><li>时机问题，目前中国资源密集型产业向外转移</li></ol></li></ul></li></ol><h3 id="中国对外经济关系战略潜能">中国对外经济关系战略潜能</h3><blockquote><p>中国已积累了罕见的经济实力，但是执政者还不善于用这种实力寻求国际抱负。</p></blockquote><p><strong>对各章探讨的对外经济关系各个方面潜能加以总结</strong>：</p><ol><li>参与国际经济分工时，可以使用自身各方面优势塑造周边中小国对中国的不对称依赖。</li><li>集中了世界最大的外汇官方储备可以通过耐心大胆巧妙的长期投资把手中外汇变成世界主要跨国企业的控制权，形成网络化的非正式权力。</li><li>推动人民币国际化，修正货币格局，让东亚在世界经济体系获得更有利的位置，并对美国国际权势基础形成瓦解作用。</li><li>中国企业走出去创建品牌的时候，中国的外宣系统应当加以支持和利用，获得世界各地主流媒体的影响力。</li><li>借助自身资金和市场规模，应该有选择的调控全球基础原材料的价格，拥有部分定价权。</li><li>对外援助和资本输出结合起来，在体系外围国家扮演金融和货币危机救援者的角色，形成中国援助品牌。</li></ol><p><strong>这些构想的实现需要中国的决策和执行体系做必要的改革，尤其是将对外经济事务同涉外政治事务之间的制度性藩篱消除掉。</strong>比较现实的政策建议，通过边际性改革促进对外战略和对外经济政策之间实现若干功能性的结合。</p><h3 id="对外经济关系的风险">对外经济关系的<strong>风险</strong></h3><p><strong>2010-2020:</strong></p><ol><li>货币政策与泡沫化风险：<ul><li>这里不是说价格高得让人难以理解就是泡沫，而是符合某种特点的价格运动过程。（自我增长自我毁灭的循环。）</li><li>外资的投资行为，造成了人民币升值的事实，又使外资“理性决策”，继续投资。</li></ul></li><li>全球化退潮风险</li><li>对外投资效率风险<ul><li>国有企业体制缺陷，对人激励约束不充分</li><li>民营企业规模小，资本有限</li></ul></li></ol><p><strong>2020-2030:</strong></p><ol><li>逆全球化纵深发展，中美经济持续脱钩，并各自组团将全球市场再次变成相互平行而竞争的两个体系。</li><li>美国国内的债务周期将迎来巨幅调整阶段。<ul><li>2021年前后巨额的债券到期，借新还旧不可持续成本提高，除非大幅降息。</li></ul></li><li>一带一路面临的挑战，没有很好的回答以下问题：<ul><li>发展中国家缺什么发展不起来？<ul><li>可能并不是钱，而是现代主权国家治理能力和治理体系。</li></ul></li><li>我们通过一带一路究竟在追求什么要素？<ul><li>不是能源资源，甚至也不是劳动力，而是<strong>巨量年轻消费者</strong>。</li></ul></li><li>当发展中国家还不起债的时候，我们如何追求回报？</li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
      <tag>翟东升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>代理模型辅助的演化计算</title>
    <link href="/paper-reading/surrogate/"/>
    <url>/paper-reading/surrogate/</url>
    
    <content type="html"><![CDATA[<p>本文是对 Surrogate-assisted evolutionary computation: Recent advances and future challenges 这篇综述的阅读笔记。这是一篇发表于2011年的关于在演化计算中如何应用辅助模型的综述。</p><span id="more"></span><h2 id="前言">前言</h2><p>绝大部分的演化计算都假设存在一个可以为每一个个体提供 fitness value 的手段，或是模拟，或是实验，或是一个显式的 fitness function。但是有的时候，这个 fitness 的评估是非平凡的，例如当模拟或实验需要消耗大量成本。此时通过使用代理模型的演化计算方法来减少昂贵问题上使用演化计算时间成本。</p><p>代理模型往往和真实的 fitness function 一起使用，以防演化计算被误引入代理模型提供的错误最优。当问题越高维度，代理模型的构建难度就越大。</p><h2 id="代理模型的策略">代理模型的策略</h2><blockquote><p>No analytical fitness function exists for accurately evaluating the fitness of a candidate solution.Instead, there are only more accurate and less accurate fitness estimation methods, which often trade off accuracy with computational costs.</p></blockquote><p>使用代理模型也需要权衡模型的效率和保真度。最初，一部分工作完全依赖代理模型进行演化搜索，但是代理模型引入的可能并不存在的最优会带来严重的问题。代理模型几乎可以用在所有的演化计算步骤中来剔除差的结果，并且减少随机性：population initialization, cross-over, mutation, local search and fitness evaluations。</p><p>根据代理模型的使用对象进行不同，可以将代理模型方法分类可以分为以下三类：</p><ul><li>Generalization based:<ul><li>surrogates are used for fitness evaluations in some of the generations, while in the rest of the generations, the real fitness function is used</li></ul></li><li>Individual based:<ul><li>the real-fitness function is used for fitness evaluations for some of the individuals in a generation</li></ul></li><li>Population based:<ul><li>more than one subpopulation co-evolves, each using its own surrogate for fitness evaluations. Migration of individuals from one sub-population to another is allowed.</li></ul></li></ul><hr><h2 id="单代理模型">单代理模型</h2><p>我们假设与真实 fitness 函数交互费时，希望尽可能减少与真实函数交互。那么关键的问题就在于如何确定哪个个体是应该被重新评估的。我们需要考虑到以下三个方面。</p><h3 id="1-选取重评估样本的标准">1. 选取重评估样本的标准</h3><p>不得不说这些选取的方式和<strong>主动学习</strong>极度相似。选取具有以下特征的样本评估:</p><ul><li>potentially have a good fitness value</li><li>representative</li><li>large degree of uncertainty in approximation<ul><li>fitness landscape around these solutions has not been well explored</li><li>improve the approximation accuracy of the surrogate,</li></ul></li></ul><p>如何描述或者估计这种不确定性或者错误呢？</p><ul><li>uncertainty is roughly set to be inversely proportional to the average distance to the closest data samples</li><li>estimating the variance of the individual estimates given by an ensemble of surrogates</li></ul><h3 id="2-如何评估代理模型的好坏">2. 如何评估代理模型的好坏</h3><p>首先代理模型并不是需要严格和 fitness function 相同才可以发挥作用，在存在较大的预测错误时同样可以起到作用，如下图所示。</p><div style="width:90%;margin:auto"><img src="/paper-reading/surrogate/surrogate-error.png" class=""></div><p>一些常用的度量：</p><ul><li>mean squared error between the individual’s real fitness value and the predicted fitness</li><li>the number of individuals that have been selected correctly using the surrogate</li><li>the rank of the selected individuals, calculated based on the real fitness function.</li><li>rank correlation: measure for the monotonic relation between the ranks of two variables</li><li>continuous correlation between the surrogate and the original fitness function.</li></ul><h3 id="3-提升预测的准确性">3. 提升预测的准确性</h3><ul><li>神经网络的正则化</li><li>随着搜索更新模型</li><li>建立一个地位的搜索空间</li><li>评估时利用生成的中间数据</li></ul><hr><h2 id="多代理模型">多代理模型</h2><p>模型类别可能不同，模型保真度（fidelity）可能不同。此处根据对 fidelity 的掌控把多代理模型分为两类，同质（homogeneous）和异质（heterogeneous）多代理模型。</p><blockquote><p>By homogeneous multiple surrogates, the fidelity of the surrogates are not explicitly controlled, even if different types of surrogates are used.</p><p>On the contrary, heterogeneous surrogates vary in their fidelity due to an explicit control in model complexity or training data.</p></blockquote><ul><li>同质（homogeneous）多代理模型<ul><li>多个模型可以提升预测质量，也可以帮助识别较大的预测错误。</li><li>其经验有效性在多篇工作中得到证实。</li></ul></li><li>异质（heterogeneous）多代理模型<ul><li>其实是组合了一些列不同粒度的代理模型。</li><li>这类工作提出的背景也是训练不同粒度的代理模型会有不同的成本，粒度越低成本越低。</li></ul></li></ul><hr><h2 id="在昂贵问题之外更多的考虑">在昂贵问题之外更多的考虑</h2><ol><li>Surrogates in interactive evolutionary computation</li><li>Surrogated-assisted evolution for solving dynamic optimization</li><li>Surrogates for robust optimization</li><li>Surrogates for constrained optimization</li></ol><h2 id="实际应用">实际应用</h2><p>代理模型的方法更多的是应用驱动。</p><blockquote><p>One intensively researched area is surrogate-assisted design optimization, such as turbine blades, airfoils, forging, vehicle crash tests, multi-processor systems-on-chip design and injection systems. Other applications include drug design, protein design, hydroinformatics and evolutionary robotics.</p></blockquote><h2 id="未来挑战">未来挑战</h2><ol><li>Theoretic work</li><li>Multi-level, multi-fidelity heterogeneous surrogates</li><li>Surrogate-assisted combinatorial optimization</li><li>Surrogate-assisted dynamic optimization</li><li>Rigorous benchmarking and test problems</li></ol>]]></content>
    
    
    <categories>
      
      <category>Paper Reading</category>
      
    </categories>
    
    
    <tags>
      
      <tag>EA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vim 常用功能记录</title>
    <link href="/programming/vim/"/>
    <url>/programming/vim/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>Vim 是一款文本编辑器。说来惭愧，自己在日常使用中并不熟练，于是此处记录一些有需求的功能，便于查阅。</p><span id="more"></span><h2 id="四种模式">四种模式</h2><ul><li>正常模式：<code>&lt;ESC&gt;</code></li><li>命令模式：<code>:</code> or <code>/</code></li><li>插入模式：<code>i</code> or <code>a</code> or <code>o</code>（new line）</li><li>可视模式：<code>v, V, &lt;Ctrl&gt;+v</code></li></ul><h2 id="正常模式下常用命令">正常模式下常用命令</h2><p>基本：</p><ul><li>保存退出：<code>:wq</code> or <code>ZZ</code></li><li>不保存退出：<code>:q!</code> or <code>:qa!</code></li><li>光标位置和文件信息：<code>&lt;Ctrl&gt;+g</code></li><li>显示及取消显示行号：<code>:set nu</code> and <code>:set nonu</code></li><li>定位到 n 行：<code>:n</code></li><li>翻页：<code>ctrl+f</code>（下一页） <code>ctrl+b</code>（上一页）</li></ul><p>搜索：</p><ul><li>搜索：<code>/+&lt;content&gt;</code></li><li>继续搜索：<code>n</code>（向下） or <code>N</code>（向上）</li><li>跳转至从哪里来：<code>&lt;Ctrl&gt;+o</code>（向后） or <code>&lt;Ctrl&gt;+i</code>（向前）</li><li>对应符号的跳转（例如括号）：<code>%</code></li></ul><h2 id="正常模式下编辑">正常模式下编辑</h2><p>插入或更改：</p><ul><li>插入模式：<code>i</code> or <code>a</code> or <code>o</code>（新一行）</li><li>替换字符：<code>r+&lt;char&gt;</code> or <code>R+&lt;char&gt;</code>（多个字符）</li></ul><p>删除：</p><ul><li>删除当前字符：<code>x</code></li><li>删除当前单词：<code>dw</code></li><li>删除2个单词：<code>d2w</code></li><li>删除当前行：<code>dd</code></li><li>删除2行：<code>2dd</code></li><li>删除到当前行尾：<code>d$</code></li></ul><p>撤销删除</p><ul><li>撤销：<code>u</code>（单次） or <code>U</code>（整行）</li><li>整行重做：<code>&lt;Ctrl&gt;+R</code></li></ul><p>复制粘贴：</p><ul><li>复制：<code>y</code>（在可视模式下选中）</li><li>粘贴内容：<code>p</code>（）</li></ul><p>替换文本：</p><ul><li>To substitute new for the first old in a line type    <code>:s/old/new</code></li><li>To substitute new for all 'old’s on a line type       <code>:s/old/new/g</code></li><li>To substitute phrases between two line #'s type       <code>:#,#s/old/new/g</code></li><li>To substitute all occurrences in the file type        <code>:%s/old/new/g</code></li><li>To ask for confirmation each time add ‘c’             <code>:%s/old/new/gc</code></li></ul><h2 id="移动光标">移动光标</h2><p>行内移动光标：</p><ul><li>向前移动两个单词至词首：<code>2w</code></li><li>向前移动两个单词至词尾：<code>2e</code></li><li>移动到行首：<code>0</code></li><li>移动到行尾：<code>$</code></li></ul><p>跨行移动图标（显示什么内容）：</p><ul><li>光标定位到第 n 行的行首 <code>nG</code></li><li>光标定位到第一行的行首 <code>gg</code></li><li>光标定位到最后一行的行首 <code>G</code></li><li>光标定位到当前屏幕的第一行行首 <code>H</code></li><li>光标移动到当前屏幕的中间 <code>M</code></li><li>光标移动到当前屏幕的尾部 <code>L</code></li><li>把当前行移动到当前屏幕的最上方，也就是第一行 <code>zt</code></li><li>把当前行移动到当前屏幕的中间 <code>zz</code></li><li>把当前行移动到当前屏幕的尾部 <code>zb</code></li></ul><h2 id="其他功能">其他功能</h2><p>大小写转换</p><ul><li>将光标下的字母改变大小写 <code>~</code></li><li>将光标位置开始的3个字母改变其大小写 <code>3~</code></li><li>改变当前行字母的大小写 <code>g~~</code></li><li>将当前行的字母改成大写 <code>gUU</code></li><li>将当前行的字母全改成小写 <code>guu</code></li><li>将从光标开始到下面3行字母改成大写 <code>3gUU</code></li><li>将光标下的单词改成大写。 <code>gUw</code></li><li>将光标下的单词改成小写 <code>guw</code></li></ul>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Vim</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>深度主动学习批判文章阅读</title>
    <link href="/paper-reading/deep-AL-criticism/"/>
    <url>/paper-reading/deep-AL-criticism/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>目前出现一些对深度主动学习批判的文章，结合自己的实践，深以为然，此处将其整理一下。同时这些文章也收录进了本人 <code>awesome-active-learning</code> 的仓库，详见<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/subfields/deep_AL.md">此链接</a>。在本文末尾，本人也提出了一些自己的看法。</p><span id="more"></span><p>文章列表：</p><ul><li>Parting with Illusions about Deep Active Learning [2019, Arxiv]</li><li>Towards Robust and Reproducible Active Learning Using Neural Networks [2020, Arxiv]</li><li>Effective Evaluation of Deep Active Learning on Image Classification Tasks [2021, Open Review]</li></ul><hr><h1>文献概览</h1><h2 id="1-Parting-with-Illusions-about-Deep-Active-Learning-2019-Arxiv">1. Parting with Illusions about Deep Active Learning <a href="https://arxiv.org/abs/1912.05361">[2019, Arxiv]</a></h2><p>这篇文章指出当前主动学习没有考虑到半监督学习及数据增强等平行设定，于是他们在图像分类和语义分割上做了一个对比实验。实验中对比到的内容包括：多种 SOTA 主动学习策略、加入数据增强模块的主动学习策略、加入半监督学习方法的主动学习策略、半监督学习策略。</p><p>分类任务的结果:</p><blockquote><ul><li>主动学习加入数据增强可以带来提升，但是这会模糊不同主动学习策略间的区别，他们表现都大致相同。</li><li>主动学习与半监督学习结合可以带来比单独使用主动学习和半监督学习都要好的表现。</li><li>不同主动学习策略的优劣排序在不同数据集上不同。</li><li>在样本数量极少时，主动选取的样本表现差于随机选取，包括在半监督学习上的随机选取。</li></ul></blockquote><p>语义分割的结果：</p><blockquote><ul><li>半监督学习加随机选取表现最好。</li></ul></blockquote><p>总结:</p><ul><li>当前用于评估主动学习的模式并不好，会带来错误的结论。</li><li>半监督学习的加入会大幅提升主动学习表现。</li><li>很多 SOTA 的主动学习方法会比随机选取要差，尤其是当标记样本数很小时。</li></ul><h2 id="2-Towards-Robust-and-Reproducible-Active-Learning-Using-Neural-Networks-2020-Arxiv">2. Towards Robust and Reproducible Active Learning Using Neural Networks <a href="https://arxiv.org/abs/2002.09564">[2020, Arxiv]</a></h2><p>这篇文章指出在不同的主动学习文章中，作为基准的随机选取策略表现飘忽不定。为了提高主动学习工作的可复现度和鲁棒性，这里对当前方法做一个公平的对比。</p><p>同时本文指出，当前主动学习方法大多忽视了正则化对减小泛化误差的作用。所以作者也将不同的正则化项 (parameter norm penalty, random augmentation (RA), stochastic weighted averaging (SWA), and shake-shake (SS)) 加入了对比。</p><p>图像分类任务的结果:</p><blockquote><ul><li>相比各作者在原文中提到的结果，这里随机选取的表现都要比他们宣称的更好。同时没有策略可以明显超过随机选取。</li><li>使用不同的主动学习批选取数目，得到的表现不一致。</li><li>主动学习方法没有超越随机选取，且在类别不平衡设定上表现不鲁棒。</li><li>加入了 RA 和 SWA 的正则化，主动学习表现明显提升，同时不同策略间表现差异减小。</li><li>把选取的样本迁移到不同的模型结构时，不同策略表现不同，但是随机选取表现依然占优。</li></ul></blockquote><p>讨论：</p><blockquote><ul><li>基于这种相同 baseline 表现不一致的情况，强调主动学习的对比应当在一系列限定条件下施行。</li><li>不同于 <code>Parting with Illusions about Deep Active Learning</code> 这篇文章，作者认为<ul><li>主动学习的表现提升仅在有限的的实验条件下才会出现</li><li>这种基于随机选取的提升不具有统计学意义</li><li>在加入正则化之后，这些对于随机选取策略的提升消失。</li></ul></li><li>正则化在小样本情况下带来的提升可观</li><li>对于一些在模型中使用到未标记样本训练的主动学习策略，例如 <code>VAAL</code> 更应该使用半监督学习来作为基线方法。</li><li>相信当前主动学习的工作都是基于未正则化的模型，其表现提升不能说是由于样本选取的好。</li></ul></blockquote><p>提出了一个评估的标准：</p><blockquote><ul><li>策略要在不同优化器、模型结构、批选取大小等上保证鲁棒。</li><li>模型训练时应当加入 RA 或 SWA 这类的正则化。</li><li>迁移测试必须进行，用来保证选取的样本的确是高质量的。</li><li>实验应该使用统一的评估平台</li><li>实验过程的快照应该留存发布</li><li>训练、测试、标记、未标记、选取样本的编码应该被分享。</li></ul></blockquote><h2 id="3-Effective-Evaluation-of-Deep-Active-Learning-on-Image-Classification-Tasks-2021-Open-Review">3. Effective Evaluation of Deep Active Learning on Image Classification Tasks <a href="https://arxiv.org/abs/2106.15324">[2021, Open Review]</a></h2><p><strong>个人认为这篇文章十分全面且实验到位。</strong>本文指出了当前 AL 工作的一些问题：</p><blockquote><ol><li>不同 AL 策略在不同的工作中往往存在矛盾的表现</li><li>非故意的排除一些用于深度学习的重要一般化步骤，例如数据增强和 SGD 优化。</li><li>对于标记效率等评估方式缺乏认知</li><li>对 AL 在什么情形下能超过随机选取没有清晰的认知</li></ol></blockquote><p>作者展示了一个统一的对于 SOTA 主动学习策略在图像分类下的复现，且在几个不同方面做出了分析。他们指出了一些重要但是目前不清楚的细节：</p><blockquote><ol><li>模型在每个轮循环之后需要从头训练还是可以 fine-tuning？</li><li>使用精心选取的初始集对 AL 有何影响。</li><li>有没有一个完美的 AL batch size？或者这个 AL batch size 重要吗？</li><li>什么情形下 AL 可以超越随机选取？什么因素对其产生影响？</li><li>AL 的 scalability 如何？具体的，模型的训练和 AL 的选取各需要多少时间？</li></ol></blockquote><p>以下是他们的重要结论和实用的经验：</p><blockquote><ol><li>数据增强对测试集表现以及标记效率能带来提升。</li><li>SGD 表现要比 Adam 表现好。</li><li>在使用数据增强和 SGD 优化器时，Diversity 选取策略难以比简单的 Uncertainty 选取表现好。</li><li>在加入人工制造的数据冗余时，BADGE 开始表现好于 Uncertainty 选取。</li><li>每个类别中未标记样本的数量对于表现有很大影响：每个类别中样本数越少，对于 AL 的提升空间越小。</li><li>初始标记数据的选取在几轮循环后对 AL 表现将几乎没有影响。</li><li>AL batch size 同样对表现几乎没有影响。</li><li>在每轮循环中，重训练模型或者 fine-tune 模型，只影响最开始几轮选取的表现。</li><li>最费时的步骤是每轮循环中模型的重训练。</li></ol></blockquote><hr><h1>总结、讨论与个人看法</h1><h2 id="总结">总结</h2><p>这三篇文章都是对当前深度主动学习的批判与调研文，个人很钦佩这种刨根问底的态度。首先这三篇文章有一些共性的结论：</p><ol><li>数据增强可以带来性能提升 [1,3]</li><li>半监督学习，正则化可以带来性能提升 [1,2]（个人看法，某些类的半监督学习方法可以看作正则化项，于是这里放在一起）</li><li>在加入适用于深度学习的提升方法后，不同 AL 策略间的优劣程度变得模糊 [1,2,3]</li><li>[1,2] 认为应当将半监督学习作为基线方法。</li></ol><p>当然也有一些互相排斥的结论：</p><ol><li>[2] 认为加入正则化之后，主动学习相对于随机选取的提升消失，不具有统计意义，但是 [1,3] 中数据增强后仍相对随机选取有提升。</li></ol><h2 id="个人看法">个人看法</h2><p>就这三篇文章而言，背景是当前一大部分的深度主动学习仅考虑了<strong>主动学习的范畴</strong>而没有更多考虑<strong>深度学习的问题</strong>。</p><p>仅从主动学习范畴而言，这二十多年来，Pool-Based AL 的架构，评估方式都没有发生过太大变化：</p><ul><li>全监督式学习</li><li>循环架构并每次从头训练</li><li>通过学习曲线评估不同策略</li><li>以随机选取样本的监督式学习模型作为最基础的基线</li></ul><p>如果从传统模型来考虑，这个主动学习的范畴其实没有太大问题。但是近十年来，深度学习兴起，其实为主动学习带来了新的实现环境。之前的有关深度主动学习的调研（见<a href="/paper-reading/deep-AL-survey/" title="这篇笔记">这篇笔记</a>），其实已经指出了很多在深度模型中使用主动学习面临的挑战。其中第一条就是主动学习期望选取少量重要标记样本，而深度学习期望大量训练样本，两者之间有着矛盾。所以在深度学习的框架下，不能仅仅考虑主动学习的范畴，也要结合深度学习的情况。</p><p>深度学习在这十年的发展中，其实也苦于标记样本数目稀少，但是在深度学习的社区中，采用了一些其他的方式来解决此问题，并取得了十分不错的效果：</p><ul><li>数据增强</li><li>利用未标记的样本<ul><li>半监督学习</li><li>自监督学习</li></ul></li><li>预训练</li></ul><p>所以目前来看，主动学习的范畴致力于用少量的标记样本达到与随机选取相同的表现，深度学习的这些方法致力于用已有的标记数据达到更好的表现。这两种角度其实是一件事情，放在主动学习评估的学习曲线中，就是横向比较和纵向比较。其实在评估时，绝大部分的主动学习工作，都是宣称前者但是采纳后者。换言之就是更侧重于纵向的比较（当然横向好就会带来纵向好毋庸置疑）。</p><p>在这种情况下，<strong>许多深度主动学习仍然使用传统主动学习范畴就很不公平了</strong>。根本原因在于比较的基线方法是一个明明能获取大量未标记样本却只在少量标记样本上训练的模型。换句话说，当前的很多深度主动学习方法还是在虐菜，虐那些没有使用先进的深度学习方法且仅在少量标记样本上训练的神经网络的菜。再打个比方说，主动学习可以看作一种样本维度的提升方式，当前的很大一部分深度主动学习是在对像刀剑一样的武器上进行磨刀抛光提升，表明我磨的比你好。殊不知现在神经网络经过多年社区的贡献已经变成了诸葛神弩或者是火枪。所以说现在仍基于对刀剑提升的作为主动学习的评估已经过时了，磨好的刀是比不过未经提升的火枪的。只有在火枪上进行提升，才可能是当前深度主动学习需要考虑的方向，才是能带来实用价值的方向。正式的说，就是<strong>如何在当前深度学习这些已经验证好用的通用方法下，进一步使用主动学习减少标记成本</strong>。</p><p>目前来看，在策略设计之外，我们需要对主动学习的框架来进行调整，这些调整和主动学习策略的设计可以是正交的，并不一定互相影响：</p><ol><li>首先比较的基线需要是随机选取样本训练的，纳入很多先进成熟深度学习方法的神经网络，包括但不限于：半监督，自监督，正则化，数据增强等方法。</li><li>模型的训练可能需要重训练和增强训练交替进行，而不是一味的重训练（考虑到相较于经典方法来说，神经网络训练时间较长。）</li><li>评估的方式不能单纯以学习曲线论，labeled efficiency 也是一个更直观的角度。</li></ol>]]></content>
    
    
    <categories>
      
      <category>Paper Reading</category>
      
    </categories>
    
    
    <tags>
      
      <tag>active-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Prompt 学习记录</title>
    <link href="/machine-learning/prompt/"/>
    <url>/machine-learning/prompt/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>在自然语言处理中有一个叫做 prompt 的新范式最近较火，其背景是在少标记的场景下学习。本文主要内容都是从 <a href="https://arxiv.org/pdf/2107.13586.pdf">Pre-train, Prompt, and Predict: A Systematic Survey of Prompting Methods in Natural Language Processing</a> 这篇综述中提取。仅涵盖本人认为最需要被科普的内容。</p><span id="more"></span><h1>背景</h1><p>当前在自然语言处理中主要存在以下范式，其中由 a 到 d 基本按照时间顺序出现。总的来说，目前为止经历了两个 sea changes（重大变化）。</p><blockquote><div style="width:100%;margin:auto"><img src="/machine-learning/prompt/paradigm.png" class=""></div></blockquote><p>在2017年以前，主要以完全监督学习为主（a和b范式）。研究的主要内容在于特征提取（传统模型），结构构建（深度模型）。但是在2017年之后，经历了第一个重大变化，完全监督的旧范式的使用不断在缩小，预训练及微调（c范式）开始流行。在当前时间节点，2021年，正在经历第二个重大变化。当前对于下游任务学习并不是通过预训练及微调中的 objective engineering，而是通过 prompt（提示）来实现。</p><p>这里举一个 prompt 的例子。</p><blockquote><p>When recognizing the emotion of a social media post, “I missed the bus today.”, we may continue with a prompt “I felt so __”, and ask the LM to ﬁll the blank with an emotion-bearing word.</p><p>Or if we choose the prompt “English: I missed the bus today. French: __”), an LM may be able to ﬁll in the blank with a French translation.</p></blockquote><p>通过这种选取合适的 prompt 的方法，预训练的 language model（LM）可以用来预测合适的输出，有时甚至不需要 task-specific 的训练。</p><h1>Prompt 的正式表述</h1><p>基于 prompt 的方法尝试规避无法获得大规模数据的问题，直接对样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> 的概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">;</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(\boldsymbol{x};\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span> 进行建模，之后再用这个概率来预测<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">y</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span></span></span>。以下是一些基于 prompt 的方法中的术语。</p><blockquote><div style="width:100%;margin:auto"><img src="/machine-learning/prompt/terminology.png" class=""></div></blockquote><p>通常来说，prompt 的方法预测高质量的输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{y}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9023em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span> 有三步。</p><ol><li>Prompt Addition：通过模版，将原始语句转化为 Prompt，含有空白等待填入。</li><li>Answer Search：在候选集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">Z</mi></mrow><annotation encoding="application/x-tex">\mathcal{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.07944em;">Z</span></span></span></span>中，选取 answer prompt <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">z</mi><mo>^</mo></mover><mo>=</mo><msub><mrow><mi mathvariant="normal">search</mi><mo>⁡</mo></mrow><mrow><mi mathvariant="bold-italic">z</mi><mo>∈</mo><mi mathvariant="script">Z</mi></mrow></msub><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>f</mi><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi></mrow></msub><mrow><mo fence="true">(</mo><msup><mi mathvariant="bold-italic">x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><mi mathvariant="bold-italic">z</mi><mo fence="true">)</mo></mrow><mo separator="true">;</mo><mi>θ</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{z}}=\operatorname{search}_{\boldsymbol{z} \in \mathcal{Z}} P\left(f_{\mathrm{fill}}\left(\boldsymbol{x}^{\prime}, \boldsymbol{z}\right) ; \theta\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7079em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.04213em;">z</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">search</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.04213em;">z</span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.07944em;">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1774em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">fill</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.04213em;">z</span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>。</li><li>Answer Mapping：将高分的回答 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">z</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.04213em;">z</span></span></span></span></span></span> 和高分的输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{y}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9023em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span> 对应起来。</li></ol><h2 id="设计-Prompt-时需要考虑的具体问题">设计 Prompt 时需要考虑的具体问题</h2><p>这里一般来说存在以下5个需要具体考虑的问题：</p><ol><li>如何选择预训练模型</li><li>选择何种 Prompt 来作为 Prompting funtion（模版）。</li><li>设计候选集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">Z</mi></mrow><annotation encoding="application/x-tex">\mathcal{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.07944em;">Z</span></span></span></span>，可能同时还需要考虑与输出的映射。</li><li>对简单框架的扩展以提高表现和适用性。</li><li>训练参数的策略</li></ol><p>此处不一一展开，可以到综述中寻找具体的部分。</p><h2 id="Prompt-的应用和挑战">Prompt 的应用和挑战</h2><p>这篇综述也详尽的展开了当前 Prompt 的应用和挑战。这里只简单记录不做展开。</p><p>应用方面，几乎涉及了 NLP 的方方面面，集中于以下几大类：Knowledge Probing、Classiﬁcation-based Tasks、Information Extraction、“Reasoning” in NLP、Question Answering、Text Generation、Automatic Evaluation of Text Generation、Multi-modal Learning、Meta-Applications。</p><p>挑战方面，主要集中于以下几个大类：Prompt Design、Answer Engineering、Selection of Tuning Strategy、Multiple Prompt Learning、Selection of Pre-trained Models、Theoretical and Empirical Analysis of Prompting、Transferability of Prompts、Combination of Different Paradigms、Calibration of Prompting Methods。</p><h2 id="相关资料">相关资料</h2><ul><li><a href="http://pretrain.nlpedia.ai">Pretrain, Prompt, Predict: A New Paradigm for NLP</a></li><li><a href="https://arxiv.org/pdf/2107.13586.pdf">Pre-train, Prompt, and Predict: A Systematic Survey of Prompting Methods in Natural Language Processing</a></li><li><a href="https://github.com/thunlp/PromptPapers">PromptPapers</a></li></ul><h1>对这个范式的看法</h1><p>Prompt 方法归根结底还是面向标记数据缺乏这一老生常谈的问题。</p><p>从二十多年前的经典方法开始，大家就在对这一问题展开研究。从模型角度入手似乎还是比较少见，主要还是在学习范式的角度上进行研究。从最开始的监督学习，到半监督学习，还有迁移学习，都是致力于使用有限的标记来最大化任务表现。近几年这种半监督，或者说自（无）监督的方法已经极大程度上融进了目前机器学习的框架中。有时作为一种特征提取器而存在，有时作为一种正则化而存在。从这一角度来看，当前的几种范式，都是在探讨如何最大化利用未标记样本，Prompt 也不例外。</p><h2 id="对于-Prompt-而言">对于 Prompt 而言</h2><p>在我来看 Prompt 的定位应该是一种较为成熟的广泛适用于文本的自监督学习方法。自监督学习关键在于定义一种可以自己知道正确答案的任务，用此任务来训练，以得到对该任务的较好表现，同时也可以获取质量相对较好的特征以适用于下游任务。</p><p>当前的预训练模型大多都是由 mask 这类操作来自监督训练。所以在预训练模型上学习的填空能力是可以很好的用于 Prompt 定义的填空题。由于这种填词题在训练的时候已经见过，不像很多下游任务还需要知道之前没见过的标签，所以预训练模型在寻找 answered prompt 时可以 zero-shot 或者 few-shot。</p><p>总的来说，这种范式设计了一种能“引诱”模型输出之前在大量样本中学到的统计（/逻辑/推断）数据。个人觉得还是蛮有意思，或许可以用来对模型进行解释。</p><h2 id="对于自己主动学习的研究而言">对于自己主动学习的研究而言</h2><p>主动学习和这些范式其实不太相同，上述半监督自监督学习主要考虑如何利用未标记样本，而主动学习是在探讨如何最大化利用有限的标记成本来选取最有价值的样本。其已假设更重要的样本能学出来相对随机选取的样本更好的模型。</p><p>在当前无监督自监督学习表现如此之好的情况下，单纯使用主动学习得到的标记样本意义似乎不大。因为单纯选取少量重要的标记样本可能仍旧难以与大量未标记样本上的自监督匹敌。这就是那两篇主动学习劝退文里面指出的问题。所以说个人认为主动学习中，尤其是模型的训练部分，为了最大化效用，应该是一定是要使用未标记样本的。</p><p>主动学习中存在标记，那么必然是一个下游任务。那么具体如何结合少量标记样本和大量未标记样本来训练，就是其他那几种范式。在其他范式上学到的特征提取器上对于下游进行微调，可能才是主动学习最好的实施方法。具体如何微调，又是一个研究了很久的问题。</p><p>所以这种无机的结合可能才是主动学习的实际场景。</p>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>nlp</tag>
      
      <tag>few-shot-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Numpy 相关</title>
    <link href="/programming/numpy/"/>
    <url>/programming/numpy/</url>
    
    <content type="html"><![CDATA[<p>一些在使用 Numpy 时需要注意的东西</p><span id="more"></span><h2 id="随机数生成">随机数生成</h2><p>为保证实验结果可复现，一般我们使用 <code>np.random.seed(number)</code> 来固定随机种子，之后可保证调用随机数生成器产生的结果相同。</p><p>但是在项目规模较大，且需要导入其他包时，这种固定随机种子的办法可能会出现一定问题。原因在于其他的包中，可能同样会设定其他的全局随机种子 <code>np.random.seed(other_number)</code>。导致之后生成的样本不是按照自己设定的随机种子来生成。</p><blockquote><p>“The preferred best practice for getting reproducible pseudorandom numbers is to instantiate a generator object with a seed and pass it around” — Robert Kern, <a href="https://numpy.org/neps/nep-0019-rng-policy.html">NEP19</a>.</p></blockquote><p>解决方法是定义一个随机数生成器，并将其传送到需要使用随机数的地方。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-meta">&gt;&gt;&gt; </span>rng = np.random.default_rng(<span class="hljs-number">2021</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>rng.random(<span class="hljs-number">4</span>)<br>array([<span class="hljs-number">0.75694783</span>, <span class="hljs-number">0.94138187</span>, <span class="hljs-number">0.59246304</span>, <span class="hljs-number">0.31884171</span>])<br></code></pre></td></tr></table></figure><p>Reference:</p><ul><li><a href="https://towardsdatascience.com/stop-using-numpy-random-seed-581a9972805f">Stop using numpy.random.seed()</a></li><li><a href="https://numpy.org/neps/nep-0019-rng-policy.html">NEP 19 — Random Number Generator Policy</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>numpy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>早停与验证集损失</title>
    <link href="/programming/early-stopping/"/>
    <url>/programming/early-stopping/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>一些有关神经网络训练早停及验证集损失的记录。实验中发现验证集损失与其准确度不严格单调负相关，所以搜索一下答案。</p><span id="more"></span><h2 id="早停">早停</h2><p>训练神经网络时，随着训练迭代次数的增加，训练损失会下降。而验证集损失一般会经历一个先下降后上升的过程，上升时则为过拟合出现。在此情况下，一般选用早停来结束当前模型的训练。</p><p>对于某种评估指标，假设其越低越好（/越高越好），在训练过程中，如果在一定数量的 epoch 的容忍度之内，其没有比之前的最好评估要低（/高），则停止训练，并重载之前表现最好时的模型参数作为最终的模型输出。</p><p>一般的，我们使用在验证集上的损失来作为早停的依据，如果验证集损失不进一步下降，那么则停止训练。（这也是目前来看大多数人用的依据。）但是早停的依据到底是使用验证集上的 loss 还是 accuracy（或者其他相应的 metric）并没有看到一个统一的说法，互联网上两派的支持者有之。</p><p>对于这种情况，George 在其<a href="http://alexadam.ca/ml/2018/08/03/early-stopping.html">博文</a>中指出了早停的一些问题。其中最重要的一点是，验证集准确度并不随着验证集损失的减小而严格单调递增，如下图所示。</p><div style="width:70%;margin:auto"></div><p>所以之后 George 实现了一种双重标准的早停，只有当损失和准确率都变糟糕时才早停。</p><h2 id="验证集损失与准确率">验证集损失与准确率</h2><p>一般来说，验证集损失与准确率呈负相关关系。但是有些时候，存在验证集损失上升，但是验证集准确性仍进一步提高的情况。</p><p>这出现于模型对于预测过于自信和极端的情况。换句话说，模型倾向于输出较为极端的预测值，这样使得在同样数量分错的情况下，少数预测错的样本主导了 loss，但是对整体准确率影响不大。</p><p>以下是一些可能出现的原因：</p><ul><li>训练集验证集数据分布不一致</li><li>训练集过小未包含验证集所有情况</li></ul><p>Github 上也有一个 <a href="https://github.com/thegregyang/LossUpAccUp">Repo</a> 来讨论此现象。对于解决方法来说似乎没有一个明确的结论。作者在尝试了较小模型和批正则化后仍然会出现此问题。</p><h2 id="Reference">Reference</h2><ul><li><a href="http://alexadam.ca/ml/2018/08/03/early-stopping.html">Early Stopping and its Faults</a></li><li><a href="https://www.zhihu.com/question/318399418/answer/1202932315">验证集loss上升，准确率却上升该如何理解？ - 刘国洋的回答 - 知乎</a></li><li><a href="https://stats.stackexchange.com/questions/282160/how-is-it-possible-that-validation-loss-is-increasing-while-validation-accuracy">https://stats.stackexchange.com/questions/282160/how-is-it-possible-that-validation-loss-is-increasing-while-validation-accuracy</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>loss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>信息论以及机器学习中的熵</title>
    <link href="/machine-learning/entropy/"/>
    <url>/machine-learning/entropy/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>这里对机器学习中常用到的信息论知识点做一个总结。第四次更新本文，每次都能发现之前的理解有疏漏和不清晰的地方。这次更新本文为两部分，信息论中的熵 &amp; 机器学习中的熵，主要包含相关的定义和何如理解这些概念。</p><span id="more"></span><h1>信息论中的熵 – 编码的视角</h1><h2 id="信息编码">信息编码</h2><p>所谓信息编码，就是在信息传递时，进行的必要转化。一般情况下，以比特传输信息。为了使信息高效传播，高概率高频次传递的信息将以更短的编码展现，而较少发生的低概率信息编码则会更长，一个具体的例子是<a href="https://zh.wikipedia.org/wiki/%E9%9C%8D%E5%A4%AB%E6%9B%BC%E7%BC%96%E7%A0%81">霍夫曼编码</a>。在这个背景下，某一个事件 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 的编码长度则会与其概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 成负相关，一般来说至少需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mrow><mo fence="true">(</mo><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log _{2}\left({p(x)}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> 个比特来对其进行编码。</p><h2 id="信息熵">信息熵</h2><p>对于一个随机变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 进行编码，考虑到每个事件 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 出现的概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 和编码长度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log \left({p(x)}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>，对随机变量的编码可以由对每个事件编码的期望得到，这个期望就是信息熵：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mi>X</mi></msub><mo stretchy="false">[</mo><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi>X</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(X)=\mathbb{E}_{X}[I(x)]= - \sum_{x \in X} p(x) \log {p(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3717em;vertical-align:-1.3217em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></span></p><p>在信息编码中，当我们用少于信息熵长度的比特编码时，一定有资讯的损失，所以信息熵被称为理论最优编码长度。对于随机变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 而言，信息熵是其不确定性的度量，也可以看作是信息量的期望：</p><ul><li>当分布越平均，事件出现概率都相似，采样不确定性更大，杂乱信息多，信息熵越大。</li><li>当分布越不均，事件出现概率大不同，采样不确定性更小，杂乱信息少，信息熵越小。</li></ul><h2 id="交叉墒">交叉墒</h2><p>我们已知每一个事件 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 在一个已知的概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 下相应的编码长度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log \left({q(x)}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>，当我们用这个编码对一个真实的（预先未知的）概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 进行表示时，可以得到在这个新分布下期望的编码长度，这个期望就是交叉熵：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi>X</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(p, q)=-\sum_{x \in X} p(x) \log q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3717em;vertical-align:-1.3217em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p><p>说人话就是使用基于分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 的编码表来编码服从分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 的样本所需的平均编码长度。这个平均长度一定是不小于使用基于分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 本身的编码表的，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo stretchy="false">)</mo><mo>≥</mo><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(p, q) \geq H(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>。</p><h2 id="相对熵">相对熵</h2><p>对于分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span>，已知其交叉熵，可以得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 相对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 的相对熵：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo stretchy="false">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>x</mi></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">D_{\mathrm{KL}}(p \| q) = H(p, q) - H(p) =-\sum_{x} p(x) \log \frac{q(x)}{p(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">KL</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.677em;vertical-align:-1.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>相对熵又称为 KL 散度，是两个概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 差别的一种非对称性度量。其表示使用基于分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 的编码表来编码服从分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 的样本（相比起用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 自己的分布来编码）所需的额外的平均比特数。</p><h2 id="联合熵">联合熵</h2><p>Joint entropy，联合分布的熵。那么对应的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> 可被称作边缘熵。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant="script">X</mi></mrow></munder><munder><mo>∑</mo><mrow><mi>y</mi><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(X, Y)=\sum_{x \in \mathcal{X}} \sum_{y \in \mathcal{Y}} p(x, y) \log \left(\frac{1}{p(x, y)}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.8804em;vertical-align:-1.4304em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.14643em;">X</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em;">Y</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4304em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><h2 id="条件熵">条件熵</h2><p>Conditional entropy，以条件概率计算的熵。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>Y</mi><mo>∣</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant="script">X</mi></mrow></munder><munder><mo>∑</mo><mrow><mi>y</mi><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(Y \mid X)=\sum_{x \in \mathcal{X}} \sum_{y \in \mathcal{Y}} p(x, y) \log \left(\frac{1}{p(y \mid x)}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.8804em;vertical-align:-1.4304em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.14643em;">X</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em;">Y</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4304em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><p>由贝叶斯定理 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mo>∣</mo><mi>x</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x, y)=p(y \mid x) p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 可得条件熵和联合熵关系式：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><mi>H</mi><mo stretchy="false">(</mo><mi>Y</mi><mo>∣</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>+</mo><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo>∣</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>Y</mi><mo separator="true">,</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(X, Y)=H(X)+H(Y \mid X)=H(Y)+H(X \mid Y)=H(Y, X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span></span></p><h2 id="互信息">互信息</h2><p>Mutual information 指两个集合之间的相关性，定义是随机变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> 的联合分布与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 的边缘分布的乘积之间的差异，其具有对称性。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">;</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>D</mi><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊗</mo><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I(X ; Y)=D_{\mathrm{KL}}(p(x, y) \| p(x) \otimes p(y))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">KL</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord">∥</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">))</span></span></span></span></span></p><p>其可以理解为在获得一个随机变量的信息之后，观察另一个随机变量所获得的“信息量”（单位通常为比特）。也可以理解为不确定性的减少量，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 中包含多少 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 中的信息。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">;</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo>∣</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><mi>H</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><mi>Y</mi><mo>∣</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi><mo stretchy="false">(</mo><mi>Y</mi><mo separator="true">;</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I(X ; Y)=H(X)-H(X \mid Y)=H(X)+H(Y)-H(X, Y)=H(Y)-H(Y \mid X)=I(Y ; X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span></span></p><div style="width:60%;margin:auto"><img src="/machine-learning/entropy/entropy.png" class="" title="熵相关的 Venn 图"></div><h1>机器学习中的熵 – 应用与实现</h1><h2 id="作为损失函数使用的交叉墒">作为损失函数使用的交叉墒</h2><p>机器学习中，设计损失函数的思想就是考虑我们预测分布与真实分布的差异。在这个情况下，相对熵是一个不错的选择。同时由于相对熵中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> 是一个固定值并不重要，所以我们可以直接使用交叉熵作为神经网络的损失函数。其形式为，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>y</mi><mi>i</mi></msub><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">loss = -\sum_{i=1}^{n} y_i \log(\hat{y}_{i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">oss</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个样本的真实标记（参考 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> 来理解）。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\hat{y}_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个样本在不同类别上的概率，神经网络中这个概率常常使用 softmax 函数，或者 sigmoid 函数得到。</p><h2 id="Pytorch-中实现">Pytorch 中实现</h2><p>在 pytorch 中有两种方式实现交叉熵损失。可以参考之前的<a href="/programming/neural-network-loss/" title="这篇笔记">这篇笔记</a>。可以调用<code>NLLLoss()</code>或<code>CrossEntropyLoss()</code>两个函数。两函数的不同点主要在于输入不同：</p><ul><li>最后一层全连接层的输出可以直接调用<code>CrossEntropyLoss()</code></li><li>对于<code>NLLLoss()</code>，要将最后一层全连接层的输出再通过一次<code>LogSoftmax()</code>计算才能调用。</li></ul><p>同时如果类别不平衡也可以在每一个类别上加上相应的权重。</p><h2 id="交叉熵的求导">交叉熵的求导</h2><p>因为之前要的工作要手动计算损失函数反向传播时对最后一层参数的梯度，所以需要对交叉熵损失求导。此处我们只需要考虑对最后一层全连接层的输出求导即可，对参数可以之后再进一步求导。</p><p>先考虑一下正向的过程（在 n 个类别下使用 softmax 的情况），对于一个样本在最后一层全连接层的输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">X = [x_1,...,x_n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>，我们考虑第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个类，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><munderover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow><msub><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msub><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi></mrow></mpadded><mpadded width="+0.6em" lspace="0.3em"><mrow><mi>L</mi><mi>o</mi><mi>g</mi><mi>S</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></mpadded></munderover><mo>−</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">)</mo><munderover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow></mrow></mpadded><mpadded width="+0.6em" lspace="0.3em"><mi>Y</mi></mpadded></munderover><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_i\xrightarrow[i_{th} output]{LogSoftmax}- \ln (\frac{\exp (x_{i})}{\sum_{j=1}^{n} \exp (x_{j})}) \xrightarrow[]{Y}- y_i \ln (\frac{\exp (x_{i})}{\sum_{j=1}^{n} \exp (x_{j})}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8279em;vertical-align:-0.7198em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span><span style="top:-2.1163em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">tp</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7198em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5571em;vertical-align:-1.1301em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1301em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span><span style="top:-2.578em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.122em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5571em;vertical-align:-1.1301em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1301em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><p>当考虑所有类别时，一般是将最右端这一项加权平均或加权求和。此处我们假设权重相等，对所有类别相加，则可以得到总损失。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>y</mi><mi>i</mi></msub><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><msub><mi>y</mi><mi>c</mi></msub><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">loss = - \sum_{i=1}^{n}y_i \ln (\frac{\exp (x_{i})}{\sum_{j=1}^{n} \exp (x_{j})}) = - y_c \ln (\frac{\exp (x_{i})}{\sum_{j=1}^{n} \exp (x_{j})}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">oss</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1301em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5571em;vertical-align:-1.1301em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1301em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>c</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y_c = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>，指当前样本的真实标记是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>−</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>S</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">loss = - \ln (\frac{\exp (x_{c})}{\sum_{j=1}^{n} \exp (x_{j})})  = - \ln(Softmax(x_c)) = - \ln(S(x_c))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">oss</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5571em;vertical-align:-1.1301em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1301em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></span></p><p>此处进行求导，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial loss}{\partial x_i} = - \frac{1}{S(x_c)} \frac{\partial S(x_c)}{\partial x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2074em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">oss</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>而对于 softmax 函数求导需要分类讨论：</p><ul><li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">i=c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>时, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial S(x_c)}{\partial x_i} = S(x_c)(1-S(x_c))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4551em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></li><li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo mathvariant="normal">≠</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">i\neq c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>时, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial S(x_c)}{\partial x_i} = - S(x_i)S(x_c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4551em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul><p>所以导数为：</p><ul><li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">i=c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>时, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{\partial loss}{\partial x_i} = S(x_i)-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">oss</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li><li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo mathvariant="normal">≠</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">i\neq c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>时, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{\partial loss}{\partial x_i} = S(x_i)-0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">oss</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></li></ul><h2 id="Reference">Reference</h2><ul><li><a href="https://en.wikipedia.org/wiki/Cross_entropy">Cross entropy - From Wikipedia, the free encyclopedia</a></li><li><a href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Kullback–Leibler divergence - From Wikipedia, the free encyclopedia</a></li><li><a href="https://en.wikipedia.org/wiki/Information_theory">Information theory - From Wikipedia, the free encyclopedia</a></li><li><a href="https://zhuanlan.zhihu.com/p/131647655">Softmax以及Cross Entropy Loss求导</a></li><li><a href="https://zh.m.wikipedia.org/zh-hans/%E4%BA%92%E4%BF%A1%E6%81%AF">互信息</a></li><li>Yu Zhang’s Blog</li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>loss</tag>
      
      <tag>entropy</tag>
      
      <tag>info-theory</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>神经网络损失函数</title>
    <link href="/programming/neural-network-loss/"/>
    <url>/programming/neural-network-loss/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>由于总是忘记一些 loss 的常用场景和区别，此处记录一些常用的神经网络 loss。</p><span id="more"></span><p>Pytorch <a href="https://pytorch.org/docs/stable/nn.html#loss-functions">官方文档</a>中有十余种 loss 函数，其中常用的主要是<code>CrossEntropyLoss</code>、<code>NLLLoss</code>、<code>MSELoss</code>等。这里仅先对这些常用 loss 展开。</p><h2 id="NLLLoss">NLLLoss</h2><p>负对数损失，常用于分类任务。值得注意的是，这里的输入 <code>X</code> 需要已经包含对于相应类别的 log-probability。<strong>使用这个 loss 的时候需要在模型最后加入 <code>LogSoftmax</code> 层。</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>l</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>l</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>l</mi><mi>N</mi></msub><msup><mo stretchy="false">}</mo><mi mathvariant="normal">⊤</mi></msup><mo separator="true">,</mo><mspace linebreak="newline"></mspace><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mo>−</mo><msub><mi>w</mi><msub><mi>y</mi><mi>n</mi></msub></msub><msub><mi>X</mi><mrow><mi>n</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">l(X,y) = L = \{l_1,...,l_N\}^\top, \\l_n = -w_{y_n}X_{n,y_n},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mpunct">,</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span></p><p>其中 <code>X</code> 是输入，<code>y</code> 是目标，<code>w</code> 是类别的权重，<code>N</code> 是 batch size。</p><p>具体的计算例子可以看<a href="https://blog.csdn.net/qq_22210253/article/details/85229988">这篇文章</a>。</p><h2 id="CrossEntropyLoss">CrossEntropyLoss</h2><p>交叉墒损失，同样常用于分类任务。这个标准结合了 LogSoftmax 和 NLLLoss 两个部分。</p><p>首相介绍一下 LogSoftmax，其包含 log 函数和 softmax 函数。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">LogSoftmax</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><mrow><munder><mo>∑</mo><mi>j</mi></munder><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{LogSoftmax}\left(x_{i}\right)=\log \left(\frac{\exp \left(x_{i}\right)}{\sum_{j} \exp \left(x_{j}\right)}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">LogSoftmax</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1218em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>对于交叉墒损失，值得注意的是，这里的输入 <code>X</code> 需要已经包含对每一个类，未经处理的 unformalized score。<strong>换句话说，使用这个 loss 的时候不需要在模型最后加入 <code>Softmax</code> 层。</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">loss</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mtext> class </mtext><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">[</mo><mtext> class </mtext><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mi>j</mi></munder><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><mo>−</mo><mi>x</mi><mo stretchy="false">[</mo><mtext> class </mtext><mo stretchy="false">]</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><munder><mo>∑</mo><mi>j</mi></munder><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{loss}(x, \text { class })=-\log \left(\frac{\exp (x[\text { class }])}{\sum_{j} \exp (x[j])}\right)=-x[\text { class }]+\log \left(\sum_{j} \exp (x[j])\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">loss</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord"> class </span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">])</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord text"><span class="mord"> class </span></span><span class="mclose">])</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1218em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord text"><span class="mord"> class </span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.1638em;vertical-align:-1.4138em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">])</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>对于加权的情况，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">loss</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mtext> class </mtext><mo stretchy="false">)</mo><mo>=</mo><mtext> weight </mtext><mo stretchy="false">[</mo><mtext> class </mtext><mo stretchy="false">]</mo><mrow><mo fence="true">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">[</mo><mtext> class </mtext><mo stretchy="false">]</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><munder><mo>∑</mo><mi>j</mi></munder><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{loss}(x, \text { class })=\text { weight }[\text { class }]\left(-x[\text { class }]+\log \left(\sum_{j} \exp (x[j])\right)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">loss</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord"> class </span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1638em;vertical-align:-1.4138em;"></span><span class="mord text"><span class="mord"> weight </span></span><span class="mopen">[</span><span class="mord text"><span class="mord"> class </span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord text"><span class="mord"> class </span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">])</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>最终的 loss 需要加权平均得到，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">loss</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mtext> class </mtext><mo stretchy="false">)</mo><mo>=</mo><mtext> weight </mtext><mo stretchy="false">[</mo><mtext> class </mtext><mo stretchy="false">]</mo><mrow><mo fence="true">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">[</mo><mtext> class </mtext><mo stretchy="false">]</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><munder><mo>∑</mo><mi>j</mi></munder><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{loss}(x, \text { class })=\text { weight }[\text { class }]\left(-x[\text { class }]+\log \left(\sum_{j} \exp (x[j])\right)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">loss</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord"> class </span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1638em;vertical-align:-1.4138em;"></span><span class="mord text"><span class="mord"> weight </span></span><span class="mopen">[</span><span class="mord text"><span class="mord"> class </span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord text"><span class="mord"> class </span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">])</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>其中 <code>x</code> 是输入，<code>class</code> 是目标类，<code>weight</code> 是类别的权重，<code>N</code> 是 batch size。</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>neural-network</tag>
      
      <tag>Python</tag>
      
      <tag>Pytorch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>好文阅读转载</title>
    <link href="/reading-note/article-sharing/"/>
    <url>/reading-note/article-sharing/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>此处记录一些之前阅读，感触颇深或者觉得有趣的文章，并附连接。</p><span id="more"></span><h2 id="人生成长">人生成长</h2><ul><li><a href="https://yzhang-gh.github.io/notes/reading/reward-and-half-life.html">收益值与半衰期 - 采铜</a>：从个人提升的角度，评估一件事是否该做。</li><li><a href="https://zhuanlan.zhihu.com/p/82028811">25岁的年轻人，要想清两件事 - 北冥乘海生</a>：定义人生的目标函数，弄清人生的约束条件。</li><li><a href="https://mp.weixin.qq.com/s/PHJCHHUrj2CcfCk8vv24pA">胸怀伟大理想 践行爱国情怀 | 学术人生</a>：朱松纯在北大元培学院对2021级新生的演讲，介绍了人的“中心极限定律”。</li></ul><h2 id="宗教信仰">宗教信仰</h2><ul><li><a href="https://www.zhihu.com/question/426477472/answer/1590124777">怎么样回答外国朋友“这个世界人人有寄托，为什么中国人没有信仰”这个问题？ - 赵浪</a>：简单宗教探讨中，如何进行辩经。</li></ul><h2 id="哲学">哲学</h2><ul><li><a href="https://www.zhihu.com/question/384441334/answer/1146525915">我们穷极一生，究竟追寻的是什么？ - 曹哲</a></li></ul><h2 id="写作与表达">写作与表达</h2><ul><li><a href="https://mp.weixin.qq.com/s/nNl6qZtVx8OjyiT1rz6JJA">你以为我在剑桥读经典，其实我不过是学会说话</a>：准确使用语言。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>转载</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>合作的进化</title>
    <link href="/reading-note/evolution-of-cooperation/"/>
    <url>/reading-note/evolution-of-cooperation/</url>
    
    <content type="html"><![CDATA[<p>《合作的进化》 罗伯特·阿克塞尔罗德</p><span id="more"></span><h2 id="极简简介">极简简介</h2><p>罗伯特·阿克塞尔罗德是美国科学院院士，著名行为分析和博弈论专家。主要由他在博弈论和复杂性理论上基础性突破而广为人知。他是把计算机模型运用到社会科学问题领域的权威学者。</p><p>这本书是一本乐观的书。</p><p>本书从一个重复囚徒困境的竞赛结果出发，分析了表现优异策略的特点，并分析推广到社会生活中。阐述了合作如何诞生与发展，与合作存在的环境。通过分析“一报还一报”，将其特点作为重要元素，指导我们真实的合作进程。</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>这是一本蛮有趣的社会学书籍，其研究方法较为严谨符合逻辑。本书主张的观点，其实是可以为每一个正直人所用，的确有一些受益。最主要的观点在于合作中成功策略应该有四个特性，从个人角度看来，是可以在日常生活中运用的。这样在善良的前提下，可以保护自身利益。</p><p>此外作者对于合作产生的背景的研究也蛮有趣。我觉得这也是一个比较重要的部分。其重要性在于作为管理者，如何使被管理的部门产生且维持高效的合作。这样其实是会增大整体的效应。</p><p>本书主要观点其实不多。翟老师之前的介绍中其实已经基本涵盖。书中主要是多了很多实验细节和阐述，其实不需要刻意来读。</p><h3 id="缺点（喜爱挑毛病）">缺点（喜爱挑毛病）</h3><p>这种基于强假设的逻辑推演局限性明显。因为真实环境，假设并不一定成立。</p><p>此外计算机的模拟其实并不能很好的作为“提炼道理”的工具。这就有些像日常生活中看到什么事，悟到了什么道理，这个事未必全面，这个道理未必准确。这也是很多 heuristic 方法的通病。</p><p>个人认为这本书其实是提出来一个假说。但是假说要通过演绎才能使其更加完备。</p><h1>按节讨论/摘录</h1><h2 id="第一章：合作的问题">第一章：合作的问题</h2><p>在什么条件下才能从没有集权的利己主义者中产生合作？国与国之间人与人之间都会面临这个问题。</p><p>本书重点研究追求各自利益的个体行为，并分析在社会系统中有哪些因素影响个体行为。目标是建立一个合作理论以帮助我们理解合作出现的必要条件。基本假设是个体追求自身利益。</p><p>假设下一步对局的收益是上一步对局收益的w倍（w是折扣系数，小于1）。<strong>那么如果折扣系数足够大，则不存在独立于对方所采用策略的最优策略。</strong>举例，参议院中，你最好喝将来会回报合作的人合作，而不是与将来行为不太受现在影响的人合作。</p><p>囚徒困境的框架：</p><ul><li>对策者的收益不可比较。</li><li>收益不必对称。</li><li>对策者收益是相对的而不是绝对的。</li><li>决定是否合作不必顾及他人的看法。</li><li>不必假设对策者是理性的，不必假设她们总是企图争取最大利润。</li><li>对策者的行为不必都是有意识地选择</li></ul><h2 id="第二章：“一报还一报”在计算机竞赛中的胜利">第二章：“一报还一报”在计算机竞赛中的胜利</h2><p>“一报还一报”策略在重复囚徒困境中胜出。同时在演化计算的方式下，“一报还一报”在代际间保留，且比例增加。在演化后期，一些前期成功的不善良程序转折变差。</p><p>一个成功决策应有的四个特性：</p><ul><li>对方合作你就合作以避免不必要的冲突。</li><li>对方的背叛你是可激怒的。</li><li>在给挑衅以反击后你是宽容的。</li><li>行为要简单清晰。</li></ul><h2 id="第三章：合作的建立">第三章：合作的建立</h2><p>探索结果的适用范围。简单来说要求<strong>个体有足够大的机会再次相遇</strong>，形成未来打交道的利害关系。在进化中数学表达就是当折扣系数足够大时，一报还一报是“集体稳定的”，不容易被侵入。</p><p>相似的，一个被认为在下次选举落选的国会议员很难在原有的信任和声誉上和同僚们做立法交易。</p><p>“总是背叛”的策略总是集体稳定的，可以阻止个体的侵入。但是新来者是一个小群体的话，就有机会建立合作。（相遇匹配不随机，新来者之间有机会建立合作。）善良的策略不能被单个个体侵入，那么也不能被这类个体的小群体侵入。</p><p>这样合作的进化可以分成三个阶段：</p><ol><li>起始阶段：合作可以在无条件背叛的世界里产生。有交往的可能，合作便会出现。</li><li>中间阶段：基于回报的策略在许多不同类型策略中成长起来。</li><li>最后阶段：基于回报的策略一旦建立，能防止其他不太合作的策略的侵入。因此社会进化的齿轮是不可逆转的。</li></ol><h2 id="第四章：一战中“自己活也让别人活”的系统">第四章：一战中“自己活也让别人活”的系统</h2><p>四五章具体说明这个结果的适用范围。第四章论述“自己活也让别人活”系统。</p><p>讲述了一战英德前线对峙的例子。在都没有前进的企图时，双方愿意一起克制而不愿交替采取敌对行动。合作的开始，有同时进餐的因素，也有糟糕天气的因素。同时在合作中双方也会证明自己有必要是会报复的。</p><p>当然也有很多影响合作的问题：</p><ul><li>部队的换防</li><li>炮兵更不容易受到报复（在克制和报复中起到重要作用</li><li>最终由司令部的突然袭击破坏合作）</li></ul><h2 id="第五章：生物系统中的合作进化">第五章：生物系统中的合作进化</h2><p>战壕里的士兵清楚理解和认识到回报在维持合作中的作用。但是参与者的这种理解并不是合作出现和稳定必须的。合作可以在没有预见的情况下产生。这一章主要是在生物学的角度论述。</p><p>在没有明显亲缘关系的情况下，自然界中形成了许多共生关系。这一章并没有太大兴趣，可以之后再仔细阅读。</p><h2 id="第六章：如何有效的选择">第六章：如何有效的选择</h2><p>预见对于合作的进化不是必要的，但是的确很有帮助。</p><p>在持续的囚徒困境中如何表现，作者向个体选择提供四个方面的建议：</p><ul><li>不要妒忌对方的成功<ul><li>要求自己比对方做的更好不是一个很好的标准，否则可能导致危险的冲突</li><li>一报还一报总是表现不错，但是他从来没有比别人得更多的分。</li></ul></li><li>不要首先背叛</li><li>要对合作和背叛都做出回报</li><li>不耍小聪明<ul><li>不要用一些复杂的方法来推断对方，这些推断通常是错误的。</li><li>自己的策略复杂到对方不可理解是非常危险的。</li><li>在非零和博弈中，诀窍在于鼓励合作，表明你愿意回报。</li></ul></li></ul><h2 id="第七章：如何促进合作">第七章：如何促进合作</h2><p>改革者通过改变相互作用的条件来促进合作：</p><ul><li>增大未来的影响，增加接触频率</li><li>改变收益值，使利害关系可以被看到</li><li>教育人们相互关心</li><li>教育人们要回报</li><li>改进辨别能力</li></ul><h2 id="第八章：合作的社会结构">第八章：合作的社会结构</h2><p>合作理论应用的领域。不同类型社会结构如何影响合作发展方式。</p><p>四个能引起有趣的社会结构形式的因素：</p><ul><li>标记：划分种群。</li><li>信誉：体现在其他人对他采用策略的信心上。</li><li>管理：政府处理个人间公司间纠纷。</li><li>领地：策略在领地上传播。</li></ul><h2 id="第九章：回报的鲁棒性">第九章：回报的鲁棒性</h2><p>进化的方法基于一个简单的原则：成功的东西可能在将来经常出现。这本书研究从在没有集权的情况下，合作如何从自私者中产生，扩展到当人们却是关心会发生什么和当有集权时又会发生什么。其中友谊不是合作的进化必要的，预见性也不是必要的。</p><p>从小群体开始合作，在善良、可激怒和某种程度的宽容规则中逐步成长，一旦成为一个群体，采用这种有识别力的策略的个体就能保护自己不受侵入，总体的合作水平是在上升而不是在下降。换句话说，合作的进化是不可逆转的。</p><p>最有价值的发现是：具有预见能力的参与者了解合作理论的真谛后，可以加快合作的进化。</p>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>腾讯云相关记录</title>
    <link href="/software-tools/hexo/tencent-cloud-hexo/"/>
    <url>/software-tools/hexo/tencent-cloud-hexo/</url>
    
    <content type="html"><![CDATA[<p>本文记录在腾讯云服务器上部署 Hexo 搭建的博客时遇到的问题。</p><span id="more"></span><h1>腾讯云相关</h1><h2 id="远程连接">远程连接</h2><p>需要在本地使用 ssh 连接云端 root 账户或者普通账户。首先在腾讯云里 ubuntu 下管理员账户名为 ubuntu 而不是 root。</p><p>第一次链接出现管理员账户无法使用密码和密钥连接其普通账户也无法使用密码登录的情况。这时需要在腾讯云实例的控制台中对 ssh 进行相关设置。具体来说修改以下文件 <code>/etc/ssh/sshd_config</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">PasswordAuthentication <span class="hljs-built_in">yes</span> <span class="hljs-comment"># 开启密码登录权限</span><br>PubkeyAuthentication <span class="hljs-built_in">yes</span> <span class="hljs-comment"># 使用密钥登录</span><br></code></pre></td></tr></table></figure><p>之后重启服务 <code>sudo service sshd restart</code> 即可。之后使用 ssh 和下载好的密钥进行连接，详见<a href="https://cloud.tencent.com/document/product/1207/44643#.E4.BD.BF.E7.94.A8.E5.AF.86.E9.92.A5.E7.99.BB.E5.BD.95">官方文档</a>。</p><h2 id="使用-nginx-部署-Server">使用 nginx 部署 Server</h2><p>详见<a href="https://zhuanlan.zhihu.com/p/108720935">这篇文档</a></p><p>其中涉及到不少对 Nginx 的操作，下面记录一些基础命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 首先使用 Nginx 命令的时候需要使用管理员权限。</span><br><span class="hljs-comment">## 开启服务器</span><br>sudo systemctl nginx<br><span class="hljs-comment">## 重新启动更新设置</span><br>sudo systemctl restart nginx.service <br></code></pre></td></tr></table></figure><p>其中 Nginx 的配置文件位于 <code>/etc/nginx/nginx.conf</code>，更改过后重启即可。</p><h2 id="服务器-SSL-证书安装部署">服务器 SSL 证书安装部署</h2><p>可以参考腾讯云的<a href="https://cloud.tencent.com/document/product/400/35244">这篇文档</a>。主要就是将证书上传再再 Nginx 中设置。需要注意的是颁发证书对应的域名一定要和真是域名相同，不要少前缀。</p><h2 id="本地-ssh-连接服务器长时间不操作断开问题">本地 ssh 连接服务器长时间不操作断开问题</h2><p>具体来说修改以下文件 <code>~/.ssh/config</code>。增添以下内容。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">Host *<br>        <span class="hljs-comment"># 断开时重试连接的次数</span><br>        ServerAliveCountMax 5<br>        <span class="hljs-comment"># 每隔5秒自动发送一个空的请求以保持连接</span><br>        ServerAliveInterval 5<br></code></pre></td></tr></table></figure><p>参考<a href="https://www.pkslow.com/archives/ssh-keep-alive">这篇文章</a>。</p><h2 id="使用-webhook-对-repo-的更新进行监控">使用 webhook 对 repo 的更新进行监控</h2><p>详见这几篇文档：</p><ul><li><a href="https://zhuanlan.zhihu.com/p/116136090">使用Github的Webhooks+Node完成网站的自动化部署</a></li><li><a href="https://jimmysong.io/blog/github-webhook-website-auto-deploy/">使用 GitHub Webhook 实现静态网站自动化部署</a></li><li><a href="https://jelly.jd.com/article/6006b1025b6c6a01506c878a">使用Github的webhooks进行网站自动化部署</a></li></ul><p>然而事实是我这次并没有从 webhook 的方向来部署，而是从 github action 中 ssh 到服务器进行操作。具体的部署步骤放在服务器的 deploy 文件中。</p>]]></content>
    
    
    <categories>
      
      <category>Software Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>cloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>高斯过程 Gaussian Process</title>
    <link href="/machine-learning/gaussian-process/"/>
    <url>/machine-learning/gaussian-process/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>一份理解高斯过程的笔记。</p><span id="more"></span><p>参考：</p><ul><li><a href="https://distill.pub/2019/visual-exploration-gaussian-processes/">A Visual Exploration of Gaussian Processes</a></li><li><a href="https://zhuanlan.zhihu.com/p/56562456">看得见的高斯过程：这是一份直观的入门解读</a></li><li><a href="https://www.zhihu.com/question/46631426/answer/1735470753">如何通俗易懂地介绍 Gaussian Process？</a></li><li><a href="https://zhuanlan.zhihu.com/p/104601803">高斯过程回归：推导，实现和理解</a></li><li><a href="http://sirlis.cn/deep-learning-gaussian-process">深度学习基础（高斯过程）</a></li></ul><h2 id="高斯过程的简要理解">高斯过程的简要理解</h2><p>高斯过程可以被用于分类和回归问题，是一种非参数贝叶斯方法。在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 个测试样本上预测的情况，可以想象成在一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 维的高斯分布下进行采样。在每个维度上的采样结果或者该维度的均值，可以当作在这个样本上的预测值。所以说问题转化为如何构建这个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 维的高斯分布，一旦构建完成则可以用来回归预测。</p><p>直接对预测数据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">X^\ast</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> 构建这个先验分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(f(X^\ast))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span> 是困难的，所以在有训练数据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 的情况下，我们期望找到的是一个后验概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(f(X^\ast)|Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>。</p><h2 id="多变量高斯分布">多变量高斯分布</h2><p>我们先从多变量高斯分布说起，介绍其形式和性质。</p><h3 id="1-先验分布">1. 先验分布</h3><p>对于一个先验分布是高斯分布的一组随机变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>μ</mi><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">Σ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X \sim \mathcal{N}(\mu,\,\Sigma)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord mathnormal">μ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Σ</span><span class="mclose">)</span></span></span></span>， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 可以由两部分组成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">X_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">X_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，代表原始随机变量的子集，维度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>a</mi></msub><mi mathvariant="normal">∣</mi><mo>+</mo><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>b</mi></msub><mi mathvariant="normal">∣</mi><mo>=</mo><mi>p</mi><mo>+</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">|X_a|+|X_b| = p + q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>。</p><p>具体来说，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>X</mi><mo>=</mo><msub><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mi>a</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mi>b</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mi>p</mi><mo>+</mo><mi>q</mi></mrow></msub><mspace width="1em"/><mi>μ</mi><mo>=</mo><msub><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mi>a</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mi>b</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mi>p</mi><mo>+</mo><mi>q</mi></mrow></msub><mspace width="1em"/><mi mathvariant="normal">Σ</mi><mo>=</mo><msub><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="normal">Σ</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="normal">Σ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="normal">Σ</mi><mrow><mi>b</mi><mi>a</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="normal">Σ</mi><mrow><mi>b</mi><mi>b</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mi>p</mi><mo>+</mo><mi>q</mi><mo separator="true">,</mo><mi>p</mi><mo>+</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X=\begin{bmatrix}X_a\\X_b\end{bmatrix}_{p+q}\quad\mu=\begin{bmatrix}\mu_a\\\mu_b\end{bmatrix}_{p+q}\quad \Sigma=\begin{bmatrix}\Sigma_{aa}&amp;\Sigma_{ab}\\\Sigma_{ba}&amp;\Sigma_{bb}\end{bmatrix}_{p + q, p + q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5858em;vertical-align:-1.1358em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.5914em;"><span style="top:-1.7003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5858em;vertical-align:-1.1358em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.5914em;"><span style="top:-1.7003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5858em;vertical-align:-1.1358em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ab</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bb</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.5914em;"><span style="top:-1.7003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1358em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span> 是对应的均值和方差。</p><h3 id="2-通过先验分布得到后验分布">2. 通过先验分布得到后验分布</h3><p>此时我们可以通过条件作用 conditioning 从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>a</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>b</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(X_a,X_b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>b</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>a</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(X_b|X_a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。这样是从一个维度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>a</mi></msub><mi mathvariant="normal">∣</mi><mo>+</mo><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>b</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|X_a|+|X_b|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>的高斯分布得到一个维度为维度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>b</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|X_b|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span> 的高斯分布。以下是一个二维高斯分布的示意图，其中包含边缘分布以及条件分布的示意。</p><div style="width:80%;margin:auto"><img src="/machine-learning/gaussian-process/marginal-condition.png" class=""></div><p>条件作用之后均值和标准差会发生变化，依据高斯分布的性质可以得到以下条件分布，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>X</mi><mi>b</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>a</mi></msub><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><msub><mi>μ</mi><mrow><mi>b</mi><mi mathvariant="normal">∣</mi><mi>a</mi></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mrow><mi>b</mi><mi mathvariant="normal">∣</mi><mi>a</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X_b|X_a \sim N(\mu_{b|a},\Sigma_{b|a})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>b</mi><mi mathvariant="normal">∣</mi><mi>a</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mrow><mi>b</mi><mi>a</mi></mrow></msub><msubsup><mi mathvariant="normal">Σ</mi><mrow><mi>a</mi><mi>a</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>X</mi><mi>a</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>a</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>μ</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">\mu_{b|a}=\Sigma_{ba}\Sigma^{-1}_{aa}(X_a-\mu_a)+\mu_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>b</mi><mi mathvariant="normal">∣</mi><mi>a</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mrow><mi>b</mi><mi>b</mi></mrow></msub><mo>−</mo><msub><mi mathvariant="normal">Σ</mi><mrow><mi>b</mi><mi>a</mi></mrow></msub><msubsup><mi mathvariant="normal">Σ</mi><mrow><mi>a</mi><mi>a</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">Σ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Sigma_{b|a}=\Sigma_{bb}-\Sigma_{ba}\Sigma^{-1}_{aa}\Sigma_{ab}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bb</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ab</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p><p>总的来说，在由一系列随机变量组成的高斯分布中，可以得到其中一部分随机变量的条件分布（同为高斯分布的形式）。这个分布的具体形式与条件作用中随机变量的取值、均值和协方差有关。</p><h2 id="高斯过程">高斯过程</h2><p>此时我们发现，在多维高斯分布中，我们已经可以通过条件概率得到特定随机变量的高斯分布了，这就是高斯过程用于预测的基础。得到的高斯分布的均值可以用作预测值，方差可以用作预测的不确定性。高斯过程就是一个定义在连续域上的无限多个高斯随机变量所组成的随机过程，我们想做的事是将这所有的无限多的随机变量表示出来。</p><p>那么类似的，我们首先需要建立起联合分布的高斯分布表达式，要定义均值和协方差矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span>。</p><ol><li>均值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span>，一般在数据归一化的情况下，先验均值可以设为 0 函数。</li><li>对于协方差矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span>，则可以用核函数来生成。</li></ol><blockquote><p>核函数，一般用作一种距离的度量，可以理解为可以两个样本点的相互影响。这里用现有样本的特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 建立随机变量间的距离，再用其作为每个维度之间的协方差。此处的核函数有多种选择方式，可以起到添加先验知识的作用。此外，核函数还可以通过组合来使用，比如加法组合、乘法组合等，通常会获得一些合并的特性，比如既是周期又有线性。</p></blockquote><p>在联合分布中，我们不仅要考虑待预测的测试样本点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">X^\ast</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>，还需要考虑观测的训练样本点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>（下图中黄色点）。训练样本点限制了函数空间中的函数，使得我们可以得到一个更加合理的预测结果。</p><div style="width:80%;margin:auto"><img src="/machine-learning/gaussian-process/training-points.png" class=""></div><p>限制的效果如下图所示，可以看到在训练样本点附近的预测值更加准确。</p><div style="width:60%;margin:auto"><img src="/machine-learning/gaussian-process/kernel-example.png" class=""></div><p>具体来讲对于观测点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>（训练点，注意这里的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 和上一小节的不同，这里是表示训练样本的特征）与其对应值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，所有的非观测点（测试点） <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">X^\ast</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> 的值定义为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(X^\ast)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。我们对预测值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 构建多维高斯分布。这里我们把均值向量替换为均值函数。那么有，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>f</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>μ</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext>，</mtext><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo separator="true">,</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo separator="true">,</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}Y\\f(X^\ast)\end{bmatrix}\sim N(\begin{bmatrix}\mu(X)\\\mu(X^\ast)\end{bmatrix}，\begin{bmatrix}k(X,X)&amp; k(X,X^\ast)\\k(X^\ast,X)&amp;k(X^\ast,X^\ast)\end{bmatrix})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>同样的我们可以得到条件分布，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi>Y</mi><mo separator="true">,</mo><msup><mi>X</mi><mo>∗</mo></msup><mo separator="true">,</mo><mi>X</mi><mo stretchy="false">)</mo><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><msup><mi>μ</mi><mo>∗</mo></msup><mo separator="true">,</mo><msup><mi>k</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(f(X^\ast)|Y,X^\ast,X) \sim N(\mu^\ast,k^\ast)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>μ</mi><mo>∗</mo></msup><mo>=</mo><mi>k</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo separator="true">,</mo><mi>X</mi><mo stretchy="false">)</mo><mi>k</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>X</mi><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>Y</mi><mo>−</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>μ</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu^\ast=k(X^\ast,X)k(X,X)^{-1}(Y-\mu(X))+\mu(X^\ast)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8831em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">μ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">μ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mo>∗</mo></msup><mo>=</mo><mi>k</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo separator="true">,</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>k</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo separator="true">,</mo><mi>X</mi><mo stretchy="false">)</mo><mi>k</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>X</mi><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>k</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k^\ast=k(X^\ast,X^\ast)-k(X^\ast,X)k(X,X)^{-1}k(X,X^\ast)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。这个条件分布的含义是，在我们知道训练数据的特征以及标签和测试数据特征的情况下，我们可以得到测试数据的标签的分布。</p><p>一般在数据归一化的情况下，先验均值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">μ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu(X^\ast)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">μ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 可以设为 0 函数。在 <code>sklearn</code> 中，可以通过调节参数 <code>normalize_y=True</code> 实现。这样我们可以得到最终的高斯分布，即我们的预测输出。其强相关于预测样本于训练样本的距离，训练样本的标签以及核函数的选择。</p>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>gaussian-process</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>杠杆率无法衡量经济风险</title>
    <link href="/economy-finance/didongsheng/dibi/"/>
    <url>/economy-finance/didongsheng/dibi/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>2019.12.</p><p>该视频是翟币的由来视频。</p><span id="more"></span><h2 id="去杠杆概念的源起">去杠杆概念的源起</h2><p>Ray Dalio，桥水基金创始人。他的核心概念就是去杠杆。</p><p>他认为债务/GDP不能太高而且不能增长太快，否则经济会崩塌。但是这个可能是在胡扯。逻辑可能是错的。</p><p>债务是存量概念，GDP是流概念。能不能得出有意义的结论？</p><p>举例，银行放债。企业的销售额除以债务能不能说明问题。京东和字节跳动相比，字节跳动销售额虽然可能小，但是利润更大。</p><h2 id="杠杆率与经济危机无关">杠杆率与经济危机无关</h2><p>日欧债务率都相当高，但是即使负利率，都很债务安全。杠杆理论的反例，债务率低的崩盘了很多。</p><p>那什么具有决定性意义呢？债务的定价货币是什么。</p><h2 id="翟币">翟币</h2><p>用10万翟币债券债务关系买手机。一年之后还钱只需要再印十万就好。</p><p>格林斯潘：“女士们先生们，这些钱我们永远都不用还。”</p><h2 id="中国政府债务">中国政府债务</h2><p>中国没有借美元债，都是人民币债。中国债务率大家都觉得高。中央政府债务率占GDP比例20%都不到。但是地方政府借了很多债。</p><p>即便中央地方债务都算进去，也仅有60%左右。和德国中央政府差不多。</p><p>本币债和外币债有重要区别。本币债其实本质上是一种隐形的税收。</p>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
    <tags>
      
      <tag>翟东升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>全球发展不平等，中国在其中扮演了什么角色？</title>
    <link href="/economy-finance/seminar-talks/global-inequality-china/"/>
    <url>/economy-finance/seminar-talks/global-inequality-china/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>海南绿色金融研究院为世界银行原首席经济学家Branco Milanovic教授与翟东生老师组织了一个线上对话。Branco 是个很有思想的学者，他提出的“大象曲线”用以描述和解释全球化时代的财富再分配效应及其政治后果，是国际政治经济学中的经典概念。</p><span id="more"></span> <h1>讲座部分</h1><h2 id="Global-Income-Inequality-and-the-Role-of-China-全球收入不平等和中国的作用">Global Income Inequality and the Role of China 全球收入不平等和中国的作用</h2><div style="width:60%; margin:auto"><img src="/economy-finance/seminar-talks/global-inequality-china/gini.png" class=""></div><p>大概分成三个部分：</p><ul><li>1950年前，英国日本等经济增长，而中国下降。不平等增加。</li><li>1950-2000，二战后美国在不平等中占据重要地位，不平等并未加剧。</li><li>1980年后中国印度崛起，这些国家之前贫穷，不平等减少。</li></ul><p>虽然中国等国家的崛起减少的国家间的不平等，但是国内的不平等仍在加剧。中国对减少全球不平等起着积极作用。但是随着中国越来越富有，作为中上收入国家，其实中国是会加剧全球不平等。印度非洲对减少全球不平等越来越重要。</p><h2 id="Inequality-in-US-美国的不平等">Inequality in US 美国的不平等</h2><p>美国自由主义资本中的系统性不平等：</p><ul><li>资本收入对总收入的重要性提升，资本集中度提高。</li><li>高收入人群劳动收入也很高。不像传统的资本家只有资本收入。高等级人群在劳动力市场和资本市场都很富有。（homoploutia）</li><li>人们门当户对的结合。选型婚配。（homogamy）</li><li>富有的人对政治控制程度的增高。</li><li>大学入学率与父母收入正相关。</li></ul><h2 id="Inequality-in-China-中国的不平等">Inequality in China 中国的不平等</h2><p>中国的不平等在2010年之后稳定并逐步下降。城镇不平等和总不平等高度相关。</p><div style="width:60%; margin:auto"><img src="/economy-finance/seminar-talks/global-inequality-china/gini-china.png" class=""></div><p>三个可解决的不平等，相比之下，美国较小：</p><ul><li>省份收入的不平等。可以提高GDP用财政政策解决。</li><li>城乡地理间收入的不平等。可以通过劳动力流动和解决户口解决。</li><li>腐败带来的不平等。反腐政策解决。</li></ul><p>三个可困难的不平等：</p><ul><li>资本收入增加。越高收入的人，资本收入越多。</li><li>高等级人群在劳动力市场和资本市场都很富有。近十年此指标增长较高。homoploutia。</li><li>社会流动性降低，教育与父母收入相关。</li></ul><h1>提问部分（翟东升）</h1><ol><li>质疑一下中国的发展未来会限制世界不平等，同时更依赖印度非洲等地区对不平等作出贡献。仅从GDP角度分析可能是这样，但是还是应该考虑一些其他因素。中国正在转型为资本提供者。从2013年来，中国把越来越多的钱投入到全球外围地区。所谓的一带一路。如果中国对人类命运共同体贡献成功，还是可以减轻全球不平等。在未来我们会通过长期促进全球外围地区发展来推动平等。</li><li>homoploutia，其实是一个可以解决的办法。新时代中国特色社会主义市场经济，整个世界的体制正在趋同。什么样的资本主义应该实行？美国的撒钱（helicopter money）更像共产主义来。欧洲的高福利其实使人懒惰。如何平衡成本和收益？对欧洲福利进行调整，构建一种社会福利体系。欧洲很多的福利被用于或者浪费于公共系统，或者让老年人多活一个月，这是性价比很低的。公共部门为了挽救人们生命和财富分配的干预应该致力于减少年轻人之间的不平等。年轻人无法选择，但是年长的人应该对自己的行为负责。所以财力应该节省出来给年轻人。中国的资本增长主要在于地产，年轻人要承担这个后果。在中国我们应该补偿这种代际剥夺。</li><li>抛去资本所有权的集中，更应该谈论数据所有权的集中。1971年之前资本指黄金，之后指大国的主权信用。1980后我们见证着资本稀缺性的下降。目前最重要的是数据的所有权。在美国是公司高管们拥有这些数据。</li></ol><h1>回复部分（BM）</h1><ol><li>一带一路可以为非洲带来增长，但是技术上讲，还是会不可避免的加剧不平衡。</li><li>代际不平衡类似人口老龄化，这种不平衡在美欧都有。年轻人进步的机会比其父母更少。</li><li>资本收入包括数据等资产。资本的种类的确在变化。</li></ol>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
    <tags>
      
      <tag>翟东升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>主动学习与交互决策过程</title>
    <link href="/machine-learning/active-reinforcement/"/>
    <url>/machine-learning/active-reinforcement/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>之前导师让调研一下“基于主动学习技术的可交互策略学习方法”，此处整理成文便于留存。</p><span id="more"></span><h1>调研背景介绍</h1><p><font color=red>调研关键词：</font>主动学习，可交互，策略学习，降低标注成本</p><h2 id="相关领域">相关领域</h2><h3 id="主动学习">主动学习</h3><p>首先我们指出广义场景下<strong>主动学习</strong>有两种含义，技术面和任务面（不冲突，侧重点不同）。但是不论是指技术还是任务，当我们提到主动学习的时候，总是伴随着对某项<strong>成本降低的期望</strong>。</p><ul><li>技术面：一种以某种原则选取数据的技术（此种含义不必须与人交互）</li><li>任务面：一种以某种原则选取数据从而节省监督学习标记成本的任务（标记任务需要与人交互）</li></ul><h3 id="策略学习">策略学习</h3><p>一般来说，策略是在指定任务中为完成任务目标而实行的行动准则。目前来看，有两种被广泛使用的<strong>策略学习</strong>方法：</p><ul><li>强化学习（需要与环境交互）</li><li>模仿学习（需要与专家系统交互）</li></ul><hr><h2 id="具体调研的方向">具体调研的方向</h2><p>故此调研的调研重点置于主动学习AL与强化学习RL与模仿学习IL的交叉方向上面(<strong>以降低成本为目的</strong>)。<u><em>此处的分析及本文的调研以问题为导向，不特别深入到具体技术的归类。</em></u></p><p>问题分类（调研结构以此为标准）：</p><ul><li>传统AL数据标记任务下的问题（监督学习中设计相关策略减少标记成本）（标记任务中与人交互）<ul><li>使用RL/IL的policy作为AL标记任务的选取策略（AL的任务面）</li></ul></li><li>RL场景下的问题（有时与环境交互复杂昂贵）<ul><li>定义一种数据选取的原则来指导policy的学习（AL的技术面）</li></ul></li><li>IL场景下的问题（与专家系统交互复杂昂贵）<ul><li>定义一种数据选取的原则来指导policy的学习（AL的技术面）</li></ul></li></ul><p>另一种分类（在此调研中可找到相应模块）：</p><ul><li>在策略学习中无人类参与<ul><li>Active Reinforcement Learning</li></ul></li><li>在策略学习中有人类参与<ul><li>Imitation/Reinforcement Learning in Conventional AL Process</li><li>Interactive Reinforcement Learning</li><li>Active Imitation Learning</li></ul></li></ul><hr><h1>三类相关方向</h1><h2 id="1-传统AL数据标记任务">1. 传统AL数据标记任务</h2><h3 id="背景简介">背景简介</h3><p>在AL的任务面下， AL与RL有着相似的任务框架，都可以看作MDP。</p><div style="width:60%;margin:auto"><img src="/machine-learning/active-reinforcement/agent_environment_MDP.png" class=""></div><div style="width:60%;margin:auto"><img src="/machine-learning/active-reinforcement/AL_framework.png" class=""></div><p>两类问题描述如下：</p><table><thead><tr><th></th><th>RL</th><th>AL（任务面）</th></tr></thead><tbody><tr><td>Task</td><td>Decision tasks</td><td>Instance selection tasks with supervised learning</td></tr><tr><td>Purpose</td><td>Learn best policy to maximize the total return</td><td>Construct best labeled condition (coming with best prediction results)</td></tr><tr><td>Goal</td><td>Policy</td><td>Labeled condition</td></tr></tbody></table><p>我们将两类问题的相关概念进行对比如下：</p><table><thead><tr><th></th><th>RL</th><th></th><th>AL（任务面）</th></tr></thead><tbody><tr><td>agent</td><td>Apply [current state =&gt; action]</td><td>selector</td><td>Apply [current labeled state =&gt; selection]</td></tr><tr><td>state</td><td>Describe current condition</td><td>labeled state</td><td>Current labeled and unlabeled data</td></tr><tr><td>action</td><td>The response from the agent under the certain state</td><td>selection</td><td>The response from the selector under the curtain labeled state. (A set of unlabeled data)</td></tr><tr><td>environment</td><td>Apply [state + action =&gt; next state + reward]</td><td>oracle/interaction</td><td>Apply [labeled state + selection =&gt; next labeled state]. Oracle annotate the selection set.</td></tr><tr><td>reward</td><td>Given by the environment after an action is taken</td><td></td><td></td></tr><tr><td>policy</td><td>The guideline for the agent to take optimal actions</td><td>query strategy</td><td>The guideline for the selector to make optimal selections</td></tr><tr><td>value</td><td>Evaluation of the current state/action/state-action-pair</td><td>score</td><td>Evaluation of the current potential selections</td></tr><tr><td>model (not necessary)</td><td>The learned formula of the environment</td><td>model</td><td>The learned formula of the oracle</td></tr></tbody></table><p>我们发现RL中的Policy其实对应着AL中的选取策略。在此方向上，我们可以发现两者的区别</p><ul><li>相似处：RL policy和AL strategy都应该同时考虑exploration&amp;exploitation。</li><li>不同处：RL学习policy，但是AL通常使用预先启发式设定的strategy。</li></ul><hr><h3 id="问题与思路">问题与思路</h3><p><font color=red>存在的问题：</font>AL通常使用预先启发式设定的strategy其实很多时候并不是最优，而且对不同场景不一定适用。这就带来了一个问题，这个预先设定好的heuristic有时候并不是最优，对不同场景不一定适用。</p><p><font color=red>直观的方法：</font>从RL与AL的相似性出发，我们或许可以运用强化学习学习policy的方法来学习一个strategy。</p><p>目前主要有三类工作（数据标记任务，所以需要与人简单交互）：</p><ul><li>在一个相关的领域学习策略<ul><li>之后不伴随策略在数据集间的迁移</li><li>之后伴随策略在数据集间的迁移</li></ul></li><li>直接在目标领域学习策略</li></ul><p><font color=red>KEY WORDS：</font> Learning to actively learn, Data-driven AL, Meta-active learning (ability to work with all kinds of data)</p><hr><h3 id="现有工作列表">现有工作列表</h3><p>在一个相关的领域学习策略，之后不伴随策略在数据集间的迁移：</p><ul><li><a href="http://papers.nips.cc/paper/7010-learning-active-learning-from-data">Learning active learning from data [2017, NIPS]</a>:<strong>LAL</strong>.<strong>In pool-based AL setting</strong>.Random forest as basic classifiers.The state consist the current classifier parameters and a randomly selected data (Monte-Carlo).Train a random forest regressor that predicts the expected error reduction for a candidate sample in a particular learning state.The regressor works as the value function of the state action pair.Train the policy on the representative dataset and use it on the target dataset (without updating).</li><li><a href="https://www.aclweb.org/anthology/P18-1174.pdf">Learning How to Actively Learn: A Deep Imitation Learning Approach [2018, Annual Meeting of the Association for Computational Linguistics]</a>:<strong>ALIL</strong>.<strong>In pool-based AL setting</strong>.The task is named entity recognition in a cross lingual setting.The state consists of the labeled and unlabelled datasets paired with the parameters of the currently trained model.An action corresponds to the selection of a query data point, and the reward function is the loss of the trained model on the hold-out evaluation set.Imitation Learning directly learns the map (policy) from state to action in a supervised manner.The policy is then used on the target dataset (without updating).</li><li><a href="https://arxiv.org/pdf/2010.15382.pdf">Learning to Actively Learn: A Robust Approach [2020]</a>:Address that previous works in this area learn a policy by optimizing with respect to data observed through prior experience (e.g., metalearning or transfer learning).This approach makes no assumptions about what parameters are likely to be encountered at test time, and therefore produces algorithms that do not suffer from a potential mismatch of priors.</li></ul><p>在一个相关的领域学习策略，之后伴随策略在数据集间的迁移：</p><ul><li><a href="https://arxiv.org/abs/1708.02383">Learning how to Active Learn: A Deep Reinforcement Learning Approach [2017, Arxiv]</a>:<strong>PAL</strong>(Policy based Active Learning).<strong>In stream-based AL setting</strong> where the policy/strategy is to decide whether to query the current instance.The task is named entity recognition in a cross lingual setting, where transfer the learned strategy/policy to the target domain (where no enough data to learn a strategy).The policy is learned by deep Q-network.The state is the current instance the previous constructed dataset.The reward is given by a hold-out set.Then the learned policy is transferred to the target dataset with policy updating.</li></ul><p>直接在目标领域学习策略：</p><ul><li><a href="https://ieeexplore.ieee.org/abstract/document/6248108">RALF: A reinforced active learning formulation for object class recognition [2012, CVPR]</a>:First to consider AL as a MDL process.They use Q-learning to learn the adaptive combination between exploration and exploitation.Use the overall entropy as the reward in each iteration.The state is the strategy combination condition and the action is the trade-off parameter.They also used a guided initialization for Q-table.</li><li><a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.707.8414&amp;rep=rep1&amp;type=pdf">Active Learning by Learning [2015, AAAI]</a>:<strong>ALBL</strong>.By Hsuan-Tien Lin (NTU).Connect AL with the well-known multi-armed bandit problem.Choose strategies in the AL process by estimating the performance of different strategies on the fly.Use EXP4.P as the core solver.The action is to choose a specific strategy.</li><li><a href="https://openaccess.thecvf.com/content_CVPR_2019/html/Yoo_Learning_Loss_for_Active_Learning_CVPR_2019_paper.html">Learning Loss for Active Learning [2019, CVPR]</a>:Attach a small parametric module, named “loss prediction module”, to a target network, and learn it to predict target losses of unlabeled inputs.The “loss prediction module&quot; could be considered as the value function of the state-action pair.The state is the current model parameters and the action is the selected instance.The idea to directly predict the loss is similar to <em>[Learning active learning from data [2017, NIPS]]</em>, but this work doesn’t need to train the policy in advance.The policy is trained during the AL process.</li><li><a href="https://www.aclweb.org/anthology/P19-1401.pdf">Learning How to Active Learn by Dreaming [2020, ACL]</a>:The follow-up work for <em>[Learning How to Actively Learn: A Deep Imitation Learning Approach]</em>.Recent data-driven AL policy learning methods are also restricted to learn from closely related domains.This method fine-tune the initial AL policy directly on the target domain of interest by using wake and dream cycles.Cross-domain and cross-lingual text classification and named entity recognition tasks.Wake learning is an AL process, and the dream learn is a policy updating process.The current weak model was used as a weak annotator to train the policy in the dream phase.</li></ul><p>此类方法在其他类型标注任务中的相关应用:</p><ul><li><a href="https://dl.acm.org/doi/abs/10.1145/3340555.3353742">Multi-modal Active Learning From Human Data: A Deep Reinforcement Learning Approach [2019, ICMI]</a></li><li><a href="https://arxiv.org/abs/2002.06583">Reinforced active learning for image segmentation [2020, ICLR]</a></li><li><a href="https://www.aclweb.org/anthology/K18-1033.pdf">Learning to Actively Learn Neural Machine Translation [2020, CoNLL]</a></li><li><a href="https://link.springer.com/chapter/10.1007%2F978-3-030-59710-8_4">Deep Reinforcement Active Learning for Medical Image Classification [2020, MICCAI]</a></li></ul><hr><h3 id="分析与看法">分析与看法</h3><p>首先这一节我们面对的还是传统的AL场景，面对的主要是数据标注的任务。相比于传统的AL启发式方法，此类学习Policy的方法对算力的要求很大，虽然标称的表现也会好，但是如果真的实际使用则需要权衡。</p><p>浅见：</p><ul><li>对不同任务设计特异性的AL策略（不论是启发还是学习一个策略）是当下的趋势。</li><li>对于一些复杂任务，基于RL策略的迁移或许是一种良好的解决方案。</li></ul><hr><h2 id="2-Reinforcement-Learning-场景">2. Reinforcement Learning 场景</h2><h3 id="背景简介-2">背景简介</h3><p>强化学习相关知识与概念在此不赘述。具体可以参见<a href="/machine-learning/reinforcement-learning/" title="这篇文章">这篇文章</a>。</p><p>强化学习面对的问题场景就是一个广义的学习一个智能 agent 的场景。一般通过与环境的交互来学习 agent 的 policy。环境交互的过程中一般会黑盒地出状态的转移以及相应的奖励。Policy 的训练依赖于观测的结果。一般是在观测到的 trajectory 中进行训练: $${S_0,A_0,R_0,S_1,A_1,R_1,S_2,A_2,R_2,…,S_{n-1},A_{n-1},R_{n-1},S_n,R_n}$$（主流的强化学习方法分为 model-based 与 model-free 两种，区别在 policy 的训练是否依赖对环境的状态转移建模。）</p><p>训练的过程中存在一个问题：若持续以当前的学到的策略与环境进行交互（exploitation），那么学习的结果则容易陷入一个局部最优当中。所以在强化学习中 exploitation 需要伴随 exploration，这样可以避免陷入局部最优并且找到更好的策略。最简单的分配方式是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>−</mo><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">\epsilon-greedy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">ree</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>，按照一定比例分配 exploitation 和 exploration。如果 exploitation 过多，则容易陷入局部最优，如果 exploration 过多，则较难有充足的数据训练一个较好的policy。所以说 exploitation 之外的 exploration 也十分重要。</p><p>通常情况下RL假设与环境的交互是即时完成且没有花费的。然而现实情况下，与环境的交互，通常是需要付出代价的（时间或算力或实际成本）。在 large, high-dimensional environment 中，这个成本更为高昂（复杂的模拟计算等）。此时我们希望我们每一次的交互都能被更好的利用起来：</p><ul><li>在 exploitation 中用更好的训练方式（大部分强化学习在研究的的）</li><li>在 exploration 中选择更好的交互样本，更高效探索（active）</li></ul><p>于是RL则与AL选取更优样本的逻辑产生了交叉，主要是聚焦于探索的场景下。《人工智能：一种现代的方法》21.3中的主动强化学习提到了这一现象。我们想更优更高效地 exploration（Agent 不必关心那些它知道不需要的而且可以避开的状态的具体效用）。此处我们称这种选取为 active reinforcement learning。</p><p>此处的 Active 不一定一定要有人的存在。这里的 Active 含义: the agent seeks out novelty based on its own “internal” estimate of what action sequences will lead to interesting transitions.</p><hr><h3 id="问题与思路-2">问题与思路</h3><p><font color=red>存在的问题：</font>RL与环境交互会产生交互成本。较多的探索会影响模型的训练，同时也会造成一定的cost损失。</p><p><font color=red>直观的方法：</font>借鉴AL的思路，制定或学习探索的方式，更高效的探索，使相同数量的探索下训练的policy更好。</p><p>目前主要有以下几类工作：</p><ul><li>ARL: 整体框架仍是RL的框架。加入探索的heuristic。（不与人交互，只与环境交互）<ul><li>ARL-1: 与环境交互获取状态转移和奖励时产生cost</li><li>ARL_2: 只在与环境交互获取奖励时产生cost，状态转移不产生cost。</li></ul></li><li>IRL: 以RL的框架为基础，添加interactive的部分。（需要与人交互）</li></ul><p><font color=red>KEY WORDS：</font> active exploration, active reinforcement learning, interactive reinforcement learning</p><hr><h3 id="现有工作">现有工作</h3><p>ARL-1:与环境交互获取状态转移和奖励时产生cost。(No human interactions)</p><p>由于需要主动的选择来与环境进行交互，一般来说是要选取我们认为环境能反馈更多信息的样例。通常的做法是在对环境的建模上来衡量informativeness。具体衡量的方法与AL中的方法相似（QBC/Entropy/Information Gain, etc.）所以说绝大部分的工作都是基于Model-based RL。</p><ul><li><a href="https://dl.acm.org/doi/abs/10.1145/1390156.1390194">Active Reinforcement Learning [ICML, 2008]</a>:Before this work, many ideas are trying to explore the actions which agents has experienced the fewest number of times in the past.In this paper, the agent determines the sensitivity of the optimal policy to changes in transitions and rewards.It then focuses its exploration on the regions of space to which the optimal policy is most sensitive.The process is similar to ADP.Use Taylor’s approximation to model the local sensitivity of the utility on current policy.</li><li><a href="https://proceedings.neurips.cc/paper/2016/file/abd815286ba1007abfbb8415b83ae2cf-Paper.pdf">VIME: Variational Information Maximizing Exploration [2016, NIPS]</a>:Agent should take actions that maximize the reduction in uncertainty about the dynamics (transition).Use BNN to learn the model.This can be formalized as maximizing the sum of reductions in entropy of transition probability.The exploration to the uncertain state of the models should reward more.</li><li><a href="http://proceedings.mlr.press/v97/shyam19a.html">Model-based active exploration [2019, ICML]</a>:Better state-action pair makes the model ensemble changes more.The utility of the state action pair is the disagreement among the next-state distributions given s and a, in terms of JSD (Jensen-Shannon Divergence), of all possible transition functions weighted by their probability.(用可能的transaction分布变化作为criteria。)</li><li><a href="https://arxiv.org/abs/1906.04161">Self-supervised exploration via disagreement [2019, ICML]</a>:The idea is similar to <em>Model-based active exploration</em>.Generate an intrinsic reward, defined as some difference measure (i.e., KL-divergence, total variation) across the output of different models in the ensemble drives exploration.(Such exploration might be ineffective, as the policy may visit regions of the state space which have no relation to solving the task.)</li><li><a href="https://proceedings.neurips.cc/paper/2019/hash/03b264c595403666634ac75d828439bc-Abstract.html">Explicit explore-exploit algorithms in continuous state spaces [2019, NIPS]</a>:Applicable in large or infinite state spaces.Exploration and exploitation are controlled by a threshold.Exploration is guided by the disagreement in the model set.And the models updated after get the exploration trajectories.Exploitation is guided by one of the model in the model set.</li><li><a href="https://arxiv.org/pdf/2002.02693.pdf">Ready Policy One: World Building Through Active Learning [2020, Arxiv]</a>:View MBRL exploration as an active learning problem (select trajectory from trajectory space), where we aim to improve the world model in the fewest samples possible.Acquiring data that most likely leads to subsequent improvement in the model.The exploration metric is based on <strong>reward variance</strong> computed from a (finite) collection of models.</li><li><a href="https://arxiv.org/pdf/2006.09436.pdf">SAMBA: Safe Model-Based &amp; Active Reinforcement Learning [2020, Arxiv]</a>:From Huawei UK.<strong>Safe-RL</strong> setting, every trajectory comes with a cost.Aim at minimizing cost, maximizing active exploration (bi-objective), and meeting safety constraints.Increases in regions with dense training-data (due to the usage of CVaR constraint) to aid agents in exploring novel yet safe tuples.The exploration use an expected leave-one-out semi-metric between two Gaussian processes defined, for a one query state-action pair. (Model change)</li></ul><hr><p>ARL-2:只在与环境交互获取奖励时产生cost，状态转移不产生cost。</p><p>Specify the cost C:</p><ul><li><a href="https://arxiv.org/abs/1803.04926">Active reinforcement learning with monte-carlo tree search [2018]</a>:The reward needs to be paid to observe.The received reward has the discount for the querying cost.</li><li><a href="https://arxiv.org/abs/2005.12697">Active Measure Reinforcement Learning for Observation Cost Minimization [2020]</a>:The policy applied with Q-learning.Add whether to query as part of the action in Q-table, so the number of action would be twice as large as the ordinary Q-table.After each query, it jump to the queried state and update a transition model.Otherwise, it go to the state according to the transition model.(没太懂这篇文章的intuition)</li></ul><hr><p>IRL:与环境交互获取状态转移和奖励时产生cost，人类交互不产生cost</p><p>此类问题的背景仍旧是搜索空间大，搜索耗时且复杂。所以仍然是在与环境交互时产生cost，希望使用人类专家在训练时的介入来缓解这个问题。人类专家的交互仍然是为了使exploration更高效。但是需要强调，此处的问题并没有对与人类专家交互的数量与质量进行假设。</p><ul><li><a href="https://www.cc.gatech.edu/~ksubrama/files/efd-paper-aamas16.pdf">Exploration from Demonstration for Interactive Reinforcement Learning [2016, aamas]</a>:A model-free policy-based approach, uses human demonstrations to guide search space exploration.The demonstrations are used to learn an exploration policy that actively guides the agent towards important aspects of the problem.In the proceeding of a episode, when the agent reaches a informative state (computed by leverage and discrepancy), it queries the action from the state with the closest leverage to the current state, then update the policy parameters.A self-play with the environment followed in this episode, and the parameters are keep updating.</li><li><a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/11/InteractiveTeaching.pdf">Interactive Teaching Strategies for Agent Training [2016]</a>:A work by Microsoft.Include two agent: student(learn from RL) and teacher(fixed human policy).Contains two module: student initiated and teacher initiated.Query when the student has a low Q-value difference on the current state.(the student is uncertain about which action to take)</li><li><a href="https://arxiv.org/pdf/1701.04079.pdf">Agent-Agnostic Human-in-the-Loop Reinforcement Learning [2016, NIPS]</a>:Develop a framework for human-agent interaction that is agent-agnostic and can capture a wide range of ways a human can help an RL agent (e.g. Q-values, action optimality, or the true reward.)</li></ul><hr><h3 id="分析与看法-2">分析与看法</h3><p>ARL和普通RL的工作界限其实并不是很明显，因为很多 RL 的工作也是需要处理 exploitation 和 exploration。此处只是挑了一些很明显使用到 AL 相关思路的文章，如果要详尽调研则较为困难。</p><p>IRL 其实比较有趣，它主要是想通过人的参与让与环境的交互更高效，人在这里只是起到画龙点睛的作用，或许这种交互可以用到很多 RL 系统。</p><hr><h2 id="3-Imitation-Learning-场景">3. Imitation Learning 场景</h2><h3 id="背景简介-3">背景简介</h3><p>模仿学习相关知识与概念在此不赘述。具体可以参见<a href="/machine-learning/reinforcement-learning/" title="这篇文章">这篇文章</a>。</p><p>简单来说，模仿学习会在学习的过程中与专家交互，同时获得专家对指定 state 所作出的 action $$\pi_*(s)$$。模仿学习的目标为学习一个 policy，使其与专家的 policy 尽可能接近（模型生成的状态-动作轨迹分布和输入的轨迹分布相匹配/获得同样的 reward 等）。</p><p>通常情况下，根据应用场景的不同，IL可以分为以下几类（By ICML 2018 IL Tutorial）:</p><ul><li>Behavior cloning</li><li>Direct policy learning (multiple step BC)</li><li>Inverse reinforcement learning (assume learning R is statistically easier)</li></ul><p>与RL类似，IL同样是在观测到的trajectory中进行训练: $${S_0,A_0,S_1,A_1,S_2,A_2,…,S_{n-1},A_{n-1},S_n}$$。不同的是，在 trajectory 中并没有每一步的 reward。</p><hr><h3 id="问题与思路-3">问题与思路</h3><p><font color=red>存在的问题：</font>当我们想要通过模仿来学习策略的时候，唯一的学习来源来自于 Expert 对所询问的 stat e的回答（相应 action）。这种与 Expert 的交互是昂贵的。</p><p><font color=red>直观的方法：</font>询问专家时，挑选更有价值的 state 来询问相应的 action。</p><p>目前的工作也是基于 IL 的分类，存在于以下两类：</p><ul><li>Direct Policy Learning</li><li>Inverse reinforcement learning</li></ul><p>在 IL 中，一部分工作使用一定数量与<strong>专家</strong>交互下 policy 的表现作为评估，类似于 AL 中的学习曲线。所以说一部分 IL 天然的可以看作 AL 的问题（以 AL 选取策略降低与专家交互成本）。（另一部分使用一定数量与<strong>环境</strong>交互下 policy 的表现作为评估，是以人的参与降低与环境交互成本，类似之前提到的 IRL。）</p><p><font color=red>KEY WORDS：</font> imitation learning, active imitation learning, active inverse reinforcement learning</p><hr><h3 id="现有工作-2">现有工作</h3><p>Under Direct Policy Learning:</p><p>此类工作的目标是学一个 state 到 action 的 map，是一个监督学习的过程，选取的方式基于学习到的 supervised model。</p><ul><li><a href="https://jmlr.org/papers/volume15/judah14a/judah14a.pdf">Active Imitation Learning: Formal and Practical Reductions to I.I.D. Learning [2014, JMLR]</a>:Under the subclass <em>Direct Policy Learning</em>.Construct a committee by bootstrap sampling (posterior over policies).Select states by density weighted QBC strategy and get the corresponding action.The density is from trajectory from the simulated environment.Maintain a supervised labeled state-action pairs.</li><li><a href="https://dl.acm.org/doi/abs/10.5555/3298483.3298654">Query-Efﬁcient Imitation Learning for End-to-End Simulated Driving [2017, AAAI]</a>:Maintain a safety classifier to decide which state needs to be queried.Use supervised loss between the action given by trained policy and reference policy on the visited states.</li></ul><hr><p>Under Inverse reinforcement learning:</p><p>由于目标之一是学习 value function，所以通常是以当前的 value function 来构建选取 state 的逻辑。</p><ul><li><a href="https://link.springer.com/chapter/10.1007/978-3-642-04174-7_3">Active Learning for Reward Estimation in Inverse Reinforcement Learning [2009, ECML PKDD]</a>:Take the entropy of the value prediction on the state as the sample strategy (where the reward is unsure).i.e. the disagreement on the learned reward functions.It query the specific action from the oracle on the selected state. (162)</li><li><a href="https://www-cs.stanford.edu/people/ebrun/pdfs/mandel2017add.pdf">Where to Add Actions in Human-in-the-Loop Reinforcement Learning [2017, AAAI]</a>:Selecting the state s to query the action where adding the next action most improves the estimated value of state.</li><li><a href="http://proceedings.mlr.press/v80/kang18a/kang18a.pdf">Policy Optimization with Demonstrations [2018, ICML]</a>:Use discriminator between human demonstrations and trajectory from environment to make the exploration close to the human’s action.The purpose is to use the current demonstration to train a policy as good as possible.(Demonstration is collected in loops, could be considered as an AL process.)</li><li><a href="https://arxiv.org/pdf/1905.11867.pdf">Interactive Teaching Algorithms for Inverse Reinforcement Learning [2019, IJCAI]</a>:Focus on how could a teacher provide an informative sequence of demonstrations to an IRL learner to speed up the learning process.The main idea is to pick a demonstration with maximal discrepancy between the learner’s current policy and the teacher’s policy in terms of expected reward.</li></ul><hr><h3 id="分析与看法-3">分析与看法</h3><p>Imitation Learning 天然和 AL 有很多相似的地方。AL 是想模仿 oracle 的黑盒模型，IL 是想模仿 expert 的黑盒策略。人在 IL 中的重要程度就像人在 AL 中的重要程度一样，因为人类是系统唯一可以获得监督信息的地方。所以说本节所在意的并不是环境的交互成本，而是人类的交互成本，这就使 AIL 与 IRL 产生了区别（问题的定义不同）。</p><hr><h1>总结</h1><p>本文以两种维度介绍了主动学习与可交互策略相关的问题，并以第一种维度进行了展开（第二种维度同样可以找到相应模块）。</p><p>其中对于人类专家存在的交互式的策略学习，当前已经有了一些综述或者前瞻的文章。这些工作主要介绍了不同交互的方式与目的，并不一定包含减少标记成本的模块。</p><ul><li>Power to the people: The role of humans in interactive machine learning [2014, AI Magazine]</li><li><a href="https://arxiv.org/pdf/1811.07871.pdf">Scalable agent alignment via reward modeling: a research direction [2018]</a>: From Deepmind.</li><li><a href="https://arxiv.org/pdf/1909.09906.pdf">Leveraging Human Guidance for Deep Reinforcement Learning Tasks [2019, IJCAI]</a></li><li><a href="https://dl.acm.org/doi/abs/10.1145/3357236.3395525">A Survey on Interactive Reinforcement Learning: Design Principles and Open Challenges [2020, ACM DIS]</a></li></ul><h2 id="最新进展-发展趋势">最新进展&amp;发展趋势</h2><p>本文并未对相关技术的最新进展展开探讨，但是从问题的角度来讲的确出现了一些新问题。包括但不限于：</p><ul><li>由 active RL 到 active safe RL</li><li>IRL 中考虑交互的方式（不同形式的指导，或者相同形式指导的不同展现方式）</li></ul><p>但是现在来看问题的大类并没有发生什么改变。交互的成本只有两类：与环境交互成本，与人类专家交互成本。在这次简要的调查中并没有发现其他类的问题。</p>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>active-learning</tag>
      
      <tag>reinforcement-learning</tag>
      
      <tag>imitation-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>强化学习 &amp; 模仿学习基础知识</title>
    <link href="/machine-learning/reinforcement-learning/"/>
    <url>/machine-learning/reinforcement-learning/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>总是会看到强化学习及模仿学习的内容，每次看完都会忘记，此处把之前的小笔记总结一下。</p><span id="more"></span><h1>基本术语 Terminologies</h1><p>以下术语在强化学习和模仿学习中都经常见到。</p><ul><li>agent: the intelligent individual</li><li>environment: The agent is acting in an environment.</li><li>state: Current condition. The agent can stay in one of many states of the environment</li><li>action: The agent chooses to take one of many actions under the certain states.</li><li>reward: Once an action is taken, the environment delivers a reward as feedback.</li><li>policy: Agents’ behavior.(s =&gt; a) The agent’s policy π provides the guideline on what is the optimal action to take in a certain state with the goal to maximize the total rewards.</li><li>value: (s =&gt; value) Each state is associated with a value function V(s) predicting the expected amount of future rewards we are able to receive in this state by acting the corresponding policy.<ul><li>state-value of a state s is the expected return if we are in this state at time t.</li><li>action-value (“Q-value”; Q as “Quality” I believe?) of a state-action pair is expected return if we are in this state at time t and take action a.</li><li>A-value: The difference between action-value and state-value is the action advantage function (“A-value”):</li></ul></li><li>model: Transition and reward. (s,a =&gt; s’ &amp; r) How the environment reacts to certain actions (we may or may not know).</li></ul><h1>强化学习</h1><h2 id="1-马尔科夫决策过程">1. 马尔科夫决策过程</h2><p>In more formal terms, almost all the <strong>RL problems</strong> can be framed as <strong>Markov Decision Processes (MDPs)</strong>.All states in MDP has “Markov” property, referring to the fact that the future only depends on the current state, not the history.The goal is to react on each state to <strong>maximize the total reward</strong>.</p><div style="width:70%;margin:auto"><img src="/machine-learning/reinforcement-learning/MDP.png" class="" title="MDP"></div><p>如果所有 MDP 成分都已知，我们便可以较容易的训练出来一个 agent。但是现实情况是很多时候，我们的 agent 对 transition function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 和 reward function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 一无所知，所有的信息都来自于同环境的交互。</p><h3 id="1-1-强化学习方法分类">1.1. 强化学习方法分类</h3><ol><li>以是否对环境建模分类:<ul><li>Doesn’t model the environment:<ul><li>Model-free RL: Doesn’t need to know the transition function (“model”), neither the real function nor a learned function.</li></ul></li><li>Model the environment:<ul><li>Model-based RL: Need to know the transition function (“model”), either the real function or a learned function.</li><li>Inverse reinforcement learning: Need to learn a value function for a state. (Imitation learning)</li></ul></li></ul></li><li>以行动策略和评估策略是否相同分类：<ul><li>On-policy: Use the deterministic outcomes or samples from the target policy to train the algorithm. 行动策略和评估策略相同</li><li>Off-policy: Training on a distribution of transitions or episodes produced by a different behavior policy rather than that produced by the target policy. 行动策略和评估策略不同</li></ul></li></ol><h3 id="1-2-对价值函数进行评估和分解">1.2. 对价值函数进行评估和分解</h3><p>强化学习的目标是可以使最终价值最大化，所以需要对其进行评估。</p><p>Bellman equations refer to a set of equations that decompose the value function into the immediate reward plus the discounted future values.</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>V</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>a</mi><mo>∈</mo><mi mathvariant="script">A</mi></mrow></munder><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">∣</mi><mi>s</mi><mo stretchy="false">)</mo><msub><mi>Q</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>Q</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><munder><mo>∑</mo><mrow><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>∈</mo><mi mathvariant="script">S</mi></mrow></munder><msubsup><mi>P</mi><mrow><mi>s</mi><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><mi>a</mi></msubsup><msub><mi>V</mi><mi>π</mi></msub><mo stretchy="false">(</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>V</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>a</mi><mo>∈</mo><mi mathvariant="script">A</mi></mrow></munder><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">∣</mi><mi>s</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><munder><mo>∑</mo><mrow><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>∈</mo><mi mathvariant="script">S</mi></mrow></munder><msubsup><mi>P</mi><mrow><mi>s</mi><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><mi>a</mi></msubsup><msub><mi>V</mi><mi>π</mi></msub><mo stretchy="false">(</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>Q</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><munder><mo>∑</mo><mrow><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>∈</mo><mi mathvariant="script">S</mi></mrow></munder><msubsup><mi>P</mi><mrow><mi>s</mi><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><mi>a</mi></msubsup><munder><mo>∑</mo><mrow><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>∈</mo><mi mathvariant="script">A</mi></mrow></munder><mi>π</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">∣</mi><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><msub><mi>Q</mi><mi>π</mi></msub><mo stretchy="false">(</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}V_{\pi}(s) &amp;= \sum_{a \in \mathcal{A}} \pi(a \vert s) Q_{\pi}(s, a) \\Q_{\pi}(s, a) &amp;= R(s, a) + \gamma \sum_{s&#x27; \in \mathcal{S}} P_{ss&#x27;}^a V_{\pi} (s&#x27;) \\V_{\pi}(s) &amp;= \sum_{a \in \mathcal{A}} \pi(a \vert s) \big( R(s, a) + \gamma \sum_{s&#x27; \in \mathcal{S}} P_{ss&#x27;}^a V_{\pi} (s&#x27;) \big) \\Q_{\pi}(s, a) &amp;= R(s, a) + \gamma \sum_{s&#x27; \in \mathcal{S}} P_{ss&#x27;}^a \sum_{a&#x27; \in \mathcal{A}} \pi(a&#x27; \vert s&#x27;) Q_{\pi} (s&#x27;, a&#x27;)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.6868em;vertical-align:-5.0934em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5934em;"><span style="top:-7.5934em;"><span class="pstrut" style="height:3.05em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span><span style="top:-4.9217em;"><span class="pstrut" style="height:3.05em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.05em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span><span style="top:0.4217em;"><span class="pstrut" style="height:3.05em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.0934em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5934em;"><span style="top:-7.5934em;"><span class="pstrut" style="height:3.05em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight">A</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">∣</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span><span style="top:-4.9217em;"><span class="pstrut" style="height:3.05em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.075em;">S</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.05em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight">A</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">∣</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.075em;">S</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">)</span></span></span></span><span style="top:0.4217em;"><span class="pstrut" style="height:3.05em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.075em;">S</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight">A</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.0934em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="2-Common-Approaches">2. Common Approaches</h2><div style="width:80%;margin:auto"><img src="/machine-learning/reinforcement-learning/taxonomy.png" class="" title="Taxonomy"></div><h3 id="2-1-Dynamic-Programming">2.1. Dynamic Programming</h3><p>When the model is fully known, following Bellman equations, we can use Dynamic Programming (DP) to iteratively evaluate value functions and improve policy. The policy would greedy based on the Q-value. Iteratively update the state value and the Q-value.</p><p>Generalized Policy Iteration (GPI) adaptive dynamic process</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub><munderover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow></mrow></mpadded><mpadded width="+0.6em" lspace="0.3em"><mtext>evaluation</mtext></mpadded></munderover><msub><mi>V</mi><msub><mi>π</mi><mn>0</mn></msub></msub><munderover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow></mrow></mpadded><mpadded width="+0.6em" lspace="0.3em"><mtext>improve</mtext></mpadded></munderover><msub><mi>π</mi><mn>1</mn></msub><munderover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow></mrow></mpadded><mpadded width="+0.6em" lspace="0.3em"><mtext>evaluation</mtext></mpadded></munderover><msub><mi>V</mi><msub><mi>π</mi><mn>1</mn></msub></msub><munderover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow></mrow></mpadded><mpadded width="+0.6em" lspace="0.3em"><mtext>improve</mtext></mpadded></munderover><msub><mi>π</mi><mn>2</mn></msub><munderover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow></mrow></mpadded><mpadded width="+0.6em" lspace="0.3em"><mtext>evaluation</mtext></mpadded></munderover><mo>⋯</mo><munderover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow></mrow></mpadded><mpadded width="+0.6em" lspace="0.3em"><mtext>improve</mtext></mpadded></munderover><msub><mi>π</mi><mo>∗</mo></msub><munderover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mrow></mrow></mpadded><mpadded width="+0.6em" lspace="0.3em"><mtext>evaluation</mtext></mpadded></munderover><msub><mi>V</mi><mo>∗</mo></msub></mrow><annotation encoding="application/x-tex">\pi_0 \xrightarrow[]{\text{evaluation}} V_{\pi_0} \xrightarrow[]{\text{improve}}\pi_1 \xrightarrow[]{\text{evaluation}} V_{\pi_1} \xrightarrow[]{\text{improve}}\pi_2 \xrightarrow[]{\text{evaluation}} \dots \xrightarrow[]{\text{improve}}\pi_* \xrightarrow[]{\text{evaluation}} V_*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2581em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">evaluation</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span><span style="top:-2.578em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.122em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3396em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0895em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">improve</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span><span style="top:-2.578em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.122em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2581em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">evaluation</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span><span style="top:-2.578em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.122em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3396em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0895em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">improve</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span><span style="top:-2.578em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.122em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2581em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">evaluation</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span><span style="top:-2.578em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.122em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2115em;vertical-align:-0.122em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0895em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">improve</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span><span style="top:-2.578em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.122em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2581em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1757em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">evaluation</span></span></span></span></span><span class="svg-align" style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span><span style="top:-2.578em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.122em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1757em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><h3 id="2-2-Monte-Carlo-Methods">2.2. Monte-Carlo Methods</h3><p>Model-free method.It learns from episodes of raw experience without modeling the environmental dynamics and computes the observed mean return as an approximation of the expected return</p><h3 id="2-3-Temporal-Difference-Learning">2.3. Temporal-Difference Learning</h3><p>TD Learning is model-free and learns from episodes of experience.However, TD learning can learn from <strong>incomplete</strong> episodes and hence we don’t need to track the episode up to termination.</p><p>主要思想是将效用估计朝着理想均衡方向调整:</p><ul><li>TD调整一个状态与已观察到的后继状态相一致</li><li>ADP调整一个状态与可能出现的的后继状态相一致</li><li>TD可视为对ADP的一个粗略有效的一阶近似</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>V</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>α</mi><msub><mi>G</mi><mi>t</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>V</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><msub><mi>G</mi><mi>t</mi></msub><mo>−</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>V</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>γ</mi><mi>V</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>γ</mi><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>A</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}V(S_t) &amp;\leftarrow (1- \alpha) V(S_t) + \alpha G_t \\V(S_t) &amp;\leftarrow V(S_t) + \alpha (G_t - V(S_t)) \\V(S_t) &amp;\leftarrow V(S_t) + \alpha (R_{t+1} + \gamma V(S_{t+1}) - V(S_t)) \\Q(S_t, A_t) &amp;\leftarrow Q(S_t, A_t) + \alpha (R_{t+1} + \gamma Q(S_{t+1}, A_{t+1}) - Q(S_t, A_t))\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">γV</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span><span style="top:-0.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>To learn optimal policy:</p><ul><li>SARSA: On-Policy TD control<ul><li>“SARSA” refers to the procedure for updating the Q-value.</li><li>Same routine of GPI.</li><li>In each step of SARSA, we need to choose the next action according to the current policy.</li></ul></li><li>Q-Learning: Off-policy TD control<ul><li>The key difference from SARSA is that Q-learning does not follow the current policy to pick the second action (off-policy).</li><li>Q-learning may suffer from instability and divergence when combined with an nonlinear Q-value function approximation</li></ul></li><li>Deep Q-Network<ul><li>It quickly becomes computationally infeasible to memorize Q-table when the state and action space are large.</li><li>Use functions (i.e. a machine learning model) to approximate Q values and this is called function approximation.</li><li>greatly improve and stabilize the training procedure of Q-learning by two innovative mechanisms:<ul><li>Experience Replay: improves data efficiency, removes correlations in the observation sequences, and smooths over changes in the data distribution.</li><li>Periodically Updated Target: only periodically updated, overcomes the short-term oscillations</li></ul></li></ul></li></ul><h3 id="2-4-Combining-TD-and-MC-Learning">2.4. Combining TD and MC Learning</h3><p>In TD learning, we only trace one step further down the action chain when calculating the TD target. One can easily extend it to take multiple steps to estimate the return.</p><div style="width:90%;margin:auto"><img src="/machine-learning/reinforcement-learning/TD_MC_DP_backups.png" class=""></div><h3 id="2-5-Policy-Gradient">2.5. Policy Gradient</h3><p>All the methods we have introduced above aim to learn the state/action value function and then to select actions accordingly. Policy Gradient methods instead learn the policy directly with a parameterized function.</p><ul><li>Measure the quality of a policy with the policy score function.</li><li>Use policy gradient ascent to find the best parameter that improves the policy.</li></ul><h3 id="2-6-Asynchronous-Advantage-Actor-Critic-A3C">2.6. Asynchronous Advantage Actor-Critic (A3C)</h3><ul><li>Asynchronous: Several agents are trained in it’s own copy of the environment and the model form these agent’s are gathered in a master agent. The reason behind this idea, is that the experience of each agent is independent of the experience of the others. In this way the overall experience available for training becomes more diverse.</li><li>Advantage: Similarly to PG where the update rule used the dicounted returns from a set of experiences in order to tell the agent which actions were “good” or “bad”.</li><li>Actor-critic: combines the benefits of both approaches from policy-iteration method as PG and value-iteration method as Q-learning (See below). The network will estimate both a value function V(s) (how good a certain state is to be in) and a policy π(s). Agent uses the value estimate (the critic) to update the policy (the actor) more intelligently than traditional policy gradient methods.</li></ul><div style="width:70%;margin:auto"><img src="/machine-learning/reinforcement-learning/a3c.png" class=""></div><h2 id="3-Known-Problems">3. Known Problems</h2><ul><li>Exploration-Exploitation Dilemma</li><li>Deadly Triad Issue: off-policy, nonlinear function approximation, and bootstrapping are combined in one RL algorithm, the training could be unstable and hard to converge.</li></ul><h1>模仿学习</h1><h2 id="1-背景">1. 背景</h2><p>Background:</p><ul><li>Given: demonstrations or demonstrator</li><li>Goal: train a policy to mimic demonstrations</li></ul><p>Intuition:</p><ul><li>人们并不总是知道执行某项任务所获得的报酬</li><li>但是人们可能会知道“做什么是正确的事情（最佳策略）</li></ul><p>Rollout: sequentially execute <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi(s_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> on an initial state</p><ul><li>Produce trajectory <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{T}=(s_0,a_0,s_1,a_1,...)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.25417em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mclose">)</span></span></span></span></li></ul><h2 id="2-模仿学习分类">2. 模仿学习分类</h2><ul><li>Behavior cloning</li><li>Direct policy learning (multiple step BC)</li><li>Inverse reinforcement learning (assume learning R is statistically easier)</li></ul><div style="width:70%;margin:auto"><img src="/machine-learning/reinforcement-learning/IL_types_1.png" class="" title="Imitation learning types 1"></div><div style="width:70%;margin:auto"><img src="/machine-learning/reinforcement-learning/IL_types_2.png" class="" title="Imitation learning types 2"></div><h3 id="2-1-Behavioral-Cloning-simplest-Imitation-Learning-setting">2.1. Behavioral Cloning (simplest Imitation Learning setting)</h3><p>Treat experts’ states-actions pairs i.i.d and as training example use supervised learning (from state to action).Distribution provided exogenously.</p><p>When to use BC?</p><div style="width:70%;margin:auto"><img src="/machine-learning/reinforcement-learning/BC.png" class="" title="BC"></div><h3 id="2-2-Direct-Policy-Learning">2.2. Direct Policy Learning</h3><p>Learning reduction: Reduce “harder” learning problem to “easier” one</p><p>Idea:</p><ul><li>Construct a sequence of distributions or sequence of supervised learning problems.</li><li>Query interactive oracle about the state and construct a loss function according to our action and expert action on this state.</li></ul><div style="width:70%;margin:auto"><img src="/machine-learning/reinforcement-learning/DPL_example.png" class="" title="DPL_example"></div><div style="width:70%;margin:auto"><img src="/machine-learning/reinforcement-learning/IL_sequential.png" class="" title="Sequential process"></div><h3 id="2-3-Inverse-reinforcement-learning">2.3. Inverse reinforcement learning</h3><p>Inverse RL指我们需要对环境的reward进行建模。RL与IRL的对比如下图所示：</p><div style="width:70%;margin:auto"><img src="/machine-learning/reinforcement-learning/RL_IRL.png" class="" title="RL-IRL"></div><p>In a traditional RL setting, the goal is to learn a decision process to produce behavior that maximizes some predefined reward function.Inverse reinforcement learning (IRL), flips the problem and instead attempts to extract the reward function from the observed behavior of an agent.IRL seeks the reward functions that ‘explains’ the demonstrations.</p><p>此时同样存在是否依赖 transition function 的情况</p><div style="width:70%;margin:auto"><img src="/machine-learning/reinforcement-learning/InverseRL.png" class="" title="InverseRL"></div><h1>References</h1><ul><li><a href="https://en.wikipedia.org/wiki/Reinforcement_learning">https://en.wikipedia.org/wiki/Reinforcement_learning</a></li><li><a href="https://medium.com/@SmartLabAI/reinforcement-learning-algorithms-an-intuitive-overview-904e2dff5bbc">https://medium.com/@SmartLabAI/reinforcement-learning-algorithms-an-intuitive-overview-904e2dff5bbc</a></li><li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html">https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html</a></li><li>人工智能：一种现代的方法</li><li><a href="https://sites.google.com/view/icml2018-imitation-learning/">https://sites.google.com/view/icml2018-imitation-learning/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>reinforcement-learning</tag>
      
      <tag>imitation-learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>翟东升政经启翟系列视频</title>
    <link href="/economy-finance/didongsheng/zjqd/"/>
    <url>/economy-finance/didongsheng/zjqd/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>翟老师与观视频合作的系列视频，内容可能较为广，此处总结要点便于回顾。整个系列视频的时间为 2020-06 至 2021-02。整个系列视频约有40节，内容涵盖政治经济教育文化等方面。是翟老师其自身研究观点的整理与科普输出，值得思考。</p><span id="more"></span><h1>2020-06-03 雄安，你就是中国的学园都市了！</h1><p>如何在新型举国体制下处理政府和市场关系</p><ul><li>市场是政府的创造物，是一种基础性公共产品，目的是覆盖消费者。</li><li>政府要帮助新的商业模式探清道路。</li><li>科学由政府来做，技术由市场和企业来做</li><li>政府需要向国民提供安全。</li><li>政府可以为企业分担小部分的技术研发风险。</li></ul><p>科技创新：</p><ul><li>技术路线不能单主体决策</li><li>适当的远离市场，“养一批闲人”在雄安，创造一个良好的科研氛围。</li></ul><h1>2020-06-10 美国以后不让我们摸了，中国该怎么自己过河？</h1><p>创新人才基础存在（智商较高）。</p><p>中国文化抑制创新的因素：</p><ul><li>重物而轻人，不愿意为人才买单只愿意为物品买单。</li><li>对说谎造假的惩罚和仇视不够，机会不能给到有真才实学的人。</li><li>好面子怕出丑怕红脸，尊老。</li><li>不喜辩论不喜批判。</li><li>教育考试体系求全，要求平衡发展。</li><li>人才之间跨国交流，目前被抑制。</li></ul><h1>2020-06-17 曾经的华尔街之狼，为什么在特朗普时代成了哈士奇？</h1><p>美国金融业对美国内政外交的影响力产生持续大规模的衰落。</p><p>1960年代，华尔街背后家族有多个族群，基本都是犹太人。1970年代前，美国国家利益就是有利于通用公司的利益。1980年代，什么有利于华尔街什么就有利于美国。</p><p>上位过程：</p><ul><li>华尔街通过捐赠逐步上位。同时搞人员渗透（1960开始持续上升，最高达到60%）。</li><li>华尔街搞意识形态渗透，逐步上位。例如格林斯潘。</li><li>华尔街大而不能倒，绑架内政外交。</li></ul><p>下位过程：</p><ul><li>08年金融危机之后政治声望一落千丈</li><li>和其他医药协会、步枪协会比不占上风</li></ul><p>世界资本主义利益分配结构：</p><ul><li>美国产业通过股权债券外包给欧日韩</li><li>欧日韩FDI（外商直接投资）产业迁移到中国实现中国工业化（要付给外商15%）</li><li>中国买美国国债，和华尔街有紧密联系（3%收益率）<ul><li>3%-15%是快速工业化的代价</li><li>中方和华尔街关系紧密（互利），2016年之后华尔街影响力急剧衰弱。</li></ul></li></ul><p>负利率时代，受伤最严重的就是金融系统，所以华尔街影响力可能还会持续下降。</p><h1>2020-06-24 中国年轻人压力这么大，怎么才能让他们有钱消费？</h1><p>《美国真相》：政府市场关系的分析。</p><p>市场私人部门繁荣是因为政府能提供有效公共产品：</p><ul><li>和平安全</li><li>基础设施</li><li>国际贸易条约</li><li>基础科研基础教育</li><li>知识产权保护</li></ul><p>在保证公共产品的情况下，综合税率越低越好。</p><p>为何瑞典和北欧区域如此成功？不是因为税收高，企业就不干活，而是政府有钱可以转化为有效公共产品，导致私人部门的繁荣。</p><p>国内主要矛盾：全球总需求本国总需求增速偏低，但是供给能力偏强，供给过剩。</p><p>所以：</p><ul><li>内循环，让中国年轻人有钱去消费。</li><li>中国综合税率和美国差不太多，并不适合给企业减税，降税是增加了后代债务，给全球消费者输出了通货紧缩，加强了中国与外部的竞争力度。</li><li>鼓励年轻人生孩子。</li></ul><h1>2020-07-01 数据时代中国真正的对手还是只有一个：美国</h1><p>新技术带来的挑战：科技进步对中国对世界的冲击和影响。科技进步利于再分配而不是创造新财富。以更低成本以满足原有需求。</p><p>现象：</p><ul><li>垄断性平台剥削生产商</li><li>商家相对消费者能力更大了</li></ul><p>科技进步后果：</p><ul><li>贫富分化进一步增大</li><li>大企业和政府谈判地位更强</li></ul><p>负利率时代，人工智能发展时代，金融业能容纳的就业人数未来将会萎缩。教师等细分领域的人员也会需求降低。英语汉语西语对其他语言的文明的冲击可能十分明显。</p><p>如何建设新时代中国特色社会主义，不能刻舟求剑。重新思考教育制度，终身教育。退休制度，福利制度。养老育儿制度。</p><h1>2020-07-08 黑人运动在美国翻不了天，真正会使美国蛮族化的力量是…</h1><p>美国文化革命的根源：</p><ul><li>种族的结构性变化</li><li>贫富分化</li></ul><p>美版文革特点：种族党派贫富分化叠加一起。</p><ul><li>共和党几乎全部白人。民主党五花八门。</li><li>美国文化革命发展缓慢，呈现周期性，需要社会动能去刺激。持续时间长。</li></ul><p>运动的前景：</p><ul><li>虽然以黑人为导火索，拉丁人真正动员起来才是真正的高潮。</li><li>平权的悖论：肤色，性别，年龄段。是要求机会的平等还是结果的平等？</li><li>如何评判革命是否成功？（是否通过斗争达到团结？）美国正在出现古罗马的蛮族化。</li></ul><p>对中国的启示：</p><ul><li>要对中美竞争有信心。</li><li>信心源于，我专而敌分。</li><li>美国种族主义的原罪。</li><li>加强对拉丁裔文化的研究。什么样的新美国化？对美政策有的放矢。</li></ul><h1>2020-07-15 翟老师：下代霸主应该是个十亿人口规模的国家…印度：正是在下</h1><p>全球化的周期（贸易全球化指标：出口/GDP）：</p><ul><li>1870-1914 上升</li><li>1914-1945 下降：英帝国的衰落</li><li>1945-1979 平行竞争，半球化时代</li><li>1979-2008 全球化时代，中国融入世界市场，英美提出新自由主义全球化。</li><li>2008-至今 全球化指标下行，逆全球化。</li></ul><p>为什么全球化会有一个波动？全球化是历史的必然趋势吗？</p><ul><li>广义全球化：大航海突破地理隔阂。</li><li>狭义全球化：</li><li>霸权周期就是全球化周期。</li></ul><p>几波全球化：</p><ul><li>荷兰大航海，使商品跨境流通。人口大规模增长。百万人口。</li><li>英国工业文明诞生，FDI跨界流通。人均GDP跨境流通。千万人口。</li><li>美国，信息革命，货币跨界流动。亿级人口。</li><li>十亿人口规模？中国？印度？欧盟？</li></ul><h1>2020-07-22 统治世界400年的新教，就要被我们“筷子教“打败了？</h1><p>看起来是霸权更替，但是荷兰英国美国都是新教文明。</p><p>12年前，指标上出现重大变化。2019年，东亚文化制造业总产出超过新教文明圈。东亚文明圈的共同点，都在用筷子。</p><p>过去两百年形成的大众政治体系在逐渐过时。小众政治时代，对全人类的政治稳定提出巨大挑战。</p><h1>2020-07-29 欧盟又开始追求大一统了？中国先笑出了声……</h1><p>全球市场对欧洲一体化前景乐观。</p><p>需要中央政府对利益进行再分配。因为内部不同省份竞争力变化。在欧盟下看，汇率对德国低谷，对南欧高估，所以强者愈强，弱者恒弱。但是以前欧盟的转移支付能力有限。新冠疫情下的转移支付法案，让他家看到了一体化的希望。</p><p>欧盟对中国的定位（疫情之前）：</p><ul><li>系统性对手：政治和社会制度方面</li><li>谈判伙伴：国际问题</li><li>经济竞争</li></ul><p>未来三角游戏：</p><ul><li>军事：中美俄</li><li>经济：中美欧</li></ul><p>欧盟体系：成员国太多，成事不足败事有余。</p><h1>2020-08-05 眼看和平演变马上要成功…公知和特朗普：快！“救”中国</h1><p>黑格尔：重要的历史往往上演两次，第一次是悲剧，第二次是闹剧。</p><p>美国对华派系</p><ol><li>老一代中国问题专家，知华派愿意接触中国，白人为主。</li><li>新一代中国问题专家，很多由中国去美国，对中国文化抱有仇恨态度，认为接触派是错的。坚持有原则的现实主义，施压中国。</li></ol><p>进入美国体系，经济上的获益，是以独立性丧失为代价。虽然特朗普政府短期带来的损失比较多，但是戳破了过去四十年美国对中国实施的和平演变政策，而且客观的太高了中国的国际地位。</p><p>两个时代的中美关系：</p><ul><li>奥巴马时代：不平等，不对抗</li><li>特朗普时代：平等，对抗</li></ul><h1>2020-08-12 美国：我得癌症了，急需医生！美国医保：可肿瘤就是我</h1><p>美帝国为什么相对衰弱了？</p><ul><li>过度扩张穷兵黩武？这个观点站不住脚。国防占比占财务支出规模减少。</li><li>美帝国体系最大的问题是内耗。医疗医保支出持续扩大，医保体系存在巨大的系统性问题。</li></ul><p>美国医疗产业越来越垄断，形成强大利益集团。药品福利管理局也在合并垄断，推荐高价格药品。保险业不受联邦反垄断法管理。且这一系列链条向政府提供了很多的政治献金。猫鼠沆瀣一气。</p><p>如何游说的？华盛顿K街，很多游说公司。和国会议员助理沟通，再简短的和议员见面写支票，进入他下一次的竞选资金池。</p><h1>2020-08-19 从小父母告诉我读书可以改变命运！美国学生：我酸了…</h1><p>两种教育思潮的撕扯：</p><ul><li>自由主义教育思想：爱与自由，自然生长。重视文科艺术。个人价值本位。</li><li>非自由主义教育思想：调用本民族教育资源。从严要求约束。重视理工科。集体价值本位。</li></ul><h2 id="美国">美国</h2><p>美国自由主义教育好不好？</p><ul><li>公立教育质量非常差。<ul><li>很早放学。</li><li>体育娱乐活动多。</li><li>理工科难度比较低。</li><li>中小学老师待遇低，素质差。</li></ul></li><li>读书改变命运的观念不存在。读书无用论。</li><li>美国高等教育存在巨大泡沫。</li><li>人文领域人才来自私立教育，理工人才来自欧亚大陆。</li></ul><h2 id="日本">日本</h2><p>看到日本年轻人综合素质比较低下。举例：</p><ul><li>中文专业无法用中文英文交流。</li><li>旅游专业无法安排行程。日语也无法讲解。</li></ul><p>1980教育改革，让孩子自由生长。造成平成废宅。</p><h2 id="百年前英德">百年前英德</h2><p>自由主义和非自由主义教育理念之争，百年前英德已经完美演绎了</p><p>1870-1914：</p><ul><li>英国<ul><li>小学入学率偏低（50%），中学更低（25%）</li><li>着重于发现天赋</li><li>嘲讽对技能的培训</li></ul></li><li>德国作为一个落后国家<ul><li>重视教育，认为教育是义务</li><li>强调纪律和礼貌</li><li>重视理工科</li></ul></li></ul><h2 id="中国">中国</h2><p>不能学习英美的自由主义教育。坚持为中华民族崛起而读书。应该继续重视理工科。在高考下，寒门仍能出贵子。针对目前教育的问题，可以通过更实际的方式解决。</p><h1>2020-08-26 压低老百姓的福利来发展本国经济，这不是必须滴！</h1><p>以德意志第二帝国的成功经验为例。</p><ol><li>发达的公共产品：<ul><li>市场经济</li><li>福利制度</li><li>全序列高质量教育</li><li>基础设施建设</li><li>立法保护创新</li></ul></li><li>德意志帝国产业部门兼并联合。真实世界中垄断不一定带来低效，可能会以全球消费者的福利损失来通过工资和福利分享给本国国民。</li><li>德国金融为实体产业服务，鼓励金融和实体产业股权人事上高度交叉。</li></ol><p>对中国启示：</p><ul><li>加大教育研发投入，保护知识产权</li><li>搞好社会再分配，实现社会团结</li><li>不必压低本国福利来谋求经济发展</li></ul><h1>2020-09-02 这个盛世帝国的灭亡，给中国复兴之路留下的5个经验教训</h1><p>以德意志第二帝国的灭亡为例。二十世纪早期的德意志帝国和当今中国有相似之处：</p><ul><li>后发的工业国，通过新一轮工业革命的基于实现对原有大国的赶超</li><li>与原有大国是盟友关系，但趋于反目</li><li>陆海复合型国家，且安于陆权</li><li>想过与原有大国重温旧梦（英德，中美G2）</li><li>新型大国韬光养晦</li><li>反对老大国的自由主义经济学，强调国情独特，强调个体服从整体，爱国主义价值观</li><li>国内搭建铁路，海外延伸，要实现大陆体系互联互通</li><li>模仿发达国家再技术反超</li><li>面临外国邻国的仇怨</li><li>工业化之后通过财富再分配缓解国内分化</li><li>认为老霸主是全球帝国，不会集中所有力量，对方会上门来打，自己有主场优势。把问题想象的相对简单。</li></ul><p>会重蹈覆辙吗？有若干点关键不同。</p><ul><li>政治制度不同。世袭封建和资本主义的嫁接vs民主集中制度。</li><li>名族个性不同。中国人实用唯物主义。德意志浪漫主义，内在的自杀倾向，悲剧之美。</li><li>人口规模不同。中国相当于美欧日只和。人口质量长期来看不同。</li><li>外交制度不同。中国不搞扩张主义。</li><li>中国不穷兵黩武。</li></ul><p>对我们的教训：</p><ul><li>不要过度刺激民族主义。给本国民众提供平等发展空间。不能热衷操纵民意。</li><li>联盟战略。</li><li>少搞存量博弈，多搞增量博弈。</li><li>军事力量建设，不能面面俱到要有专长。在一两个维度有绝对优势。</li><li>充分战略规划和估计，不能太过乐观。</li></ul><h1>2020-09-09 讨论“中国GDP何时超美”没意义，这不是时间能决定的问题</h1><p>用线性外推推测中国GDP合适超过美国是存在很严重的错误的。大国GDP相对力量变化背后结构性因素逻辑是什么。</p><p>中国经济超过美国不是客观趋势而是<strong>一种选择</strong>。背后的逻辑结构：</p><ul><li>过去100年绝大多数国家GDP难以长期超过美国。</li><li>中心国家比外围国家富有且稳定。</li><li>大国人均GDP占美国比例会不断上移趋进却无法达到美国经济。</li><li>美国的GDP和其他国家的GDP不一样。美国提供流动性，其经济是虚的。</li><li>美国经济的“虚”决定其他经济的“实”。</li></ul><p>美国GDP占全球1/4：</p><ul><li>非美经济规模应该等于美经济规模（生产=消费）</li><li>美元占全球货币市场份额50%多。</li></ul><p>所以：</p><ul><li>中国如果以美元储备为基础，永远无法超过美国GDP。</li><li>出口换美元存在局限</li></ul><h1>2020-09-16 美帝国自以为一切尽在掌握，不料失控而让这里再度崛起</h1><p>东亚供应链的政治经济学含义。目前三大供应链：东亚，美加墨，欧洲。</p><p>日本是龙头，其成功之后低端产业转移到四小龙，之后再转移到中国，现在正在转移到越南。为什么东亚能成功？龙腾文化。</p><ul><li>东亚具有强政府，对于国民比较强势。工业化往往是由强政府推动。强政府一般是由战争而来。</li><li>东亚民众智商高。全球人均智商最高的区域。</li><li>东亚文化总体不信神。（升官发财生儿子。交易心态。）高储蓄率。</li></ul><p>东亚模式缺陷：依附性的出口导向的发展，以本国民众的血汗换取别的国家的主权信用。</p><p>美国用投资收益顺差来支付贸易逆差。经济表现不错，通胀低位。但是以中国加入东亚供应链而转变。于是美国提出TPP想把中国踢出，但是特朗普推出。所以RCEP获得发展。</p><h1>2020-09-23 中国工业化搞全产业链通吃？这是违背经济规律的幼稚做法！</h1><p>中国实现最大规模最快的工业化，主要原因1992年之后：</p><ul><li>区别于日韩，中国欢迎别的国家来投资。（超国民待遇）</li></ul><p>这一系列工业化浪潮，打乱了日本的雁行计划。1994年人命币贬值，与美元非正式挂钩。开放欢迎<strong>制造业</strong>外资。</p><p>中国角色的变化，从低端到终端。本土品牌，本土供应链崛起。目前全产业链都有。</p><h2 id="中国要保持全产业链吗？">中国要保持全产业链吗？</h2><p>不能。汇率定价，要素价格配置不能同时适应低附加值和高附加值的商品。</p><p>通过产业升级改造，可以产生贸易顺差，人民币汇率会进一步升高。此时劳动密集型产品没有生存空间。中国劳动力总人数萎缩，劳动力成本越来越高（这是我们发展的目的。）。</p><p>我们不是要保持全产业链，而是要保留高附加值的产业。不能有卡脖子的事情。低端的污染的产业要让别人承担一部分。低端产业也不能转移到一个国家，非东亚国家。</p><h2 id="新冠会导致去中国化加速吗？">新冠会导致去中国化加速吗？</h2><p>会强化中国制造业的地位。虽然东亚制造业先断裂再快速恢复，介入到了很多原先排斥我们的地方。中国在东亚取得了中心地位。</p><h2 id="政治影响">政治影响</h2><p>之前日本经地区首要地位时，政治上十分软弱。而中国的地区领导力令人刮目相看。</p><h1>2020-09-30 日本究竟毁在哪里？日本政策界：我们也反思了35年…</h1><p>中国汇率提升会不会重蹈日本的覆辙？</p><h2 id="日本有什么问题">日本有什么问题</h2><p>和德国相比，日元升值很晚。大企业财阀推动少升值晚升值。导致产业升级得慢。德国不靠汇率低估来获取竞争力。所以德国央行不需要大规模放水导致泡沫。同时日本生育率持续低迷。</p><p>广场协议日元升值。广场协议之前日本大幅低息放债。这种快速升值，伤害了其制造业。日本通过资本项目放开和离岸中心来拉动经济。导致资产泡沫化。</p><p>问题所在：开始拒绝升值，后来短期大幅升值。</p><h2 id="对于中国">对于中国</h2><p>2005年开始升值，每年6%左右。政府给予纺织等行业补贴。但是去除补贴他们的利益也创新高。</p><h1>2020-10-07 中国低端制造业能不能转移到内陆？取决于这两个关键因素</h1><p>观点：不可行</p><h2 id="云南行">云南行</h2><p>想要将江浙沪玩具产业转移到云南的园区。但是价差很微小。长期来看这些制造业难以生存。人民币汇率长期看涨。且老龄化形势严峻。</p><p>云南的要素价格难以与东南亚等国PK。劳动力产业东南沿海的原因，运输成本低。云南运输成本很高。</p><h2 id="重庆黄奇帆">重庆黄奇帆</h2><p>引入其他地方的产业，补贴成本。仍然没有提高重庆占国内的制造业占比。</p><h2 id="我们发展的目的">我们发展的目的</h2><p>让人民过上好日子，而不是老板过上好日子。不是为了拥有这些制造业。一些无关国家安全的产业可以放弃。</p><h1>2020-10-14 听说欧洲人有好为人师的习惯，那就给他个机会，顺便打击美国反华势力</h1><p>新时代中国应该向谁学习？欧洲。</p><p>过去的中国，先学习苏联，再进行中国特色社会主义探索，再学习美国及其盟友美日韩。</p><p>为什么一定要向他人学习呢？</p><ul><li>向自己学习不吉利（lol），中国之前向谁学习谁就变差了。</li><li>师心自用和我们传统文化相悖，我们虚心好学。</li><li>和世界态势有关。国外势力新冷战，中国也没有意愿推广中国模式。以美国为首对中国模式敌视。如果抬高欧洲有利于制造统一战线。</li></ul><p>向欧洲学习：</p><ul><li>我们依旧谦虚</li><li>不再向美国学习</li><li>寻求政治共识，孤立分化共和党反华</li></ul><p>学欧洲什么？欧洲不是一个统一的模式：</p><ul><li>莱茵模式，以德国为代表</li><li>斯堪的纳维亚半岛北欧模式</li><li>地中海模式</li><li>盎格鲁撒克逊模式（比较市场化与美国类似），出口导向</li></ul><p>我们想要学的是前两种模式以及作为一个整体的模式</p><ul><li>德国的资本主义：重视国有企业在命脉产业，大陆法系，发挥国家市场两种力量</li><li>利益相关者资本主义模式（不是stockholder）</li></ul><p>欧洲各国在专利发展，人口阶级纵向流动，绿色发展等方面都十分领先。欧洲最大的公共产品是和平，其实现了一个人类命运共同体。</p><p>学习欧洲需要避免的教训：</p><ul><li>移民政策</li><li>福利政策，给老年人福利偏高</li><li>个人价值本位的人权政策，抽象人权。人权不能神圣化，我们要搞集体价值本位的人权。</li></ul><h1>2020-10-21 打破人口外流与经济衰退之间的恶性循环，振兴东北奥里给！</h1><h2 id="东北有什么问题？">东北有什么问题？</h2><p>东北为什么不行？</p><ul><li>并不是因为讲人情搞腐败，90年代的广东也有这些问题。不能用普遍因素解释区域性的特殊现象。</li><li>和地理区域有关，冬天工作时间少。但是这个观点也不合理，北欧和美国东海岸都冷。</li><li>全球化和老龄化带来的人口流动产业变迁才是根本问题。</li></ul><p>全球化：</p><ul><li>解放前是工业化最早的地区，解放后学苏联也是很领先全中国的。</li><li>1992年之后，中国成为美欧体系外围，东南沿海区位优势，人口优势处于这个体系中。东南沿海的枝叶嫁接在别人的根上，而放弃了自己的根东北。</li><li>东北军工科技和其他地区脱钩。</li></ul><p>老龄化：</p><ul><li>老龄化社会产出不会产少，可以用机器</li><li>但是老龄化社会消费萎缩，人的生命是有欲望周期，48岁是欲望高峰。</li><li>下岗潮和老龄化浪潮导致东北和其他地区拉开差距。</li></ul><p>这两个因素导致人口自由流动，年轻人出去回不来，加剧了东北老龄化趋势。本地的就业进一步下降。人不是物以稀为贵。人越密集不是竞争更激烈更难，而是每个年轻人发展机会越大。认识群居动物，人聚在一起分工规模扩大，交易机会增加，合作成本降低。</p><p>为什么东北成为中国老龄化最快的区域？因为东北是现代化城市化工业化最早的区域。现代化核心指标，女性的受教育提高。女性个体意识觉醒，导致离婚率上升，生育率下降。这个对女性是好事，但是长时间轴看，老龄化趋势加重。</p><h2 id="如何振兴东北？">如何振兴东北？</h2><p>寻找一个契机，是东北区域形成新的良性循环。e.g. 图们江出海口打通，每年多几个月北冰洋到西欧的海上通道。再做一个新城大城，提供特殊政策，吸引东北年轻人，甚至中国世界的年轻人。</p><h1>2020-10-28 地方政府亟需从抢资本转向抢人：得年轻人者，得天下！</h1><p>中国地方政府操盘过程中从强资本转向抢年轻人的逻辑。</p><h2 id="资本不再稀缺，人才稀缺">资本不再稀缺，人才稀缺</h2><p>人才是21世纪最重要的发展要素。这个转变的原因：</p><ul><li>全球需求的萎缩，产能过剩<ul><li>别国更富的人变老了，在去杠杆</li><li>中国人也在变老，产能过剩</li><li>欧日长期处于负利率时代</li></ul></li></ul><p>所以目前是“资产荒”，有钱人不愿消费，年轻人没有钱。蛋糕难以做大。存量博弈时代，需求侧更加重要，才要抢人。</p><p>从别的地方抢年轻人，以邻为壑。抢人是划算的。极少部分人才是重要的，其他人只是为了保持基因多样性。10000人中最优秀的人被吸引走了，那这10000人价值其实很少了。人才的现金流十分可观。</p><p>年轻人的养老教育等都是将来时。但是年轻人带来的效益是立竿见影的。（深圳直呼内行。）</p><h2 id="鼓励地方政府恶性竞争？">鼓励地方政府恶性竞争？</h2><p>这个从来不是新的东西。以前一直都是抢资本的恶性竞争。但是抢人会改变竞争的方式和重点。把补贴外国资本的资金拿来补贴本国年轻人。以人为中心，比倒贴资本来说，格局更有合理性。</p><h2 id="先有人还是先有产业？">先有人还是先有产业？</h2><p>蛋生鸡还是鸡生蛋？有人就有市场。不一定是要人才，有需求的年轻人都是需要争取的对象。</p><p>BBC这种无良媒体，是媒体经济学家。他们不懂底层逻辑，只拿数据对比。人口流出地区，借很少的债都是在作孽。人口流入地区，多借债是没问题的。比如武汉区域位置很好，大学教育先进，长期来看，武汉的大学生一半左右留在武汉。此处来看基础设施建设很必要。</p><h2 id="如何抢人？">如何抢人？</h2><ol><li>要形成良性竞争。年轻人在你这里生活很方便。基础设施，医疗教育跟上。</li><li>抢人再着急也不能抢外国人。</li><li>中西部不适合抢人，抢人适合大城市。</li></ol><p>政治经济学原理：</p><ul><li>财富的源头是人而不是物。</li><li>发展的本质是人的能力的提升而不是物的堆积。</li><li>技术进步导致人的消费比劳动更重要。</li></ul><p>所以年轻人比老人更重要。自由主义经济学主张，善待企业家。但是这个很容易变成，善待有钱人，厚待有钱人。民本主义政治经济学要善待本地的年轻人。</p><h1>2020-11-04 是什么让资源红利成了诅咒？政府需四大调控政策避免这些小城坐吃山空</h1><h2 id="资源诅咒的问题">资源诅咒的问题</h2><p>当一个国家发现某个市场需求巨大的自然资源，最初会有经济热潮，之后回落，升值可能有长期的经济萧条。资源反而是上天的诅咒。这个行业挣钱不挣钱和人是否努力关系不大</p><h2 id="国家的分类">国家的分类</h2><p>四种分类</p><ul><li>中心美英：提供货币信用</li><li>次中心欧日韩：提供研发，高附加值产品</li><li>再外围中涂墨越等：卖血汗</li><li>最外围国家中东非洲拉美：卖资源</li></ul><p>在国家内部也存在这样的分工。发展不均衡。发展不是物的堆积，发展是让人的能力不断提升。</p><h2 id="资源诅咒的病理机制">资源诅咒的病理机制</h2><p>多重作用路径复杂交织。</p><ol><li>市场角度，大宗商品波动大。给能源产地经济带来巨大冲击。<ul><li>价格上升期，其他产业萎靡，储蓄资金都涌入能源</li><li>价格下行期，围绕资源的产业全部倒掉。所有人几乎同时失业。</li><li>（老百姓放高利贷，利滚利发大财）</li></ul></li><li>政治和社会机制。<ul><li>收益容易被当地有钱有势的人窃取。</li><li>采掘技术要和大公司合作，民选总统往往是大公司的傀儡。</li><li>最后留给人民的往往是一地鸡毛。</li><li>存量博弈，导致当地矛盾越来越大。</li></ul></li></ol><h2 id="如何治理资源诅咒现象">如何治理资源诅咒现象</h2><p>宏观调控，对资源采掘业抑制发展。</p><ul><li>深度研发，生产下游产品。</li><li>控制总收入。价格低多卖，价格高少卖。</li><li>把资源采掘业获得的现金流培养本地年轻人。</li><li>搞储备，建立财富基金，维持平稳收入和经济波动。</li></ul><h1>2020-11-11 特朗普用贸易战拖住中国，之后拜登能“贡献”什么？日本：我有一计…</h1><p>大选的看点：</p><ol><li>共和党已经抛弃特朗普，权贵阶层也抛弃。但是特朗普并没有输得很惨。拜登大赢没有出现。<ul><li>一部分古巴裔年轻人背叛了民主党。公交车原理，上车之后希望后面人不要来。</li></ul></li><li>投票和拜登关系不大，其实是对特朗普的表决。<ul><li>提前投票，邮寄投票很利于民主党。</li></ul></li><li>这次大选有可能严重伤害美国政治治理体系，戳破美国政治神话。<ul><li>民主神话，撕裂美国，无论选谁，另一半都不服。</li><li>法制神话，如果诉诸司法，最高法院，大法官怎么判。</li></ul></li><li>国会的归属，可能出现跛鸭。</li><li>民主党共和党分歧会扩大。</li></ol><h2 id="未来中美欧关系">未来中美欧关系</h2><p>唯二能交流的话题：</p><ul><li>医疗环保</li><li>公共卫生</li></ul><h2 id="拜登为人">拜登为人</h2><p>心胸宽广，情商高情绪稳定，可以谈成合作。但是年纪比较大。而且他其实也只是过客。关税战一定会被拜登停掉。即使加入TPP也对中国影响较小。</p><h1>2020-11-18 它是决策者的参考也是投资者的僚机，请看今天的人口解读！</h1><p>如何从中国人口曲线研究中国经济？人口是慢变量，塑造的是长期趋势。</p><p>2014年那个时间节点，中国各年龄段的人口分布：</p><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/zjqd/popularization-curve-2014.png" class=""></div><h2 id="中国人口曲线的特点">中国人口曲线的特点</h2><p>从曲线来看</p><ul><li>50岁之后：自然规律，人的老化，曲线下降</li><li>50岁之前：社会规律，向左下方倾斜。总和生育率TFR下降（世界银行数据）</li><li>出生波动性很大。</li></ul><p>回顾中国人口（联合国儿童基金会数据）</p><ul><li>婴儿潮1963-1970中国，每年接近3000万。</li><li>回声潮1985-1989中国，每年近2500万。</li><li>2000年后新生儿掉到2000万之下。</li><li>单独二胎，2016全面二胎，2017反弹到1780万，然后迅速下跌。</li></ul><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/zjqd/birth-curve.png" class=""></div><p>人口的质量来看：</p><ul><li>接受过高等教育的人数随代际变化很快。<ul><li>婴儿潮（约30/3000）</li><li>今天（800/1500）</li></ul></li></ul><h2 id="人口曲线对政策制定的影响">人口曲线对政策制定的影响</h2><p>2009年的人口数据，可以推断出2011年起中国人工工资将会出现大幅上涨。后金融危机时代，中国60后人口退出低端劳动力市场（比高端劳动力退的更早）。3000万人退休，但是只有不到1000万未接受高等教育的人接替，所以农民工数量大幅减少。所以工资水平上升。所以不担心农民工失业现象，即使没有经济增长，因为我们生不出孩子。</p><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/zjqd/popularization-curve-2009.png" class=""></div><p>中国经济增速保GDP稳定增加意义何在？1%GDP能多创造约近100万非农就业岗位。这是一种确保中国社会稳定的政治需要。</p><p>2012年之后，中国政府并不故意维持较高增速，我们低端劳动力就业压力降低。即便经济增速2020年，2%中国东南沿海企业仍然招工难。</p><p>未来很长一段时间，真正面临的是<strong>大学生就业压力</strong>。引入低端产业的同时，其实是把高端产业让给了西方国家。新冠疫情加速了这样一种以内循环为主的方向的切换。只有这样创造的岗位才是自主品牌设计，高端产业，研发等。</p><h2 id="人口曲线对个人投资决策的影响">人口曲线对个人投资决策的影响</h2><p>需要配合另一条曲线。人一生的消费曲线。年轻人没钱有欲望，老年人有钱没欲望，所以消费的都少。消费高峰期时是中年人。从统计意义来看，人哪一年生孩子哪一年买车买房，哪一年孩子出国是一个定数，符合大数定理。</p><p>一般来看，大学毕业要结婚会买房。42岁事业有成收入较高换大房子。47岁左右消费高峰。52岁买豪车。60岁医药支出的高峰。65岁养老度假高峰。</p><p>这样结合婴儿潮和回声潮：</p><ul><li>2005-2012全中国会有一个房地产牛市（从90年代推断）。</li><li>2016-2021会有房地产小牛市，小户型为主，大城市远郊区。<ul><li>85-89年婚房消费高峰。</li></ul></li><li>2027-2030最后一次温和的牛市，好于2016-2021，弱于2005-2012。<ul><li>集中在大户型，回声潮买房人生巅峰。婴儿潮养老房。</li></ul></li></ul><p>年轻人口持续聚居的区域依旧会上涨。流失的区域则会下跌。</p><h2 id="总结">总结</h2><p>过去式，未来中国人口曲线波动性很少。但是可以用到，一带一路沿线国家投资。</p><h1>2020-11-25 美国：10年了，我都想把中国从全球经济里叉出去！RCEP：现在梦醒了吗？</h1><h2 id="中国加入RCEP的影响">中国加入RCEP的影响</h2><p>短期内对中国的经济影响有限。10-20年生效。给各国国内一个缓冲阶段。</p><p>较发达国家使用负面清单，而中国需要6年从正面清单转向负面清单。这个要求政府对经济运行体系管制效率题能力要求更高。</p><p>（来自朋友的数据）经济学量化模型，模拟对各国福利增长的影响，增长有限。但是RCEP的价值更多的在于重塑东亚地区地缘经济体系。</p><h2 id="RCEP对东亚供应链影响">RCEP对东亚供应链影响</h2><p>中日韩等经济链依附于美欧消费市场，是全球外围地区。现在通过全世界最大的自由贸易协定，整个体系就能够构成一个较为完整的经济体。但是还缺一个大市场，之后中国的再分配和经济升级，中国将成为全球最大市场。</p><h2 id="RCEP对中日关系的影响">RCEP对中日关系的影响</h2><p>日本在过去50年间难以扮演实质的东亚经济领头羊角色。RCEP实质实现了中日之间的自由贸易协定。可以理解为日本即将回归亚洲，以中国为中心的东亚贸易体系（经济上）。只有在经济政治安全建立深度依赖的时候才能看到“亚洲是亚洲人的亚洲”。</p><h2 id="RCEP对CPTPP的影响">RCEP对CPTPP的影响</h2><p>面对TPP中国需要做很多改革：工会、知识产权、环保、争端裁量权。否则需要自绝于东亚。所以中国加入RCEP谈判，这是一种对TPP的反制。2017美国退出TPP，日本看摊CPTPP。</p><p>中国政策延续性很好，不会否定前任。如果2021年初把中欧投资协定搞定，中日中欧大局已定。美国排挤中国的图谋难以成功了。</p><h2 id="RCEP看中印对比">RCEP看中印对比</h2><p>印度自绝于东亚经贸新体系。印度国家能力较弱。国家能力指可以强势的进行国内利益再分配。（来自社会革命改造，人民的信任。）印度的自治自立更多的是一种政治审美，而不是社会科学。逃遁避世，拒绝先进，是一条自我毁灭之路。穆迪想学邓小平，但是缺乏毛泽东帮他进行必要的社会改造。</p><h1>2021-01-06 复盘2020年我的十个预判，2021年再做七个展望</h1><h2 id="2020年初的判断">2020年初的判断</h2><ol><li>1月份，乐观面对疫情，认为5月能战胜病毒。认为病毒对欧美伤害更严重。是一次大考，考国家动员能力。但是没有想到美欧如此惨烈。</li><li>西方社会不仅会面临金融波动，还会大规模失业，引起政治危机。有些误判。之前支持桑德斯年轻人会打败建制派，预测错了。</li><li>预判对华舆情恶化。人的本能，在困难的时候妒忌和指责。2020，中国形象面临挑战。</li><li>反对美股会崩，预判标普跌破2300之后反弹，到冬季疫情重来之后再次下跌。但是没有料到美元防水情况下市场特立独行。</li><li>认为人民币成为全球金融避险地之一。成为逆周期货币。预测对了，人民币升值。（虽然比多年前的预测弱了一些）</li><li>大宗商品的波动。现在来看只能说大体正确。</li><li>预测美国传统产业出现破产潮。但是在美联储和政府的救助之下，没有出现。这个预测是错的。</li><li>认为2020年制造业不会离开中国反而会有全球占比扩张和升级。这方面说对了。东亚复苏最早，相对占比升高。</li><li>预测全世界封锁中国到中国封锁全世界。</li><li>中国资本市场，会有一个小牛市。我们需要一个牛市，预判破4000，甚至到4300.局部牛市体现在科创板创业板。</li></ol><p>做预测判断不是为了牟利。是为了检验底层知识框架和对世界的理解和认识是否准确。总体来看，方向大致正确，精确度有待提高。</p><h2 id="2021年的预测">2021年的预测</h2><ol><li>2021年，中美关系局部回暖，但是科技战，技术封锁持续。</li><li>中欧之间双边投资协定的签订和生效可能会有反复。目前仅完成了草签。部分国家议会可能难以支持。</li><li>中国内循环方面，解决卡脖子问题方面将会有多个好消息。</li><li>2021新冠疫苗生产效能竞争会成为热点。这里中国拥有优势。</li><li>2021全球多边主义有所回暖。尤其是中美欧三大经济体讨论环保节能气候变化。整治避税天堂。</li><li>2021美欧发达国家可能会使坏，怂恿重债发展中国家向中国减免债务。面临外交压力。</li><li>人民币CFET指数仍热保持一定强势。</li></ol><h1>2021-01-13 美联储已经躺平乎？你我正在买单矣</h1><p>之前2020年三月专家会认为道指会掉到10000点之下。但是却涨破30000点。这就是无铆货币时代的印钱的魅力。</p><h2 id="美联储量化宽松政策回顾和预测">美联储量化宽松政策回顾和预测</h2><p>次贷危机之后</p><ul><li>2008年9000亿</li><li>2014年4.2万亿</li><li>2019年8月中3.7万亿</li><li>2020年疫情之前4.2万亿</li><li>2020年12月7.2万亿</li></ul><p>据说2022年下一位美联储主席可能是义务现代货币理论簇拥着的女性专家。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">现代货币理论认为，现代货币体系实际上是一种政府信用货币体系。<br>主权货币不与任何商品与其他货币挂钩，只与未来税收债券相对应。<br></code></pre></td></tr></table></figure><p>所以2025年拜登第一任期结束，美联储资产负债表可能是15-16万亿美元左右。那么从2008到2025年年复合增速大约为18%（印钱速度，美元资产贬值速度）。美元资产增值速度低于18%则是在为美国国民福利长治久安做贡献。</p><h2 id="美联储资产负债表扩张，为什么美国没有严重通胀？">美联储资产负债表扩张，为什么美国没有严重通胀？</h2><p>第一大持有人是美联储，规模大于所有外国政府持有的总和。两种通胀缓冲作用：</p><ul><li>金融系统的冻结效应，弱化了信用创造过程，m1扩张但是m2、m3还没有扩张，推迟了通胀的表达。</li><li>美元作为全球储备货币，可以全球获得商品服务。通胀是全球性的。越外围通胀越高。在产能过剩，老龄化严重的经济体甚至可能出现通缩。</li></ul><h2 id="美元大放水流动性去哪里了？">美元大放水流动性去哪里了？</h2><p>三个池子吸收流动性：</p><ol><li>商品：可贸易品。全球产能过剩，美国也人口老化消费降低，所以价格不会涨得特别快。这个池子不会吸收太多流动性。</li><li>服务：增加理发餐饮价格，但是这些东西不可囤积。不能作为对抗通胀保值增值的手段。</li><li>资产：股市房地产债券。</li></ol><h2 id="美联储可以无限印钞而没有约束吗？">美联储可以无限印钞而没有约束吗？</h2><p>理论上没有限制，只要全世界愿意用劳动换美元。</p><p>共和党强调小政府，控制赤字。但是共和党总统债务扩张大幅加快。现代货币理论学者，说债务大不是问题。</p><p>扩张没有边界，但是扩张速度还是有限制。利息支出不能失控。过去20多年美国国债存量巨幅增长，但是债务利息支出稳定。美国国债利率一路降低。</p><p>如果未来通胀加剧，美联储不得不加息，导致美联邦财政借新还旧滚动存量债务利息翻倍。全球和美国本土储蓄者敢不敢相信美元？哪些因素导致美国本土通胀率走高呢？（理论和政策研究的富矿，值得研究）</p><h2 id="全球性防水带来的影响">全球性防水带来的影响</h2><ol><li>操纵汇率。美财政部将越南（操盘水平低）瑞士（货币受欢迎必须管控汇率）列为汇率操纵国。中国连续三年是汇率操纵的警告对象。</li><li>资产价格飙升。美国股市，房地产。数字货币。全球资产配置者需要把小比例资金放入某种保险柜对冲。老年人的保险柜（黄金），年轻人的保险柜（数字货币）。小泡沫（黄金比特币）并不是大事。</li><li>汇率的波动。美元指数年初100+到现在89。美国贸易逆差大幅扩张。</li></ol><h2 id="中美金融体制重大差异">中美金融体制重大差异</h2><p>中国m2和美国比较，中国GDP低但是m2大，不专业也不合理。</p><ul><li>美国m2:m1+储蓄存款、小额定期、零售的货币市场基金</li><li>中国m2:m1+个人存款企业存款、人民币存款和外汇存款</li><li>美国m2不包含10w远以上的大额和外汇存款。美国m2统计口径小于中国。</li><li>真正可比的是m3</li><li>或者比较中国净主权信用货币（资产负债表-外汇占款），和美国的资产负债表。中国信用增长率10.8%，美国18%。</li></ul><p>中国不应该建立巨额的外汇储备。</p><h1>2021-01-20 经济战该怎么打？拿破仑大陆封锁政策是最生动的反面教材！</h1><h2 id="什么是经济战">什么是经济战</h2><p>使用经济金融手段，打击削弱对方的实力和社会稳定性，改变对方政治政策和行为。</p><p>历史上：</p><ul><li>法国拿破仑对英国的大陆封锁</li><li>1950苏伊士运河，美国对英法制裁，迫使从埃及撤兵。</li></ul><p>特朗普政府：</p><ul><li>技术禁运，华为等公司的制裁</li><li>人才回归审查</li><li>关税战（针对很多贸易伙伴），一般不能称为经济战，不是以政治为目的。</li></ul><h2 id="拿破仑的经济战">拿破仑的经济战</h2><p>军事成功，大战略层面失败。打遍天下欧洲无敌手之后，发动对英国的经济战。因为海军被摧毁，不能通过暴力摧毁英国。</p><p>拿破仑犯了很多战略错误：</p><ul><li>对暴力管制迷信，对市场力量的轻视。管制内外形成巨大的价格落差。</li><li>不理解金融在国家间斗争的作用。没有把货币纳入考虑。<ul><li>允许英镑在欧洲流通。</li></ul></li><li>重商主义经济里面，拿破仑想把英国黄金挣完，使英国破产。<ul><li>在金本位下，谁黄金多谁东西贵。</li></ul></li><li>对自身的政治定位没有与时俱进。<ul><li>控制欧洲之后仍然把法国利益作为首位。</li></ul></li></ul><h2 id="中国古代经济战">中国古代经济战</h2><p>管仲，服帛降鲁。倡导穿帛，但是不允许产丝，从鲁国进口丝，鲁国农民不种粮食了。后来禁止穿帛，同时禁止粮食出口鲁国。鲁国饥荒，通货膨胀，鲁王投降。</p><p>拿破仑应该低价出售粮食且高价收购英国棉布。之后同时宣布对英国禁运粮食，对英国公司债作废。</p><h2 id="如何经济战">如何经济战</h2><p>经济战不要想挣钱，是会赔钱的。经济学家认为制裁要满足一致性原则、脆弱性原则（认为没有道理）。</p><p>经济战重要的不是压力的绝对值，而是压力的波动性。受打击对象短期收到极大压力无法有效调整。经济战要形成不利于对手，而操之在我的供求关系的巨幅波动。</p><h1>2021-01-27 美元与黄金脱钩的50年：富国债务率在变高，而穷国外汇储备却变大</h1><p>自由主义右翼经济学家喜欢用宏观杠杆率来衡量经济体的健康程度。中国宏观杠杆率高，变化太快。</p><h2 id="探讨债务问题要和货币联系起来">探讨债务问题要和货币联系起来</h2><p>以di币为例。用自己可以发行印制的钞票界定你我之间的债权债务关系，那我借的钱越多，我占你的便宜越大。用黄金等自己不能印的货币借钱，哪怕借的少都是麻烦。</p><h2 id="1971年之后债务情况">1971年之后债务情况</h2><p>富国债务率越来越高，穷国有越来越大外汇储备</p><p>毛轱辘的观点：这个是民主制度中，政治家欺负两类没有选票的利益相关者。外国人和后代。美欧日这几十年的积累债务就是在欺负外国人和后代。</p><p>翟老师观点：原因是金本位废除，主权债务的货币约束消失。而不是民主制度。1970年前美欧宏观杠杆率下行，之后持续上行。1971年之前民主制度没有带来杠杆率上升。</p><h2 id="黄金非货币化对世界运行方式的影响">黄金非货币化对世界运行方式的影响</h2><p>意义重大，影响深远。1971年前，价值有黄金定义，像一个黄金铺满的平面，相对稳定。1971年之后，就像一个美元铺满的球面，各国央行往里充气。这个气是大国的主权债务（信用变成财富）。</p><p>个人和企业想挣到钱，宏观前提是全球主要大国愿意提供负债来支撑经济的信用。</p><h2 id="华尔街的观点">华尔街的观点</h2><p>桥水基金Ray Dalio尝试用皇冠杠杆率解释金融市场经济波动国家兴衰。</p><ul><li>量纲不对，GDP流量，债务存量</li><li>1971之前和之后混为一谈。技术分析的假设，过去现实未来内在一致性，这个假设不一定成立。</li><li>单因素论，尝试找到一个因素。</li></ul><p>华尔街很多人把意识形态偏见当作定理科研学术。追求深刻惊悚带节奏，不追求真理。</p><p>某些华尔街资产管理人和民科思想家说的和中国有关的东西可信度很低。因为中国为大客户，他们要说一些讨喜或者耸人听闻的话。就像“邹忌讽齐王纳谏”。</p><h2 id="当今世界债务">当今世界债务</h2><p>全球宏观风险宏观杠杆率逻辑关系，1980年以来：</p><ul><li>发达国家债务率走高，发展中国家比较低。</li><li>哪些因素导致经济体债务率高不出问题，债务耐受度。</li><li>债务率高低和宏观风险无关，非本币计价的主权债务与宏观风险高度相关。</li></ul><p>发展中国家用本币借不到债，导致发展中国家的原罪，金融体系中遭受某种先天制裁。</p><h1>2021-02-03 建设后疫情时代的“一带一路”，输出我们强政府的经验与能力</h1><p>后疫情时代一带一路怎么搞。面临一些变革的必要和升级换代的机遇。</p><h2 id="民本主义政治经济学">民本主义政治经济学</h2><p>四组关系：</p><ul><li>中心和外围：中心剥削，但是中心更重要，供养昂贵的高精尖项目</li><li>公共部门和私人部门的关系：公共部门提供公共产品，成本是综合税率</li><li>人和物的关系：财富不是物的堆积，人才是财富。人的生产消费创新才是财富的源头。</li><li>可贸易品和不可贸易品的关系：可贸易是财富的生产，不可贸易是财富的再分配。不可贸易品的定价区别来自于可贸易品的盈利能力。所以发展的时候是要发展可贸易品。</li></ul><p>如何理解美国梦，第五个命题：我们目前处于主权信用的大泡沫中。美国梦，他激动世界就繁荣，他低落世界就萧条。中华民族伟大复兴，我们自己做梦。</p><h2 id="一带一路背景下">一带一路背景下</h2><p>美国梦即将苏醒，中国将进入中心。一般美国人民不愿意在进行全球化。西方世界变老了变小气了，也消费不动这么多东西了。不断印钱，不断稀释债权的游戏不可持续怎么办。</p><p>那我们和世界外围塑造一个新的泡泡，以前我们在别人的梦境，现在自己做梦。中国人消费是全球最大市场。旧泡泡我们是债主，但是用别人的货币定价。新泡泡我们是加之基准的确定者，定价货币人民币。</p><h2 id="外围国家为什么贫穷">外围国家为什么贫穷</h2><p>自由主义认为原因是缺少资本，但是其实不是，王公贵族很有钱。原因在于当地缺少公共产品，因为没有强政府。强政府指国家机器对社会的管控识别动员。</p><p>要帮他们发展起来，要输出如何如何建立强政府的经验和能力。就是国家建设的现代化。</p><h2 id="一带一路的目的是什么">一带一路的目的是什么</h2><p>追逐的是一带一路年轻生命。他们愿意消费但是没有钱。我们借钱给他们，他们有了现金流购买我们的产品。之后进一步投资借债，让这些年轻人进入我们的循环（但不是生活）。多种族聚居会带来惨重教训（欧美，五胡乱华）。</p><h2 id="一带一路三个倡议">一带一路三个倡议</h2><ol><li>多投资，少放债。用股权发展人民币计价的全球二级市场。</li><li>多搞集中投资，少搞分散投资（管控减弱）。</li><li>帮助他们获得可贸易部门的繁荣。设立特区，有主权没有治权，工业化新城，种族多元文化一元。塑造新中国人群体。</li></ol><p>人类命运共同体实现过程就是漫长而曲折的。</p><h1>2021-02-24 如何诱导国家间的合作与互信？推演博弈论在外交策略上的应用</h1><p>利用囚徒困境研究自私的人类何以可能合作和相互信任。个人国家来讲什么处世之道是合理的。</p><h2 id="囚徒困境">囚徒困境</h2><p>关于囚徒困境：</p><ul><li>什么是囚徒困境？<ul><li>两个囚徒是否招供。</li><li>纳什均衡。</li></ul></li><li>人性假设，人是不是自私的？<ul><li>生物学来讲是自私的。保存基因。</li><li>但是也有例外，利他主义。蚂蚁蜜蜂，共享75%的基因</li></ul></li></ul><h2 id="生活中的囚徒困境">生活中的囚徒困境</h2><p>明知合作可以共赢，但是理性的自私信任缺乏带来背叛。即使自己不贪心，但是难以相信对方不贪心。熟人社会，互相之间是友善的。</p><h2 id="是否存在最优的博弈策略">是否存在最优的博弈策略</h2><p>在罗伯特·艾克斯洛德的实验中，他向各界征集了一些列博弈策略。第一轮策略评比中，“tit for tat”（一报还一报）策略在实验中获得了第一。第二轮评比中，告诉大家该策略最优，使大家改进。但是“tit for tat”策略仍旧获得了第一。</p><p><strong>“tit for tat”</strong>：第一步假设对方是好人，之后重复对方上一步的操作。这个策略可以最有效的鼓励其他程序与自己长期合作。这个简单的策略有以下品质：</p><ol><li>善良。假设世界是对自己好的。</li><li>可激怒的。会产生报复。</li><li>宽容。如果对方弃恶从善可以原谅对方。</li><li>不嫉妒。不争取高于对手的分数。</li></ol><p>建议阅读，《合作的进化》，被诺贝尔经济学家得主认为比其自身的研究更高明。</p><h2 id="从博弈论中得到的人生信条">从博弈论中得到的人生信条</h2><ol><li>友善。</li><li>有原则。</li><li>宽容。</li><li>简单。</li><li>不妒忌朋友的成功。</li></ol><h2 id="一报还一报实操的问题">一报还一报实操的问题</h2><p>朋友关系不一定是囚徒困境。很多时候高成本低回报。现实中很多时候回报的程度不确定。如果双方都采用这个策略，误解可以导致以恶报恶。</p><h2 id="利用圈子解决人际关系中的问题">利用圈子解决人际关系中的问题</h2><p>双边关系中的回报放到多边关系中进行操作，很多问题可以引刃而解。用关系网分担了人心的自私带来的背叛的诱惑。</p><h2 id="国与国之间，对外战略的启示">国与国之间，对外战略的启示</h2><p>多边主义外交，一个国家的背叛的潜在损失很大。背负信用压力的大国，越是利用自己的信用，别人越敢相信。</p><p>中国礼让谦虚大度，捍卫原则根本利益，不羡慕别人的成功。</p><p>国与国之间应该把一次性的囚徒困境转化为重复博弈，诱导国与国之间的信任和合作，培育出信任与和平。</p>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
    <tags>
      
      <tag>翟东升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>大师计划系列视频</title>
    <link href="/economy-finance/didongsheng/dashi/"/>
    <url>/economy-finance/didongsheng/dashi/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>记录一下翟老师《大师计划》视频的内容。<br>视频时间：2021.06</p><span id="more"></span><h1><strong>1. 当今世界格局与力量对比</strong></h1><p><strong>幂律</strong>现象：强者恒强弱者恒弱。</p><p>美国领先，中国紧随其后，但是远超其他。</p><ul><li>GDP规模</li><li>财政开支，军费开支</li><li>互联网巨头平台</li><li>独角兽企业数量</li><li>顶级大学</li><li>博士学位，高被引学者</li><li>专利产出，人工智能</li></ul><p>中国仍未到达第二的地方</p><ul><li>国际舆论话语权</li><li>国际组织影响力</li><li>货币国际化指标：美欧英日中</li></ul><p>超过或正在超过美国：</p><ul><li>出口贸易额</li><li>国内消费市场</li><li>理工科大学生人数</li><li>中等收入人群规模（4.5-5亿，是否具有小汽车）</li><li>汽车市场</li><li>智能手机销售</li><li>互联网接入用户</li><li>制造业产出增加值</li><li>能源资源消耗</li><li>500强数目</li><li>5g技术</li></ul><h1><strong>2. 大胆拥抱崛起的中国</strong></h1><p>至2013-2035年。</p><ul><li>目前大学生知识分子较多，能积极参与社会分工。</li><li>2012年前出口导向，央行资产负债表扩张（以美元储备作为基础）。</li><li>2014年前中国主权信用严重压抑，将来有巨大发展空间。</li><li>2013年以来，出口对外依赖度转变。提出并推动一带一路（非美经济体）。</li></ul><p>以美元信用为基础发行货币，无论你的质量科技含量再怎么高，都是加强美元的购买力。所以真正重要的不是跑的多努力，而是往什么方向跑。</p><h1><strong>3. 中国相对于美国“道”的优势</strong></h1><p>人类文明史上两种策略的竞争和对立（格劳秀斯的海洋文明流派 &amp; 康德的大陆文明流派）：</p><ul><li>美国：选取政治、三权分立、私有产权、自由市场</li><li>集体价值本位：个体服从整体，自上而下分配管控</li></ul><p>前者在市场竞争有优势（利益，贪婪），后者在军事上有优势（荣誉感，恐惧）</p><p>国家于市场的关系具有三角对立关系。国家发展的好取决于公共部门的能力和特质。底边越长越好。税率越低越好效率越高越高。</p><div style="width:60%; margin:auto"><img src="/economy-finance/didongsheng/dashi/public.png" class=""></div><div style="width:60%; margin:auto"><img src="/economy-finance/didongsheng/dashi/tax.png" class=""></div><p>学习苏联，把底边建立。（但是苏联的税点特别高）学习美国及盟友，降低综合税率，所以出现了繁荣的私人部门。两者不能相互否定，而是要正体反体合体（中庸之道）。</p><h1><strong>4. 中国相对于美国“治”的优势</strong></h1><p>两个重要任务：</p><ol><li>数字经济的转型：机遇和冲击<ul><li>数据所有权对社会的冲击，国内现在正在规范，之前也进行了对本土公司的保护。</li><li>社会政治影响，民众识字率大幅提升，年轻人只从互联网获取和传播再加工信息，大众政治由小众政治所取代。</li></ul></li><li>解决贫富分化。<ul><li>美国：印钱，加税</li><li>中国：反腐，对不合规资本系打击，财富再分配（精准扶贫）</li></ul></li></ol><h1><strong>5. 美国衰落的主要原因</strong></h1><p>盎格鲁撒克逊王朝的帝国的生命周期末端的老年病：</p><ul><li>精神分裂：<ul><li>两党意识形态分歧变大，社会极化，攻势瓦解。</li><li>种族上也有投影。共和党白人，民主党有色人种。</li><li>建制派和民粹分裂。民众认为精英欺负大家。</li><li>四个所谓的美国：<ul><li>极左：民主党民粹派（桑德斯、沃伦，主张现代货币理论，发钱）</li><li>偏左：民主党建制派（拜登希拉里，拜登政策在讨好民粹派）</li><li>偏右：共和党精英（米奇·麦康奈尔，切尼，布什。正在失去共和党基本盘）</li><li>极右：共和党民粹（特朗普。占据共和党基本盘。）</li></ul></li></ul></li><li>脑瘤：<ul><li>华尔街的金融资本。70年代之后被一个特殊族群主导。高盛出产的精英在政界影响巨大。</li><li>内政上金融压倒实业。</li><li>外交上偏向于对中东伊斯兰的镇压征服。</li><li>经常制造泡沫。</li></ul></li><li>肝癌：<ul><li>肝癌导致有机体力量萎缩。</li><li>医疗医保医药构成的医疗系统挤占大量的财政空间。</li><li>美国是在医疗上制造支出最大的经济体，但是是OECD国家中人均寿命明显偏低的。</li><li>三医系统的政治捐赠最多。</li></ul></li></ul><h1><strong>6. 在中美的长期竞争中，我们如何赢得胜利</strong></h1><ol><li>要调整好心态。前倨而后恭。<ul><li>2035年前鼓起勇气敢于竞争。</li><li>2035年后美国可能经历惨烈的去杠杆。我们需要谦虚谨慎。</li><li>2035-2050如果美帝国出现崩盘，中俄关系可能也会出现不利于我们的翻转。</li></ul></li><li>赢得竞争不是两个国家的竞争，而是两个体系的竞争。<ul><li>美国同盟战略。源自罗马同盟大战略。</li><li>孟德斯鸠的研究，罗马在击败对手后吸纳盟友。但是盟友间不友好。而且会干涉盟友权力传承。</li><li>新的阵营浮现。美国赢得冷战后，应该避免使中俄结盟。</li><li>日本永远忠诚于最强大的国家。</li><li>印度对外政策，利用别国矛盾向双方索取好处。</li><li>我们对抗的是整个美国的同盟体系。</li><li>美国处境危险。多空双方对峙。多方中国没有加杠杆，空方拉盟友加杠杆才能均衡。如果中国加杠杆，空方可能爆仓。（如果未能兑现一个盟友的安全经济承诺。）</li><li>使他使用成本越来越高，用时间耗死他。</li></ul></li><li>做好国内再分配，和国际再分配。<ul><li>中央和地方的再分配。中央应该利用良好的信用敢于借钱，形成巨大的国债池。但是地方应该少借债。</li><li>地区再分配，东南沿海到中西部。</li><li>减少外汇储备，投到一带一路沿线的股权和债权。</li><li>积攒金钱是之前贫穷给我们带来的匮乏感的二次伤害。</li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
    <tags>
      
      <tag>翟东升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Principles for Academic Writing</title>
    <link href="/research/academic-paper-writing/"/>
    <url>/research/academic-paper-writing/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>A note about the principles for academic writing.</p><span id="more"></span><h1>Details</h1><ul><li>Capitalize the first letter of a proper noun<ul><li>For models: True</li><li>For paradigms: False</li></ul></li><li>Do not use “And” at the start of a sentence.</li></ul><h1>Narrative/Statement</h1><ul><li>Avoid and eliminate the fuzziness and subjectivity of language to the greatest extent.<ul><li>Avoid to use “we”, “I think”, etc.</li></ul></li><li>Avoid verbose expressions.</li><li>Make the statement accurate and clear.</li><li>Make the definitions accurate and clear.<ul><li>Use the right symbols for different concepts.</li></ul></li></ul><h1>Polish</h1><ul><li>Emphasize the contributions in your introduction.</li></ul><h1>Presentations of Results</h1><ul><li>Present the results in a legible way.<ul><li>Include both tables and figures.</li></ul></li><li>The figures should be in proper size and easy to be recognized.</li></ul><h1>Formatting</h1><h2 id="Reference">Reference</h2><ul><li>Unify the formats of the references in<ul><li>Capitalization</li><li>Abbreviation</li><li>Constitution</li></ul></li><li>The formal BibTex references of publications in CS literature could be found in DBLP.</li><li>For the conferences, record the month, address.</li></ul>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Research</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo文档更新时间设置</title>
    <link href="/software-tools/hexo/hexo-updated-time/"/>
    <url>/software-tools/hexo/hexo-updated-time/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>Hexo 在使用远程部署时，默认 <code>update_option: mtime</code>, 即以最后修改时间作为更新时间。这个问题导致每次编译时，文章提交到远程，所有的文章都显示更新，且时间相同。具体解决方法则是在 Front-matter 中加入<code>updated:</code>项，则编译过后的更新时间以此为准。目前看来没有可以使其自动更新的方法。</p><span id="more"></span><h1>批量加入更新时间</h1><p>这里对之前原有的 post 我们可以按照生成时间 <code>date</code> 来批量添加 <code>updated：</code>具体事项过程即在 _post 目录下运行以下代码：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> `<span class="hljs-built_in">ls</span> .`; <span class="hljs-keyword">do</span> value=`gawk <span class="hljs-string">&#x27;/date:/&#123;print &quot;updated: &quot;$2&quot; &quot;$3&#125;&#x27;</span> <span class="hljs-variable">$&#123;file&#125;</span>`; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;value&#125;</span>; gsed <span class="hljs-string">&quot;3 a\\<span class="hljs-variable">$&#123;value&#125;</span>&quot;</span> -i <span class="hljs-variable">$&#123;file&#125;</span>; <span class="hljs-keyword">done</span>;<br></code></pre></td></tr></table></figure><p>需要注意的是，awk 和 sed 命令在 MacOS 下使用方法与 Linux 不同，此处应该使用 gawk 和 gsed。</p><h1>手动更新时间</h1><p>在 <code>_config.yml</code> 中设置 <code>update_option: date</code>，则更新时间与文章创建时间一致。虽然这样起不到“更新时间”的作用，但是至少不会无缘无故的对未更新的文件进行更新。如果出现一些重要的文章修改，手动更新时间添加 <code>updated:</code> 即可。</p>]]></content>
    
    
    <categories>
      
      <category>Software Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>Master Ma</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>翟东升教授文章摘录总结</title>
    <link href="/economy-finance/didongsheng/articles/"/>
    <url>/economy-finance/didongsheng/articles/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>作为翟老师的粉丝，翟老师的文章视频几乎每期必看。此处将翟老师一些微博，头条号中的文章进行观点记录，以便查阅。</p><span id="more"></span><p>翟（dí）东升：<br>中国人民大学国际关系学院副院长、博士、教授。<br>中国人民大学世界经济专业与国际政治经济学博士生导师。<br>中国人民大学国际货币所特聘研究员。</p><p>研究方向： 货币与金融的国际政治经济学，中国对外经济关系美国政治经济</p><h1>人民币汇率、美元指数与全球通胀问题 2021-05-28</h1><ul><li>首先人民币汇率并不强，只是由于美元下跌看起来涨势明显。</li><li>时至今日，美国仅仅是我们的第三大出口市场。要讨论汇率对实体经济的影响，必须看CFET指数，也就是人民币兑一揽子主要贸易伙伴的货币的加权平均值。</li><li>人民币正在成为逆周期货币，且对美元应该有长期升值趋势 美元指数本身有17年左右的大周期，我们此刻处于新一轮下行周期的早期，考虑到新冠疫情冲击下美欧等国货币政策的现状和差异，明后两年内美元指数如果暴跌到70，无须惊讶。</li><li>关于美联储货币政策是否会尽快转入收缩的问题，我的判断是，他们会口惠而实不至。美联储主席和总统的关系会影响到货币政策。</li><li>鲍威尔若想获得连任，2022年之前很难加息缩表 我们此刻也许正在一个通胀率大时代的转折点上，未来三十年，也就是到2050年之前，全球主要经济体的通胀率也许是震荡上行的，或者说具有上涨容易下跌难的特点，各种预料之外的事情，比如疫情、战争、大国刺激生育和产业链调整等等，都会推动这个趋势的展开。</li></ul><h1>硕鼠的养成与美国的政治极化 2020-05-20</h1><ul><li>任何一个政治经济体系都存在不完美或者有待弥补的漏洞。识别、利用并扩大这些漏洞，就能给某些聪明人快速收割巨额财富和权势的机会，但却是以国民和政府的损失为代价的。他们的财务成功不是因为创造了财富，不是因为发明了新的技术和工艺，而是利用了政治和经济体系中功能失调的那部分扭曲和漏洞。</li><li>尽管饱受批评和嘲讽，科赫兄弟仍然是美国的成功人士，或者说仍然在操纵着美国的政治经济乃至科研和教育，而他们在中国的模仿者如今纷纷落马。中国特色社会主义市场经济与美国资本主义市场经济的根本区别由此显现：事实雄辩地说明，中国走的是以人民为中心的路线，美国走的是以资本为中心的路线；我们是经得起考验的人民共和国，而美国越来越像一个“香蕉共和国”。哪个国家更有前途？我从2009年起就断言，中国更有前途。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
    <tags>
      
      <tag>翟东升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>翟东升人民币国际化课程</title>
    <link href="/economy-finance/didongsheng/rmb-courses/"/>
    <url>/economy-finance/didongsheng/rmb-courses/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>翟老师金融货币市场的课程。</p><span id="more"></span><h1>第一讲：为什么关于人民币汇率的悲观预测错了</h1><p>这一讲的目的是破除一定对于汇率的谬误。</p><p><strong>现象</strong>：<br>2014-2016汇率破7。所以多数持牌企业用人民币海外投资，资金成本昂贵但是收益低。只有当5%速度贬值时才能获利。</p><h2 id="看空人民币的5个错误理由：">看空人民币的5个错误理由：</h2><ul><li>国内已过增长期</li><li>房地产泡沫不可持续，资产价格高估，只能通过汇率贬值调整</li><li>地方政府债务大，泡沫破裂会导致汇率下跌</li><li>过早的去工业化问题（东南亚，一带一路），产业和资本的转移。</li><li>中国GDP为50%，但是m2是美国的150%以上。</li></ul><h2 id="错在哪里（实证数据）：">错在哪里（实证数据）：</h2><ul><li>经济增速和汇率相关吗？<ul><li>顺周期货币和逆周期货币表现不同。外围地区顺周期，中心地区逆周期。</li><li>中国变为顺周期。</li></ul></li><li>资产泡沫与汇率波动相关性？<ul><li>跨国资产价格并不具有一价定理（回归均值）</li><li>政府并不存在保汇率保房价问题</li></ul></li><li>地方政府债务并没有那么高。（债务/GDP）<ul><li>同时债务率和汇率之间负相关。只有有钱的人才能借到更多钱。</li><li>衡量债务风险的不是债务率，若以本币借债，本质上是一种隐形税收。</li><li>格林斯潘：“女士们先生们，大家不用瞎担心，这些债其实我们永远都不用还了。” （e.g.翟币）</li></ul></li><li>资本输出汇率不一定贬值。<ul><li>资本输出会让货币更加稳定，外部获取收益，导致长期强势。</li></ul></li><li>m2与汇率的关系。<ul><li>不公平的对比，评估美国要用m3（美国直接融资），中国m2（银行信贷）。</li><li>货币发行增速和汇率不相关。</li></ul></li><li>资本大鳄的做法既不道德也不慎重。</li></ul><h2 id="为什么人民币快速升值"><strong>为什么人民币快速升值</strong>:</h2><ul><li>中国产业升级</li><li>中国老龄化</li></ul><h2 id="划重点，汇率并不是由以下这些点决定："><strong>划重点</strong>，汇率并不是由以下这些点决定：</h2><ul><li>经济增速</li><li>房价波动</li><li>债务率</li><li>对外投资、产业迁移</li><li>货币发行增速</li></ul><h1>第二讲：长期汇率由什么决定</h1><ul><li>短期汇率由市场情绪决定，不具有可预测性</li><li>中期汇率（3-5年）由政府调控影响</li><li>长期汇率（5-10）情况下，市场内在力量影响巨大</li></ul><h2 id="影响长期汇率的直接因素（实证数据验证）：">影响长期汇率的直接因素（实证数据验证）：</h2><p>一个国家可贸易品的价格水平直接影响汇率。</p><p>可贸易品价格水平由什么决定（两个表层的经济因素）：</p><ol><li>技术水平（但只能解释20%左右的变化）</li><li>人口年龄结构，老龄化（能解释65%左右的变化）<ul><li>越老龄化，汇率越强。供给不变，需求下降，价格下降。（e.g.日本）</li></ul></li></ol><h2 id="影响汇率的六个深层因素">影响汇率的六个深层因素</h2><p>（越高越强）</p><ol><li>国家能力：公共部门能力与效率问题</li><li>开放度：积极融入国际贸易（出口）<ol><li>能源大宗商品（以物为主）：明显顺周期特征</li><li>制造业为主（以人为主）：逆周期特征明显</li></ol></li><li>要素特征<ul><li>人的核心竞争力（脑力/体力）</li><li>人还是物</li></ul></li><li>文明类型<ul><li>坚挺的文明有两大类<ul><li>新教文明</li><li>东亚文明：骨子里不信神（实用主义的神），努力证明自己的财富</li></ul></li><li>软的文明：<ul><li>南亚东南亚：小乘佛教，印度教，不鼓励生产也不鼓励消费（供给需求都萎缩）</li><li>天主教东正教伊斯兰教：不鼓励教徒寻求财富，鼓励寻求快乐（供给小于需求，则借债）</li></ul></li></ul></li><li>人群智商</li><li>宗教严肃度：询盘</li></ol><h2 id="海外投资的汇率风险">海外投资的汇率风险</h2><p>哪些国家的汇率可能大规模贬值，详见深层因素。</p><h1>第三讲：为什么中国被动成为最大外汇储备国</h1><p>巨额的外汇储备不是大国的标志而是附庸国的象征。外汇储备源自对汇率波动的恐惧。发展中国家汇率波动和受到冲击非常大。</p><h2 id="中国的外汇储备是如何形成的">中国的外汇储备是如何形成的</h2><p>为了快速工业化，招商引资，对人民币需求增多，有升值压力，但是又不能允许快速升值来保障制造业。于是中国人民银行使用外汇占款买入外汇，再由国家外汇管理局买其他国家国债。</p><p>对冲流动性（4万亿美金外汇储备30万亿人民币外汇占款，货币乘数为4的话就是120万亿广义货币，此时为了避免通胀），这些策略都是有成本的：</p><ul><li>发行央票</li><li>中央政府财政存款放在库底（利息低）</li><li>提高存款准备金率</li></ul><h2 id="央行拿外汇储备干什么去了">央行拿外汇储备干什么去了</h2><p>买国债。中国外管局是美元的主要空头力量：</p><ul><li>猜想：外汇来自资本顺差和贸易顺差，还是要控制风险。</li><li>外管局将一部分美元换成其他货币进行投资降低风险。</li><li>以中国外汇储备来预测美欧元汇率</li></ul><h2 id="外汇储备无助于汇率稳定">外汇储备无助于汇率稳定</h2><p>外汇储备是追求汇率稳定的结果。</p><p>持有巨额外汇（代价大，且并不安全）：</p><ul><li>巨量外汇占款，基础货币扩张，资产价格泡沫，央行对冲成本积累。</li><li>只能持有国债，低收益。高科技产品公司和资源无法买到。</li><li>并不能维护稳定例子：50亿美金做空巴西雷亚尔（5000亿美金储备）<ul><li>要不然汇率暴跌</li><li>要不然储备暴跌，通货紧缩，经济萧条</li><li>本国居民逃离</li></ul></li></ul><p>面对做空正确的策略：有序地贬值。</p><h2 id="中国不再需要外汇储备">中国不再需要外汇储备</h2><p>不需外汇，只需要一些黄金。技术进步，产业升级，老龄化都可以减轻人民币汇率的贬值压力。我们需要担心的是汇率的长期强势。</p><h1>第四讲：政府意志与人民币汇率波动的历史</h1><p>探讨政府在货币定价中扮演的角色及作用的方式方法。</p><h2 id="2005年前，汇率为出口导向型工业化提供支持">2005年前，汇率为出口导向型工业化提供支持</h2><p>此时需要本币相对低估。以1:1.5（1980）到1:8.7（1994）。</p><p>见到实体产业迁移消长变迁的时候，要对以后几年潜在金融危机汇率动荡债务危机警惕。</p><p>1994-2005年，汇率相对稳定。亚洲金融危机时人民币拒绝贬值，导致工业化早期出现了出口困难。（用自身的经济困难换区地区稳定。）日本却因为主动贬值丧失了地区领导权。</p><h2 id="汇率主动温和升值是好事吗？">汇率主动温和升值是好事吗？</h2><p>自主渐进可控的人民币升值背景：</p><ul><li>美国认为人民币低估，要求人民币升值。</li><li>人民银行如果要保持汇率，有通胀压力，要扩充外汇占款。</li><li>出口制造部门反对汇率升值。</li></ul><p>导致许多人搞套息交易。从香港搞廉价美元贷款，付给深圳公司，换成人民币，然后利差息差获利。巨量热钱流入中国。邀请全世界人来赌人民币升值，形成一定的泡沫，上证指数1000点到6000点。长期人为的扭曲付出了沉重代价。</p><p>后人视角给当时的决策者提建议：</p><ul><li>汇率波动走势具有随机性。</li><li>但是使月周级别不可预测。</li><li>减少热钱流动。</li></ul><h2 id="后金融危机时代，人民币汇率何去何从">后金融危机时代，人民币汇率何去何从</h2><p>2008之后渐进升值，但是大大减缓。</p><ul><li>2014人民币被低估的程度不高了。2014-2016又贬值了4%左右（时间换空间，防止被做空）。</li><li>此时需要把热钱留出去。</li><li>外商持续投资减少，撤离中国（超国民待遇消失）。</li><li>2016不要对人民币贬值恐慌，认识到中国可贸易部门竞争力提升。2017人民币由市场升值</li><li>恐慌性升值，逼空2018贸易战，贬值预期</li><li>没有安抚市场，任由市场波动。</li><li>对美出口下降，但是人民币贬值，总出口稳定。2020-2021汇率明显上涨</li><li>新冠疫情，出口率先恢复。</li><li>CFETS汇率指数，与一篮子货币进行稳定化，与美国经济脱钩（换锚）。</li><li>汇率还是要基于经济基本面。</li></ul><h2 id="划重点">划重点</h2><ol><li>东亚金融危机，中国赢得周边国家信任，为周边外交开拓了市场空间，日本丧失地区领导权。</li><li>汇率的渐进升值，把市场参与者的风险转移到了政府手里，市场调控应该注意。</li><li>政府塑造的中短期汇率及其波动方式的能力很强，但是长期人为扭曲将会付出沉重代价。</li><li>高明的汇率政策既要照顾实体经济的需要，又要充分考虑金融市场的内在规律。</li></ol><h1>第五讲：铸币税及其国际国内再分配效应</h1><h2 id="铸币税的前世今生">铸币税的前世今生</h2><p>如今货币创造成本越来越低。</p><p>中国综合税率占GDP比例较低，但是如果把铸币税和土地财政纳入考量，则综合税率不再低。</p><h2 id="勤俭节约的美德“过时”了">勤俭节约的美德“过时”了</h2><p>无锚货币时代，不应再痴迷储蓄：</p><ol><li>储蓄越多，向锚货币交的税越多。</li><li>2012年前，货币增速快，钱的购买力在不断降低。</li><li>无锚货币时代，用好杠杆做好投资。</li><li>中国人民存在海外的储蓄在不断地蒸发。</li><li>越难复制的资产，升值保值能力极高。学区房，高年份茅台，艺术品等的增值快于货币增发速度。</li></ol><h2 id="外汇占款带来的货币扩张帮助了谁？">外汇占款带来的货币扩张帮助了谁？</h2><h3 id="剥夺了哪些阶层？补贴了哪些阶层？">剥夺了哪些阶层？补贴了哪些阶层？</h3><p>出口部门获利，剥夺内地居民，补贴东南沿海。中央政府通过税收反哺内地是极其必要的。</p><p>中国央行从中国人民手中收取铸币税之后转手送给了美欧日央行，以此换取中国出口制造业的发展空间。为了扶持东南沿海企业家，才会有货币超发，才会有天量外汇储备。离开了政府提供的优质公共产品，这些企业家的表现不一定好。2020年出口繁忙，人民币升值，出口企业不挣钱因为汇率变动。离开了政府保姆般的呵护，很多企业没本事挣到那么多钱。</p><p>很多先富起来的人将政府看成他们聚敛财富的负面因素，于是：</p><ul><li>2015看空人民币</li><li>投资移民走了</li></ul><p>外资企业也是明显的获益者群体：以折扣价获得土地。利用制造业服务业投资，通过土地获得资产升值的红利。</p><h3 id="中国底层消费力的重要变化">中国底层消费力的重要变化</h3><p>外汇储备稳中有降，征收广义铸币税规模大大下降。金字塔底层的群体有了一定的消费能力。</p><h2 id="劫富济贫：美国梦的真相">劫富济贫：美国梦的真相</h2><p>美国从全球征收了多少铸币税？</p><ul><li>资产负债表增量/GDP：较小</li><li>贸易逆差-海外投资金收益：通过财政收入产生数倍GDP</li></ul><ol><li>美联储扩表，剥夺全球储蓄者。</li></ol><ul><li>0.9（2008前）=》2=》4.5（2014）=》缩表（2017初）=》扩表（2019.10）=》4.2（2020.2）=》无限量化宽松=》7.5（2020末）=》15（2025？推测）</li></ul><ol start="2"><li>铸币税补贴了谁？</li></ol><ul><li>小部分补贴了美国的穷人。</li><li>主要补贴了，美国的资本所有者，股市大涨。</li></ul><p>所以要推动人民币国际化，征收全球铸币税，吸引全球储蓄者放进我们国债池。</p><h2 id="划重点-2">划重点</h2><ol><li>2012年前，为了支持本国制造业国际竞争，用土地财政和铸币税补贴了出口产业，造成了不同资产收益率的巨大差异，也造成了不同地区发展水平和不同阶层收入水平的巨大差异，形成了强大的国内再分配效应。</li><li>美国的无限制量化宽松，伤害了美国底层和全球外围国家，但是令他最富有的人大大获益。</li><li>中国要通过人民币国际化获取一定的全球铸币税，保护自己的财富。</li></ol><h1>第六讲 人民币国际化的相关问题</h1><h2 id="不平衡的全球货币格局">不平衡的全球货币格局</h2><p>美欧 GDP 占比42%左右，但是其货币却占83%。中日韩 GDP 占比27%左右，但是其货币却只占8%。</p><h2 id="人民币国际化的进展">人民币国际化的进展</h2><p>2009年，周小川呼全球改革货币体系。人民币国际化提上日程。</p><p>人民币国际化指数在2010年左右只有0.02%，2020年已在4%左右。在贸易上和投资上增长比较快，储备较低。人民币面临的问题是国债池子太小。</p><p>随着中国高端制造业发展，人民币计价份额也会像日元一样上升。</p><h2 id="人民币国际化的改革努力">人民币国际化的改革努力</h2><p>放松人民币跨境使用的管制。</p><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/rmb-kuajing.png" class=""></div><p>政府的主动动作。</p><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/rmb-active-1.png" class=""></div><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/rmb-active-2.png" class=""></div><p>开放性大宗商品交易所，意味着全世界的资源出口国可以不必绕道美元进行交易。</p><ul><li>2015年前，人民币国际化路径和日元相似，提升本币在贸易结算份额，通过香港离岸市场发展日元海外市场。</li><li>2015年，香港市场人民币波动形成了人民币做空预期，中国政府不得不拉高隔夜拆借成本，抑制投机浪潮，意识到日本模式缺陷。</li><li>2015年后多管齐下，步步为营：<ul><li>人民币大宗商品交易</li><li>人民币对外直接投资</li><li>国债市场对外开放</li><li>上海金融中心建设</li><li>金融业外资准入放开</li><li>一带一路倡议</li><li>中资公司的跨国发展</li></ul></li><li>2020，稳慎推进人民币国际化。</li><li>未来：<ul><li>中央层面协调不同部门法规，让企业家乐于便于使用人民币</li><li>人民币上印全球通用语言</li><li>超大面额钞票，便于金融不发达地区</li><li>抛弃宏观债务率迷信，统一中国国债市场，增加交易活跃度和便利性</li><li>发行特别国债来置换人口流出区域地方政府的高息债务，节省利息成本</li><li>统计局统计公布数据时以人民币为单位，同时鼓励其他经济体使用人民币作为备用单位</li></ul></li></ul><h2 id="美国对人民币国际化的态度">美国对人民币国际化的态度</h2><p>2010年之后最初几年，中国小心翼翼，“推动人民币跨境使用”。</p><ul><li>搞经济金融事务的人看好人民币国际化</li><li>政策和战略研究的人不看好</li><li>美国政策界乐于见到搞人民币国际化，但是认为人民币无法俘获信任，<ul><li>主权信用无法相信</li><li>必须放开货币汇率管制，实体经济可能受损</li></ul></li></ul><h2 id="数字货币带来人民币国际化弯道超车的机遇">数字货币带来人民币国际化弯道超车的机遇</h2><p>中国推出数字人民币：在swift系统下，美国的制裁会造成挤兑破产。于是中国需要解决卡脖子问题。</p><p>猜想：</p><ul><li>如果能顺利推广到境外，可以农村包围城市，代替一部分美元现钞。</li><li>清晰坦率解释，取代地下流通的美元，提供资源帮助国家建设货币系统，实现货币现代化。</li><li>一带一路中，将数字人民币使用和援助相挂钩。</li><li>铸币税一部分好处恰当的分享給发展中国家人民</li></ul><h2 id="人民币国际化的前景及其影响">人民币国际化的前景及其影响</h2><ol><li>货币网络效应对人民币国际化影响<ul><li>中心化网络导致强大货币存在兑换优势</li><li>人民币国际化需要先挤兑其他小币种的份额</li></ul></li><li>人民币国际化对中国经济的影响<ul><li>汇率水平上升，国际购买力翻倍</li><li>经济规模增大，本土消费市场会成为第一大市场</li></ul></li><li>人民币国际化代价<ul><li>汇率水平敏感的行业消亡</li></ul></li></ol><h2 id="划重点-3">划重点</h2><ol><li>人民币国际化未来需要多管齐下，稳慎推进，久久为功。</li><li>全球货币市场存在赢家通吃的网络效应，人民币国际化在本世纪中期才会轮到挑战美元份额。</li><li>数字人民币将帮助人民币国际化弯道超车。</li><li>人民币国际化会造成产业转移，这也是我国劳动力结构变化的内在要求，应该顺应这个市场规律而行。</li></ol><h1>实操课：全球货币体系知识如何转化为利润</h1><h2 id="人民币汇率的预判及其分析方法">人民币汇率的预判及其分析方法</h2><p>长期：中国快速迭代产业进步+老龄化趋势=坚定看多人民币</p><p>中期（3-5年）：中央政府政策导向以及与美国的关系。</p><p>短期（1年）：关注中国新生儿数量，数量下跌的话大胆做多人民币。如果政府鼓励生孩子且取得实际效果，可以适当看空一点人民币。</p><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/birth-currency-rate.png" class=""></div><p>超短期（1-2月）：关注美元指数波动。</p><h2 id="美元在两种情况下会走强">美元在两种情况下会走强</h2><p>两种情况：</p><ul><li>当美国率先与欧洲和东亚出现经济复苏和走出困境中。</li><li>当全球经济陷入大麻烦时。流动性躲到短期美元国债。</li></ul><p>如果美国出现政变，或者遭受核武器，或者资产泡沫破裂，导致股市暴跌，资产价格失序，那这个时候美元价格会涨还是会跌？其实是会大幅上涨。事情越大涨得越凶。次贷危机和新冠疫情为例。</p><h2 id="半球模型与全球资产配置的大周期理论">半球模型与全球资产配置的大周期理论</h2><h3 id="半球模型（形似健身房物件）">半球模型（形似健身房物件）</h3><p>可以用这个模型近似全球资本主义货币体系的构造。当一只脚踩下去，气体会像边缘扩散。</p><p>当中心出现减息，资金便宜了，资金向外围溢出，资本主义外围地区出现局部和暂时的繁荣。反过来的话，繁荣消失，金融危机。这只脚的踩踏和提起形成美元价格相对一篮子货币的波动（美元指数）。</p><p>过去50年，美元指数有着明确的周期，平均16-17年一次，下跌十年反弹六年。美元下行周期，可以从中心借入便宜资金追逐资本主义外围的高风险资产。美元上行周期，做空外围，把从外围挣到的钱连本带息还回中心，利润躲进无风险资产，美元短期国债。</p><h3 id="三位一体风险定价体系">三位一体风险定价体系</h3><p>下列图中纵轴是资金的价格收益率risk</p><p>横轴是时间或者说债券的久期。连成一条线是美国国债收益率曲线。</p><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/risk-time.png" class=""></div><p>横轴的单位从时间久期切换为地点，这个世界的中心外围体系，越中心资金价格越便宜。</p><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/risk-location.png" class=""></div><p>横轴切换为资产类别。房地产风险最大收益率最大。</p><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/risk-asset-type.png" class=""></div><h3 id="长周期资产配置蕴含较高收益率的模型">长周期资产配置蕴含较高收益率的模型</h3><p>美元处于下行周期，把资金投入全球外围地区，在这一轮美元下行过程中最受益的工业化的经济体。指标上看哪一个国家的国际收支平衡表上堆积越来越多美元储备（热钱往哪里流）。所需做的去王公贵族居住的最最贵的房产和土地，然后不要动，操作周期在10年以上。当美元指数上涨的时候，所需做的是把当地房产卖掉，获得当地货币，卖掉换回美元，换回美国短期国债，只追求活下去。</p><h3 id="回溯过去50年的美元周期">回溯过去50年的美元周期</h3><p>1970年中期跑到拉美，在布宜诺斯艾利斯、里约热内卢、墨西哥城，买入最贵的房地产。1980年代初，卖出当地房产和货币，回归短期国债。1980年代中，指数再次下行，做右肩交易（趋势确定），在东亚日韩港台新加坡买入最贵的房产。1990年代中，美元上涨，卖出当地房产和货币，回归短期国债。2001到03年开始，又大幅下行，在中国投资，北京四合院，上海小洋楼。2015年美元指数上涨，周而复始。</p><h2 id="那些外围国家的房地产值得投资">那些外围国家的房地产值得投资</h2><p>问题切换成，那些外围国家在美元下行周期能成为工业化浪潮的赢家。</p><p>最理想的候选国家，应该具有以下条件：</p><ul><li>强政府，最好不要玩选举。民主制度是奢侈品，只有实现工业化才可以享受，否则劣质民主或者民主倒退。</li><li>外交采用务实的外交政策，与各个大国搞好关系（同时中美）。</li><li>经济上重商主义，鼓励出口，让自己家制造业越办越好。</li><li>人口劳动力素质比较好且有一定规模，人均智商偏高。</li><li>文化上最好不怎么信教，追求世俗的财富和成就。</li><li>地理上最好有一些值得开发的港口，因为海运成本较低，腐败与否不重要。</li></ul><p>如果找到一两个发展中国家符合一两个或者大部分条件，需要长期关注其政治变革和政策组合。这种国家一旦进入工业化轨道，办工厂的人未必能积攒巨大财富。这种工业化积攒的财富最终以各种形式流入当地统治阶级和王公贵族。导致统治阶级聚集的大城市资产价格大幅上涨。</p><h2 id="如何识别泡沫">如何识别泡沫</h2><h3 id="反身性">反身性</h3><p>索罗斯的操盘策略很多时候是在美元指数上涨周期做空外围泡沫比较严重的经济体。索罗斯是用主观认知和客观事实之间的循环联动性，寻找自我实现的预言，自我增强的趋势，利用反身性来识别泡沫。</p><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/reflexive.png" class=""></div><h3 id="实体经济和虚拟经济之间的背离问题">实体经济和虚拟经济之间的背离问题</h3><p>两个案例，注意关注类似情形，警惕危机：</p><ol><li>东南亚制造业在1990年遭到中国出口工业的竞争而被掏空，而房价股价持续走高。而汇率却铆住美元，结果产生金融泡沫。</li><li>21世纪头十年，中东欧地区经济体融入欧盟统一市场，抢夺原本属于南欧实体产业的市场空间，南欧货币融入欧元无法通过汇率调整反应经济基本面变迁，出现泡沫，欧债危机。</li></ol><p>为什么很多发展中国家喜欢搞固定汇率和联系汇率制度？出口制造行业低端，无法经受汇率波动，于是铆定主要的贸易对象。注意未来也会有国家与人民币挂钩。</p><h2 id="从发达工业国还是发展中穷国，哪个挣钱容易？">从发达工业国还是发展中穷国，哪个挣钱容易？</h2><p>两种国家：</p><ul><li>发达国家钱多富裕但是人精明。中国人挣辛苦钱。</li><li>穷国穷，没什么钱，人单纯，知识匮乏，政策漏洞多，定价错误多。</li></ul><p>在发展中国家布局相对更容易。但是道德上不建议这样做。</p><h3 id="两种策略">两种策略</h3><p>有一些发展中国家有大企业，具有国际性业务。例如能源、采矿、服务业制造业。他们有公允价值。在他们本币大幅贬值时，这些企业股票价格或迟或早等比例上涨。如果判断出本币贬值过程，及时进场加杠杆做多这些大企业。本币贬值会带来某些无风险收益。</p><h2 id="划重点-4">划重点</h2><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/important1.png" class=""></div><div style="width:60%;margin:auto"><img src="/economy-finance/didongsheng/rmb-courses/important2.png" class=""></div><h1>实操课答疑</h1><p>八个共性问题：</p><ol><li>美元指数，17年左右这个周期，鲁棒性怎么样，可靠性怎么样，是不是可信？<ul><li>大家不要迷信数字，仅三个周期不足以支撑。</li><li>美元强势周期一个比一个弱，可能是和美国优势在弱化有关。美国 GDP 占全球GDP比例降低。</li><li>一带一路一定程度扰乱了美元周期，中国输出万亿美元级别到外围地区。</li><li>如果形成中美平行格局，就要同时考虑美国和中国的周期。</li></ul></li><li>2021年夏季，美元处于自身周期的什么阶段，到底是上行周期还是下行周期？<ul><li>现在处于下行周期的早期阶段。</li><li>无论美联储什么表态，美联储都无法大幅加息缩表，美国联邦政府受不了。</li><li>美联储主席追求连任时，政府影响很大。</li></ul></li><li>2012年后如果卖出中国的房产是不是有点亏？比如深圳房子一直在涨是不是错过了许多机会？他的收益率和美国国债短期收益率相比太大了。<ul><li>不完全是美元指数的涨跌周期，滞后性。</li><li>美元指数明显趋势性上涨之后才离开发展中地区。</li><li>这样看所以应该2015年左右脱手房产（虽然深圳继续涨，但是这个和美元周期的收益关系不是太大）。</li></ul></li><li>许多国家房产交易比较麻烦，还要委托出租。有没有别的交易标的替代房子？<ul><li>古董和艺术品，尤其是有历史的国家，顶级艺术品，但是需要防伪。</li><li>猜想：伊朗可能苦尽甘来，目前各类资产便宜，有可能融入中俄体系（波斯文明的复兴，买回曾经荣耀）。</li></ul></li><li>按强政府人口智商工业化等方面来看，哪些国家值得投资：<ul><li>2011年开始鼓吹投资越南，房产上涨，汇率没有下降，但是目前行情是下半场。</li><li>柬埔寨（强政府有待考虑）孟加拉国（国际收支平衡表看来不错）。</li><li>缅甸要看他的政治安全前景（比如埃塞俄比亚提前享受了昂贵的民主制度。）</li></ul></li><li>推荐投资领域的书：<ul><li>《股票作手回忆录》：杰西·利维摩尔，最后左轮自杀。</li><li>《富可敌国》《More money than god》。</li></ul></li><li>国际收支平衡吧及其他重要宏观国别数据如何获得？<ul><li>付费：路透社、彭博、万德</li><li>DataBank、OECD、UN</li></ul></li><li>以目前的身价实力，和目前中国资本项目管制的政策有点远。能不能教一些炒股，或者在中国国内市场中间可行的现实的资产配置的招？<ul><li>无所谓心态</li><li>练看盘，所有股票，量价组合，大涨之前，涨的过程中，大跌前。</li><li>平时不要浪费时间看，该做什么做什么。</li><li>大盘暴跌的时候再看股票，看哪些恐慌杀跌。<ul><li>2016年初：小天鹅，账上钱多，基本面好，满仓。</li><li>识别庄股。</li><li>好股票：有好事，市场没有充分认识到，没有体现在价格因素。或者现在大家过度悲观。</li></ul></li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
    <tags>
      
      <tag>翟东升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>糖盐</title>
    <link href="/knowledge-from-growth/sugar-salt/"/>
    <url>/knowledge-from-growth/sugar-salt/</url>
    
    <content type="html"><![CDATA[<p>记录一些内容并未不适合公开的糖盐。个人觉得还比较有趣，亦不免寓教于乐。</p><span id="more"></span><h2 id="Archive">Archive</h2><ul><li>“虚无的充实感”<ul><li>描述忙活了半天却不知道做出什么进展但却心满意足的样子。</li><li>个人认为旨在期望你清楚地认识到自己的进步在哪里，或者说到底有没有进步。</li><li>e.g. “埋头写了1000行代码，好充实的一天。”</li></ul></li><li>“那你/我还不如去买彩票呢”<ul><li>描述一种期望可能性很小的状态，一般会有上一句作为铺垫。</li><li>个人认为旨在期望你认识到此事的荒谬。</li><li>e.g. “那我要只期望我的学生XXX（此处为动词），那我还不如去买彩票呢。”</li></ul></li><li>“如果我没记错的话”<ul><li>表示我没记错，一般用于展开陈述的开头。</li><li>个人认为旨在加强语气，但是留出弹性空间，同时引出需要强调的陈述。</li><li>e.g. “如果我没记错，现在在校的同学，应该都是申请过提前返校的同学。”</li></ul></li><li>“你觉得xxx的边界在哪？”<ul><li>一种思维方式，强调能做什么以及做好了能做成什么样？</li><li>个人认为多思考边界是一件有益的事情，比如说你的 idea 如果能成，可以做什么？可以做到什么程度？在必要性分析中可以起到重要作用。</li><li>e.g. “那么我有一个问题，请问您这个算法的边界在哪里？即你这个算法在具体什么情况下能做到什么程度？”</li></ul></li><li>“搞清做人的红线在哪。”<ul><li>表示你得清楚什么是不能做的。</li><li>出于某次事件使得全系通报批评的原因，个人认为旨在提醒你要注意自己的言行，不要做出不合适的事情。</li><li>e.g. “科研做的怎么样先不谈，要先学会做人，搞清楚做人的红线在哪里。”</li></ul></li><li>“Claim 要立的准”<ul><li>表示在科研中提出一个观点或者宣称要做什么的时候，要十分精确。</li></ul></li><li>“可以去骗别人，千万不能骗自己。”<ul><li>表示人对自己要负责任，不能糊弄自己。（当然并不是说可以去欺骗别人！仅是夸张的修辞。）</li></ul></li><li>“合肥能容得下一张安静的书桌”（亦引自他处）<ul><li>表示合肥是一个能稍微沉下心的地方。</li><li>e.g. “以前我一直不明白什么叫做“合肥能容得下一张安静的书桌”，来了深圳才明白。”</li></ul></li><li>“计算机的强项在于通用。”<ul><li>一个 claim，出自某次组会。</li><li>e.g. “优化走的就是定制化路线，一般针对一个问题设计一个算法。而计算机的强项在于通用，那么就可以做通用求解器。那么通用求解器边界在哪里？我们先从 01 问题做起。”</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>Knowledge from Growth</category>
      
    </categories>
    
    
    <tags>
      
      <tag>感悟总结</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>A Survey of Deep Active Learning</title>
    <link href="/paper-reading/deep-AL-survey/"/>
    <url>/paper-reading/deep-AL-survey/</url>
    
    <content type="html"><![CDATA[<p>记录一篇深度主动学习的调研文章。2020年，这篇 survey 被挂在了 arxiv 上， 见此<a href="https://arxiv.org/abs/2009.00236">链接</a>。此篇 survey 全30页，引用189篇参考文献。</p><span id="more"></span><h2 id="Introduction">Introduction</h2><p>Background: A rich variety of related work has been published, DeepAL still lacks a unified classification framework.</p><p>Challenges of DeepAL:</p><ul><li>Insufficient data for label samples<ul><li>The labeled training samples provided by the classic AL are insufficient to support the training of traditional DL.</li><li>The non-batch sample query method commonly used in AL is not applicable in the DL context.</li></ul></li><li>Model uncertainty<ul><li>The softmax response of the final output is unreliable as a measure of confidence, and the performance of this method will thus be even worse than that of random sampling. DL model can be too confident about the output results.</li></ul></li><li>Processing pipeline inconsistency<ul><li>AL: fixed features + learned classifiers</li><li>DL: learned features + learned classifiers</li><li>Only fine-tuning the DL models in the AL framework, or treating them as two separate problems, may thus cause divergent issues.</li></ul></li></ul><h2 id="Approaches">Approaches</h2><p>In general they summarized the corresponding approaches for the challenges.</p><ul><li>Insufficient data for label samples<ul><li>data augmentation</li><li>assigning pseudo-labels</li><li>combine supervised and semi-supervised training</li><li>batch sample</li></ul></li><li>Model uncertainty<ul><li>Bayesian deep learning</li></ul></li><li>Processing pipeline inconsistency<ul><li>Modify the combined framework of AL and DL to make the proposed DeepAL model as general as possible</li></ul></li></ul><h2 id="Query-strategies">Query strategies</h2><p>Batch Mode DAL should be satisfied.The reference indexes are copied.</p><ol><li>Uncertainty-based and hybrid query strategies<ul><li>directly use uncertainty sampling (non-batch) [9, 59, 114, 123]</li><li>query batch sample set representative to the distribution [177:Exploration-P, 183:DBAL, 99:WI-DL]<ul><li>the richer the category content of the dataset, the larger the batch size, and the better the effect of diversity-based methods;</li></ul></li><li>query batch sample set representative to the gradient embedded space [10:BADGE]</li><li>query batch sample set representative by adversarial method [146:WWAL, 150:VAAL, 81:TA-VAAL]</li></ul></li><li>Deep Bayesian Active Learning<ul><li>obtain the posterior distribution of network prediction [47:DBAL, 118:DEBAL, 28:DPEs, 114:ActiveLink]</li><li>obtain the mutual information between the batch samples and the model parameters [84: BatchBALD]</li><li>reconstructed the batch structure to optimize the sparse subset approximation [117:ACS-FW]</li><li>other [54, 105, 126, 147, 175, 179]</li></ul></li><li>Density-based Methods<ul><li>core-set approach [49:FF-Active, 138:core-set]</li><li>discriminative approach [35:Active Palmprint Recognition, 51:DAL]</li></ul></li><li>Other<ul><li>RL approach [37]</li><li>Adversarial examples[36:DFAL]</li><li>ensemble [14]</li><li>flexible acquisition function [57:RAL, 100:DRAL]</li><li>with NAS [50:Active-iNAS]</li></ul></li></ol><h2 id="Model-training">Model training</h2><p>Normally accompanied with insufficient data (under the view of DAL).</p><ol><li>assigning pseudo-labels [166:CEAL]</li><li>combine unsupervised feature learning [99:WI-DL]</li><li>data augmentation [187:GAAL, 162:BGADL, 107:ARAL]</li><li>add adversarial task [150:VAAL, 81:TA-VAAL]</li></ol><h2 id="DAL-on-the-generalization-of-the-model">DAL on the generalization of the model</h2><ol><li>Use the final layer output to make query</li><li>ALso use the middle layer output to make query [59:AL-MV, 178:LLAL, 182]</li></ol>]]></content>
    
    
    <categories>
      
      <category>Paper Reading</category>
      
    </categories>
    
    
    <tags>
      
      <tag>active-learning</tag>
      
      <tag>survey</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>黑苹果使用记录</title>
    <link href="/software-tools/macos/hackintosh/"/>
    <url>/software-tools/macos/hackintosh/</url>
    
    <content type="html"><![CDATA[<p>黑苹果使用记录，很多功能调教起来还是较为麻烦的。</p><span id="more"></span><h2 id="win-与-macOS-下显卡切换">win 与 macOS 下显卡切换</h2><p>之前一直使用的是 RX470 显卡，由于最近玩2077实在是带不动，所以考虑换卡。由于最近狂潮，AMD 显卡大涨一波价，于是乎买A卡总觉得很不值。于是入手了索泰1080至尊Plus（1800rmb， 2020年12月）。</p><p>但是由于N卡不支持黑果，所以目前目标为</p><ul><li>黑苹果下把显卡独立显卡屏蔽并使用集成显卡 UHD630 作为显卡。</li><li>Windows 下正常使用1080。</li></ul><p>其实操作很简单，理论上只需要在 config 文件中加入<code>wegnoegpu</code>屏蔽外部显卡即可。</p><p>简述一下现在的设置情况：</p><ul><li>clover 的 config 下，添加 whatevergreen 驱动里的命令 <code>wegnoegpu</code>，便可正常进入 macOS。</li><li>主板 bios 设置为集显优先，则用集成显卡进入 clover。</li><li>主板插 DP 线，显卡插 HDMI 线（这个很重要且很玄学！我最开始是相反方式插着，结果无法进 macOS 系统。（显示器是有一个DP口））</li><li>windows 下进入会有两个信号源，集显和独显。在设备管理器中关闭集显不管用（集显的DP口仍有输出。）<ul><li>在显示设置中设置只显示特定桌面（只显示独显连接的桌面）</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>Software Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MacOS</tag>
      
      <tag>Hackintosh</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python</title>
    <link href="/programming/python/"/>
    <url>/programming/python/</url>
    
    <content type="html"><![CDATA[<p>这里是个人的 Python 学习笔记。记录一些常用到但是总忘记的的 Python 知识/语句。也写一下自己有且被解决的疑问。</p><span id="more"></span><h1>用法</h1><h2 id="星号变量">星号变量</h2><p>单个星号代表这个位置接收任意多个非关键字参数，在函数的<code>*args</code>位置上将其转化成元组，而双星号代表这个位置接收任意多个关键字参数，在<code>**args</code>位置上将其转化成字典。</p><h2 id="反射">反射</h2><p>反射是 Python 中很实用的一个功能，他可以通过字符串来导入模块和方法。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">package = importlib.import_module(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;name_of_package&#125;</span>&#x27;</span>)<br>class_name = <span class="hljs-built_in">getattr</span>(package, <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;name_of_class&#125;</span>&#x27;</span>)<br>class_instance = class_name() <span class="hljs-comment"># Remember the instantiation.</span><br></code></pre></td></tr></table></figure><p>参考这两篇博文：</p><ul><li><a href="https://blog.csdn.net/lom9357bye/article/details/79107711">Python 使用反射机制实例化对象</a></li><li><a href="https://blog.csdn.net/xie_0723/article/details/78004649">Python 动态导入对象, importlib.import_module() 使用</a></li></ul><h2 id="设置代理">设置代理</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>os.environ[<span class="hljs-string">&#x27;http_proxy&#x27;</span>] = <span class="hljs-string">&quot;http://127.0.0.1:xxxx&quot;</span><br>os.environ[<span class="hljs-string">&#x27;https_proxy&#x27;</span>] = <span class="hljs-string">&quot;http://127.0.0.1:xxxx&quot;</span><br></code></pre></td></tr></table></figure><p>其中 xxxx 为对应的端口号。</p><h1>功能</h1><h2 id="格式化字符串">格式化字符串</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">## Basics             ## use &quot;·&quot; to visualize whitespace</span><br><span class="hljs-string">&quot;&#123;&#125; &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment">## &quot;1·2&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;<span class="hljs-number">1</span>&#125;</span> <span class="hljs-subst">&#123;<span class="hljs-number">2</span>&#125;</span>&quot;</span>            <span class="hljs-comment">## &quot;1·2&quot;</span><br><br><span class="hljs-comment">## Padding and alignment</span><br>a = <span class="hljs-string">&quot;test&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a:<span class="hljs-number">10</span>&#125;</span>&quot;</span>             <span class="hljs-comment">## &quot;test······&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a:&lt;<span class="hljs-number">10</span>&#125;</span>&quot;</span>            <span class="hljs-comment">## &quot;test······&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a:&gt;<span class="hljs-number">10</span>&#125;</span>&quot;</span>            <span class="hljs-comment">## &quot;······test&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a:^<span class="hljs-number">10</span>&#125;</span>&quot;</span>            <span class="hljs-comment">## &quot;···test···&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a:_&lt;<span class="hljs-number">10</span>&#125;</span>&quot;</span>           <span class="hljs-comment">## &quot;test______&quot;</span><br><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a!s&#125;</span>&quot;</span>              <span class="hljs-comment">## equals to f&quot;&#123;str(a)&#125;&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a!r:<span class="hljs-number">10</span>&#125;</span>&quot;</span>           <span class="hljs-comment">## f&quot;&#123;repr(a):10&#125;&quot;</span><br><br><span class="hljs-comment">## Floats</span><br>b = <span class="hljs-number">0.5</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;b:<span class="hljs-number">5</span>&#125;</span>&quot;</span>              <span class="hljs-comment">## &quot;··0.5&quot; !!!</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;b:&lt;<span class="hljs-number">5</span>&#125;</span>&quot;</span>             <span class="hljs-comment">## &quot;0.5··&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;b!s:<span class="hljs-number">5</span>&#125;</span>&quot;</span>            <span class="hljs-comment">## &quot;0.5··&quot;</span><br><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;b:05&#125;</span>&quot;</span>             <span class="hljs-comment">## &quot;000.5&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;b:<span class="hljs-number">.3</span>f&#125;</span>&quot;</span>            <span class="hljs-comment">## &quot;0.500&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;b:<span class="hljs-number">.3</span>e&#125;</span>&quot;</span>            <span class="hljs-comment">## &quot;5.000e-01&quot;</span><br><span class="hljs-string">f&quot;<span class="hljs-subst">&#123;b:<span class="hljs-number">.2</span>%&#125;</span>&quot;</span>            <span class="hljs-comment">## &quot;50.00%&quot;</span><br></code></pre></td></tr></table></figure><p>Copy from Yu’s <a href="https://yzhang-gh.github.io/notes/programming/python/python.html#%E4%BD%9C%E7%94%A8%E5%9F%9F-scope">blog</a>.</p><h2 id="将-Traceback-信息保存到-log-文件中">将 Traceback 信息保存到 log 文件中</h2><p>有时候要跑一个运行时间很长的文件，中间会创建 log 文件。如果跑到一半报错终止，文件中却没有相应记录则很难追踪错误。所以需要加入报错信息。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> traceback<br><br><span class="hljs-keyword">try</span>:<br>    main() <span class="hljs-comment"># The code need to be executed.</span><br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    logger.error(<span class="hljs-string">f&quot;Main program error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    logger.error(traceback.format_exc())<br></code></pre></td></tr></table></figure><h2 id="的使用与补码"><code>~</code> 的使用与补码</h2><p>使用 <code>~</code> 进行按位取反，包含符号位。</p><p>举例，5 的二进制为 0101：</p><ul><li>各位取反，1010</li><li>变为负数，转化为其补码形式（符号位保持不变，各位取反，再加1）<ul><li>符号位不变，各位取反 1（1101）</li><li>再加1（1110），也即 -6</li></ul></li></ul><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-meta prompt_">&gt;&gt;</span> ~<span class="hljs-number">5</span><br><span class="hljs-meta prompt_">&gt;&gt;</span> -<span class="hljs-number">6</span><br></code></pre></td></tr></table></figure><h1>一些疑问及回答</h1><h2 id="同一个可迭代对象的多个迭代器是否独立？">同一个可迭代对象的多个迭代器是否独立？</h2><p>独立。这问题其实是在问生成的两个迭代器是不是指向同一个内存。这个显然是不同的。所以说用两个迭代器同时遍历一个列表，都会是从头开始。</p><p>需要注意的是在 pytorch 中，遍历 dataloader 需要使用迭代器。此时如果用两个迭代器，在第一次迭代生成的样本可能不同。这个其实是因为你在生成 dataloader 的时候可能传入 <code>shuffle = True</code>，所以在生成迭代器的时候会采用不同的顺序读区。</p><h1>使用中的一些坑</h1><h2 id="Terminal-传入-Boolean-类型的参数">Terminal 传入 Boolean 类型的参数</h2><p>由于传入的参数以 string 解析，所以还需要对 string 进行判断。</p><blockquote><p>sys.argv provides you the string representation of cmd line params.‘True’ and ‘False’ are both strings, and if a string has any content in it at all, the boolean representation is True.You should simply change your condition to if test.lower() == ‘true’</p></blockquote><p>所以在习惯上还是尽量使用 json 文件传参数。但是如果使用命令行进行调试时，还是需要输入。所以目前的解决方案是在 argparse 中默认设置为 False，传入 True 则覆盖。</p><h1>一些常见的报错</h1><p>有一些经常遇到的报错，在此记录解决方案。</p><h2 id="ModuleNotFoundError-No-module-named-‘xxx’">ModuleNotFoundError: No module named ‘xxx’</h2><p>这个报错经常在服务器上调用子文件夹中的结果分析软件时得到，通常的原因是因为自建的module包所在路径不在 PYTHONPATH 下，此时把根目录路径加入即可。参考此<a href="https://www.cnblogs.com/hi3254014978/p/15202910.html">博客链接</a>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-comment"># 把当前文件所在文件夹的父文件夹路径加入到 PYTHONPATH</span><br>sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux 常用命令</title>
    <link href="/programming/linux-commands/"/>
    <url>/programming/linux-commands/</url>
    
    <content type="html"><![CDATA[<p>常用到的 linux 命令语句</p><span id="more"></span><h2 id="进程相关">进程相关</h2><p>使用 <code>ps</code> 使得命令查询任务。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># user&#x27;s running processes</span><br>ps r -ef | grep username<br></code></pre></td></tr></table></figure><p>终止进程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">kill</span> PID<br></code></pre></td></tr></table></figure><p>高级终止</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 将用户colin115下的所有进程名以av_开头的进程终止:</span><br>ps -u colin115 |  awk <span class="hljs-string">&#x27;/av_/ &#123;print &quot;kill -9 &quot; $1&#125;&#x27;</span> | sh<br><span class="hljs-comment"># 将用户colin115下所有进程名中包含HOST的进程终止</span><br>ps -fe| grep colin115 | grep HOST |awk <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> | xargs <span class="hljs-built_in">kill</span> -9;<br></code></pre></td></tr></table></figure><p>后台进程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 置于后台</span><br>ctrl+Z<br><span class="hljs-comment"># 重新拉到前台</span><br><span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 查询后台进程</span><br><span class="hljs-built_in">jobs</span><br><span class="hljs-comment"># 删除进程，使用 job 查询到的任务号</span><br><span class="hljs-built_in">kill</span> %1 <br></code></pre></td></tr></table></figure><h3 id="后台运行">后台运行</h3><p>使用 <code>nohup</code> 使得命令后台运行，同时断网和关闭终端都不会终止任务，适合用来作为任务提交方式。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">nohup</span> /root/start.sh &amp;<br></code></pre></td></tr></table></figure><p>此外，python 中自带的 <code>subprocess.popen()</code> 方法同样可以起到后台运行命令且关闭终端不退出的作用，所以不必要使用 <code>nohup</code>。</p><h2 id="文件处理">文件处理</h2><h3 id="解压缩">解压缩</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 对于 zip 文件</span><br>unzip compressed.zip<br><span class="hljs-comment"># 对于 tar.gz 文件</span><br>tar -xvzf compressed.tar.gz<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>摸爬滚打</title>
    <link href="/knowledge-from-growth/mud-down/"/>
    <url>/knowledge-from-growth/mud-down/</url>
    
    <content type="html"><![CDATA[<p>增强对这个世界各种属性的认识。</p><span id="more"></span><h2 id="Archive">Archive</h2><ul><li>人和人的体质不能一概而论。<ul><li>eg. 本科的同学们发了很多顶会文章。</li></ul></li><li>重要的个人利益不能放弃，如果可以放弃的话，自由一定会导致强者对弱者的剥削。这就是为什么我们的伦理道德认为一个人是不能处分自己最重要的利益的，因为自由不能以彻底放弃自由为代价。<ul><li>from 罗翔</li><li>eg. 代孕</li></ul></li><li>很多复杂问题是更高维度简单问题的投影，比如说打篮球动作变形、速度慢、配合差是很多时候体力不行；写程序烂、bug 多、时间长是抽象分解问题做的不好</li><li>发展不是物的堆积，发展是让人的能力不断提升。<ul><li>from 翟东升</li></ul></li><li>成功的道路并不像想象得那么拥挤，在人生的马拉松长路上，绝大部分人跑不到一半就主动退下来了。到后来，剩下的少数人不是嫌竞争对手太多，而是发愁怎样找一个同伴陪自己一同跑下去。因此，教育是一辈子的事情，笑到最后的是一辈子接受教育的人。<ul><li>from 吴军博士，腾讯前副总裁。这里是否为最开始的出处存疑。</li><li>虽然听起来是一句鸡汤文，但是还是体现了持续学习的重要性。</li><li>有两点感受：<ol><li>找一个志同道合能一起进步的人十分重要。</li><li>持续的学习进步，一点一滴的成长十分关键。请尽量做一些收益可以累计的事情。可以参考<a href="https://yzhang-gh.github.io/notes/reading/reward-and-half-life.html">《收益值与半衰期》</a>这篇文章。</li></ol></li></ul></li><li>克制自己的欲望，特别是当它伪装成一种积极的形态出现时；克制自己的傲慢，特别是当它伪装成一种虚幻的正义感出现时。<ul><li>from 张列弛<a href="https://www.liechi.org/cn/2021/01/coldwinter/">《冷冬》</a></li><li>可以看作是对自己之前“熬夜是对生活仍有期待”观点的一种驳斥。</li></ul></li><li>让子弹飞一会。<ul><li>在水落石出前永远不要急于站队，翻转打脸甚至正邪之间的切换可能猝不及防。</li><li>阿里女员工强奸事件有感。</li><li>让学 yyds。</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>Knowledge from Growth</category>
      
    </categories>
    
    
    <tags>
      
      <tag>感悟总结</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>自我提升</title>
    <link href="/knowledge-from-growth/self-improvement/"/>
    <url>/knowledge-from-growth/self-improvement/</url>
    
    <content type="html"><![CDATA[<p>一些平时总是注意不到但是应该要注意的东西。</p><span id="more"></span><h2 id="阅读">阅读</h2><ul><li>阅读时要寻找作者的观点（能代表这一篇文章的东西），不要总是无重点的阅读，否则较难形成知识或经验。</li></ul><h2 id="表达方式">表达方式</h2><ul><li>陈述观点或者描述事物时先简要说结论，再重新以背景、问题、分析、归纳的顺序铺展开来补充。</li><li>在打断对方并对自己观点加以补充时需要注意（这种情况一般是发生于你认为对方没有听明白）。<ul><li>首先你并不清楚是否对方理解了你的观点，可能需要听完对方的表述。<ul><li>如果对方理解，你加以打断，或是一种自大表现。</li><li>如果对方不理解，完全可以等他说完，再补充表述。</li></ul></li><li>如果听完还是不清楚对方是否理解，则可以寻求对方复述一遍。大部分人可能不会介意重复一遍自己的理解，但是介意对方认为自己不理解对方的观点。</li></ul></li></ul><h2 id="思维方式">思维方式</h2><ul><li>避免想当然。</li><li>一点不要含糊，含糊代表着侥幸、代表着自我欺骗、代表着自我感觉飘然。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Knowledge from Growth</category>
      
    </categories>
    
    
    <tags>
      
      <tag>感悟总结</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pytorch 踩坑</title>
    <link href="/programming/pytorch/"/>
    <url>/programming/pytorch/</url>
    
    <content type="html"><![CDATA[<p>使用 Pytorch 时学到的一些知识</p><span id="more"></span><ul><li><a href="#1-%E7%94%A8%E6%B3%95">1. 用法</a><ul><li><a href="#11-%E9%9A%8F%E6%9C%BA%E7%A7%8D%E5%AD%90">1.1. 随机种子</a></li><li><a href="#12-zero_grad-optimizer-or-net">1.2. zero_grad optimizer or net？</a></li><li><a href="#13-%E5%88%9D%E5%A7%8B%E5%8C%96%E7%BD%91%E7%BB%9C">1.3. 初始化网络</a></li><li><a href="#14-nnmodule-%E4%B8%AD-__call__-vs-forward">1.4. nn.module 中 <code>__call__</code> vs <code>forward</code></a></li><li><a href="#15-nllloss--crossentropyloss">1.5. NLLLoss &amp; CrossEntropyLoss</a></li><li><a href="#16-tensor-%E9%9D%9E-contiguous-%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8-view">1.6. tensor 非 contiguous 导致无法使用 view()</a></li><li><a href="#17-pytorch-%E4%B8%AD-hook-%E7%9A%84%E4%BD%BF%E7%94%A8">1.7. pytorch 中 hook 的使用</a></li><li><a href="#18-%E6%9F%A5%E7%9C%8B%E6%9F%90%E4%B8%80%E5%B1%82%E6%A2%AF%E5%BA%A6">1.8. 查看某一层梯度</a></li><li><a href="#19-%E8%AE%A1%E7%AE%97%E6%9F%90%E4%B8%80%E5%B1%82%E6%A2%AF%E5%BA%A6">1.9. 计算某一层梯度</a></li><li><a href="#110-%E8%AE%A1%E7%AE%97%E6%A2%AF%E5%BA%A6%E7%9A%84%E6%97%B6%E9%97%B4">1.10. 计算梯度的时间</a></li><li><a href="#111-%E5%A2%9E%E5%8A%A0%E4%B8%8E%E5%88%A0%E5%87%8F%E7%BB%B4%E5%BA%A6">1.11. 增加与删减维度</a></li><li><a href="#112-%E5%85%81%E8%AE%B8-batch-%E4%B8%AD%E7%9A%84%E6%A0%B7%E6%9C%AC%E4%B8%8D%E7%AD%89%E9%95%BF">1.12. 允许 batch 中的样本不等长</a></li><li><a href="#112-%E5%AF%B9-batchnorm-%E7%9A%84%E5%8F%82%E6%95%B0%E8%BF%9B%E8%A1%8C%E5%9B%BA%E5%AE%9A">1.12. 对 BatchNorm 的参数进行固定</a></li><li><a href="#113-%E5%AF%B9%E4%BD%BF%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%95%B0%E8%BF%9B%E8%A1%8C%E5%9B%BA%E5%AE%9A">1.13. 对使用线程数进行固定</a></li></ul></li><li><a href="#2-%E8%AE%BE%E7%BD%AE">2. 设置</a><ul><li><a href="#21-dataloader-%E4%B8%AD%E7%9A%84-num_workers-%E9%80%A0%E6%88%90%E8%AE%AD%E7%BB%83%E5%BE%AA%E7%8E%AF%E7%BC%93%E6%85%A2">2.1. Dataloader 中的 num_workers 造成训练循环缓慢</a></li></ul></li><li><a href="#3-%E6%8A%A5%E9%94%99">3. 报错</a><ul><li><a href="#31-runtimeerror-cuda-error-device-side-assert-triggered">3.1. RuntimeError: CUDA error: device-side assert triggered</a></li><li><a href="#32-runtimeerror-cuda-out-of-memory">3.2. RuntimeError: CUDA out of memory</a></li><li><a href="#33-runtimeerror-function-mulbackward0-returned-nan-values-in-its-0th-output">3.3. RuntimeError: Function ‘MulBackward0’ returned nan values in its 0th output.</a></li></ul></li><li><a href="#4-%E4%B8%80%E4%BA%9B%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5">4. 一些异常情况</a><ul><li><a href="#41-lossbackward-%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4%E8%BF%87%E9%95%BF">4.1. <code>loss.backward()</code> 运行时间过长</a></li></ul></li></ul><h1>1. 用法</h1><h2 id="1-1-随机种子">1.1. 随机种子</h2><blockquote><p>在导入文件之前，先导入与随机种子相关的包，这样导入的文件随机数也被确定。</p></blockquote><p>在文件的开头添加以下代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">seed_torch</span>(<span class="hljs-params">seed=<span class="hljs-number">1029</span></span>):<br>random.seed(seed)<br>os.environ[<span class="hljs-string">&#x27;PYTHONHASHSEED&#x27;</span>] = <span class="hljs-built_in">str</span>(seed) <span class="hljs-comment"># 为了禁止hash随机化，使得实验可复现</span><br>np.random.seed(seed)<br>torch.manual_seed(seed)<br>torch.cuda.manual_seed(seed)<br>torch.cuda.manual_seed_all(seed) <span class="hljs-comment"># if you are using multi-GPU.</span><br>torch.backends.cudnn.benchmark = <span class="hljs-literal">False</span><br>torch.backends.cudnn.deterministic = <span class="hljs-literal">True</span><br><br>seed_torch()<br></code></pre></td></tr></table></figure><h2 id="1-2-zero-grad-optimizer-or-net？">1.2. zero_grad optimizer or net？</h2><blockquote><p><code>model.zero_grad()</code> and <code>optimizer.zero_grad()</code> are the same IF all your model parameters are in that optimizer.It is safer to call <code>model.zero_grad()</code> to make sure all grads are zero.e.g. if you have two or more optimizers for one model.</p></blockquote><h2 id="1-3-初始化网络">1.3. 初始化网络</h2><p>网络参数初始化会对模型表现产生影响，一般通过一些随机的方式初始化参数。具体的影响可以见<a href="https://zhuanlan.zhihu.com/p/25110150">这篇博文</a>。具体如何实现网络权重初始化，可以通过对模型每一层遍历赋值实现，参见如下代码。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">params = <span class="hljs-built_in">list</span>(net.parameters())<br>torch.nn.init.xavier_uniform(layer) <span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> params<br></code></pre></td></tr></table></figure><h2 id="1-4-nn-module-中-call-vs-forward">1.4. nn.module 中 <code>__call__</code> vs <code>forward</code></h2><blockquote><p>call 方法中调用了 forward 函数，区别主要在于如果使用 forward 函数来进行前向传播，则无法使用 pytorch 提供的 hook 功能。</p></blockquote><h2 id="1-5-NLLLoss-CrossEntropyLoss">1.5. NLLLoss &amp; CrossEntropyLoss</h2><p>从文档中：</p><blockquote><p>This CrossEntropyLoss criterion combines nn.LogSoftmax() and nn.NLLLoss() in one single class.</p></blockquote><p>可以简单理解为：</p><blockquote><p>CrossEntropyLoss == LogSoftmax + NLLLoss</p></blockquote><p>那我们为什么要用 LogSoftmax 呢？</p><blockquote><p>因为在实现上，算log值更加便捷，如果直接计算指数值，可能会出现极大或者极其接近0的情况。所以使用 LogSoftmax 的话数值稳定性可能会更好。参考<a href="https://www.zhihu.com/question/358069078/answer/912691444">此链接</a>。</p></blockquote><h2 id="1-6-tensor-非-contiguous-导致无法使用-view">1.6. tensor 非 contiguous 导致无法使用 view()</h2><p>当使用 tensor 操作时，新建了一份 tensor 元信息，并重新制定 stride，导致其不连续，无法使用 view()。</p><p>最简单的解决方法是使用<code>tensor.contiguous()</code>, 此时会重新开辟一块内存储存底层数据。</p><p>若不介意底层数据是否使用了新的内存，用<code>reshape()</code>则更方便。</p><p><a href="https://zhuanlan.zhihu.com/p/64551412">这篇文章</a>提供了一个非常完善的解释。</p><h2 id="1-7-pytorch-中-hook-的使用">1.7. pytorch 中 hook 的使用</h2><p>Pytorch 中的 hook 为我们提供了一个较为方便的方式来访问网络某一层的输入与输出（前向的话返回 feature，反向的话返回梯度。）</p><p>具体的使用方法，首先要在相应的层上打开前向或者反向的 hook：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># forward</span><br><span class="hljs-comment"># 定义 forward hook function</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hook_fn_forward</span>(<span class="hljs-params">module, <span class="hljs-built_in">input</span>, output</span>):<br>    <span class="hljs-built_in">print</span>(module) <span class="hljs-comment"># 用于区分模块</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;input&#x27;</span>, <span class="hljs-built_in">input</span>) <span class="hljs-comment"># 首先打印出来</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;output&#x27;</span>, output)<br>    total_feat_out.append(output) <span class="hljs-comment"># 然后分别存入全局 list 中</span><br>    total_feat_in.append(<span class="hljs-built_in">input</span>)<br><br><span class="hljs-comment"># Add hook on the layer you want</span><br>modules = model.named_children() <span class="hljs-comment"># </span><br><span class="hljs-keyword">for</span> name, module <span class="hljs-keyword">in</span> modules:<br>    module.register_forward_hook(hook_fn_forward)<br><br><span class="hljs-comment">###############################################</span><br><span class="hljs-comment"># backward</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hook_fn_backward</span>(<span class="hljs-params">module, grad_input, grad_output</span>):<br>    <span class="hljs-built_in">print</span>(module) <span class="hljs-comment"># 为了区分模块</span><br>    <span class="hljs-comment"># 为了符合反向传播的顺序，我们先打印 grad_output</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;grad_output&#x27;</span>, grad_output) <br>    <span class="hljs-comment"># 再打印 grad_input</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;grad_input&#x27;</span>, grad_input)<br>    <span class="hljs-comment"># 保存到全局变量</span><br>    total_grad_in.append(grad_input)<br>    total_grad_out.append(grad_output)<br><br>modules = model.named_children()<br><span class="hljs-keyword">for</span> name, module <span class="hljs-keyword">in</span> modules:<br>    module.register_backward_hook(hook_fn_backward)<br></code></pre></td></tr></table></figure><p>注意 register 函数接受的是一个函数，会为传入的函数传递三个参数 module， grad_input， grad_output。这里的 input 和 output 都是以前向网络的方向来进行标记的。</p><p>反向传播中对于线性模块：o=W*x+b ，它的输入端包括了W、x 和 b 三部分，因此 grad_input 就是一个包含三个元素的 tuple。而在 forward hook 中，input 是 x，而不包括 W 和 b。</p><p>详见这篇非常好的<a href="https://zhuanlan.zhihu.com/p/75054200">讲解</a>。</p><h2 id="1-8-查看某一层梯度">1.8. 查看某一层梯度</h2><p>hook 是一种提取梯度的方法，同样的，还有其他方法可以提取梯度。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 一个全链接层举例</span><br><span class="hljs-built_in">list</span>(model.modules())[<span class="hljs-number">5</span>].weight.grad<br></code></pre></td></tr></table></figure><h2 id="1-9-计算某一层梯度">1.9. 计算某一层梯度</h2><p>其实如果使用 <code>loss.backward()</code> 然后再利用 hook来提取梯度会有一些耗费时间，因为反向传播是要从尾到头的，如果你只需要倒数几层的梯度的话，其实可以直接计算。<code>torch.autograd.grad</code> 方法提供了一个计算梯度的方式，可以看以下例子，此方法返回的对象是一个仅有一个元素的元组。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 计算梯度</span><br><span class="hljs-comment"># 如果需要多次计算的话记得保留计算图</span><br>grad= torch.autograd.grad(outputs=loss, inputs=W, retain_graph=<span class="hljs-literal">True</span>, only_inputs=<span class="hljs-literal">True</span>)[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p>一般来说当我们计算每一个样本所引起的梯度时，可以将 batch_size 设为1，然后分别求梯度。但是这样是比较费时的，所以可以使用 <code>autograd.grad</code> 中的 <code>is_grads_batched</code> 选项 (Pytorch 1.11 版本)。在<a href="https://github.com/pytorch/pytorch/blob/caa28ff4959c7cf7165dabf1ffae7c233b8e4b61/torch/autograd/__init__.py#L177">源代码</a>中对其这样描述：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">is_grads_batched (bool, optional): If ``True``, the first dimension of each tensor in ``grad_outputs`` will be interpreted as the batch dimension.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>grad= torch.autograd.grad(outputs=loss, inputs=W, retain_graph=<span class="hljs-literal">True</span>, only_inputs=<span class="hljs-literal">True</span>, is_grads_batched=<span class="hljs-literal">True</span>)[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><h2 id="1-10-计算梯度的时间">1.10. 计算梯度的时间</h2><p>在我的实验终有一个计算每一样本对梯度贡献的需求，有两种方法计算：</p><ul><li>将 <code>batch_size</code> 设为1，然后使用 <code>torch.autograd.grad</code> 计算梯度。</li><li>用非1的 <code>batch_size</code>，计算 loss 时，不 reduce，这样得出来的 loss 是一个向量。遍历这个向量，对向量中每一个tensor使用 <code>torch.autograd.grad</code> 计算梯度。</li></ul><p>但是发现一个问题。在 batch 下，平均每个样本的前向时间是要远小于不使用 batch。但是平均每个样本的后向时间是要远大于不使用 batch。（这里远小远大是指数量级）。</p><p>推测原因为如果遍历向量的话的话，获得的 tensor 中 <code>grad_fn</code> 是 UnbindBackward 而不是 nlllossbackward。所以尝试在计算 loss 之前就对样本进行遍历，但是其实时间上和遍历 loss 是一样的。因为是用 loss 计算梯度是要使用之前的计算图，遍历网络输出会使遍历的每一个输出的 <code>grad_fn</code> 变化。用这种方式虽然看起来 loss 的 <code>grad_fn</code> 还是 nlllossbackward，但是在梯度的计算过程中还是会遇到 UnbindBackward。</p><p>所以这个问题没有想到具体的解决方法，就选取了耗费时间相对较短的方法。</p><h2 id="1-11-增加与删减维度">1.11. 增加与删减维度</h2><p>有时在对批数据进行乘法等矩阵操作时，时常需要对数据进行升维降维。此处记录一下操作流程。</p><p>例如我们相对两个矩阵进行乘法，第一个矩阵唯度为[N, M]，第二个矩阵维度为[N, K]，其中 N 为该 batch 中样本数目。我们期望通过得到一个维度为[N, M, K]的三维矩阵。但是直接的矩阵相乘并不能起到升维的效果，所以在相乘之前要进行升维。将两个矩阵分别升维到[N, M, 1]和[N, K, 1]。</p><p>此处用到两个方法：</p><ul><li><code>torch.squeeze(n)</code>：若第 n 维维度为1，则将此维度删除。</li><li><code>torch.unsqueeze(n)</code>：将第 n 为维度增加维度为1。</li></ul><p>有时在增加删减维度之后，需要对原始维度进行重新排序，此时可以用到<code>torch.permute()</code>方法。</p><h2 id="1-12-允许-batch-中的样本不等长">1.12. 允许 batch 中的样本不等长</h2><p>一般情况下 pytorch 中，每个 batch 的每一个样本都是等长的，如果不等长的话会报错。</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-symbol">RuntimeError:</span> each element in list of <span class="hljs-keyword">batch </span><span class="hljs-keyword">should </span><span class="hljs-keyword">be </span>of equal size<br></code></pre></td></tr></table></figure><p>一般来说，这是因为 Dataloader 中的参数 <code>collate_fn</code> 的默认值为 torch 自定义的 <code>default_collate</code>，<code>collate_fn</code> 的作用就是对每个batch进行处理，而默认的 <code>default_collate </code>处理出错。自定义的 <code>default_collate</code> 的作用是将列表中的元素变成 tensor 的形式，详见<a href="https://blog.csdn.net/SWEDEN_1003/article/details/84343496">这篇文章</a>，同时源码见<a href="https://github.com/pytorch/pytorch/blob/master/torch/utils/data/_utils/collate.py">这里</a>。</p><p>所以这个时候的处理方式是自定义一个 <code>collate_fn</code>，并在其中使用 padding，将每个样本扩充至等长，使得变为 tensor 这一过程不出错。</p><p>参考了<a href="https://blog.csdn.net/weixin_44799217/article/details/115137820">这篇文章</a>。</p><h2 id="1-12-对-BatchNorm-的参数进行固定">1.12. 对 BatchNorm 的参数进行固定</h2><p>采用预训练模型的时候，其中经常包含 <code>BatchNorm</code> 层，在对模型进行改造的时候，有的时候会出现问题，这个时候就需要对 <code>BatchNorm</code> 层进行一个固定。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> net.modules():<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(m, nn.BatchNorm2d):<br>        m.<span class="hljs-built_in">eval</span>()<br></code></pre></td></tr></table></figure><h2 id="1-13-对使用线程数进行固定">1.13. 对使用线程数进行固定</h2><p>自己在使用 Pytorch 的时候发现，有时候一个文件会占用很多的 CPU 核心。当提交多个任务时，其会将所有 CPU 快速占满，且难以高效运用，导致影响所有的实验任务。于是对单个任务的 CPU 使用加以限制成为了一个需求。此时可以使用以下命令来限制 torch 使用的线程数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">torch.set_num_threads(<span class="hljs-number">1</span>) <br></code></pre></td></tr></table></figure><h1>2. 设置</h1><h2 id="2-1-Dataloader-中的-num-workers-造成训练循环缓慢">2.1. Dataloader 中的 num_workers 造成训练循环缓慢</h2><p>在本地跑实验，一个简单的网络的训练，发现 Dataloader 中 num_workers 设置的数目越大，在 batch 中训练越耗时，表示莫名其妙。在我的情形下将其设为8要比将其设为0慢了百倍以上。仔细看了一下 mini-batch 的训练过程并且记录了一下时间，发现主要的时间开销发生于 for 循环遍历 loader 之后退出循环时。所还还是将其设为了0。</p><p>造成这个的主要原因可能是 IO 耗时和模型前/后传耗时之间的 GAP 太大，导致进程间造成了阻塞</p><ul><li><a href="https://bbs.cvmart.net/topics/2066">PyTorch DataLoader 初探</a></li><li><a href="https://liulin1995.github.io">Pytorch训练加速技巧</a></li></ul><h1>3. 报错</h1><h2 id="3-1-RuntimeError-CUDA-error-device-side-assert-triggered">3.1. RuntimeError: CUDA error: device-side assert triggered</h2><p>参考<a href="https://cloud.tencent.com/developer/article/1686771">此篇文章</a>。</p><p>一般来说这个报错存在于在 GPU 运行时，不易清晰定位到错误源，所以网络上大家给出的建议是去 CPU 上跑一下。这个错误出现的原因是数据中的类标记label和网络中的类标记label不匹配。包括但不限于以下几种问题。</p><table><thead><tr><th>pytorch识别的类别</th><th>数据中的类别</th></tr></thead><tbody><tr><td>[0,1,2,3]</td><td>[1,2,3,4]</td></tr><tr><td>[0,1]</td><td>[0,1,2,3]</td></tr></tbody></table><p>解决方法只要找到矛盾发生的地方，对数据中类别的标签进行改动即可。当然有的时候也可能是网络格式写错。</p><h2 id="3-2-RuntimeError-CUDA-out-of-memory">3.2. RuntimeError: CUDA out of memory</h2><p>起因在于丢了49000张 mnist 数据进去没有分 batch，本来以为数据的大小只占了450m内存应该不会有问题，但是发现跑了一个前向就加了七八个g的显存，甚至一个模型直接把24g的显卡显存跑炸了。</p><p>分析原因应该是因为 batch size 较大的时候，前向输入模型，在某一层计算时申请了很大的 tensor 导致消耗了成倍与数据大小的显存。这个在小 batch 的情况下应该并不会有太大影响，所以说还是需要使用 batch。</p><p>当然还是可以在需要的时候释放缓存，治标不治本。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">torch.cuda.empty_cache() <br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/weixin_38278334/article/details/105575403">这篇文章</a>简要介绍了 pytorch 的缓存机制。</p><h2 id="3-3-RuntimeError-Function-‘MulBackward0’-returned-nan-values-in-its-0th-output">3.3. RuntimeError: Function ‘MulBackward0’ returned nan values in its 0th output.</h2><p>其实很多类似的这种报错，只是 Function 不一样而已。出现这种情况的原因是出现了梯度爆炸（gradient-explode），导致出现 NaN 值。解决的方法是先定位，再处理。</p><p>定位可以使用 <code>detect_anomaly</code>，找到报错位置。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> autograd.detect_anomaly():<br>    loss.backward()<br></code></pre></td></tr></table></figure><p>处理的话方法不定，一般来说是需要让梯度不要过大。有一些人提到可以减小学习率，但是这个治标不治本（到底多少才算小呢？）。所以比较好的方法还是在容易出现梯度爆炸的地方进行处理。一般来说容易出现梯度爆炸的地方是 <code>log</code> 函数中，在对概率求熵时出现。所以可以给概率值加上一个很小的数值，如下所示：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_entropy</span>(<span class="hljs-params">y_softmax</span>):<br>    entropy = - torch.<span class="hljs-built_in">sum</span>(y_softmax * torch.log(y_softmax + <span class="hljs-number">1e-6</span>), dim = <span class="hljs-number">1</span>) <span class="hljs-comment"># Avoid gradient explode.</span><br>    <span class="hljs-keyword">return</span> entropy<br></code></pre></td></tr></table></figure><h1>4. 一些异常情况</h1><h2 id="4-1-loss-backward-运行时间过长">4.1. <code>loss.backward()</code> 运行时间过长</h2><p>近期在服务器上迁移代码时发现同样的一句 <code>loss.backward()</code> 在 Titan RTX 和 A30 的服务器上运行速度相差数倍，在 A30 上反而更慢，令人诧异。对比了不同服务器上的 pytorch 版本，cudatoolkit 版本，以及数据集和模型情况，发现均为同样的设定，并无出错。此外速度变慢仅仅是出现在一个 NLP 的原始文本数据集上，其他的图像数据集则并无问题。</p><p>经过一番搜寻，发现可能是 cudnn 的问题。首先是在一个 “The speed of pytorch with cudatoolkit 11.0 is slower than cudatoolkit 10.2” 的 issue 中发现了一个人在 <code>cudnn.enabled=True</code> 的情况下运行更快。又在一个 “Convolution operations are extremely slow on RTX 30 series GPU” 的 issue 中发现了 <code>torch.backends.cudnn.benchmark=True</code> 语句。之前并未了解 cudnn 的用处，也并不知道当下是什么版本，于是查询了 <code>torch.backends.cudnn.benchmark=True</code> 的作用。发现如果该项设置为 True 时，cuDNN使用的非确定性算法就会自动寻找最适合当前配置的高效算法，来优化运行效率。但是如果网络的输入数据在每次 iteration 都变化的话，会导致 cnDNN 每次都会去寻找一遍最优配置，这样反而会降低运行效率，对于文本数据而言正是此情况。于是在该数据集上需要将这一项禁用（默认启用），禁用之后速度正常。</p><p>参考：</p><ul><li><a href="https://github.com/pytorch/pytorch/issues/47908">The speed of pytorch with cudatoolkit 11.0 is slower than cudatoolkit 10.2</a></li><li><a href="https://github.com/pytorch/pytorch/issues/47039">Convolution operations are extremely slow on RTX 30 series GPU</a></li><li><a href="https://www.cnblogs.com/wanghui-garcia/p/11514502.html">pytorch torch.backends.cudnn设置作用</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Pytorch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>亲密关系</title>
    <link href="/reading-note/intimate-relationship/"/>
    <url>/reading-note/intimate-relationship/</url>
    
    <content type="html"><![CDATA[<p>《亲密关系》 克里斯多福·孟</p><span id="more"></span><h2 id="极简简介">极简简介</h2><p>这是一本介绍亲密关系的书，两性关系为主（relationship）。其重点讲的是从作者角度出发亲密关系中不愉快的成因及少数他认为的解决办法。</p><h2 id="个人看法">个人看法</h2><p>间断地浏览了一遍这本书，或许遗漏了重点，此处仅以自己印象来进行评价。可能有些地方记错记漏，但是无所谓，不喜勿喷。以下所有仅从个人角度出发。</p><h3 id="极简评价">极简评价</h3><p>并不是一本可以学到知识的书，但是如果比较善于推广反思，倒是可能会有一些收获。简单理性人寻求知识不建议阅读。如果对自己的感情状况毫无头绪无从下手可以适当阅读。</p><h3 id="缺点（喜爱挑毛病）">缺点（喜爱挑毛病）</h3><ul><li>自己造定义，但是讲述又不严谨。<ul><li>所以这本书不能以工具书的角度来看，但也不能以闲书的角度来看，我就因为总忘了定义导致可能理解有出入。</li></ul></li><li>几乎把所有的问题归因到了原生家庭和小时候的痛苦。<ul><li>不失有一定道理，但是看了整本书都是这么一套 cliche ，便觉得有点点肤浅了。</li></ul></li><li>很多问题都是由他自己的经验出发举例说明。或者说讲了很多有的没的的故事。<ul><li>举例论述其实并不很有说服力，且不具有覆盖性。</li><li>给人一种看起来这个人怎么这么善于反思这么厉害的样子。（成功学大师的影子）</li></ul></li><li>很多说得很绝对的话，虽然可能有一定道理，但是明明是 opinion 却以一种 fact 的样子讲出来，让人不舒服。<ul><li>举例：“我们所看到的每件事，其实都是我们内心的投射，我们怎么评论别人就是我们怎么看待自己。”</li></ul></li><li>其实没有提到有效的解决方案。<ul><li>只是很乐观的提沟通，提去爱，神神叨叨的讲什么灵魂真理。</li></ul></li><li>他其实提倡对伴侣没有期望。<ul><li>Ridiculous</li></ul></li></ul><h3 id="感想-看法">感想/看法</h3><ul><li>这个作者每次讲观点总是说的不是很一致（说的不清楚，可能他自己也没搞清楚），而且最后也总是引到奇奇怪怪的结论。所以我此处给他的观点总结一下，这也可能是这个作者唠唠叨叨写了一本书想讲的东西。反正我总结完觉得还是有点道理。<ul><li>其实很多亲密关系中面临的问题都只是导火索，究其根本，悲伤失落或者生气的原因都不是导火索看起来的那样子。【背景】</li><li>这件事其实很多人意识不到，以为只是导火索这件事的问题（或者说很多过去的没点燃的导火索的问题）。【背景】</li><li>稍微深一点的原因在于不同的人生活上需求可能不同（eg. 不同的生活习惯）。【过度】</li><li>更深层的原因在于心理上的需求，这一点不同人可能是相同的（eg. 都希望被尊重）。【原因】</li><li>对于心理上的需求可沟通解决。【解决】</li></ul></li><li>其实面对很多问题的时候，跳出事件本身，客观的想一想自己要什么可能会好一些。</li><li>我不认为要无期望或者低期望。<ul><li>我觉得人与人之间的相处总是以期望为前提的，无期望这件事太理想化了。</li><li>但是对人的期望最好同时也是对自己的期望。比如你期望伴侣让你快乐，为什么不可以自己快乐呢？当自己内心强大的时候，对别人期望的落空其实并没有那么难以接受。</li></ul></li></ul><h2 id="句段摘录">句段摘录</h2><p>可能是一些我觉得可能有点道理的话。</p><ul><li>最悲哀的是，在得到满足前，我们不愿意去爱自己的伴侣，紧抱着需求不放手，又不让自己去爱。</li><li>我们真正需要的，没有人能给。</li><li>如果对别人取悦我们的能力抱有太大的期望，那么失望便会是必然的结果。<ul><li>不满意时，问问自己此时此刻希望从伴侣身上得到什么。</li><li>愿不愿意放弃这项期望，是由自己满足还是由伴侣满足。</li></ul></li><li>我们宁愿争吵也不愿面对伤口，是因为生气比承受心碎简单的多。</li><li>过去的创伤并不会随着时间逝去。每个自我局限的信念，都来自于过去的创伤。<ul><li>找出这些信念在我们心中驻足的所在，将会很有帮助。</li></ul></li><li>亲密关系让我们有机会面对并治好旧伤，从而改变衍生自伤痛的错误想法。</li><li>当被卷进权力斗争的漩涡时，你一定要切记，我生气的原因不是我自己想的那回事。</li><li>对伴侣发怒的原因<ul><li>麻痹自身心中的痛</li><li>是对方有罪恶感，有效控制对方的行为</li></ul></li><li>如果无力掌控大局又不想感觉能力不足，或没安全感，最快的解决方法就是证明自己是对的。</li><li>如果你相信对亲密关系，你只需要付一半的责任，那么，即使你能付出百分之百，实际付出的，却只有50%。既然你所看到的一切都是你内心的投射。你就会发现伴侣，也只是付出50%。这样一来，你们两人都会坚持自己已经做了自己该做的那一份，却指责对方不肯尽全力。</li><li>只有当你愿意为发生在自己身上的事情完全负责的时候，你才能得到选择的力量。</li><li>如果你为了伴侣牺牲，那么你就会把对方看成是利用你的人，因为他们没有尽他们应尽的力量。</li><li>虽然弥补伴侣的放纵不是你的责任，但对方的放纵行为的确是你的责任。这句话的意思是你有能力对伴侣的行为作出响应，而不是采取牺牲的方式。</li><li>我们所看到的每件事，其实都是我们内心的投射，我们怎么评论别人就是我们怎么看待自己。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Reading Note</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Miniconda</title>
    <link href="/programming/miniconda/"/>
    <url>/programming/miniconda/</url>
    
    <content type="html"><![CDATA[<p>Miniconda 与 Anaconda 为 conda 的发行版，主要用于包管理，其中 miniconda 更轻量级。由于日常使用总是会忘记，所以此处记录一些常用的命令。</p><span id="more"></span><h2 id="安装">安装</h2><p>首先从清华源下载安装包并安装。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda2-4.5.11-Linux-x86_64.sh<br>bash Miniconda2-4.5.11-Linux-x86_64.sh<br><span class="hljs-built_in">source</span> ~/.bashrc<br></code></pre></td></tr></table></figure><p>Conda 默认的软件源在国外,速度非常的慢,我们可以将其更换为<a href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/">清华源</a>。可以直接在<code>.condarc</code>中添加</p><figure class="highlight bash"><figcaption><span>.condarc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/<br>- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/<br>- https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/<br>- https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/<br></code></pre></td></tr></table></figure><p>之后需要使用 <code>conda clean -i</code> 清除索引缓存，保证用的是镜像站提供的索引。]注意有的时候会显示 url 错误， 此时换成 https 可能会解决问题。</p><h2 id="配置">配置</h2><h3 id="对环境更改">对环境更改</h3><p>创建所需要环境，一般有三种情况。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 创建新环境</span><br>conda create -n py3.8 python=3.8<br><span class="hljs-comment"># 克隆环境</span><br>conda create --name myclone --<span class="hljs-built_in">clone</span> myenv<br><span class="hljs-comment"># 直接从 yaml 文件生成新环境</span><br>conda <span class="hljs-built_in">env</span> create -f environment.yml<br></code></pre></td></tr></table></figure><p>激活环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda activate py3.8<br></code></pre></td></tr></table></figure><p>然后下载所需软件包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda install XXX<br></code></pre></td></tr></table></figure><p>退出环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda deactivate py3.8<br></code></pre></td></tr></table></figure><p>删除环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda remove --name myenv --all<br></code></pre></td></tr></table></figure><h3 id="批量导入导出组件">批量导入导出组件</h3><p>导出导入 yml 文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda <span class="hljs-built_in">env</span> <span class="hljs-built_in">export</span> --no-builds &gt; environment.yml<br>conda <span class="hljs-built_in">env</span> create -f environment.yml<br>conda <span class="hljs-built_in">env</span> create -f environment.yml -n new_env_name <span class="hljs-comment"># 新名称</span><br>conda <span class="hljs-built_in">env</span> update --file environment.yml <span class="hljs-comment"># 用于对当前环境更新</span><br></code></pre></td></tr></table></figure><p>导出导入 txt 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">conda list -e &gt; requirements.txt<br>conda create --name py3.8 --file requirements.txt <span class="hljs-comment"># 顺便创建环境</span><br>conda install --<span class="hljs-built_in">yes</span> --file requirements.txt <span class="hljs-comment"># 不创建新环境</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Conda</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cuda 使用记录</title>
    <link href="/programming/cuda/"/>
    <url>/programming/cuda/</url>
    
    <content type="html"><![CDATA[<p>在服务器上使用cuda遇到一些问题，在此记录。</p><span id="more"></span><h2 id="在-torch-cuda-is-available-返回-False">在 torch.cuda.is_available() 返回 False</h2><p>最主要的问题是在 python 中输入<code>torch.cuda.is_available()</code>时，返回 False。猜测应该是某种版本不匹配造成的问题。于是先查询版本。</p><p>通过<code>nvidia-smi</code> 查询到的版本为 <code>CUDA Version: 11.0</code>， 和我安装的 pytorch 对应的 cuda10.0 不兼容。于是下载对应版本即可解决，注意与 python 发行版的冲突。(下载贼慢)</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">conda</span> install pytorch torchvision cudatoolkit=<span class="hljs-number">11</span>.<span class="hljs-number">0</span> -c pytorch<br></code></pre></td></tr></table></figure><h2 id="查询版本">查询版本</h2><p>查询版本有<a href="https://blog.csdn.net/weixin_44023916/article/details/107256522">三种方法</a>。</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">nvidia-smi</span><br></code></pre></td></tr></table></figure><p>这个命令既可以查cuda的驱动API版本，也可以查看GPU运行状态。查询到的版本为：<code>NVIDIA-SMI 450.57  Driver Version: 450.57  CUDA Version: 11.0 </code>。<br>最终需要匹配的版本以此命令为准。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">cat <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/cuda/</span>version.txt<br></code></pre></td></tr></table></figure><p><code>CUDA Version 10.0.130</code></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">nvcc <span class="hljs-comment">--version</span><br></code></pre></td></tr></table></figure><p><code>Cuda compilation tools, release 10.0, V10.0.130</code></p><p>有时会显示command not found，解决方法<a href="#nvcc---version-command-not-found">见此</a>。</p><h2 id="nvcc-version-command-not-found">nvcc --version command not found</h2><p>首先查看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> /usr/local/cuda/bin<br></code></pre></td></tr></table></figure><p>存在nvcc命令，此时配置环境变量即可。</p><figure class="highlight bash"><figcaption><span>.bashrc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> PATH=/usr/local/cuda/bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=/usr/local/cuda/lib64:<span class="hljs-variable">$LD_LIBRARY_PATH</span><br></code></pre></td></tr></table></figure><p>然后更新配置文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> ~/.bashrc<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Cuda</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Docker</title>
    <link href="/programming/docker/"/>
    <url>/programming/docker/</url>
    
    <content type="html"><![CDATA[<p>Docker 使用过程中的一点记录。<br>大部分内容来源于此<a href="https://www.runoob.com/docker/docker-tutorial.html">教程</a>。</p><span id="more"></span><h2 id="简单介绍">简单介绍</h2><p>Docker 包括三个基本概念:</p><ul><li>镜像（Image）：Docker 镜像（Image），就相当于是一个 root 文件系统。比如官方镜像 ubuntu:16.04 就包含了完整的一套 Ubuntu16.04 最小系统的 root 文件系统。</li><li>容器（Container）：镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和实例一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。</li><li>仓库（Repository）：仓库可看成一个代码控制中心，用来保存镜像。</li></ul><p>Docker 容器通过 Docker 镜像来创建。容器与镜像的关系类似于面向对象编程中的对象与类。</p><h2 id="基础命令">基础命令</h2><p>Docker run 可以在容器内运行一个应用程序。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">$ docker run ubuntu <span class="hljs-regexp">/bin/</span>echo <span class="hljs-string">&quot;Hello world&quot;</span><br></code></pre></td></tr></table></figure><p>以上命令完整的意思可以解释为：Docker 以 ubuntu15.10 镜像创建一个新容器，然后在容器里执行 bin/echo “Hello world”，然后输出结果。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker images   <span class="hljs-comment">#检查有哪些镜像</span><br>$ docker ps –a    <span class="hljs-comment">#检查有哪些容器</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker run -it ubuntu /bin/bash   <span class="hljs-comment">#运行交互式容器</span><br>$ docker run -itd ubuntu /bin/bash   <span class="hljs-comment">#后台启动容器</span><br>$ <span class="hljs-built_in">exit</span> (ctrl+D) <span class="hljs-comment">#容器内退出容器</span><br>$ docker stop [<span class="hljs-built_in">id</span>/name] <span class="hljs-comment">#停止容器（在容器外）</span><br>$ docker start [<span class="hljs-built_in">id</span>/name] <span class="hljs-comment">#后台启用停止的容器</span><br>$ docker restart [<span class="hljs-built_in">id</span>/name] <span class="hljs-comment">#重启容器</span><br>$ docker <span class="hljs-built_in">exec</span> -it [<span class="hljs-built_in">id</span>/name] <span class="hljs-comment">#进入容器，退出终端容器不停止</span><br>$ docker attach [<span class="hljs-built_in">id</span>/name] <span class="hljs-comment">#进入容器，退出终端导致容器停止</span><br>$ docker <span class="hljs-built_in">rm</span> [<span class="hljs-built_in">id</span>/name] <span class="hljs-comment">#删除容器</span><br>$ docker rmi [<span class="hljs-built_in">id</span>/name] <span class="hljs-comment">#删除镜像</span><br></code></pre></td></tr></table></figure><h2 id="创建镜像">创建镜像</h2><h3 id="更新镜像">更新镜像</h3><p>当我们从 docker 镜像仓库中下载的镜像不能满足我们的需求时，需要对镜像进行更改。一般有两种方法：</p><ol><li>从已经创建的容器中更新镜像，并且提交这个镜像</li><li>使用 Dockerfile 指令来创建一个新的镜像</li></ol><p>此处我们只考虑更新镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker run -it ubuntu /bin/bash  <span class="hljs-comment"># Open a container</span><br>$ /<span class="hljs-comment">#    # Do modification</span><br>$ <span class="hljs-built_in">exit</span>  <span class="hljs-comment"># exit container</span><br><br><span class="hljs-comment"># Create image</span><br>$ docker commit -m=<span class="hljs-string">&quot;has update&quot;</span> -a=<span class="hljs-string">&quot;user&quot;</span> container_id image_name <br></code></pre></td></tr></table></figure><h3 id="镜像备份">镜像备份</h3><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran">docker <span class="hljs-keyword">save</span> -o image_name.tar image_name<br></code></pre></td></tr></table></figure><p>执行后，运行 ls 命令即可看到打成的 tar 包</p><h3 id="镜像恢复与迁移">镜像恢复与迁移</h3><p>首先我们先删除掉 image_name 镜像，然后执行以下命令进行恢复。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">docker load -<span class="hljs-selector-tag">i</span> image_name<span class="hljs-selector-class">.tar</span><br></code></pre></td></tr></table></figure><p>执行后再次查看镜像，可以看到镜像已经恢复。</p><h2 id="使用-GPU">使用 GPU</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run --gpus all nvidia/cuda:11.1-base-ubuntu18.04 nvidia-smi<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Icarus 主题设置</title>
    <link href="/software-tools/hexo/Icarus/"/>
    <url>/software-tools/hexo/Icarus/</url>
    
    <content type="html"><![CDATA[<p>本文内容都与当前使用的主题 Icarus 相关。</p><p>具体的主题设置可以见此<a href="https://blog.zhangruipeng.me/hexo-theme-icarus/Configuration/icarus%E7%94%A8%E6%88%B7%E6%8C%87%E5%8D%97-%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE/#more">链接</a>，对应的 markdown 源代码可以见此<a href="https://raw.githubusercontent.com/ppoffice/hexo-theme-icarus/site/source/_posts/zh-CN/Configuring-Theme.md">链接</a>。</p><span id="more"></span><h2 id="布局设施">布局设施</h2><h3 id="侧边栏">侧边栏</h3><p>设置<code>sidebar</code>中某个侧边栏的<code>sticky</code>为<code>true</code>来让它的位置固定而不跟随页面滚动。</p><figure class="highlight yaml"><figcaption><span>_config.icarus.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">sidebar:</span><br>    <span class="hljs-attr">left:</span><br>        <span class="hljs-attr">sticky:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">right:</span><br>        <span class="hljs-attr">sticky:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h2 id="样式更改">样式更改</h2><h3 id="字体更改">字体更改</h3><p>觉得自带 Ubuntu 字体太丑了。更改字体需要更改两个文件。</p><p>这个文件是告诉浏览器使用哪个字体的。</p><figure class="highlight yaml"><figcaption><span>/Users/rui/Documents/Note/node_modules/hexo-theme-icarus/include/style/base.styl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">//</span> <span class="hljs-string">line</span> <span class="hljs-number">9</span><br><span class="hljs-string">$family-sans-serif</span> <span class="hljs-string">?=</span> <span class="hljs-string">&#x27;Open Sans&#x27;</span><span class="hljs-string">,</span> <span class="hljs-string">&#x27;Noto Serif SC&#x27;</span><span class="hljs-string">,</span> <span class="hljs-string">&#x27;Microsoft YaHei&#x27;</span><span class="hljs-string">,</span> <span class="hljs-string">sans-serif</span><br></code></pre></td></tr></table></figure><p>这个文件是告诉浏览器下载哪个字体的。</p><figure class="highlight yaml"><figcaption><span>/Users/rui/Documents/Note/node_modules/hexo-theme-icarus/layout/common/head.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">//</span> <span class="hljs-string">line</span> <span class="hljs-number">54</span><br><span class="hljs-string">//</span> <span class="hljs-string">输入需要下载的字体即可</span><br><span class="hljs-attr">default:</span> <span class="hljs-string">fontcdn(&#x27;Open+Sans:wght@400;600&amp;family=Source+Code+Pro&#x27;,</span> <span class="hljs-string">&#x27;css2&#x27;</span><span class="hljs-string">),</span><br></code></pre></td></tr></table></figure><p>同时部署时需要把文件拷进去。</p><p>参考：</p><ul><li><a href="https://chinsun9.github.io/tags/web-font/">github hexo blog web font 적용하기</a></li><li><a href="http://81.70.200.6/2020/12/16/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98%E4%B8%80%E6%8F%BD%E5%AD%90%E8%AE%B0%E5%BD%95/">博客相关问题一揽子记录</a></li></ul><h3 id="主题定制">主题定制</h3><p>之后是一定会对主题进行定制的，但是近期没有时间，而且欠缺一些前端方面的知识。这里记录一些见过的对 lcarus 定制的连接，用于学习和获得灵感。</p><p>List：</p><ul><li><a href="https://angericky.github.io/2018/12/24/icarus%E4%B8%AA%E6%80%A7%E5%AE%9A%E5%88%B6/">hexo及icarus主题个性定制</a>：文章显示较为好看，而且加了不少插件。</li><li><a href="https://chinsun9.github.io/tags/hexo/">hexo icarus 테마 프로필영역 css 수정</a>：这个是加了一个新主题。</li><li><a href="https://www.alphalxy.com/2019/03/customize-icarus">Icarus 主题自定义</a>：一些细节改动</li><li><a href="https://blog.it-follower.com/posts/2085550418.html">Hexo博客icarus主题定制</a></li></ul><h2 id="功能开启或添加">功能开启或添加</h2><h3 id="加入博客评论区-Gitalk">加入博客评论区 Gitalk</h3><p>有很多插件可供选择，这里我们使用了 Gitalk，本质上是在 Github 上面新开一个 Repo，然后在 issue 区记录评论，然后通过 OAuth App 读写并显示到博客中。具体的设置可以参见 Icarus 的<a href="https://ppoffice.github.io/hexo-theme-icarus/Plugins/Comment/icarus%E7%94%A8%E6%88%B7%E6%8C%87%E5%8D%97-%E7%94%A8%E6%88%B7%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6/">用户评论插件</a>。</p><p>插件设置好之后可能会出现一些问题：</p><ul><li>gitalk授权登录后报错403：一般来说是版本或 Proxy 的问题，需要升级版本或者更换 proxy，我选择了后者。参考 Gitalk 的 <a href="https://github.com/gitalk/gitalk/issues/433">issue</a> 和<a href="https://umm.js.org/p/1d1d49e9/">这篇博客</a>。</li><li><a href="https://eminoda.github.io/2021/06/16/hexo-gitalk-comment-plugins-in-github-issue/">文章批量初始化</a>：我由于文章数较少，是一个一个手动初始化的，日后可能会需要用上批量初始化。</li></ul><h3 id="加入博客评论区-Giscus">加入博客评论区 Giscus</h3><p>Icarus 并没有对 Giscus 的支持，所以还是要从 index 文件层面进行改动。整体来说愿意与 Gitalk 比较相似，不过不是在 issue 区记录评论，而是在 discussion 区记录。回答可以按照层级展开，个人比较喜欢。</p><p>首先访问 <a href="https://giscus.app/zh-CN">Giscus 官网</a>，获取对应的 <code>html</code> 代码，如下所示</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://giscus.app/client.js&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-repo</span>=<span class="hljs-string">&quot;xxxxxxxxx&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-repo-id</span>=<span class="hljs-string">&quot;xxxxxxxxx&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-category</span>=<span class="hljs-string">&quot;xxxxxxxxx&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-category-id</span>=<span class="hljs-string">&quot;xxxxxxxxx&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-mapping</span>=<span class="hljs-string">&quot;pathname&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-reactions-enabled</span>=<span class="hljs-string">&quot;1&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-emit-metadata</span>=<span class="hljs-string">&quot;0&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-input-position</span>=<span class="hljs-string">&quot;bottom&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-theme</span>=<span class="hljs-string">&quot;light&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">data-lang</span>=<span class="hljs-string">&quot;zh-CN&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&quot;anonymous&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">async</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>之后只需要将其放到原有的主题中放置 comments 的地方，替换原有代码即可。在 Icarus 中对应的文件是 <code>node_modules/hexo-theme-icarus/layout/common/comment.jsx</code>。climbing</p><p>参考了以下几篇文章：</p><ul><li><a href="https://zhauniarovich.com/post/2021/2021-06-giscus/">Giscus: The New Commenting Engine for My Website</a></li><li><a href="https://www.futlabs.com/2021/09/20/How-to-use-the-github-discussions-to-add-a-comment-feature-to-your-static-website-build-with-hexo/">How to use the github discussions to add a comment feature to your static website built with hexo?</a></li></ul><p>此外如果想要在 <code>config</code> 文件中控制 <code>Giscus</code> 的话，可以做以下更改</p><figure class="highlight yaml"><figcaption><span>_config.icarus.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">giscus:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">data_repo:</span> <span class="hljs-string">xxxxxxxxx</span><br>  <span class="hljs-attr">data_repo_id:</span> <span class="hljs-string">xxxxxxxxx</span><br>  <span class="hljs-attr">data_category:</span> <span class="hljs-string">xxxxxxxxx</span><br>  <span class="hljs-attr">data_category_id:</span> <span class="hljs-string">xxxxxxxxx</span><br>  <span class="hljs-attr">data_mapping:</span> <span class="hljs-string">pathname</span><br>  <span class="hljs-attr">data_reactions_enabled:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">data_emit_metadata:</span> <span class="hljs-number">0</span><br>  <span class="hljs-attr">data_input_position:</span> <span class="hljs-string">bottom</span><br>  <span class="hljs-attr">data_theme:</span> <span class="hljs-string">light</span><br>  <span class="hljs-attr">data_lang:</span> <span class="hljs-string">zh-CN</span><br>  <span class="hljs-attr">crossorigin:</span> <span class="hljs-string">anonymous</span><br><br></code></pre></td></tr></table></figure><figure class="highlight jsx"><figcaption><span>comment.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs jsx">&#123;(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">giscus</span>.<span class="hljs-property">enable</span> === <span class="hljs-literal">true</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://giscus.app/client.js&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-repo</span>=<span class="hljs-string">&#123;config.giscus.data_repo&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-repo-id</span>=<span class="hljs-string">&#123;config.giscus.data_repo_id&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-category</span>=<span class="hljs-string">&#123;config.giscus.data_category&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-category-id</span>=<span class="hljs-string">&#123;config.giscus.data_category_id&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-mapping</span>=<span class="hljs-string">&#123;config.giscus.data_mapping&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-reactions-enabled</span>=<span class="hljs-string">&#123;config.giscus.data_reactions_enabled&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-emit-metadata</span>=<span class="hljs-string">&#123;config.giscus.data_emit_metadata&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-input-position</span>=<span class="hljs-string">&#123;config.giscus.data_input_position&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-theme</span>=<span class="hljs-string">&#123;config.giscus.data_theme&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">data-lang</span>=<span class="hljs-string">&#123;config.giscus.data_lang&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&#123;config.giscus.crossorigin&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">async</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>    &#125; <br>&#125;)()&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Software Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Icarus</tag>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>讲座及研讨班记录</title>
    <link href="/computer-science-engineering/seminar-talk/"/>
    <url>/computer-science-engineering/seminar-talk/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>本篇Blog用于记录参加的讲座，不定期更新。</p><span id="more"></span><h1>搜索引擎的技术趋势和精准度提高【常毅】</h1><br><p><strong>主讲人</strong>：常毅教授，吉林大学人工智能学院院长<strong>日期</strong>：2020/11/23</p><h2 id="1-Introduction">1. Introduction</h2><p><strong>搜索引擎架构</strong>：</p><ul><li>网页爬虫</li><li>倒排索引（word &gt; document 拿空间换时间的一个过程）</li><li>网页检索&amp;网页排序（0.2s内）</li></ul><p><strong>PageRank 算法</strong>：</p><p>Google最先提出的一种网页排名算法。大众一般误认为google精准是仅仅是因为PageRank这一项技术，事实上是因为其很多黑科技的结合。</p><p><strong>搜索引擎进化史</strong>：</p><ul><li>1994-1998 Syntactic matching关键字匹配</li><li>1998-2006 PageRank，外加利用指向信息，点击信息等</li><li>2006-2014 垂直搜索，知识图谱</li><li>2014～ mobile search，私人助手，聊天机器人等</li></ul><p>搜索引擎后发劣势（追赶者很难超越）：用户数据积累较少导致效果较差。</p><p>深度学习在搜索引擎里的优势远远小于我们所期待的（至少在2016年）。</p><h2 id="2-Web-search-ranking-review">2. Web search ranking review</h2><p><strong>排序问题的变换</strong>：</p><ul><li>pointwise：退化为回归问题，用gradient boosting类回归</li><li>pairwise：排错对数越来越少</li><li>listwise</li></ul><h2 id="3-Yahoo-web-search-ranking-practice">3. Yahoo web search ranking practice</h2><p>简要介绍了2015年KDD best paper的工作。这是一个系统性的工作，并不仅仅单一的提出了一个算法。</p><p><strong>Practical challenges</strong>：</p><ul><li>avoid ugly result on the top</li><li>Semantic gap between query and document</li><li>Search queues follows a long tail distributions</li></ul><h3 id="3-1-排序学习的算法">3.1. 排序学习的算法</h3><p>2010 Yahoo learning rank challenge中前十名都是使用tree-based算法。2010年得出的结果中lambdaMart &gt; logisticRank。</p><p>2015年KDD best paper中logisticRank则好于lambdaMart和2010年结果相悖。</p><p>根据2015年的结果总结得出造成这一现象的原因是以前的community都或多或少忽略了&quot;over 99% query-url pairs are bad&quot;这一现象。</p><h3 id="3-2-查询改写的方法">3.2. 查询改写的方法</h3><p>机器翻译需要平行语料库，需要以用户反馈来学习查询语料对训练翻译模型。</p><p><strong>举个例子</strong>：<code> Tesla Price =&gt; How much is a Tesla</code></p><p>使用用户查询关键字与点击情况进行匹配。</p><h3 id="3-3-Click-similarity-feature">3.3. Click similarity feature</h3><p>当前存在很多feature types，如图所示：</p><div style="width:60%; margin:auto"><img src="/computer-science-engineering/seminar-talk/201123feature_types.jpg" class=""></div><p>Click similarity feature是一种特征提取的方法。通过二分图对Query进行特征构建</p><p>比deep learning效果好。在特征提取的问题上DL不会dominant，<strong>为什么</strong>？</p><ul><li>Web search ranking is an ‘easy’ and well studies task -李航</li><li>DL更适用数据初识表示和解决问题的合适表示相距甚远时 -周志华</li><li>DL适用于信息complete的时候，WSR中这一条件并不总是成立。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Computer Science and Engineering</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cs-seminar</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>肖钢讲座：我国多层次资本市场建设</title>
    <link href="/economy-finance/seminar-talks/xiaogang/"/>
    <url>/economy-finance/seminar-talks/xiaogang/</url>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p><strong>主讲人</strong>：肖刚（中国证监会前主席）<strong>日期</strong>：2020-11-19</p><span id="more"></span><hr><p>十四五金融工作八大任务：</p><ul><li>建设现代央行制度（1983建立，农业改革到企业改革，为金融发展提供历史性条件）</li><li>构建金融支持实体经济的体制机制</li><li>国有商业银行改革</li><li>市场枢纽，注册制，常态化退市，提高融资比重</li><li>金融双向开放</li><li>完善监管体系、透明度、法制化</li><li>整治乱象</li><li>防范风险</li></ul><hr><h1>1. 主要内容（PPT总结归纳而来）</h1><h2 id="1-1-重要意义">1.1. 重要意义</h2><p>多层次资本市场强调资本市场枢纽功能（举例2013钱荒)：<br>微观主体活力、稳健货币政策、资本市场功能 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span> 相互支撑<br><strong>社会的需要推动政策的变动。</strong></p><p>多层次资本市场是我国特有术语：</p><ul><li>以金融工具类别来分：股债衍生品</li><li>以交易场所来分：场内场外市场。交易所市场，产权交易市场（中央最新文件，并列为新市场体系）</li><li>以发行方式来分：公募大众的市场，私募小众的市场</li></ul><p>多层次资本市场重要意义：</p><ul><li>改善融资结构服务实体经济</li><li>促进科技创新</li><li>满足财富管理需求</li><li>提高<strong>直接融资比重</strong>防范金融风险</li><li>扩大开放提升影响力</li></ul><p>助力内循环与双循环：</p><ul><li>资源配置能力</li><li>风险分担能力</li><li>市场约束能力</li></ul><p>“技术创新+资本市场”是产业升级的强大推动力。存在两大问题：</p><ul><li>科技成果转化专业化服务体系不健全， 高校、科研与市场供需对接不畅。</li><li>信用评价体系缺乏差异化、针对性。知识产权融资有限、质押率偏低、不良率较高。 投贷联动有待完善。</li></ul><hr><h2 id="1-2-私募市场">1.2. 私募市场</h2><p>私募基金服务实体经济（2019年3季度末）</p><ul><li>累计投资境内未上市未挂牌企业股权、新三板企业股权和再融 资项目数量达到11.18万个，形成股权资本金6.36万亿元。所投资账面价值分布，股权类资产占比46.2%。</li><li>2018年向境内未上市挂牌企业股权本金新增1.22万亿元，相当于同期新增社会融资规模的6.3%。</li><li>在投中小企业项目5.98万个，本金2万亿；在投高新技术企业 3.1万个，本金1.27万亿。</li></ul><p>资金主要来源于：企业&gt;资管计划&gt;居民</p><hr><h2 id="1-3-交易所市场">1.3. 交易所市场</h2><p>中国上市公司海外收入比较低。</p><p>A股再融资政策调整：</p><ul><li>非公开发行对象数量上限分别由10名和5名（创业板） 统一调 整到35名。</li><li>非公开发行价格由原先不得低于定价基准日前20个交易 日均价的90%，改成80%，吸引投资者，降低发行难度。</li><li>非公开发行锁定期缩短，原规定控股股东36个月、普通 投资者2个月不得转入，分别减半，改为18个月和6个月，不再受减持规则限制。</li></ul><p>A股行业表现：</p><ul><li>高增长、不稳定：5G、新能源、军工、半导体、互联 网、券商、创业板、中证1000。牛市涨得多，熊市跌 得多。</li><li>高增长、很稳定：医疗、医药、消费、白酒、食品饮 料、家电。牛市涨得多，熊市跌得少。</li><li>低增长，不景气：煤炭、纺织、有色、钢铁、能源、 化工、交通。牛市涨得少，熊市跌得多。</li><li>高股息、低增长：机械设备、电力、金融、地产、上 证50。牛市涨得少，熊市跌得少。</li></ul><p>北向资金：</p><ul><li>北向资金占外资持股近七成（2019年底）。 对A股有明显领先性，多次精准抄底“聪明钱”，作为投资决策的一个参考。</li><li>北向资金类型：<ul><li>配置型资金，主要跟踪MSCI等指数</li><li>套利型资金（个股、指数、汇率间的利差），如离岸人民币汇率走高，北向资金流出，A股下跌</li></ul></li><li>北向资金择股：<ul><li>行业发展成熟，在产业链上具有高溢价。</li><li>所处行业壁垒高，短时间很难有新的竞争者。</li><li>持续稳定的高ROE.</li></ul></li></ul><p>什么是股票发行注册制：</p><ul><li>注册制不是登记备案制，股票发行上市仍要经过审核同意，但与现行核准制不同。</li><li>只要不违背国家利益和公众利益，企业能不能发行、何时发行、以什么价格发行，均应由企业和市场自主决定。</li><li>以信息披露为中心，企业必须披露充分和必要的投资决策信息，审批部门不对企业资产质量和投资价值进行判断，更不“背书”，也不对信息披露的真实性负责，但要对招股说明书的齐备性、一致性和可理解性负责。</li><li>发行人是信息披露第一责任人，中介机构承担对发行人信息披露的把关责任，投资者自主作出投资决策并自担投资风险。</li><li>实行宽进严管，政府职责重在事中事后监管，严惩违法违规，保护投资者合法权益。</li></ul><p>推进注册制改革的核心在于理顺市场与政府的关系。注册制的巧妙之处就在于既能较好地解决发行人与投资者信息不对称所引发的问题，又可以规范监管部门的职责边界，避免监管部门的过度干预，不再对发行人“背书”，企业业绩与价值、未来发展前景均交由投资者判断和选择，股票发行数量与价格由市场各方博弈，让市场发挥资源配置的决定性作用。监管部门则集中精力履行好事中事后监管职责，维护好市场秩序。</p><p>创业板面临挑战：</p><ul><li>发行、定价市场化程度</li><li>再融资、退市效率，优胜劣汰功能</li><li>前沿产业与未来科技企业不足，缺乏顶尖巨头新兴产业。 “易进易出、快进快出、大进大出+明星企业”</li></ul><hr><h2 id="1-4-上市公司相关制度">1.4. 上市公司相关制度</h2><p>我国退市的现状：退市率低</p><p>成因分析：</p><ul><li>强制退市标准尚不完备，且可执行性较差。</li><li>退市执行力度不够，为规避退市行为提供了条件。</li><li>股票发行被人为调控，造成上市资源稀缺。</li><li>投资者权益保障不足，加大了退市难度。</li><li>直接融资渠道有限，上市公司退市后生存困难。</li></ul><hr><h2 id="1-5-债券市场">1.5. 债券市场</h2><p>防范化解债券市场风险。</p><p>两大风险：企业违约风险、部分中小金融机构和非法人产品的杠杆风险。</p><p>总体思路：坚持市场化、法治化原则，<strong>有序可控打破刚性兑付</strong>，打击逃废债行为，加强政策协调，完善监管制度，切实保护投资者利益。</p><p>政策措施：</p><ul><li>健全市场化、法治化信用风险处置机制。如银行理财、券商资管计划等非法人产品管理人在破产重整中的法律地位。</li><li>合理控制债券市场杠杆水平。</li><li>规范债券市场信用评级，统一准入管理，建立以投资者为主导的市场化评介制度，推动投资人付费服务模式，引入评级机构强制退出机制。</li><li>加强监管协调，监测预警，信息共享和失信联合惩戒。</li></ul><hr><h2 id="1-6-衍生品市场">1.6. 衍生品市场</h2><p>增强实体企业利用衍生品抵御风险的能力</p><ul><li>我国商品期货共70个品种，自2013年以来，成交量连续五年占全球一半以上。</li><li>研究表明，实体企业运用衍生品套期保值，能降低风险，提高企业价值，在经济下行期更为明显。</li><li>持续推进衍生品市场改革，<strong>扩宽服务实体经济范围</strong>。 提升企业参与衍生品市场的意愿与能力，加快国际化步伐，<strong>提升我国定价影响力</strong>。</li></ul><hr><h2 id="1-7-资本市场基础设施">1.7. 资本市场基础设施</h2><p>狭义：证券市场参机构之间用于清算、结算或记录、支付证 券的多边系统。 支付系统、中央托管机构、证券结算机构、中央对手 方、交易数据库。</p><p>广义：上述五类以外扩大到：证券、期货、保险、黄金交易 所、征信系统、法律和监管环境、公司治理、会计准 则、反洗钱以及金融安全网。</p><h3 id="1-7-1-如何提高基础设施建设与改革">1.7.1. 如何提高基础设施建设与改革</h3><p>重点难点：平衡安全、效率、成本以及证券行业发展的相互关 系。安全是前提，效率是关键，成本是基础，行业 发展是支撑。四者有机整体，相辅相成。</p><p>改革内容：</p><ul><li>基础设施集约化：债券市场3家托管结算机构 场外交易数据库建设 区域性股权市场登记、托管、评估系统。</li><li>托管模式：直接持有模式和间接持有模式。间接持有法律关系：共有权（德国），信托关系（英国），证券权益（美国）</li><li>基础设施开放：与国际结算规则接轨、DVP制度境内外联结风险评估与防范，基础设施走出去。</li><li>基础设施风险防控：跨境跨市场风险，股票/债券质押、回购、期权市场，场内场外市场。流动性风险与交收违约风险。研究债券中央借贷机制，引入安全、效率高的流动性工具，完善担保品管理，全面推广逐日盯市，精细化，标准化，自动化管理，完善法律，建立折价过户、拍卖、债务抵消等快速处理机制</li><li>基础设施统筹监管</li></ul><h1>2. 给肖主席个机会讲一讲（没时间讲PPT）</h1><ul><li>我们的资本市场是在1990年建立，（1989动乱之后），那个时候资本主义国家封锁中国经济。</li><li>成立交易所释放了坚持改革开放的信念。</li><li>我国金融学过多的运用了西方金融学的理论，但是我国金融学的内涵与西方并不一样。应当创造性地研究提出中国特色的体制。</li><li>国外学界对中国经济发展肯定，但是对金融制度抱有负面看法。那么为什么经济成功金融不行？</li></ul><h1>3. Q&amp;A</h1><ol><li>社会需求推动政策改革还是国家改革推动社会进步？<ul><li><strong>社会的需要推动政策的变动。</strong></li></ul></li><li>怎么能不让科创板走创业板老路？<ul><li>上交所科创板针对战略新兴产业。</li><li>创业板起初主办化，包容性较差。</li><li>创业板在科创板上市时政策变化风险较大，先看科创板改革结果。</li><li>创业板也增强了保荐责任（推荐亏损企业必须跟投）</li></ul></li><li>深交所所长：什么时候能恢复深交所主板上市？<ul><li>八卦很久没有实质性内容。</li></ul></li><li>政府会不会拉一个牛市。<ul><li>不能出现08、15年的情形，否则会影响改革的进行。</li></ul></li><li>Andy：人生经验故事？<ul><li>没干货，终身学习</li></ul></li><li>如何和香港制度接轨？合作？（这个人问得不清不楚）<ul><li>建设国际金融枢纽</li><li>创新要素流动方面存在障碍（人才资本土地知识产权等）</li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>Economy &amp; Finance</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>MacOS 功能与设置</title>
    <link href="/software-tools/macos/macos-functions/"/>
    <url>/software-tools/macos/macos-functions/</url>
    
    <content type="html"><![CDATA[<p>不得不说在多年的MacOS使用过程中还是有很多不方便的地方。本帖记录一些经常遇到的问题与解决方法。</p><span id="more"></span><h2 id="外接显示器音频设置">外接显示器音频设置</h2><p>MacOS是不可以通过HDMI/DP控制外接显示器的音量输出的。但是黑苹果是一定要外接显示器，同时使用显示器自带的扬声器是极为方便的，所以这是一个需要解决的问题。目前来看有三种解决方案：</p><ul><li>Soundflower配套方案</li><li>Monitor Control插件</li><li>Sound Control插件</li></ul><p>其中Monitor Control在我的黑苹果上只可以调节亮度无法调节声音。Sound Control试用期内可以使用（单独条件app声音），但是试用期过后无法通过调节全局声音来调整显示器输出。Soundflower方案之前在黑苹果上一直使用，后来重装系统之后出现了蜂鸣现象。考虑到SF方案体验很不错，于是尝试解决蜂鸣现象。</p><p>先简要介绍，SF方案需要下载<a href="https://github.com/mattingalls/Soundflower/releases/tag/2.0b2">Soundflower插件</a>与相应的客户端<a href="https://github.com/MonitorControl/MonitorControl/releases/tag/v2.1.0">Soundflower Bed</a>（菜单栏插件）。简单配置即可使用，此处省略，可以使用全局的音量调节调整显示器音量。</p><p>但是使用过程中存在播放一定时间后，出现蜂鸣Humming/Bizz，在之后便无音量输出，由于SF项目已经多年未维护，所以在issue里看大家讨论的结果。问题出现的直接原因是Buffer size过小，溢出时就会出现此问题。治标不治本的方法时直接选择最大的Buffer size，但是时间过长时还是会出现此类问题。从大家的<a href="https://code.google.com/archive/p/soundflower/issues/24">讨论</a>中得出，问题出现的根本原因是Soundflower可能存在内置时钟与设备时钟不符，才导致缓冲区最终会溢出。一篇<a href="http://mac.8miu.com/thread-1096414-1-1.html">2014年的帖</a>子给出了方案.新建一个&quot;聚合设备&quot;（名称必须用英文），时钟源设置为&quot;Soundflower(2ch)&quot;，实体设备显示器勾上“漂移修正”，然后就可以拿给Soundflower用了。问题解决。</p><div style="width:70%; margin:auto"><img src="/software-tools/macos/macos-functions/soundflower.png" class=""></div><h2 id="外接2K显示屏开启HiDPI">外接2K显示屏开启HiDPI</h2><p>Macbook外接大部分2K显示器时并不会开启HiDPI，需要手动开启。开启方法很多帖子写的很详细了，详见<a href="https://www.smslit.top/2019/01/02/mac_hidpi/">此链接</a>。印象中是有一些坑，待下次再设置的时候更新。</p><h2 id="Google-Software-Update-自启动">Google Software Update 自启动</h2><p>详见<a href="https://www.imore.com/how-stop-googlesoftwareupdateapp-trying-run-your-mac">这篇文章</a>。</p>]]></content>
    
    
    <categories>
      
      <category>Software Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MacOS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo-Trials</title>
    <link href="/software-tools/hexo/hexo-trials/"/>
    <url>/software-tools/hexo/hexo-trials/</url>
    
    <content type="html"><![CDATA[<p>本文记录使用Hexo中遇到的很多坑，以后可能会重复遇到，记录在此，以观后效。</p><span id="more"></span><h2 id="功能-支持">功能&amp;支持</h2><h3 id="Markdown-image-insertion-grammar-support">Markdown image insertion grammar support</h3><p>具体配置的方法</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">_config.yml</span><br><br><span class="hljs-attr">post_asset_folder:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">marked:</span><br>  <span class="hljs-attr">prependRoot:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">postAsset:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h2 id="运行-测试坑">运行&amp;测试坑</h2><h3 id="Local-server">Local server</h3><p>存在local server无法打开或打开极慢，但是GitHub Action正常部署的情况。此时使用全局代理可解决。经查原因为在编译HTML时，难以获取all.css文件，fontawesome.com需要代理访问。将该网站加入代理规则即可解决。</p><h2 id="写作排版坑">写作排版坑</h2><h3 id="公式支持">公式支持</h3><p>使用 <code>\\</code> 时不换行，原因是hexo使用的markdown引擎造成的。其将第一个 <code>\</code> 识别为转义符号。解决方法是换一个引擎，如下：</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">npm uninstall <span class="hljs-comment">--save hexo-renderer-marked</span><br>npm install <span class="hljs-comment">--save hexo-renderer-kramed</span><br></code></pre></td></tr></table></figure><p>参考：</p><ul><li><a href="https://jdhao.github.io/2017/10/06/hexo-markdown-latex-equation/">https://jdhao.github.io/2017/10/06/hexo-markdown-latex-equation/</a></li><li><a href="https://lanlan2017.github.io/blog/eb86e892/">https://lanlan2017.github.io/blog/eb86e892/</a></li></ul><h3 id="行内公式无法编译">行内公式无法编译</h3><p>换用 kramed 作为 markdown 的渲染引擎之后，行内公式有时无法渲染。一般情况下是因为其对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">\ast</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord">∗</span></span></span></span> 和 <span class='katex-error' title='ParseError: KaTeX parse error: Expected group after &#039;_&#039; at position 1: _̲'>_</span> 的支持有些不同。在行内公式时优先会考虑 markdown 语法（这两个符号会优先认为是在定义<em>斜体</em>），其次才是公式支持，所以这种情况下无法编译。</p><p>解决方法是对文件 <code>/node_modules/kramed/lib/rules/inline.js</code> 进行修改。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//  em: /^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,</span><br><span class="hljs-attr">em</span>: <span class="hljs-regexp">/^\*((?:\*\*|[\s\S])+?)\*(?!\*)/</span>,<br></code></pre></td></tr></table></figure><p>这样可以解决下划线的问题。同时 markdown 中星号使用 <code>\ast</code> 代替。</p><p>此外在部署的时候同时记得将远程的文件替换或修改即可。</p><p>参考：</p><ul><li><a href="https://suixinblog.cn/2018/10/hexo-latex.html">https://suixinblog.cn/2018/10/hexo-latex.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Software Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo常用功能说明</title>
    <link href="/software-tools/hexo/hexo-functions/"/>
    <url>/software-tools/hexo/hexo-functions/</url>
    
    <content type="html"><![CDATA[<p>本文档会用作Hexo基本用法记录演示。</p><span id="more"></span><h2 id="新建博文">新建博文</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h2 id="Generate-static-files-Run-server">Generate static files + Run server</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo clean <span class="hljs-comment"># Clean local files</span><br>$ hexo generate <span class="hljs-comment"># Generate static files</span><br>$ hexo server <span class="hljs-comment"># Build local server</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h2 id="远端部署-use-Gitbuh-Action">远端部署 (use Gitbuh Action)</h2><p>The procedure is in <code>.github/workflows/deploy.yml</code></p><p>When this local git folder has been uploaded to github, the <code>deploy.yml</code> would be executed.</p><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><h2 id="文章折叠">文章折叠</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- more --&gt;</span><br></code></pre></td></tr></table></figure><h2 id="文章间引用">文章间引用</h2><p>站内文章引用语法如下。</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs django"><span class="hljs-template-tag">&#123;% <span class="hljs-name">post_link</span> file_name Title_of_link %&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Insert-figures">Insert figures</h2><p>不同于markdown的图片引用方法，Hexo有着自己的语法。图片文件夹位于<code>_post</code>目录下</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs django"><span class="hljs-template-tag">&#123;% <span class="hljs-name">asset_img</span> test.jpg%&#125;</span><br></code></pre></td></tr></table></figure><img src="/software-tools/hexo/hexo-functions/test.jpg" class=""><p>同时可以自定义图片大小。语法与html语法相同。</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs django"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:70%;margin:auto&quot;</span>&gt;</span></span><span class="hljs-template-tag">&#123;% <span class="hljs-name">asset_img</span> test.jpg%&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></code></pre></td></tr></table></figure><div style="width:70%;margin:auto"><img src="/software-tools/hexo/hexo-functions/test.jpg" class=""></div><p>markdown的语法需要配置之后才可以使用，具体配置的方法见<a href="/software-tools/hexo/hexo-trials/" title="这篇文章">这篇文章</a></p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">![<span class="hljs-keyword">Test</span>](<span class="hljs-keyword">test</span>.jpg)<br></code></pre></td></tr></table></figure><p><img src="test.jpg" alt="Test"></p>]]></content>
    
    
    <categories>
      
      <category>Software Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>Master Ma</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>有幸拍到的照片</title>
    <link href="/blog-general-info/gallery/"/>
    <url>/blog-general-info/gallery/</url>
    
    <content type="html"><![CDATA[<p>一些我觉得十分庆幸能拍到的照片，或有趣，或好看。</p><h2 id="2022-年">2022 年</h2><div class="justified-gallery"><img src="/gallery/photographs/2022-三角蓝.JPG" alt="三角蓝" /><img src="/gallery/photographs/2022-冷暖灯.JPG" alt="冷暖灯" /><img src="/gallery/photographs/2022-前海石晚霞.JPG" alt="前海石晚霞" /><img src="/gallery/photographs/2022-吊床.jpg" alt="吊床" /><img src="/gallery/photographs/2022-哥斯拉雾夜.jpg" alt="哥斯拉雾夜" /><img src="/gallery/photographs/2022-小马戏团.jpg" alt="小马戏团" /><img src="/gallery/photographs/2022-平安鹤.jpg" alt="平安鹤" /><img src="/gallery/photographs/2022-平滑晚霞.jpg" alt="平滑晚霞" /><img src="/gallery/photographs/2022-拿气球的人.jpg" alt="拿气球的人" /><img src="/gallery/photographs/2022-摩天轮云.jpg" alt="摩天轮云" /><img src="/gallery/photographs/2022-树和情侣.JPG" alt="树和情侣" /><img src="/gallery/photographs/2022-猫猫影.jpg" alt="猫猫影" /><img src="/gallery/photographs/2022-看彩虹.jpg" alt="看彩虹" /><img src="/gallery/photographs/2022-背影.jpg" alt="背影" /><img src="/gallery/photographs/2022-豆豆来福.jpg" alt="豆豆来福" /><img src="/gallery/photographs/2022-过山车.jpg" alt="过山车" /><img src="/gallery/photographs/2022-馋烤肠的狗.jpg" alt="馋烤肠的狗" /></div><h2 id="2021-年">2021 年</h2><div class="justified-gallery"><img src="/gallery/photographs/2021-碎片猫.jpg" alt="碎片猫" /></div><h2 id="2020-年">2020 年</h2><div class="justified-gallery"><img src="/gallery/photographs/2020-四颗球.jpg" alt="四颗球" /><img src="/gallery/photographs/2020-毕业典礼.JPG" alt="毕业典礼" /></div><h2 id="2019-年">2019 年</h2><div class="justified-gallery"><img src="/gallery/photographs/2019-两片天.PNG" alt="两片天" /><img src="/gallery/photographs/2019-凯旋门上.JPG" alt="凯旋门上" /><img src="/gallery/photographs/2019-建国70年.jpg" alt="建国70年" /><img src="/gallery/photographs/2019-棉花云.JPG" alt="棉花云" /><img src="/gallery/photographs/2019-爱丁堡泡泡.JPG" alt="爱丁堡泡泡" /><img src="/gallery/photographs/2019-莫斯科雪机场.jpg" alt="莫斯科雪机场" /></div><h2 id="2018-年">2018 年</h2><div class="justified-gallery"><img src="/gallery/photographs/2018-榴莲老吴.jpg" alt="榴莲老吴" /></div><h2 id="2017-年">2017 年</h2><div class="justified-gallery"><img src="/gallery/photographs/2017-深大情侣.jpg" alt="深大情侣" /></div><h2 id="2016-年">2016 年</h2><div class="justified-gallery"><img src="/gallery/photographs/2016-日晕.JPG" alt="奇特的环形日晕" /><img src="/gallery/photographs/2016-五月天.JPG" alt="五月天演唱会" /><img src="/gallery/photographs/2016-天普乐队.JPG" alt="天普乐队" /><img src="/gallery/photographs/2016-宁静超市口.JPG" alt="宁静超市口" /><img src="/gallery/photographs/2016-门前晚霞.JPG" alt="门前惊艳的晚霞" /><img src="/gallery/photographs/2016-晚会之后.JPG" alt="晚会之后" /><img src="/gallery/photographs/2016-中心公园.JPG" alt="中心公园" /><img src="/gallery/photographs/2016-大都会博物馆.JPG" alt="大都会博物馆" /><img src="/gallery/photographs/2016-华盛顿.JPG" alt="华盛顿" /><img src="/gallery/photographs/2016-大瀑布.jpg" alt="大瀑布" /><img src="/gallery/photographs/2016-大瀑布的人.JPG" alt="大瀑布的人" /></div>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
