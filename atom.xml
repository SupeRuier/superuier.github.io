<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Superui&#39;s Blog</title>
  
  
  <link href="https://blog.superui.cc/atom.xml" rel="self"/>
  
  <link href="https://blog.superui.cc/"/>
  <updated>2023-03-08T10:00:00.000Z</updated>
  <id>https://blog.superui.cc/</id>
  
  <author>
    <name>Superui</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Web 3.0，从 Chatgpt 说起</title>
    <link href="https://blog.superui.cc/writing/web3chatgpt/"/>
    <id>https://blog.superui.cc/writing/web3chatgpt/</id>
    <published>2023-03-08T10:00:00.000Z</published>
    <updated>2023-03-08T10:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>上一波所谓 Web3.0 以及元宇宙的热潮已经褪去很久，我向来对这些虚伪的概念嗤之以鼻。我从不认为那些区块链或数字货币的营销即为 web3.0，新一代的互联网信息技术不应当与这些肤浅的割韭菜概念等同。近几个月 Chatgpt 的兴起让我对 Web3.0 的定义有了新的思考。当然本文不会探讨技术细节，希望从“名词之争”的角度找出更准确的定义。本文或许长期更新，当前仅为一个思路，希望大家来辩经。</p><span id="more"></span><h1>个人观点在最前</h1><span style="color:red">如果从 web 1.0 和 web 2.0 相关的概念出发，以信息为核心维度来看，这一波基于大模型的“类 ChatGPT 信息生成技术”或许才能称为真正的 web 3.0。</span><p>（之前那一波基于区块链的数字货币/NFT 等技术（的炒作）目前我还不知道把它归为哪类（或许更多的是金融衍生品创新），但在我看来称其为 web3.0 是极度不合适的。在术的层面或许有一点道理，但是道的层面没什么道理。）</p><h1>历史上的 Web 1.0 以及 Web 2.0</h1><p>我对这个的理解主要来源于对《浪潮之巅》的阅读，当时还写了<a href="/reading-note/top-of-the-wave/" title="读书笔记">读书笔记</a>。此外加入 wiki 和 ChatGPT 的解释，或许对 web 1&amp;2 可以展现得较为清楚。</p><h2 id="Web-1-0">Web 1.0</h2><div class="note note-success">            <p>Wiki:<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Web1](https://en.wikipedia.org/wiki/Web_2.0#Web_1.0)">[6]</span></a></sup></p><p>Web 1.0 is a retronym referring to the first stage of the World Wide Web’s evolution, from roughly 1989 to 2004. According to Graham Cormode and Balachander Krishnamurthy, “content creators were few in Web 1.0 with the vast majority of users simply acting as consumers of content”.</p><p>Web 1.0是一个返璞词，指的是万维网发展的第一阶段，时间大约从1991年到2004年。根据科莫德和克里希纳穆绥的说法，“在Web 1.0中，内容创作者很少，绝大多数用户只是内容的消费者。”</p>          </div><div class="note note-primary">            <p>ChatGPT:</p><p>Web1.0是指早期的互联网，它主要是静态网页，信息流只是单向的，用户只能被动地接收内容，没有互动性。Web1.0 时期的网站主要是由个人和机构创建的，内容相对比较单一。</p>          </div><p>到2000年世界上流量最大的网站全部是门户网站，在美国是雅虎、MSN 和 Excite 等。在中国则是新浪、搜狐和网易三大门户网站。<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="吴军. 浪潮之巅. 人民邮电出版社, 2019.Metaverse">[7]</span></a></sup></p><p>我本人对这一段历史只有较为模糊的印象，依稀记得 360 的网站导航指向的一系列信息网页。</p><h2 id="Web-2-0">Web 2.0</h2><div class="note note-success">            <p>Wiki<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Web2](https://en.wikipedia.org/wiki/Web_2.0)">[5]</span></a></sup></p><p>Web 2.0 (also known as participative (or participatory) web and social web) refers to websites that emphasize user-generated content, ease of use, participatory culture and interoperability (i.e., compatibility with other products, systems, and devices) for end users.</p><p>Web 2.0（也称为参与式网络[1]或社交网络[2]），指以最终用户为目标，强调用户生成内容、易用性、参与文化和互操作性（如：与其它产品、系统和设备兼容）的网站。</p>          </div><div class="note note-primary">            <p>ChatGPT:</p><p>Web2.0则是指随着互联网技术的发展，互联网上的信息变得更加丰富和多样化。Web2.0的特点是用户可以通过各种方式主动参与到内容的创作和分享中，例如博客、社交媒体、维基百科等平台。Web2.0也成为了“社交互联网”的时代，人们可以通过互联网进行社交互动，实现信息共享和交流。</p>          </div><p>互联网2.0的公司不应该过多主导内容和服务，不应该参与和用户的竞争。以YouTube 为例，它host 的内容是用户（包括个人和专业的传媒公司）提供，它自己并不制作和拥有内容， 与其他提供内容的用户竞争。互联网2.0公司的一个普遍特点就是专注于打造通用的平台，而由社会上的开发力量和广大用户补充成完整的服务，从Wikipedia 到Facebook 都是如此，它们相当于软件时代的甲骨文和微软。<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="吴军. 浪潮之巅. 人民邮电出版社, 2019.Metaverse">[7]</span></a></sup></p><p>这个是互联网的当前版本，也是我与大家最熟悉的版本，每个人都有自己的社交账号，在网络上搜索信息并发布着内容。</p><h1>Web 3.0 应该是什么？</h1><h2 id="当前普遍接受的-Web3-概念">当前普遍接受的 Web3 概念</h2><div class="note note-success">            <p>Wiki:<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Web3](https://en.wikipedia.org/wiki/Web3)">[4]</span></a></sup></p><p>Web3 (also known as Web 3.0) is an idea for a new iteration of the World Wide Web which incorporates concepts such as decentralization, blockchain technologies, and token-based economics.Specific visions for Web3 differ, and the term has been described by Bloomberg as “hazy”, but they revolve around the idea of decentralization and often incorporate blockchain technologies, such as various cryptocurrencies and non-fungible tokens (NFTs).</p><p>Web3（也被称为 Web 3.0，又寫為 web3）是關於全球資訊網發展的一个概念，主要與基於區塊鏈的去中心化、加密貨幣以及非同質化代幣有關。與區塊鏈有關的 web3 概念是由以太坊聯合創始人 Gavin Wood 於 2014 年提出，並於 2021 年受到加密貨幣爱好者、大型科技公司和創業投資公司的關注。</p>          </div><p>目前 Web3 和区块链（数字货币）元宇宙<sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Metaverse](https://en.wikipedia.org/wiki/Metaverse)">[8]</span></a></sup>（一种基于虚拟连接的去中心化的社交环境）几乎成为了强相关的等价概念。这些概念混杂在各种信息源中对大家进行强势输出。或许大家已经形成思维定式，在绝大多数人眼中这些概念是等价的。</p><h2 id="ChatGPT-对什么是-Web-3-0-的解释">ChatGPT 对什么是 Web 3.0 的解释</h2><p>令人惊奇的是，ChatGPT 给出了一个我从来没有见过的 Web 3.0 的解释。这是我第一次看到不同于“基于区块链”的 Web3 定义（当然有可能是我的孤陋寡闻）。</p><div class="note note-primary">            <p>ChatGPT:</p><p>Web3.0则是指未来互联网的发展方向。Web3.0的特点是更加智能化、个性化和自适应，它能够更好地理解用户的需求，提供更为精准的服务。Web3.0也被称为“语义网”，它可以通过自然语言理解技术，将人类语言转化为机器可读的语义信息，从而实现更好的智能化交互。</p><p>总的来说，Web1.0、Web2.0和Web3.0代表了互联网在不同阶段的发展和变革。Web1.0时期是互联网的起步阶段，Web2.0时期是互联网的社交互联网时代，而Web3.0则是互联网向智能化和个性化方向发展的趋势。</p>          </div><p>这个 Chatgpt 的版本其实更加贴合我个人的理解。相信 Chatgpt 这样的输出也包含了一些 OpenAI 人员对互联网发展自己的理解和私心。</p><h1>我个人对 Web 3.0 这个名词的理解</h1><p>“名词之争”：在这里什么技术叫什么名字对技术的发展大概率不会有太大影响。这里仅做一个 Web 3.0 或许可能更适合指什么东西的讨论。</p><p>首先我们提出一些公理：</p><ol><li>每一代互联网都需要以<strong>信息</strong>为核心，包括且不限于信息的产生和分发和产权。</li><li>每一代互联网都需要对社会有着<strong>实际的而非虚构的</strong>积极正面的作用。</li><li>作为信息革命，需要伴随着大量基础设施的发展。<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Why it’s too early to get excited about Web3](https://www.oreilly.com/radar/why-its-too-early-to-get-excited-about-web3/)">[3]</span></a></sup><sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Web3](https://en.wikipedia.org/wiki/Web3)">[4]</span></a></sup></li></ol><p><strong>在这个基础上，我认为基于大模型的“类 ChatGPT 信息生成技术”才是 web 3.0 的核心含义。</strong>即从“机构收集数据”到“用户生产数据”到“自动生产数据”的一个变迁。（后者也会包含前者）当然这个在技术上是一个信息的解构与重构过程。</p><h2 id="Web-1-2-3-的对比">Web 1/2/3 的对比</h2><p>基于当前理解，我们可以从信息的维度对三种 Web 进行对比。（后一代纪可以包含前一代纪的内容。）</p><table><thead><tr><th>特点</th><th>Web1.0</th><th>Web2.0</th><th>Web3.0（基于当前分析）</th></tr></thead><tbody><tr><td>信息内容</td><td>静态网页，网站预筛选</td><td>以用户为中心进行内容创作</td><td>由人工智能系统辅助的以人为中心的创作</td></tr><tr><td>信息分发</td><td>网站</td><td>搜索引擎/社交网络</td><td>对话系统/智能辅助系统</td></tr><tr><td>信息产权</td><td>网站所有</td><td>公司/个人所有</td><td>机构（模型产权）/公司（Prompt 产权）/个人（细分内容产权）</td></tr><tr><td>信息存储</td><td>公司服务器</td><td>数据中心</td><td>数据中心 &amp; 区块链</td></tr><tr><td>信息交互性</td><td>用户被动接收内容</td><td>用户主动参与内容创作和分发</td><td>用户主动参与内容创作分发与反馈</td></tr><tr><td>信息交互方式</td><td>向单向传输（文本形式）</td><td>双向传输（文本/图像/视频等）</td><td>双向传输（更多的模态 VR/AR）（元宇宙）</td></tr><tr><td>信息基础设施</td><td>互联网</td><td>数据中心 &amp; 服务器</td><td>基于大量预训练数据的大模型</td></tr><tr><td>行业信息壁垒</td><td>内容质量</td><td>社区维护</td><td>大模型在特定场景的定制化</td></tr><tr><td>相关信息技术</td><td>古早互联网信息技术</td><td>Web服务、社交网络、博客等</td><td>人工智能、区块链、物联网、VR/AR 等</td></tr><tr><td>价值</td><td>高效的信息收集</td><td>更高效的信息收集与传播</td><td>更高效的信息收集处理与传播</td></tr></tbody></table><p>（本表格基于 chatgpt 预生成更改。）</p><h1>Reference</h1><section class="footnotes">[object Object]<div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.bilibili.com/read/cv14711971">聂辉华、李靖：《元宇宙的秩序：一个不完全契约理论的视角》</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/448262398">为什么现在对 Web3 感到兴奋还为时过早</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.oreilly.com/radar/why-its-too-early-to-get-excited-about-web3/">Why it’s too early to get excited about Web3</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://en.wikipedia.org/wiki/Web3">Web3</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://en.wikipedia.org/wiki/Web_2.0">Web2</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://en.wikipedia.org/wiki/Web_2.0#Web_1.0">Web1</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:7" class="footnote-text"><span>吴军. 浪潮之巅. 人民邮电出版社, 2019.Metaverse<a href="#fnref:7" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="https://en.wikipedia.org/wiki/Metaverse">Metaverse</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">&lt;p&gt;上一波所谓 Web3.0 以及元宇宙的热潮已经褪去很久，我向来对这些虚伪的概念嗤之以鼻。
我从不认为那些区块链或数字货币的营销即为 web3.0，新一代的互联网信息技术不应当与这些肤浅的割韭菜概念等同。
近几个月 Chatgpt 的兴起让我对 Web3.0 的定义有了新的思考。
当然本文不会探讨技术细节，希望从“名词之争”的角度找出更准确的定义。
本文或许长期更新，当前仅为一个思路，希望大家来辩经。&lt;/p&gt;</summary>
    
    
    
    <category term="Writing" scheme="https://blog.superui.cc/categories/Writing/"/>
    
    
    <category term="随笔" scheme="https://blog.superui.cc/tags/%E9%9A%8F%E7%AC%94/"/>
    
    <category term="互联网" scheme="https://blog.superui.cc/tags/%E4%BA%92%E8%81%94%E7%BD%91/"/>
    
    <category term="web1.0" scheme="https://blog.superui.cc/tags/web1-0/"/>
    
    <category term="web2.0" scheme="https://blog.superui.cc/tags/web2-0/"/>
    
    <category term="web3.0" scheme="https://blog.superui.cc/tags/web3-0/"/>
    
    <category term="chatgpt" scheme="https://blog.superui.cc/tags/chatgpt/"/>
    
    <category term="元宇宙" scheme="https://blog.superui.cc/tags/%E5%85%83%E5%AE%87%E5%AE%99/"/>
    
  </entry>
  
  <entry>
    <title>Contrastive Learning 再次学习</title>
    <link href="https://blog.superui.cc/machine-learning/contrastive-learning-again/"/>
    <id>https://blog.superui.cc/machine-learning/contrastive-learning-again/</id>
    <published>2023-02-21T10:00:00.000Z</published>
    <updated>2023-02-21T10:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>由于最近工作需要用到对比损失，这里对近期看到的一些资料进行整理。之前我们也对对比学习做过一个初步学习，具体详见<a href="/machine-learning/contrastive-learning/" title="此笔记">此笔记</a>。</p><span id="more"></span><p>本文主要是对以下三篇资料的学习：</p><ul><li>SimCSE: Simple Contrastive Learning of Sentence Embeddings <a href="https://arxiv.org/pdf/2104.08821.pdf">[2021, EMNLP]</a></li><li>Prototypical Contrastive Learning of Unsupervised Representations <a href="https://arxiv.org/pdf/2005.04966.pdf">[2021, ICLR]</a></li><li><strong>Tutotial:</strong> Contrastive Data and Learning for Natural Language Processing <a href="https://contrastive-nlp-tutorial.github.io/files/contrastive_nlp_tutorial.pdf">[2022, NAACL]</a></li></ul><h1>SimCSE</h1><p>同时有监督式和无监督式对比学习，standard <strong>dropout</strong> used as noise：</p><ol><li>Unsupervised approach:<ul><li>使用两次 dropout 并互为正样本。</li><li>Unsupervised SimCSE essentially improves uniformity while avoiding degenerated alignment via dropout noise, thus improving the expressiveness of the representations.</li></ul></li><li>Supervised approach:<ul><li>将标注样本加入对比学习。</li><li>Takes alignment between semantically-related positive pairs and uniformity of the whole representation space to measure the quality of learned embeddings.</li></ul></li><li>对比了其他的正样本生成方式：<ul><li>crop / word deletion / synonym replacement</li></ul></li><li>使用 supervised  和 unsupervised CL：<ul><li>目测这个 supervised 里面已经包含了 unsupervised？</li><li>在他自己的分析中，他们这种使用 dropout 的方法保证了 uniformity 和 alignment。</li></ul></li></ol><h1>Prototypical Contrastive Learning</h1><p>同时使用无监督对比表征学习和聚类。</p><ol><li>It encodes semantic structures discovered by clustering into the learned embedding space.</li><li>Propose ProtoNCE loss, a generalized version of the InfoNCE loss for contrastive learning, which encourages representations to be closer to their assigned prototypes.<ul><li>包含一项 infoNCE，to retain the property of local smoothness and help bootstrap clustering.</li><li>也包含一项 cluster 相关的 loss，形式和 infoNCE 很像，只是把 augmented examples 替换成了 cluster centroids。这个其实可以看做某种半/无监督类型的对比，因为本质上是使用了 pseudo-labels。</li></ul></li></ol><h1>Contrastive Data and Learning for NLP</h1><p>这个是 NAACL 上的一个 Toturial，此处记录一些自认为重要的点：</p><ol><li>Contrastive Learning = Contrastive Data Creation + Contrastive Objective Optimization</li><li>Noise Contrastive Estimation (NCE) 仅是对比学习中的一类 loss。</li><li>Normalized Temperature-scaled Cross-Entropy (NT-Xent) 即为 InfoNCE with Cosine Similarity on Normalized Embeddings。</li><li>Hard negative mining: find hard negative examples. We want to ancher-neg is greater than anchor-pos, at least by the margin.</li><li>更大的批选取通常有更好的表现。</li><li>Two geometric forces on the hypersphere: alignment &amp; uniformity</li></ol><h1>My Questions?</h1><p>本次阅读这些文章主要是为了回答自己的两个问题：</p><ol><li>在文本上如何进行正负样本的构建？（图像上的构建方式在上一次的学习笔记中已经提到不少。）<ul><li>crop / word deletion / synonym replacement / back-translation / cut-off / mixup</li></ul></li><li>同时添加 supervised 和 unsupervised contrastive loss 这种方式有时表现不错，如何解释？<ul><li>前两篇文章都有监督损失和非监督损失的结合，都取得了较好的表现。</li><li>或许是因为两种结合可以更好的保证学得表征的 alignment &amp; uniformity。</li></ul></li></ol>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;由于最近工作需要用到对比损失，这里对近期看到的一些资料进行整理。
之前我们也对对比学习做过一个初步学习，具体详见&lt;a href=&quot;/machine-learning/contrastive-learning/&quot; title=&quot;此笔记&quot;&gt;此笔记&lt;/a&gt;。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="contrastive-learning" scheme="https://blog.superui.cc/tags/contrastive-learning/"/>
    
    <category term="self-supervised-learning" scheme="https://blog.superui.cc/tags/self-supervised-learning/"/>
    
  </entry>
  
  <entry>
    <title>对于主动学习的一些思考</title>
    <link href="https://blog.superui.cc/machine-learning/al-thinking/"/>
    <id>https://blog.superui.cc/machine-learning/al-thinking/</id>
    <published>2023-02-11T10:40:00.000Z</published>
    <updated>2023-02-19T06:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>主动学习发展已经约 30 年，作为领域里面的无名小卒，自己也对这个方向有大概四五年的了解。近些年发现本领域的文章以灌水居多，真正提出问题和解决问题的少之又少（虽然绝大多数领域都是这样）。目前有一些人对 AL 的实用性和表现提出了质疑，并且也收获了一些认可。那么主动学习领域到底会何去何从？本文我会整理总结一下自己的看法，或许有一些观点缺乏证据支持，若日后需要深入，则会补上。</p><span id="more"></span><h1>客观上 AL 是什么？</h1><div class="note note-primary">            <p>关于 AL 的具体信息，可见本人 <code>awesome-active-learning</code> 的仓库，详见<a href="https://github.com/SupeRuier/awesome-active-learning">此链接</a>。</p>          </div><h2 id="主动学习面向的问题">主动学习面向的问题</h2><p>在机器学习中，需要标记样本来训练模型，获得标记样本需要成本（人工标注，实验模拟等）。为了训练一个良好的模型，获取标记样本的成本往往可观。所以我们期望可以使用更少的标记成本（通常意味着更少的标记样本）来训练得到一个表现相当的可用模型。</p><p>这个问题通常有两个解决思路：</p><ol><li>在少量标记样本下，尽可能来提升模型的表现。</li><li>选取更加值有价值的样本进行标注且训练模型。</li></ol><h2 id="主动学习的基本思路">主动学习的基本思路</h2><h3 id="一个重要的假设">一个重要的假设</h3><p>并不是所有的样本对于模型训练有着相同的重要性。相同数量的重要样本训练出的模型要好于相同数目的劣质样本。那么选择重要样本标记并训练可以有效减少标注成本（因为不同样本的标记成本近似相同）。</p><h3 id="基本解决方案（通常遵循的思路）">基本解决方案（通常遵循的思路）</h3><p>迭代式选取与训练：</p><ol><li>基于当前标记样本训练模型。</li><li>基于当前训练好的模型选取重要的新样本并更新已有标记样本库。</li><li>重复 1&amp;2 直到预算耗尽。</li></ol><p>于是乎绝大多数工作的重点都放在了如何定义“重要”以及如何选取“重要样本”。</p><h1>客观上 AL 现状？有什么局限？</h1><h2 id="现状">现状</h2><h3 id="从论文的角度而言">从论文的角度而言</h3><ol><li>从论文发表的角度来看，每年都会有一定程度的顶会顶刊，作为一个相对成熟的领域还算正常。</li><li>从论文的内容来看<ol><li>高水平会议以及期刊针对于 AL 方法或者当前解决方案的局限性进行分析讨论。</li><li>其他绝大多数工作是将 AL 当作工具与其他领域问题结合使用。在这些问题上或提出新策略，或没有。</li><li>针对传统问题提主动学习策略的越来越少。</li></ol></li></ol><h3 id="从应用的角度而言">从应用的角度而言</h3><ol><li>听说过一些数据标记公司使用 AL 来标记/构建模型。</li><li>也能时常看到一些科学界或者产业界的应用论文。</li></ol><h3 id="从学者研究强度的角度而言">从学者研究强度的角度而言</h3><p>每年也都有几篇 AL 相关的博士论文。也仍有一些课题组将 AL 作为研究重点之一。详见我们的 <a href="https://github.com/SupeRuier/awesome-active-learning">AL 资料库</a>。</p><h2 id="局限性-质疑">局限性/质疑</h2><p>我曾写过一个相关深度主动学习局限性相关论文的（见<a href="/paper-reading/deep-AL-criticism/" title="阅读笔记">阅读笔记</a>）。此外在 <code>awesome-active-learning</code> 的仓库中也有进行一些更新，详见<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/subfields/deep_AL.md">此链接</a>。</p><p>目前来说，对于现有主动学习工作/框架的质疑主要集中于以下几点：</p><ol><li>表现上（是否可以在有限样本下获得最大程度提升）：<ol><li>在用少量标记样本的前提下，表现远差于基于半监督学习和自监督学习的方法（不论用什么策略）。</li><li>如果与基于半监督学习和自监督学习的方法结合使用主动学习，AL 的提升不明显。</li></ol></li><li>可靠性上（使用可以使选用的策略优于其他策略）：<ol><li>当前许多工作提出的方法的可信性有限，不同的文章中相同的策略有时会给出不同的结果。没有一些约定俗成的 benchmark 来对比不同文章的策略。这个可能来源于不同的 AL 的设定（不同 AL_batchsize 或者重复次数随机种子可能会影响最终表现）。</li><li>当前对于主动学习策略的理解有限，同一个策略在不同的设定下可以有不同的表现，当前缺乏不同场景下哪种策略更适用的认识。</li><li>在一些场景下，主动学习甚至表现差于随机选取。</li></ol></li><li>实际使用上（是否可以顺利地部署）：<ol><li>由于主动学习实际使用中只有一次使用机会，那么如何保障其至少不差？（可靠性相关）</li><li>主动学习的标注流程与实际的标注条件或许存在冲突（串行并行）。</li></ol></li></ol><h1>我们是否还需要 AL？（以问题为导向）</h1><p>从实际的角度来看判断一个技术是否还有用，在以问题为导向的思路下，或许可以从以下几个角度思考：</p><ol><li>该技术可以用来解决的问题是否还存在？是否发生变化？</li><li>是否有其他的技术完美解决这个问题？</li><li>该技术的表现是否达到可用标准？</li></ol><h2 id="问题是否还存在？是否发生变化？">问题是否还存在？是否发生变化？</h2><p>“针对任务构建模型时标注成本昂贵的”问题依旧存在，但或许有了一些变化。</p><ol><li>标记需要付出成本的前提依旧存在。<ul><li>标注的定义更加广义，人工之外可能还有机器，亦或一些模拟实验。</li><li>随着一些众包平台的发展，或许一些简单的人力标注成本有所降低。</li></ul></li><li>监督学习的场景下，训练“特定任务”上的良好模型仍需要相对多的标记样本。<ul><li>但是纯监督学习的应用场景或许越来越少（实际使用中或许越来越局限）。</li></ul></li></ol><h2 id="其他解决方式的是否比-AL-好？">其他解决方式的是否比 AL 好？</h2><p>总的来说，主动学习期望以少量标记样本获得较好表现，当前有着以下一些方法同样面对这个场景，区别在于他们并没有着重于样本评估选取。</p><ol><li>半监督学习，同时利用标记以及未标记样本，在少样本下表现较好（于少样本监督学习）。</li><li>自监督学习，利用未标记样本和辅助任务提取标准，在使用少量标记样本 fine-tune，复杂任务上表现较好（于少样本监督学习）。</li><li>类迁移学习（预先存在一些知识积累）：<ol><li>迁移学习：有一些目标领域标记样本，通常表现好于仅在目标领域少量样本监督学习。</li><li>小样本学习：通常标记数目极少，several-shots，表现好于仅使用小样本监督学习。</li></ol></li></ol><p>这些方法通常都好于仅使用少量样本的监督学习，因为其或多或少都用到了标记样本之外的更多信息（好于单纯仅仅使用 AL）。可以说这些方法或多或少的解决了小样本下低标注成本的学习问题。</p><h2 id="AL-表现上是否达到可用标准？">AL 表现上是否达到可用标准？</h2><p>“可用标准”或许难以定义，但是考虑到其他方法的优良表现，可以认为在很多情况下，简单的仅在监督学习中使用主动学习是不能满足需求的，即不可用。</p><p>但“其他解决方式结合 AL 的重要样本选取”相对于“仅使用其他解决方式”而言，很多时候是可以带来表现提升的（表现更好通常就意味着更节省成本。）</p><ul><li>例如一些半监督学习/自监督学习/数据增强 + AL。</li><li>例如域迁移/预训练模型 + AL。</li></ul><p>所以，与各种先进范式结合的 AL 选取是可以达到使用标准的，即可用。但需要注意的是 AL 于其它范式的结合带来的提升并不能保证很大，同时在训练上可能也会带来负担（多次训练）。</p><h2 id="我们是否还需要-AL？">我们是否还需要 AL？</h2><ol><li>如果单样本标注成本极高<ul><li>那么哪怕极少量的标记数降低都可以带来可观的成本节约。</li><li>这些情况往往在科学研究，医疗分析等强依赖专家或者模拟实验中出现。</li><li>这种情况我们需要 AL。</li></ul></li><li>如果单样本标注成本有限。<ul><li>那么需要极大量的标记数目减少才可以节约成本。</li><li>这种情况在很多常见的任务中都会出现，成本或有不同，但是应该还是在一个数量级。</li><li>这种情况非 AL 或许已经可以带来极大的成本节约。</li><li>如果预算其极有限，那么或许我们进一步还需要 AL。</li></ul></li></ol><h1>个人看法</h1><p>如果还想在 AL 领域继续深入研究：</p><ol><li>使用时需要与先进范式结合及对比，而不是简单的使用随机选取监督学习作为基线。</li><li>目前预训练模型取得了长足的进展，其往具体任务上的迁移或许是一个较好的方向。个人认为 GPT-3 这种大模型以及将来可能出现的基于大量数据的“数据预收集预处理”知识库才是所谓 web3.0 的真正路径。</li><li>需要找昂贵标记成本的实际运用，这是 AL 最有实际价值的地方。<ol><li>这个可以指单次标注十分耗费金钱</li><li>也可以指单次获得标注十分耗时</li><li>也可以指其他不可避免的困难</li></ol></li><li>AL 实际使用中有着一些阻碍，可能仍需要进一步研究。<ul><li>选取样本的依据及合理性，包含一些理论研究</li><li>不同数据分布条件下的考虑</li><li>传统 AL 流程的复杂度和易用性</li><li>其他种种可以见我们的 <a href="https://github.com/SupeRuier/awesome-active-learning#5-practical-considerations---%E8%BF%90%E7%94%A8-al-%E6%97%B6%E7%9A%84%E8%80%83%E8%99%91">AAL 仓库</a></li></ul></li></ol>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;主动学习发展已经约 30 年，作为领域里面的无名小卒，自己也对这个方向有大概四五年的了解。
近些年发现本领域的文章以灌水居多，真正提出问题和解决问题的少之又少（虽然绝大多数领域都是这样）。
目前有一些人对 AL 的实用性和表现提出了质疑，并且也收获了一些认可。
那么主动学习领域到底会何去何从？
本文我会整理总结一下自己的看法，或许有一些观点缺乏证据支持，若日后需要深入，则会补上。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="active-learning" scheme="https://blog.superui.cc/tags/active-learning/"/>
    
    <category term="thinking" scheme="https://blog.superui.cc/tags/thinking/"/>
    
  </entry>
  
  <entry>
    <title>Spiking Neural Network</title>
    <link href="https://blog.superui.cc/machine-learning/spiking-neural-network/"/>
    <id>https://blog.superui.cc/machine-learning/spiking-neural-network/</id>
    <published>2023-01-29T08:30:00.000Z</published>
    <updated>2023-01-29T08:30:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>此处记录对于 Spiking Neural Network（脉冲神经网络）的学习。SNN 号称是 BP 网络之后的第三代神经网络，名头很响，但好像并没有看到太多应用。这里不求甚解，只希望把最基本的与 ANN 的对应关系简要了解。</p><span id="more"></span><h1>Spiking Neural Network 脉冲神经网络</h1><p>总的来说 SNN 与传统的 ANN 比较相似，不同点主要在于以下几个地方：</p><ol><li>信息载体使用脉冲而不是浮点数。</li><li>神经元使用类膜电压变化来产生脉冲而不是乘加运算。</li><li>主要使用突触可塑性而不是仅用 BP。</li></ol><h2 id="神经元基本运算">神经元基本运算</h2><p>神经元由 ANN 中处理浮点数转化为 SNN 这里的处理脉冲信号。</p><div style="width:70%;margin:auto"><img src="/machine-learning/spiking-neural-network/neural.jpg" class="" title="神经元"></div><p>多受到刺激超过阈值时，生成新脉冲，并进入一段时间的不应期。</p><div style="width:70%;margin:auto"><img src="/machine-learning/spiking-neural-network/neural_process.jpg" class="" title="脉冲信号的处理"></div><h2 id="模型如何训练">模型如何训练</h2><h3 id="脉冲时间的可塑性">脉冲时间的可塑性</h3><p>应用在脉冲神经网络的最常见的学习方法是依赖脉冲时间的可塑性(Spiking Time Dependency Plastic)，以下简称STDP。</p><p>突触的权重改变量依赖输入输出脉冲时间间隔。如果存在因果性，则加大权重：</p><ol><li>如前神经元发出一个脉冲，后神经元紧接着产生了一个脉冲，前后脉冲时间差极小且为正值，其中有较强的因果性，其突触权重应该大大增加。</li><li>当前神经元发出一个脉冲，过了很久后神经元也产生了一个脉冲，前后脉冲时间差极大，则其中因果关系不明显，突触权重不变化。</li><li>当后神经元发出了一个脉冲，其处于不应期，这时前神经元输入了一个脉冲，脉冲时间差为负，其非因果，突触权重应大大减小。</li></ol><p>在STDP中没有涉及到任何标签、误差信息，这是一种非监督学习。</p><h3 id="ANN-到-SNN-的转换">ANN 到 SNN 的转换</h3><p>在输入上，要将输入信号编码为脉冲序列。所有神经元用相应的 spiking neuron 替换，所得权重要进行量化。</p><h3 id="BP-算法">BP 算法</h3><p>预估网络中得变化参数得梯度从而进行反向传播。离散的输出不可导的，但是我们可以创造一个函数去逼近它，只要符号是对的，我们的梯度下降的方向就是对的，尽管不一定能最速下降，但好歹也能下降。这样得算法虽然还存在争论但它确实在某种程度上降低了SNN得训练复杂度，这样得算法比如有 spikeprop, Slayer 等等。</p><h1>Reference</h1><ul><li><a href="https://zhuanlan.zhihu.com/p/260539428">Spiking Neural Network简述 - Yannan的文章 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/416187474">脉冲神经网络 (Spiking Neural Network) 解读 (一) - 科技猛兽的文章 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/485170683">脉冲神经网络 Spiking Neural Network - 张丰麒的文章 - 知乎</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;此处记录对于 Spiking Neural Network（脉冲神经网络）的学习。
SNN 号称是 BP 网络之后的第三代神经网络，名头很响，但好像并没有看到太多应用。
这里不求甚解，只希望把最基本的与 ANN 的对应关系简要了解。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="neural-network" scheme="https://blog.superui.cc/tags/neural-network/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="spiking-neural-network" scheme="https://blog.superui.cc/tags/spiking-neural-network/"/>
    
  </entry>
  
  <entry>
    <title>Boltzmann Machine</title>
    <link href="https://blog.superui.cc/machine-learning/boltzmann-machine/"/>
    <id>https://blog.superui.cc/machine-learning/boltzmann-machine/</id>
    <published>2023-01-28T10:00:00.000Z</published>
    <updated>2023-01-28T10:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>此处记录对于 Boltzmann Machine，即玻尔兹曼机的学习。在互联网上并没有找到太多很好的资料，看了半天仍旧云里雾里，这里还是以我自己个人了解模型的思路来进行学习。以目前的了解来看，这一系列模型用得并不太多，只是偶尔被拉出来提到，所以还是得看一下。</p><span id="more"></span><h1>Restricted Boltzmann Machine 受限玻尔兹曼机</h1><h2 id="1-模型长什么样子">1. 模型长什么样子</h2><p>首先介绍玻尔兹曼机（BM），如图所示。显而易见这是一个全连接的图，v 代表 visible 即可见节点，h 代表 hidden 即隐藏节点。</p><div style="width:25%;margin:auto"><img src="/machine-learning/boltzmann-machine/bm.png" class="" title="玻尔兹曼机"></div><p>而对于受限玻尔兹曼机（RBM）而言，其包含可见层 V 和隐藏层 H，层内则不存在任何连接，即为一个二分图，如下所示。</p><div style="width:70%;margin:auto"><img src="/machine-learning/boltzmann-machine/rbm.jpg" class="" title="受限玻尔兹曼机"></div><p>由于层内不存在连接，则<strong>当给定可见层神经元的状态时，各隐藏层神经元的激活条件独立；反之当给定隐藏层神经元的状态是，可见层神经元的激活也条件独立</strong>。</p><h2 id="2-模型如何做预测">2. 模型如何做预测</h2><p>在了解模型结构之后，我们需要知道假设我们已经有训练好的模型之后，如何进行预测。换句话说就是预测需要用到模型中的那些部分以及需要进行什么步骤。</p><p>一般来说，我们做预测是想获得隐藏层（hidden）处的取值。RBM中的每个神经元只可能是二元状态0或1中的一种。我们最关心的因子是隐藏层或输入层地神经元位于状态1（激活）的概率。给定一个输入向量 v，可以得出单个隐藏神经元 j 激活的概率：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mo>∣</mo><mi mathvariant="bold">v</mi><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo fence="true">(</mo><mo>−</mo><mrow><mo fence="true">(</mo><msub><mi>b</mi><mi>j</mi></msub><mo>+</mo><msub><mi>W</mi><mi>j</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></msup></mrow></mfrac><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><msub><mi>b</mi><mi>j</mi></msub><mo>+</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>v</mi><mi>i</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">p\left(h_j=1 \mid \mathbf{v}\right)=\frac{1}{1+e^{\left(-\left(b_j+W_j v_i\right)\right)}}=\sigma\left(b_j+\sum_i v_i w_{i j}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1248em;vertical-align:-0.8034em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2799em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8301em;"><span style="top:-3.0051em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight">−</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8034em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0277em;vertical-align:-1.2777em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>同样的，给定一个隐藏层向量 j，可以得出单个输入神经元 i 激活的概率：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo>∣</mo><mi mathvariant="bold">h</mi><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo fence="true">(</mo><mo>−</mo><mrow><mo fence="true">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><msub><mi>W</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></msup></mrow></mfrac><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>h</mi><mi>j</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">p\left(v_i=1 \mid \mathbf{h}\right)=\frac{1}{1+e^{\left(-\left(a_i+W_i h_j\right)\right)}}=\sigma\left(a_i+\sum_j h_j w_{i j}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">h</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1248em;vertical-align:-0.8034em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2799em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8301em;"><span style="top:-3.0051em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight">−</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8034em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1638em;vertical-align:-1.4138em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>预先不知道的变量（或许通常为隐变量），即可作为模型的输出。</p><h2 id="3-模型如何训练">3. 模型如何训练</h2><p>从模型的预测方式可以看出，在我们知道偏置向量和权值矩阵之后即可使用模型进行预测。RBM 是一种基于能量的模型，它尝试最小化一个预先设定好的能量函数，在优化的过程中得到相关的参数。首先这个能量定义为（至于为什么这样定义在此不做讨论）：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>a</mi><mi>i</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>b</mi><mi>j</mi></msub><msub><mi>h</mi><mi>j</mi></msub><mo>−</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E(\mathbf{v}, \mathbf{h})=-\sum_i a_i v_i-\sum_j b_j h_j-\sum_{i, j} v_i h_j w_{i j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>然后可得其联合概率分布：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>Z</mi></mfrac><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>Z</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi></mrow></munder><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}p(\mathbf{v}, \mathbf{h}) &amp; =\frac{1}{Z} e^{-E(\mathbf{v}, \mathbf{h})} \\Z &amp; =\sum_{\mathbf{v}, \mathbf{h}} e^{-E(\mathbf{v}, \mathbf{h})}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.0957em;vertical-align:-2.2978em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7978em;"><span style="top:-4.7978em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">h</span><span class="mclose">)</span></span></span><span style="top:-2.7618em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2978em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7978em;"><span style="top:-4.7978em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="mopen mtight">(</span><span class="mord mathbf mtight" style="margin-right:0.01597em;">v</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">h</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.7618em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">v</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">h</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="mopen mtight">(</span><span class="mord mathbf mtight" style="margin-right:0.01597em;">v</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">h</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2978em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中 Z 为配分函数（partition function），用来做归一化。这个分布即为<strong>玻尔兹曼分布</strong>。RBM 的训练包括为给定的输入值寻找使能量达到最小值的参数。能量最小则联合分布最大，即当下状态的发生概率最大。</p><blockquote><p>利用基于能量的模型的原因是这样的，对于一个给定的数据集，如果不知道其潜在的分布形式，那是非常难学习的，似然函数都写不出来。比如如果知道是高斯分布或者多项分布，那可以用最大化似然函数来学出需要学习的对应参数，但是如果分布的可能形式都不知道，这个方法就行不通。而统计力学的结论表明，任何概率分布都可以转变成基于能量的模型，所以利用基于能量的模型的这个形式，是一种学习概率分布的通法。</p></blockquote><p>对于实际问题，我们可得观测数据的概率分布，即联合分布的一个边缘分布，即：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>P</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mi>h</mi></munder><msub><mi>P</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><msub><mi>Z</mi><mi>θ</mi></msub></mfrac><munder><mo>∑</mo><mi>h</mi></munder><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>E</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">P_\theta(v)=\sum_h P_\theta(v, h)=\frac{1}{Z_\theta} \sum_h e^{-E_\theta(v, h)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3521em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.6236em;vertical-align:-1.3021em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">h</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>再使用最大似然估计（对数形式），在对应的样本集 S 上来求得对应的参数值。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ln</mi><mo>⁡</mo><msub><mi>L</mi><mrow><mi>θ</mi><mo separator="true">,</mo><mi>S</mi></mrow></msub><mo>=</mo><mi>ln</mi><mo>⁡</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><mi>P</mi><mrow><mo fence="true">(</mo><msup><mi>v</mi><mi>i</mi></msup><mo fence="true">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><mi>ln</mi><mo>⁡</mo><mi>P</mi><mrow><mo fence="true">(</mo><msup><mi>v</mi><mi>i</mi></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ln L_{\theta, S}=\ln \prod_{i=1}^{n_s} P\left(v^i\right)=\sum_{i=1}^{n_s} \ln P\left(v^i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9402em;vertical-align:-1.2777em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6625em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9402em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6625em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p><p>如何来计算梯度（以优化似然）呢？一般使用迭代的方式逼近。目前在用的方法是吉布斯采样（得到原始向量重建值）+ 对比散度（使用重建值计算梯度）+ 梯度上升（更新梯度）的方法。（具体细节在此不赘述，日后若有需要再深入学习。）</p><h1>Deep Boltzmann Machine 和 Deep Belief Net</h1><p>深度信念网络（DBN）也是经常听到的一个名词，其结构和深度玻尔兹曼机（DBM）有一些相似。此处仅做一个了解，日后若有需要再深入学习。</p><h2 id="模型长什么样子">模型长什么样子</h2><div style="width:70%;margin:auto"><img src="/machine-learning/boltzmann-machine/dbn.jpeg" class="" title="深度信念网络"></div><br><p>简单来说第一层都是一样的，即为一层 RBM。DBN 的后面几层为前向网络，而 DBM 的后面几层仍为 RBM。整体来看，DBN是有向图（除了最上层的RBM是无向图），是巧妙结合了有向图和无向图的生成模型；DBM每相邻的两层都是RBM，是完全的无向图。</p><h1>Reference</h1><ul><li><a href="https://zhuanlan.zhihu.com/p/22794772">受限玻尔兹曼机（RBM）学习笔记 - 祁昆仑的文章 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/38024014">深度学习邂逅物理：受限玻尔兹曼机原理解析</a></li><li><a href="https://zh.wikipedia.org/wiki/%E7%8E%BB%E5%B0%94%E5%85%B9%E6%9B%BC%E6%9C%BA">玻尔兹曼机</a></li><li><a href="https://zhuanlan.zhihu.com/p/34201655">深度学习基础：Boltzmann Machines - 羽刻的文章 - 知乎</a></li><li><a href="https://www.zhihu.com/question/35396583/answer/1562794617">深度学习中，深度波尔兹曼机（DBM）和深度置信网络（DBN）都有哪些区别？ - gwave的回答 - 知乎</a></li><li><a href="https://cloud.tencent.com/developer/news/240089">深度置信网络＆深度玻尔兹曼机</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;此处记录对于 Boltzmann Machine，即玻尔兹曼机的学习。
在互联网上并没有找到太多很好的资料，看了半天仍旧云里雾里，这里还是以我自己个人了解模型的思路来进行学习。
以目前的了解来看，这一系列模型用得并不太多，只是偶尔被拉出来提到，所以还是得看一下。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="neural-network" scheme="https://blog.superui.cc/tags/neural-network/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="boltzmann-machine" scheme="https://blog.superui.cc/tags/boltzmann-machine/"/>
    
    <category term="deep-belief-net" scheme="https://blog.superui.cc/tags/deep-belief-net/"/>
    
  </entry>
  
  <entry>
    <title>Forward Forward Algorithm</title>
    <link href="https://blog.superui.cc/machine-learning/forward-forward/"/>
    <id>https://blog.superui.cc/machine-learning/forward-forward/</id>
    <published>2023-01-12T08:40:00.000Z</published>
    <updated>2023-01-12T08:40:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>Hinton 在 NeurIPS 2022 提出了 Forward Forward Algorithm<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[The Forward-Forward Algorithm: Some Preliminary Investigations](https://www.cs.toronto.edu/~hinton/FFA13.pdf)">[1]</span></a></sup>，好像还挺有意思，在此做一个学习。</p><span id="more"></span><h2 id="说在最前">说在最前</h2><p>老爷子的原文的思考角度仍然是以问题出发，先从 back-propagation 所拥有的问题讲起，引出更“人脑式”的 Forward Forward Algorithm（FFA）。本文不在意算法的具体表现怎样，也不在意具体如何代码实现，仅对文章思想作一个了解。本文写成于略读了原文，以及一些知乎讨论之后，或许有一些不正确的记载，敬请指正。</p><h2 id="主要思想">主要思想</h2><h3 id="单层的模式">单层的模式</h3><p>不需要通过最后一层将误差一层层反传回来调整权值（即不用 back-propagation），而是在每一层使用正样本（第一次 forward）和负样本（第二次 forward）来对权重进行调整。两次前想的操作完全相同，除了使用不同的数据和相反的目标。相似于反向传播中存在的损失函数 loss，FFA 中的目标函数为 goodness（大佬命名的确通俗），如下所示。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mtext> positive </mtext><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>y</mi><mi>j</mi><mn>2</mn></msubsup><mo>−</mo><mi>θ</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\text { positive })=\sigma\left(\sum_j y_j^2-\theta\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord"> positive </span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1638em;vertical-align:-1.4138em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> 是一个阈值，而不是参数/权重。正样本需要调节权重使 goodness 增加，负样本则相反。具体来说权重如何更新呢？我暂时没有找到相关表述，或许还是使用梯度下降（感觉很多时候梯度下降和反向传播混为一谈了）。</p><p>下面是一些相关的原文表述：</p><blockquote><p>The idea is to replace the forward and backward passes of backpropagation by two forward passes that operate in exactly the same way as each other, but on different data and with opposite objectives.The positive pass operates on real data and adjusts the weights to increase the goodness in every hidden layer.The negative pass operates on “negative data” and adjusts the weights to decrease the goodness in every hidden layer.This paper explores two different measures of goodness – the sum of the squared neural activities and the negative sum of the squared activities, but many other measures are possible.</p><p>The aim of the learning is to make the goodness be well above some threshold value for real data and well below that value for negative data.</p></blockquote><p>个人的理解即为使得在每一层中正样本更容易激活，而负样本更难以激活（即 activity 更小）。</p><h3 id="多层的模式">多层的模式</h3><p>在多层网络中，由于上一层已经使得正负样本模长产生区别，所以在输入下一层之前，需要对隐层向量长度进行标准化。</p><p>下面是一些相关的原文表述：</p><blockquote><p>But if the activities of the first hidden layer are then used as input to the second hidden layer, it is trivial to distinguish positive from negative data by simply using the length of activity vector in the first hidden layer.There is no need to learn any new features.To prevent this, FF normalizes the length of the hidden vector before using it as input to the next layer.This removes all of the information that was used to determine the goodness in the first hidden layer and forces the next hidden layer to <strong>use information in the relative activities of the neurons</strong> in the first hidden layer.These relative activities are unaffected by the layer-normalization.To put it another way, the activity vector in the first hidden layer has a length and an orientation.The length is used to define the goodness for that layer and <strong>only the orientation is passed to the next layer</strong>.</p></blockquote><h2 id="讨论">讨论</h2><p>把最终的 loss 反传取消，换成了每一层的限制，可能是这个文章最重要的 intuition。但是好像已经有很多人做过类似的尝试了，比如马毅教授 的 NeurIPS 2020 中稿文章 MCR2<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[如何评价 马毅教授 的 NeurIPS 2020 中稿文章 MCR2 及 自称弄明白深度学习了？ - 刘斯坦的回答 - 知乎](https://www.zhihu.com/question/423767542/answer/1893558922)">[3]</span></a></sup>。（总体来说是我不太熟悉的训练方式，还是有一点意思的。）</p><h2 id="Reference">Reference</h2><section class="footnotes">[object Object]<div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cs.toronto.edu/~hinton/FFA13.pdf">The Forward-Forward Algorithm: Some Preliminary Investigations</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.zhihu.com/question/570153849/answer/2787026263">如何评价Hinton提出的Forward-Forward方法？ - 刘斯坦的回答 - 知乎</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.zhihu.com/question/423767542/answer/1893558922">如何评价 马毅教授 的 NeurIPS 2020 中稿文章 MCR2 及 自称弄明白深度学习了？ - 刘斯坦的回答 - 知乎</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;Hinton 在 NeurIPS 2022 提出了 Forward Forward Algorithm&lt;sup id=&quot;fnref:1&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;&lt;span class=&quot;hint--top hint--rounded&quot; aria-label=&quot;[The Forward-Forward Algorithm: Some Preliminary Investigations](https://www.cs.toronto.edu/~hinton/FFA13.pdf)&quot;&gt;[1]&lt;/span&gt;&lt;/a&gt;&lt;/sup&gt;，好像还挺有意思，在此做一个学习。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="neural-network" scheme="https://blog.superui.cc/tags/neural-network/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="deep-learning" scheme="https://blog.superui.cc/tags/deep-learning/"/>
    
  </entry>
  
  <entry>
    <title>超级 Rui 的 2022 年</title>
    <link href="https://blog.superui.cc/life/2022-year-report/"/>
    <id>https://blog.superui.cc/life/2022-year-report/</id>
    <published>2023-01-02T18:00:00.000Z</published>
    <updated>2023-01-02T18:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>写在 2023 年年初，对 2022 的回顾。</p><span id="more"></span><h1>写在最最前</h1><p>第一次写年终总结，契机可能是看到了 github 上大家的年终总结，大家都在认真的描述自己或好或坏的一年，让自己有了一丝感动，原来大家在那么用力的过好自己的生活。好像博客搭建之初就是为了写一些自己的想法，但是这些年下来逐渐变成了一个笔记本，脱离了自己的初衷。在新年伊始，觉得还是应该好好的回顾一下过去的一年，这也是很不平凡的一年。</p><p>不太记得我的 2022 是以什么姿态展开的了，找不到任何形式的记录，不论是照片还是朋友圈，甚至都找不到聊天记录。隐约中好像是在五月天的线上简单的跨了一个年。那时候好像疫情已经被控制住，除了健康码和行程码之外，除了没有什么大型文娱活动之外，一切还算比较正常。但一整年的疫情变化让人诧异，奥密克戎的肆虐，攻陷了香港，也在内地开始传播，国内政府的处理手段过于让人惊异。年初的西安孕妇无法就医流产，后来的上海全城物资紧缺（不能说原因下的人们有心无力），再到每一个城市的说封就封，基层权力的无休止放大和黑暗化，自己对社会的信心开始动摇。年末迎来了预期之内的解封，重获了久违的自由，但好像明白了自己就是一粒沙，在棋手的棋盘上微不足道。</p><p>读博已经过去了四年多，学业也如期进入延期毕业，虽然在入学时就已经预期了延期，但是仍旧十分忐忑。第四年结束时，老板的批评对自己有了重重的一击，接着就是一段时间的消沉，不过后来事情好像缓缓的恢复了正轨。此外也搬回了家住，重启了和父母的长期相处，感觉依旧在磨合。总之今年一整年感觉都在不断地认识自己，或许有了一些成果，但是总体仍旧在了解自己的过程中。久违的情感线的确有了一些新进展，算是给 2022 年画上了一个比较好的句号。</p><h1>具体来说</h1><h2 id="反反复复的疫情">反反复复的疫情</h2><p>疫情对自己的心态有着很大的影响，新冠在 2022 年的一波三折，让自己对整个社会产生了极大的怀疑。这一年经历的事情或许是一种“中国大家长”式的“牺牲自由的保护”，或许无可厚非，虽然喜爱自由的我并不喜爱这些管控措施，但是不得不说他们的确在一定时间段内对绝大多数人都起到了超越带来的“不方便”的保护。但可怕的是，权力的不断蔓延和失控，层层加码的防控，西安流产的孕妇，京东拼死送不进上海的物资，“爱丁堡”的戏虐，北京的居委会“软肋”，让我大受震撼和大失所望。从上海那一波过后，自己渐渐觉得开完会之后是一定会放开的，事实也的确是这样。但是放开之后也惊讶于其“仓促”，好像这么多年在“骗钱的”连花清瘟之外并没有什么长足的准备，一波感冒发烧的高潮前，人们买不到药，让人惊讶。</p><p>自己也阳了，虽说一直觉得总是会阳的不是什么大事，但是真的阳的时候，觉得还是很感慨的，好像自己在新冠纪元下总算真实的参与了一波。身边的老师朋友的防护也十分的注重， wzy 更是全副武装拒人千里之外，让人感到害怕。爸妈也都得了，一个患病之初惊讶的问我“你怎么没买连花清瘟？”，一个在康复之后就开始喝酒，实在是让人不能放心。自己也没有高烧，吃了准备的布洛芬，低烧加没精神加咳嗽，体验卡就到期了。总之，做了三百多次核酸的深圳一年结束了。</p><h2 id="学业和工作">学业和工作</h2><p>其实一直不想谈论自己的学业，一是觉得自己太菜了，二是觉得可能有点逃避，三是觉得徒增焦虑。但是好像不谈的话事情也不会变得更好，不如仔细回想一下。</p><p>上半年对社会的失望和失去信心让我产生了对“未来工作”的焦虑，毕竟已经第四年，如果正常毕业的话下半年就该工作了。那段时间伴随着各大厂的裁员，大家都人心惶惶，自己虽然还有“毕业”这件事作为一道屏障，还是忍不住担心了起来。总之到处“取经”加上自己“分析”，好像有了一套自己的看法，结论并不重要，但是中间的几条推论或许值得作为之后的指导方针：一是要去核心岗位，业务才是核心竞争力；二是要去你的竞争力可以累积，以达到一加一等于二的位置。</p><p>其八月底的时候在办延期手续，期间和老板沟通了好几次，讨论了进度和补助等等的东西。印象最深刻的是 9.1 号的那个晚上，和老板通了一通电话，他惊讶于“你怎么还在想这些东西？”“你现在这些进度将来怎么吃这碗饭？”“你的态度是不是端正？”那天是我的生日，但是在几天的压抑下心情并不好，老板这几盆冷水实在是透心凉。那次谈话让我重新的又一次认识到了自己的“幼稚”，好像总是活在自己的世界中，总是仅仅从自己的角度考虑问题。记得他说“别说科研了，也别说其他什么事物，哪怕是你和女朋友相处，你也得想想对方要什么而不是你认为对方要什么。”在科研上的体现就是是否能做出好工作，在人际的体现就是你的“情商”是否高。那通电话我最大的收获就是：不能总是“我觉得”，而是“大家觉得是什么样”或者“应该是什么样”或者“事实是什么样”。此外，前几年提出的“信马由缰”又在脑海中被 recall 了，当时的确觉得应该痛改前非（端正一下态度），毕竟人的精力的确是有限的。</p><p>那通谈话过后，的确进入了一段时间的充实期，不过或许主要原因还是那段时间主要是改论文，目标明确，在不久之后第一篇文章终于也被接收，也拥有了一篇 Trans，虽然是一般的 Trans。在那之后又回到了“问题”“方法”“实验”的这一循环中，要在一个场景下设计新策略，或许有些撞大运的样子，目标的明确程度没有那么高，那种高强度的充实期又向平常回归了一些。有意思的是十二月的某一天，在一个新思路下策略跑出了无比显著的优良表现，尝试了几种不同的组合都能说明有效，于是得意洋洋的在多个数据集上跑起了实验，并且编辑好了给老板的邮件。在发送之前，保险性的又检查了一遍代码，发现代码中自己不小心“作弊”多选了样本，显著的好结果都是假的，心又跌到谷低，洋洋得意瞬间消失，编辑好的邮件也删除掉了。科研路上的常规操作罢了，此后又恢复了策略的常规设计当中。</p><p>此外还有一件有趣的事是，之前接受的期刊邀请我当审稿人，第一次以自己的名义审稿（而不是老板分配任务）。于是乎长篇大论写出了自己的审稿意见，给了一个 minor revision。最后看到总的审稿结果是拒稿，另外两位审稿人简单一笔带过，让我显得认真又滑稽。不管怎么样，科研经验又增加了一些。</p><h2 id="与家人">与家人</h2><p>第四年之后就不能住学校了，于是搬回了一站地铁之外的家里。我其实一直抵触回家住，因为实在是和害怕父母长期相处，因为之前寒暑假总是会爆发冲突，但是这次好像还好，总的来说还算平静。搬回家没多久就是自己的生日，和老板通话的那个晚上。通话的时候我还没回家，回家的路上自己想了很多，包括与父母的关系。我总是抱怨爸爸妈妈，嫌弃他们给的不够好，观念老旧，不相信科学什么的，所以平时的沟通好像总是带有一种“教育”他们的感觉。那天回家，爸爸妈妈给我买了蛋糕，我自己几乎从不过生日，也很多年没吃过蛋糕。吃蛋糕的时候爸爸妈妈也和我聊了这些年的规划，包括他们即将退休什么的，他们有什么打算，还有表示对我将来选择的支持。那一刻我深感羞愧，我总是在抱怨“我觉得”他们做的不够好，但是他们其实已经给我了很多“他们觉得”足够好的事物，虽然我平时对他们很蛮横，但是他们的未来规划里处处有我处处考虑我，让我深深地感受到了自己的自私。晚上睡觉之后，给他们编辑了一段微信，表示了谢谢他们，我爱他们。</p><p>搬回家也带回来了 Luna。来福和豆豆两条狗对这只猫十分感兴趣，然而猫却很自闭胆小，所以时刻就会出现追逐逃窜逼到墙角这种戏码。为了避免纷争，买了一个栅栏隔开了猫狗。来福是一条大大咧咧的狗，对 Luna 充满了好奇，我甚至怀疑他喜欢我们家 Luna，不过他总在栅栏打开的时候跑进来偷吃猫粮，坏狗一只。豆豆是一只很神经敏感的小母狗，脾气暴躁总觉得大家对他有敌意，对于 Luna 总是会凶狠的叫和追逐，但是她其实很胆小，追逐也是在瓷砖上原地打滑，等待 Luna 跑远才追上去。在来福不在身边的时候，豆豆就很怂，并不敢对 Luna 发起什么攻势。Luna 也是一只怂猫，但是也有着猫的好奇，所以总是跨过栏杆出来玩，尤其是我在外面的时候。她也发现了豆豆的虚张声势，逐渐胆子大了，甚至有时两狗一猫可以很近的对峙，十分有趣。不知道新一年，这三个狗东西能不能和睦相处。</p><div style="width:100%; margin:auto"><img src="/life/2022-year-report/dog-cat.jpg" class=""></div><h2 id="与朋友">与朋友</h2><p>感觉这一年和朋友相处多了很多。</p><p>最好的朋友 zy 毕业跑去杭州工作了，本来最最开始觉得这个人也会一直在深圳一直在身边，结果最终还是到了另一个城市。人生中第一次和一个朋友有这么久的长时间生活重叠，从深圳到英国再回来有五年了。好像什么都聊，除了没什么太多共同爱好之外，真的是很交心的朋友，科研学习上也给予了自己很大帮助。走了之后好像有一种“依赖摆脱”的强迫独立感，interesting。不过后来还是去杭州找了一次 zy，感觉小日子过得还不错，也就放心了，希望新一年他能找到他的合适的伴侣。</p><p>今年朋友里最大的事情好像是 srx 结婚，第一次以好友的身份参加婚礼。从初中开始的好朋友，结束十年的爱情长跑结婚了，看着还挺感动，留下了一两滴喜悦的泪水。拍了好多照片帮了好多忙，全场最佳男性 Maid of Honor 好吧哈哈哈。</p><p>好像很多很好的朋友这年也都结了婚，甚至有的还有了娃，让人惊讶。但是有时候距离遥远的话，错过了 pyq 就会一无所知（没看到 hy 的朋友圈），成年人好像有一种不互相打扰的默契（更愿意相信他们不是因为关系不亲近而没想私发我）。朋友们还是要多联系一下，相信他们不会觉得我打扰他们。同时少找 hy 看病，多聊聊非医患关系哈哈哈哈。</p><p>此外的话，高中同学在深圳凑齐了四个人，真不错。zj 又重新去读书了，有目标感的读书真不错。还有实验室的同学们也真好，喜欢他们。还有参加了几次社交局，认识了一些玩伴和酒友，令人快乐。希望新一年可以多维护发展积极正面的朋友关系。</p><h2 id="运动健康">运动健康</h2><p>今年总算对运动做了记录，但是仅仅是很潦草的记录。有过一段时间的健康生活，也有了紧接着的懒散。篮球打得越来越少了，懒惰+篮球场遥远或是最大原因。学会了跟着视频做运动，但是好像仅仅是动一动。今年爬了很多山：塘朗山，七娘山，小南山，大雁顶。好像爬山并不是很有趣，可能还是要和好玩的人一起爬才好。</p><div style="width:50%; margin:auto"><img src="/life/2022-year-report/exercise.png" class=""></div><p>身体方面的确是我的正常水平：</p><ul><li>今年做了两三年的年度常规体检</li><li>喜提人生第一次骨折，还是肋骨骨折</li><li>扁桃体发炎好几次（迟早割了这玩意）</li><li>补了牙齿，但是好像又有了龋齿</li><li>胸闷胸痛好几次哈哈以为自己要死了，医生和 hy 说其实没必要那么关注自己的身体</li><li>新冠体验卡，滴！</li></ul><h2 id="金钱与消费">金钱与消费</h2><p>今年最大的改变是没有了收入，只能靠前些年攒的钱过日子，这个现象可能要持续到毕业，当然我还是坚信“毕业之后就会有钱”这种事。</p><p>理财方面这一年就很统一，基金赔了很多、股票赔了很多、美股过山车也赔了很多哈哈哈。不过总体上也都还在自己的心理和客观承受能力范畴之内。我仍旧认为年轻时候多亏亏钱没什么不好的，毕竟我现在也亏不了多少，总比将来有钱了交学费好。（当然话是这么说，有时候看到那个绿油油的数字就会觉得，我有这个钱为啥不去给自己快乐快乐呢？）</p><p>此外消费观今年在逐渐完善。根源好像是买相机的时候，当时咨询过一个二手商家一款旧相机，他跟我说“没必要在这种太老的机子中挑挑拣拣，你值得拥有一些好东西的。”当然这是商家引诱消费的惯用话术，但是的确让我反思了我的消费观，并且意识到“我的确配得上好东西，此外贵的东西的确有它的价值。”那么最重要的东西或许还是搞清自己的需求，常用的东西再贵也不贵。</p><h2 id="摄影">摄影</h2><p>摄影好像是我从初中就拥有的爱好，起源于老爸或许是出于炫耀购买的单反。这么多年来这个爱好贯穿了我的每一年，但是我却没意识到它是一个爱好，也没有把它当成一件很特别的事情。</p><p>手机一直是我这么多年拍照的主力，直到今年我又摸到了当年的那台老单反，忽然意识到虽然我没有用相机，但是摄影已经贯穿了我的生活，抛开作品质量而言已经成为了我生命的一部分。于是我对设备也进行了更新，也提高了拍摄的频率，好像眼里的世界变得更有趣了起来。不，或许是在我眼里一贯是那么有趣，但是我愿意多拍下来一些了。买了我最爱的 GR3，每天在口袋中，留下了很多很值得回忆的瞬间。对摄影的看法也发生了改变，从“记录”转向了“表达”，同样在这个时候，我开始自诩为“摄影师”了。</p><div style="width:100%; margin:auto"><img src="/life/2022-year-report/gr3.jpg" class=""></div><p>今年发了一条 B 站视频，我的第一条视频“洗猫”。想起来之前卖给我相机的那个人，他说他“本来是想立志做一个 up 主的”，最后也没能实现。做视频好像也有一丝意思，以后可以多进行尝试。今年的 Best of 2022 的摄影作品还没有整理出来，之后应该也会做成视频分享出来。</p><h2 id="读书">读书</h2><p>今年看了一些书，不多，但至少还是在读。印象深刻的有以下几本：《乌合之众》，《浪潮之巅》，《罪与罚》。自己读书好像一直都很功利，想着从书中直接获得可以拿来用的东西（结论），所以更偏好一些“工具类”书籍。比如从《乌合之众》中了解到了群体的运作模式，从《浪潮之巅》中了解到了互联网的发展历史，这些都是直接可以和现实社会的事件对应起来的，好读也好用。而《罪与罚》这种小说就难懂了很多，它需要理清繁琐的人物关系，否则难以读明白，更别说读懂。但是这部小说给我留下了很深的印象，或许是因为他通篇都是精神独白，我比较喜欢这种心理活动的描写。此外“自己认为的正义”和“正义”之间的关系，让我想起了老板对我的教诲“不要总是你觉得”，似乎很多事情都是相通的，过于关注自己好像并不是什么好事。</p><p>当然还有一些前一年就开始看的书，现在都没看完，罪过罪过。</p><h2 id="观影和视频">观影和视频</h2><p>相比往年，这一年好像没有看太多电影和剧，或许是因为的确没什么新电影，或许也是因为觉得看的太累。但是的确看了一些令人印象深刻的作品，包括电影、剧、还有一些其他视频作品。</p><p>《爱在三部曲》，的确给到我震撼，一部对话式的作品，让我意识到或许真的能遇到灵魂伴侣，或许真的有人会因为你是你而爱你。巧合式的相遇和剧情推进，过于浪漫温柔。无法抵抗浪漫和温柔。</p><p>《隐入尘烟》，是一部全网下架的片子，也是因为下架我才产生了兴趣拿来看看。这部电影的画面十分的美，色调和构图十分喜爱。至于剧情则有些压抑，主角有一种林冲式的悲剧，底层人民的厄运魔咒似乎无法通过乐观和勤劳逃脱。社会主义下不能这么惨，或许这就是被禁的原因吧。</p><p>《我的三体之章北海传》，是在看艺画开天的《三体》之后才接触了这个作品，基于“我的世界”拍摄。最大的感触是，不通过特效和噱头是可以吸引人的眼球把故事讲漂亮的。当然叫好和叫座或许大多时候都是冲突的。印象最深刻的可能还是北海的那一句“没关系的，都一样”。</p><p>《是，首相》真的是一部有趣的剧。俗话说“半部 YMP 治天下”，让人看到政治的荒诞与幽默。英式英语好像也很好听，汉皮真的很可爱。之后应该会认真学习一下。</p><p>《木鱼水心的水浒讲解》是木鱼水心 2022 年一整年的作品，的确能让人了解水浒的来龙去脉。我一直没有完整读过水浒（惭愧惭愧），算是对其了解甚微。这个系列着实给我补充了很多文学历史以及艺术知识。目前对《水浒》所描绘的那个世界充满了反感，所以看了一半暂停了观看，但是这个系列在我心中已经拥有了很高的评分。</p><h2 id="游戏">游戏</h2><p>好像是今年弃坑了原神，太非太累了，不过好像后面的剧情很不错，可以之后尝试下回来看看。此外还在 w2g 中用模拟器下载了塞尔达，但是好像心境与以前不同了，也很难玩下去，或许需要一段大块时间以及一个舒适的沙发吧。</p><p>断断续续的在玩王者，还是喜欢这种有选手参与感的游戏，可以贯彻我“与人斗其乐无穷”的理念。获得了两次五杀！喜爱上了新英雄，觉得获取了一些没有意义的成就感。</p><h2 id="个人管理">个人管理</h2><p>这一年搭建了一套 Flomo + Notion + Blog 的个人管理流。碎片信息放 Flomo，然后在 Notion 中整理培养，最后发布在 Blog 上。但是实践下来好像并没有像我设计之初预想的那样高效（抛去我懒的因素来说）。</p><p>Blog 成为了我的学习笔记发布中心，还有一些遇到小困难的解决过程记录本。没有宣传出去，有用的东西也很难帮到别人。此外建立之初我好像是想多加入一些我的思考和碎碎念，但是一直也没有实施太多，或许之后还是应该思考一下博客的定位。当然博客主题没那么好看也是我一直踌躇着不进行深度内容改版的原因，或许要先进行外观改版。</p><p>Notion 和 Flomo 的交互使用好像也没有那么顺畅，好像主要是因为我并没有那么愿意写和整理。此外即使有些东西想要认真写，想到最终发布在博客的流程较为繁琐（要用电脑 commit），就又忘记开始了。或许我需要一个动态的博客，还有一个实时的瀑布流动态功能。</p><h2 id="感情">感情</h2><p>因为比较重要所以放在最后写。这一年对于感情的心态有了较大的变化。在 2021 的上一段感情过后，认为现阶段可能并不适合恋爱，原因包括时间精力金钱等方面，但是或许最重要的还是心态。心态上我很怀疑会不会有人真的因为“你是你”而喜欢你，就像《爱在》里面一样。在我心中，这个答案很难说是肯定的，我觉得找到一个契合的灵魂或许是一件不可能的事情。此外虽然后面也谈了一些恋爱，但是好像很难走出第一段恋爱对自己造成的自我怀疑与否定，很多时候是我觉得我没事了，但是其实还是有事。所以好像回到了 2016 那种状态，自我怀疑与挣扎，但是那时候还有人会提醒我“我值得很好的”（我竟然还有截图我真牛逼），但这次好像只有我自己。</p><div style="width:100%; margin:auto"><img src="/life/2022-year-report/qb-chat.png" class=""></div><p>这种状态下我有在思考一段良好关系乃至婚姻的意义。一个人但凡活着总要有点事情做，不管是大事还是小事，不管是做一年还是一辈子。（如果一个人不做事，那这个人就不算一个社会学意义上的人。）在这个基础上，做事是会有挫折的，也是会有喜悦的，这个时候如果是一个人，挫折可能太大压垮了自己，喜悦也可能无人深度分享而快速消散。在这个情况下，人就需要一个战友，可以把自己的后背交给他，当你遇到挫折的时候他会支撑着你，当你们遇到快乐的时候会相互分享，有他的陪伴你可以更好地去做你的事情。这或许就是良好关系的意义所在。</p><p>但是这个战友好像太难找到了，我好像曾经拥有这么一个战友，但是关键时刻她还是会毅然决然的离开你。所以我也在怀疑这种“因为你是你而产生的喜爱”关系的真实性和可获得性，同时也害怕费尽心机找一个人之后不合适再分开，未免有点过于难受。那这种情况还不如找玩伴，大家为了自己的快乐而快乐，于是心态好像偏向了短择，觉得没必要敞开内心。我很难相信能恰好遇到一个合适的战友。在这种情况下自己变得越来越自私和自我，一切只是为了“我的快乐”，对于索取的重视好像远超过了付出，可怕的是还不自知。这个好像就是传统意义上的“丧失了爱的能力”。</p><p>但有一天我意识到了一个道理“如果你害怕失败而不去开始而不去付出，那么可能永远找不到那个合适的人”。世界上虽然那么多人，但是和你相衬的已经很少了，如果抱着一个封闭的心态，很可能一辈子都无法找到这个人。一个人的离开其实恰恰说明了不合适，既然不是你的错，那么没有必要对自己“施加惩罚”，没必要这样对待自己。意识到这个之后，先前的阴影才完全消散，也那么恐惧和排斥一段关系了。于是认真的思索了我到底喜欢什么样的人，列了一个长长的单子，“这个人”好像过于完美，以至于我好像没有见过。和 hy 聊过这个单子，她看过之后说这么多年也只见过她老公一个这样的人（我谢谢你）。但是这个也进一步让我意识到，这样一个人是多么的难得，她不会从天上掉下来，应该主动的去寻找，去了解别人。</p><p>认识 wyc 应该是 2022 最值得记录的事情。也幸好自己反复思索过后跑回去索要了联系方式。前期好像并没有太多的交流，直到认识一周后的线下接触，发现我们有好多的“我也是”的相似点，相处的过程无比舒服。连续见了几天面，每一次都很轻松舒适，好像总有说不完的话，总想和她多待一些时间，每次分开自己都有点恋恋不舍。之后某一天，我突然想起我还有一个关于我喜欢什么样的人的长长的单子，回看发现这个人好像完美满足我的那一堆 cliche。那么难找到的那一个人，竟然被我找到了！相处了一段时间后，在圣诞节前后我们在一起了，并且有了久违的一种想要广而告之的感觉。单纯从要联系方式到熟识这一过程来看，好像认识她并不是一件稀奇或者困难的事情。但是考虑到这么长时间以来自己心态的转变和波动（再加上自己对自己“到底喜欢什么”了解的不断加深），才能发现遇到她这件事是多么的来之不易。和她度过了 2022 年的最后一天，在海边看了烟花，觉得生活十分美好。珍贵的人我会好好去珍惜。</p><div style="text-align:center"><span style="width:48%;display:inline-block"><img src="/life/2022-year-report/together.jpg" class=""></span><span style="width:48%;display:inline-block"><img src="/life/2022-year-report/firework.jpg" class=""></span></div><h1>番外篇：一些碎碎念 Blah Blah</h1><ul><li>今年出现的 chatGPT 和 AI 作画真的让人惊叹！</li><li>发现了最爱的香水，“乔治勋爵的悲剧”！</li><li>这一年买卖了太多东西，咸鱼达人好吧。与人斗其乐无穷！</li><li>今年的年度之歌竟然是《Cornfield Chase》</li><li>第一次以产品经理的视角来参与 Moment 这件产品和相关讨论，发现好像这种事情过于简单（相比于科研）。</li><li>去了性教育展的集市很快乐，发现很多人不羞于谈论性。然而第二天就停展了。</li><li>又一次开始看老友记咯！</li><li>今年又做了很多有趣的梦！当然佩服自己的梦里的想象力。</li><li>觉得深圳真的是文化荒漠，一个人出门竟然想不到任何可以去的地方。（当然可能是我的原因）</li><li>勇士夺冠了！想到 2019 在英国大晚上爬起来看球的充满心塞的自己。</li><li>竟然很喜欢黄巢的反诗，“待到秋来九月八，我花开后百花杀。冲天香阵透长安，满城尽带黄金甲。”这也太酷了吧！</li><li>男女对立也太可怕了，真的可怕。看那些新闻真的悲哀与难过。</li></ul><h1>总结展望</h1><h2 id="一些遗憾">一些遗憾</h2><ul><li>主线任务完成得不够好吧，自己好像是一个总是迷失在支线里的人。</li><li>有一些人际关系没有处理好，主要可能是一些 date 的对象。</li><li>好像也没有做多一些事情，也没有把做了的每一件事情做好。</li></ul><h2 id="立起新的-Flag">立起新的 Flag</h2><ul><li>希望明年能多写写做成了什么事。（大家还是要看结果的而不是过程）</li><li>希望能和 wyc 长久一些。（美好祝愿）</li><li>多邻国还是走下来了哦，希望今年把日语搞完。（我也不知道能不能搞完）</li><li>希望能坚持读书。</li><li>希望不要沉迷支线，多打打主线任务，做精做好。</li><li>希望能养成写总结的习惯，回顾起来应该挺有意思。</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;写在 2023 年年初，对 2022 的回顾。&lt;/p&gt;</summary>
    
    
    
    <category term="Life" scheme="https://blog.superui.cc/categories/Life/"/>
    
    
    <category term="年终总结" scheme="https://blog.superui.cc/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
    
    <category term="生活" scheme="https://blog.superui.cc/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
  <entry>
    <title>牛顿法（Newton&#39;s method）学习</title>
    <link href="https://blog.superui.cc/math/newtons-method/"/>
    <id>https://blog.superui.cc/math/newtons-method/</id>
    <published>2022-11-28T12:00:00.000Z</published>
    <updated>2022-11-28T12:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>牛顿法是一种在实数域和复数域上迭代近似求解方程的方法。此处做一个简单的学习。</p><span id="more"></span><h2 id="牛顿法能做什么？直观上怎么做的？">牛顿法能做什么？直观上怎么做的？</h2><p>一般来说，牛顿法主要用在两个方面:</p><ol><li>求方程的根：通过当前解与函数的切线在 x 轴的交点迭代更新解值，以求得方程的解。</li><li>最优化：最优化问题通常可以理解为求函数导数的解（导数值为0），则可以使用 1 中求方程的根的方法。</li></ol><p>一个简单的过程示意图如下所示：</p><div style="width:60%;margin:auto"><img src="/math/newtons-method/example.gif" class=""></div><h2 id="具体来说怎么做？">具体来说怎么做？</h2><p>求解方程时，迭代更新 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mfrac><mrow><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">x_{n+1}=x_n-\frac{f\left(x_n\right)}{f^{\prime}\left(x_n\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>最优化时，迭代更新 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mfrac><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow><mrow><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">x_{n+1}=x_n-\frac{f^{\prime}\left(x_n\right)}{f^{\prime \prime}\left(x_n\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3649em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4289em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h2 id="有什么特点？">有什么特点？</h2><p>牛顿法最突出的优点是收敛速度快，具有局部二阶收敛性。通俗来说梯度下降法每次只从你当前所处位置选一个坡度最大的方向走一步，而牛顿法在选择方向时，不仅会考虑坡度是否够大，还会考虑你走了一步之后，坡度是否会变得更大。所以，可以说牛顿法比梯度下降法看得更远一点，能更快地走到最底部。</p><h2 id="有什么局限性？">有什么局限性？</h2><ol><li>基本牛顿法初始点需要足够“靠近”极小点，否则有可能导致算法不收敛。这样就引入了全局牛顿法。</li><li>在牛顿法的迭代中，需要计算海森矩阵（函数的二阶导数）的逆矩阵，这一计算比较复杂，这样就引入了拟牛顿法，用一个矩阵来替代。<ul><li>DFP(Davidon-Fletcher-Powell)算法(DFP algorithm)</li><li>BFGS(Broyden-Fletcher-Goldfard-Shano)算法(BFGS algorithm)</li><li>Broyden类算法(Broyden’s algorithm)</li></ul></li></ol><h2 id="Reference">Reference</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/37524275">梯度下降法、牛顿法和拟牛顿法 - Eureka的文章 - 知乎</a></li><li><a href="https://zh.m.wikipedia.org/zh-hans/%E7%89%9B%E9%A1%BF%E6%B3%95">牛顿法</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;牛顿法是一种在实数域和复数域上迭代近似求解方程的方法。
此处做一个简单的学习。&lt;/p&gt;</summary>
    
    
    
    <category term="Math" scheme="https://blog.superui.cc/categories/Math/"/>
    
    
    <category term="optimization" scheme="https://blog.superui.cc/tags/optimization/"/>
    
  </entry>
  
  <entry>
    <title>训练集样本对于测试集 loss 的影响</title>
    <link href="https://blog.superui.cc/machine-learning/loss-gradient/"/>
    <id>https://blog.superui.cc/machine-learning/loss-gradient/</id>
    <published>2022-11-21T10:00:00.000Z</published>
    <updated>2022-11-21T10:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>主动学习中通常要评估样本的重要性/信息量，以选择最有价值样本使得模型提升最大。这一点在样本可解释性中也有体现，即“什么样的样本对于训练来说更加重要？”本文是几篇论文【1，2】的阅读笔记，从梯度的角度阐释样本对于最终测试集表现的影响。</p><span id="more"></span><h2 id="训练样本如何影响测试表现【2】">训练样本如何影响测试表现【2】</h2><p>自然的，去掉一个样本带来的参数变化可以写作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mi>z</mi></mrow></msub><mo>−</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\theta}_{-z}-\hat{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1662em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9579em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>，其中</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mi>z</mi></mrow></msub><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>θ</mi><mo>∈</mo><mi mathvariant="normal">Θ</mi></mrow></munder><munder><mo>∑</mo><mrow><msub><mi>z</mi><mi>i</mi></msub><mo mathvariant="normal">≠</mo><mi>z</mi></mrow></munder><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>θ</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\theta}_{-z} \stackrel{\text { def }}{=} \arg \min _{\theta \in \Theta} \sum_{z_i \neq z} L\left(z_i, \theta\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3613em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4882em;vertical-align:-1.4382em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="mrel mtight">∈</span><span class="mord mtight">Θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7795em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>但是对于每一个样本而言，我们不可能总是去掉它并重新训练一个模型。于是我们可以从 influence function 的角度来理解这个问题。即计算样本权重变化一个很小的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> 时所带来的参数变化（原始权重为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>），在这种情况下</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>θ</mi><mo>∈</mo><mi mathvariant="normal">Θ</mi></mrow></munder><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>θ</mi><mo fence="true">)</mo></mrow><mo>+</mo><mi>ϵ</mi><mi>L</mi><mo stretchy="false">(</mo><mi>z</mi><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{\theta}_{\epsilon, z} \stackrel{\text { def }}{=} \arg \min _{\theta \in \Theta} \frac{1}{n} \sum_{i=1}^n L\left(z_i, \theta\right)+\epsilon L(z, \theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4391em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="mrel mtight">∈</span><span class="mord mtight">Θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7795em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span></p><p>此时将样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> 在参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> 上权重增大 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> 时所带来的 influence 写作</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mrow><msub><mi mathvariant="script">I</mi><mtext>up,params </mtext></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mfrac><mrow><mi>d</mi><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub></mrow><mrow><mi>d</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">∣</mo></mrow><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><mo>−</mo><msubsup><mi>H</mi><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mo stretchy="false">(</mo><mi>z</mi><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\left.\mathcal{I}_{\text {up,params }}(z) \stackrel{\text { def }}{=} \frac{d \hat{\theta}_{\epsilon, z}}{d \epsilon}\right|_{\epsilon=0}=-H_{\hat{\theta}}^{-1} \nabla_\theta L(z, \hat{\theta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0497em;vertical-align:-1.2997em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">up,params </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6349em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">ϵ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.333em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='3.000em' viewBox='0 0 333 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.8486em;"><span style="top:-1.4003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4337em;vertical-align:-0.4758em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.2242em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span><span style="top:-2.9634em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4758em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mover accent="true"><mi>θ</mi><mo>^</mo></mover></msub><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi mathvariant="normal">∇</mi><mi>θ</mi><mn>2</mn></msubsup><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">H_{\hat{\theta}} \stackrel{\text { def }}{=} \frac{1}{n} \sum_{i=1}^n \nabla_\theta^2 L\left(z_i, \hat{\theta}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4787em;vertical-align:-0.3257em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3743em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span><span style="top:-2.9634em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3257em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span> 是正定的 Hessian 矩阵。在训练集中去掉 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> 点就相当于将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> 设为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">-\frac{1}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，那么参数的变化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mi>z</mi></mrow></msub><mo>−</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\theta}_{-z}-\hat{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1662em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9579em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span> 则可在不重训练模型的情况下近似为 $ -\frac{1}{n} \mathcal{I}_{\text {up,params }}(z)$.这样在更改 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> 权重的情况下，对于一个测试样本的影响的解析解可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="script">I</mi><mrow><mtext>up </mtext><mo separator="true">,</mo><mtext> loss </mtext></mrow></msub><mrow><mo fence="true">(</mo><mi>z</mi><mo separator="true">,</mo><msub><mi>z</mi><mtext>test </mtext></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mrow><mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover></mo><mfrac><mrow><mi>d</mi><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>z</mi><mtext>test </mtext></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><mrow><mi>d</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">∣</mo></mrow><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mrow><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msub><mi>z</mi><mtext>test </mtext></msub><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><mfrac><mrow><mi>d</mi><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub></mrow><mrow><mi>d</mi><mi>ϵ</mi></mrow></mfrac><mo fence="true">∣</mo></mrow><mrow><mi>ϵ</mi><mo>=</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msub><mi>z</mi><mtext>test </mtext></msub><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mo stretchy="false">(</mo><mi>z</mi><mo separator="true">,</mo><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \mathcal{I}_{\text {up }, \text { loss }}\left(z, z_{\text {test }}\right) &amp;\left.\stackrel{\text { def }}{=} \frac{d L\left(z_{\text {test }}, \hat{\theta}_{\epsilon, z}\right)}{d \epsilon}\right|_{\epsilon=0} \\ &amp;=\left.\nabla_\theta L\left(z_{\text {test }}, \hat{\theta}\right)^{\top} \frac{d \hat{\theta}_{\epsilon, z}}{d \epsilon}\right|_{\epsilon=0} \\ &amp;=-\nabla_\theta L\left(z_{\text {test }}, \hat{\theta}\right)^{\top} H_{\hat{\theta}}^{-1} \nabla_\theta L(z, \hat{\theta}) . \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.7785em;vertical-align:-4.6392em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.1392em;"><span style="top:-7.1392em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">up </span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight"> loss </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.4895em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"></span></span><span style="top:-0.5008em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.6392em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.1392em;"><span style="top:-7.1392em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em;"><span style="top:-2.464em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">ϵ</span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.19em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.333em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='3.600em' viewBox='0 0 333 3600'><path d='M145 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v2400 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-1.1486em;"><span style="top:-1.1003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5997em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.4895em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.389em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6349em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">ϵ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.333em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='3.000em' viewBox='0 0 333 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.8486em;"><span style="top:-1.4003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2997em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.5008em;"><span class="pstrut" style="height:4.19em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.389em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.2242em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span><span style="top:-2.9634em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4758em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.6392em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="主动学习中对这一结论的运用【1】">主动学习中对这一结论的运用【1】</h2><p>依赖上一节中的影响力估计，训练集中样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 对测试集中样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">x_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 在损失上的影响为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mtext>loss</mtext></msub><mrow><mo fence="true">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">I_{\text{loss}}\left(x, x_j\right)=\frac{1}{n} \nabla_\theta L\left(f_\theta\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(f_\theta(x)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">loss</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>那么在整个测试集的总影响可以写作</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>I</mi><mtext>loss</mtext></msub><mrow><mo fence="true">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munder><mo>∑</mo><mi>j</mi></munder><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_j I_{\text{loss}}\left(x, x_j\right)=\frac{1}{n} \sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">loss</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7352em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">T^{c+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 是在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 个循环过后的模型。尽管单一样本可能对某一测试样本有副作用，但是总体来说训练样本对于整个测试集的影响是正面的。那么，在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 个循环中移除一个训练样本，得到的测试集损失则变为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>L</mi><mtext>test</mtext><mrow><mo mathvariant="normal">′</mo><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>I</mi><mtext>loss </mtext></msub><mrow><mo fence="true">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munder><mo>∑</mo><mi>j</mi></munder><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} L_{\text {test}}^{\prime c+1} &amp;=L_{\text {test }}^{c+1}+\sum_j I_{\text {loss }}\left(x, x_j\right) \\ &amp;=L_{\text {test }}^{c+1}+\frac{1}{n} \sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.799em;vertical-align:-2.6495em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.1495em;"><span style="top:-5.4209em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.3857em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.6495em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.1495em;"><span style="top:-5.4209em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">loss </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-2.3857em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.6495em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>由于测试集样本未知，即无法直接得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>j</mi></msub><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5248em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.089em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.3987em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span>。所以我们同时在等式两边取 Frobenius Norm，得到</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>L</mi><mtext>test</mtext><mrow><mo mathvariant="normal">′</mo><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">∥</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munder><mo>∑</mo><mi>j</mi></munder><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><msup><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mi mathvariant="normal">⊤</mi></msup><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><mo>⋅</mo><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} L_{\text {test}}^{\prime c+1} &amp;=\left\|L_{\text {test }}^{c+1}+\frac{1}{n} \sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right)\right\| \\ &amp; \leq L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\sum_j \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)^{\top} H_\theta^{-1} \nabla_\theta L\left(T^{c+1}(x)\right)\right\| \\ &amp;=L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\nabla_\theta L\left(T^{c+1}(x)\right)^{\top} \sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\| \\ &amp; \leq L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\nabla_\theta L\left(T^{c+1}(x)\right)\right\| \cdot\left\|\sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\| \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:13.855em;vertical-align:-6.6775em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.1775em;"><span style="top:-9.1775em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.7138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span><span style="top:1.2138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.6775em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.1775em;"><span style="top:-9.1775em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-5.7138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.317em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span><span style="top:1.2138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.6775em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>而对于一个固定的测试集来说，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∥</mo><msub><mo>∑</mo><mi>j</mi></msub><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><annotation encoding="application/x-tex">\left\|\sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.556em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.800em' viewBox='0 0 556 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43zM367 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.3987em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.556em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.800em' viewBox='0 0 556 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43zM367 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span></span> 可以看做一个不变项。所以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mtext>test</mtext><mrow><mo mathvariant="normal">′</mo><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">L_{\text {test}}^{\prime c+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2458em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4542em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2458em;"><span></span></span></span></span></span></span></span></span></span> 的上界主要依赖于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><annotation encoding="application/x-tex">\left\|\nabla_\theta L\left(T^{c+1}(x)\right)\right\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span></span></span></span>。但是在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 个循环，模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">T^{c+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 不可知，所以使用模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mi>c</mi></msup></mrow><annotation encoding="application/x-tex">T^{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span></span></span></span> 来做一个近似，即</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>L</mi><mtext>test</mtext><mrow><mo mathvariant="normal">′</mo><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><mo>⋅</mo><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≲</mo><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><mo>⋅</mo><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>H</mi><mi>θ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} L_{\text {test}}^{\prime c+1} &amp; \leq L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\nabla_\theta L\left(T^{c+1}(x)\right)\right\| \cdot\left\|\sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\| \\ &amp; \lesssim L_{\text {test }}^{c+1}+\frac{1}{n}\left\|\nabla_\theta L\left(T^c(x)\right)\right\| \cdot\left\|\sum_j H_\theta^{-1} \nabla_\theta L\left(T^{c+1}\left(x_j\right)\right)\right\| \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.9275em;vertical-align:-3.2138em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.7138em;"><span style="top:-5.7138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.2138em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.7138em;"><span style="top:-5.7138em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:3.2em;"></span><span style="width:0.556em;height:1.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='1.200em' viewBox='0 0 556 1200'><path d='M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43zM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">≲</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∥</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">∥</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.4086em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2914em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43zM367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.2138em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>那么在主动学习的范畴下，更高的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∥</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>L</mi><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow><annotation encoding="application/x-tex">\left\|\nabla_\theta L\left(T^{c}(x)\right)\right\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∥</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">∥</span></span></span></span></span> 可以使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mtext>test </mtext><mrow><mi>c</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">L_{\text {test }}^{c+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2458em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4542em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">test </span></span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2458em;"><span></span></span></span></span></span></span></span></span></span> 的上界更低。所以应当选择梯度范数更低的样本。</p><p>具体梯度的计算需要通过 loss function 使用反向传播。然而具体的真实标记并未获得，所以需要特地设计损失函数来计算梯度。文章中提到了两种梯度的计算，第一种是 Expected-Gradnorm Scheme</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>L</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow></msub><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>∣</mo><mi>x</mi><mo fence="true">)</mo></mrow><msub><mi>L</mi><mi>i</mi></msub><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}L_{exp}\left(T^c(x)\right)=\sum_{i=1}^N P\left(y_i \mid x\right) L_i\left(T^c(x), y_i\right)\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.303em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.803em;"><span style="top:-3.803em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.303em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.803em;"><span style="top:-3.803em;"><span class="pstrut" style="height:3.8283em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.303em;"><span></span></span></span></span></span></span></span></span></p><p>另一种是 Entropy-Gradnorm Scheme</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>L</mi><mrow><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mrow><mo fence="true">(</mo><msup><mi>T</mi><mi>c</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>∣</mo><mi>x</mi><mo fence="true">)</mo></mrow><mi>log</mi><mo>⁡</mo><mi>P</mi><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>∣</mo><mi>x</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}L_{e n t}\left(T^c(x)\right)=-\sum_{i=1}^N P\left(y_i \mid x\right) \log P\left(y_i \mid x\right)\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.303em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.803em;"><span style="top:-3.803em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.303em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.803em;"><span style="top:-3.803em;"><span class="pstrut" style="height:3.8283em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.303em;"><span></span></span></span></span></span></span></span></span></p><h2 id="主动学习相关">主动学习相关</h2><p>当然也有很多其他的主动学习工作使用到了梯度，但是他们考虑问题的入手角度不同。本文介绍的这种通过梯度的评估本质上是考虑其对测试误差的提升。而其他的基于梯度方法通常是来评估样本对模型可能带来多大的改变，比如 EGL 和 BADGE。尤其是 EGL，在形式上和本文介绍的方法很相似，不同的是其仅计算最后一层的梯度。</p><h2 id="一些数学基础：Hessian-矩阵">一些数学基础：Hessian 矩阵</h2><p>黑塞/海森矩阵是在求多元函数的所有二阶偏导数。具体来说，假设有一个实值函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">f\left(x_1, x_2, \ldots, x_n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>，其所有的二阶偏导数在定义域内连续，那么函数的黑塞矩阵为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="bold">H</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>x</mi><mi>n</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\mathbf{H}=\left[\begin{array}{cccc}\frac{\partial^2 f}{\partial x_1^2} &amp; \frac{\partial^2 f}{\partial x_1 \partial x_2} &amp; \cdots &amp; \frac{\partial^2 f}{\partial x_1 \partial x_n} \\\frac{\partial^2 f}{\partial x_2 \partial x_1} &amp; \frac{\partial^2 f}{\partial x_2^2} &amp; \cdots &amp; \frac{\partial^2 f}{\partial x_2 \partial x_n} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\\frac{\partial^2 f}{\partial x_n \partial x_1} &amp; \frac{\partial^2 f}{\partial x_n \partial x_2} &amp; \cdots &amp; \frac{\partial^2 f}{\partial x_n^2}\end{array}\right]\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.7986em;vertical-align:-3.1493em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-5.6493em;"><span class="pstrut" style="height:5.6493em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.55em;"><span style="top:-5.55em;"><span class="pstrut" style="height:8.6em;"></span><span style="width:0.667em;height:6.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.600em' viewBox='0 0 667 6600'><path d='M403 1759 V84 H666 V0 H319 V1759 v3000 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v3000 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.05em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-6.2668em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.6264em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051em;"><span style="top:-2.1885em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3115em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5916em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6051em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.5134em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.0834em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-6.2668em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6051em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.6264em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051em;"><span style="top:-2.1885em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3115em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5916em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.5134em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.0834em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-6.0793em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span style="top:-4.4176em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span style="top:-2.3259em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-0.8959em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-6.2668em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6051em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.5134em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.0834em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.214em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5452em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.55em;"><span style="top:-5.55em;"><span class="pstrut" style="height:8.6em;"></span><span style="width:0.667em;height:6.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.600em' viewBox='0 0 667 6600'><path d='M347 1759 V0 H0 V84 H263 V1759 v3000 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v3000 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.05em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6493em;"><span style="top:-5.6493em;"><span class="pstrut" style="height:5.6493em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1493em;"><span></span></span></span></span></span></span></span></span></p><p>用下标记号表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><msup><mi mathvariant="normal">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathbf{H}_{i j}=\frac{\partial^2 f}{\partial x_i \partial x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9722em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6123em;vertical-align:-0.5423em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。</p><p>可以在泰勒展开中理解这个矩阵。在一元函数中，泰勒展开式为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo>+</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>+</mo><mfrac><mrow><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow></mrow><mrow><mn>2</mn><mo stretchy="false">!</mo></mrow></mfrac><mi mathvariant="normal">Δ</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">f(x)=f\left(x_0\right)+f^{\prime}\left(x_0\right) \Delta x+\frac{f^{\prime \prime}\left(x_0\right)}{2 !} \Delta x^2+\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.1149em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4289em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.313em;"></span><span class="minner">⋯</span></span></span></span></span></p><p>相应的，在多元函数中</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo>+</mo><mi mathvariant="normal">∇</mi><mi>f</mi><msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">T</mi></msup><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant="normal">Δ</mi><msup><mi>x</mi><mi mathvariant="normal">T</mi></msup><mi mathvariant="bold">H</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>+</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">f(x)=f\left(x_0\right)+\nabla f\left(x_0\right)^{\mathrm{T}} \Delta x+\frac{1}{2} \Delta x^{\mathrm{T}} \mathbf{H}\left(x_0\right) \Delta x+\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2312em;vertical-align:-0.25em;"></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span class="mord mathbf">H</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.313em;"></span><span class="minner">⋯</span></span></span></span></span></p><h2 id="Reference">Reference</h2><ol><li>Wang, Tianyang, et al. “Boosting active learning via improving test performance.” Proceedings of the AAAI Conference on Artificial Intelligence. Vol. 36. No. 8. 2022.</li><li>Koh, Pang Wei, and Percy Liang. “Understanding black-box predictions via influence functions.” International conference on machine learning. PMLR, 2017.</li><li><a href="https://en.wikipedia.org/wiki/Hessian_matrix">https://en.wikipedia.org/wiki/Hessian_matrix</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;主动学习中通常要评估样本的重要性/信息量，以选择最有价值样本使得模型提升最大。
这一点在样本可解释性中也有体现，即“什么样的样本对于训练来说更加重要？”
本文是几篇论文【1，2】的阅读笔记，从梯度的角度阐释样本对于最终测试集表现的影响。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="neural-network" scheme="https://blog.superui.cc/tags/neural-network/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="loss" scheme="https://blog.superui.cc/tags/loss/"/>
    
    <category term="gradient" scheme="https://blog.superui.cc/tags/gradient/"/>
    
  </entry>
  
  <entry>
    <title>机器学习中的 Lipschitz Continuity</title>
    <link href="https://blog.superui.cc/machine-learning/lipschitz-in-ml/"/>
    <id>https://blog.superui.cc/machine-learning/lipschitz-in-ml/</id>
    <published>2022-11-07T10:00:00.000Z</published>
    <updated>2022-11-07T10:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>在 discriminator 的学习使用中，经常会见到这个 Lipschitz Condition，在此处做一个学习。</p><span id="more"></span><h2 id="Lipschitz-Continuity">Lipschitz Continuity</h2><p>Lipschitz Continuous 是比可微分更严格的条件，这个性质限制了函数的微分值必须有上下限。换句话说，目标函数会被一个一次函数上下夹逼，如下图所示。</p><div style="width:50%;margin:auto"><img src="/machine-learning/lipschitz-in-ml/Lipschitz_Visualisierung.gif" class=""></div><p>以公式的形式展开，函数需要满足以下条件：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∥</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><mo>⩽</mo><mi>L</mi><mi mathvariant="normal">∥</mi><mi>x</mi><mo>−</mo><mi>y</mi><mi mathvariant="normal">∥</mi></mrow><annotation encoding="application/x-tex">\|f(x)-f(y)\| \leqslant L\|x-y\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord">∥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord">∥</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∥</span></span></span></span></span></p><h2 id="为什么会在机器学习中使用？">为什么会在机器学习中使用？</h2><p>本人目前见到过的使用地点多在 discriminator 相关工作中。Discriminator 在 GAN 相关模型中是一个必要的结构，在域迁移的模型中也多有使用。其作用是将真实样本与虚假样本分开，之后在将其固定来训练生成器使得判别器无法将虚假样本分开。</p><p>当下 GAN 可以生成足以骗过人类的高质量图像，但是其训练过程的不稳定仍然是一个具有挑战性的问题。因此，一系列的研究工作都着眼于解决不稳定训练的问题。WGAN 中使用 wasserstein distance 来代替原始 GAN 中的分类损失，效果良好。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">(</mo><msub><mi>P</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>P</mi><mi>g</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><munder><mrow><mi>inf</mi><mo>⁡</mo></mrow><mrow><mi>γ</mi><mo>∈</mo><mo>∏</mo><mrow><mo fence="true">(</mo><msub><mi>P</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>P</mi><mi>g</mi></msub><mo fence="true">)</mo></mrow></mrow></munder><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∼</mo><mi>γ</mi></mrow></msub><mo stretchy="false">[</mo><mi mathvariant="normal">∥</mi><mi>x</mi><mo>−</mo><mi>y</mi><mi mathvariant="normal">∥</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\left(P_r, P_g\right)=\inf _{\gamma \in \prod\left(P_r, P_g\right)} \mathbb{E}_{(x, y) \sim \gamma}[\|x-y\|]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7383em;vertical-align:-0.9883em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.309em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span><span class="mrel mtight">∈</span><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∏</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9883em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord">∥</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∥</span><span class="mclose">]</span></span></span></span></span></p><p>但是由于这个形式十分难以求解，所以将该优化问题转换为以下形式。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>W</mi><mrow><mo fence="true">(</mo><msub><mi>P</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>P</mi><mi>θ</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><munder><mrow><mi>sup</mi><mo>⁡</mo></mrow><mrow><mi mathvariant="normal">∥</mi><mi>f</mi><msub><mi mathvariant="normal">∥</mi><mi>L</mi></msub><mo>≤</mo><mi>K</mi></mrow></munder><msub><mi mathvariant="double-struck">E</mi><mrow><mi>x</mi><mo>∼</mo><msub><mi>P</mi><mi>r</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>x</mi><mo>∼</mo><msub><mi>P</mi><mi>θ</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">W\left(P_r, P_\theta\right)=\sup _{\|f\|_L \leq K} \mathbb{E}_{x \sim P_r}[f(x)]-\mathbb{E}_{x \sim P_\theta}[f(x)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.9104em;vertical-align:-1.1604em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em;"><span style="top:-2.1146em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∥</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mtight"><span class="mord mtight">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span><span class="mrel mtight">≤</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">sup</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1604em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0059em;vertical-align:-0.2559em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2559em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span></span></span></span></span></p><p>这个转化通过对判别器应用正则化或归一化，将判别器形式化定义为一个利普希茨连续的函数（Lipschitz continuous function），其利普希茨常数为 K。这样，在不大幅度牺牲判别器性能的条件下，判别器的梯度空间会变得更平滑，可以更加稳定的训练。在此技术上，有谱归一化和梯度归一化等工作。</p><h2 id="Reference">Reference</h2><ul><li><a href="https://mp.weixin.qq.com/s/V7DzjtidOI6ohocRgAgUEA?">舍弃谱归一化，这篇ICCV’21论文用梯度归一化训练GAN，效果极好</a></li><li><a href="https://blog.csdn.net/c9Yv2cf9I06K2A9E/article/details/83112332">深度学习中的Lipschitz约束：泛化与生成模型</a></li><li><a href="https://ai.stackexchange.com/questions/29904/what-is-lipschitz-constraint-and-why-it-is-enforced-on-discriminator">What is Lipschitz constraint and why it is enforced on discriminator?</a></li><li><a href="https://www.cnblogs.com/wonderlust/p/15767225.html">Spectral Normalization 谱归一化-原理及实现</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;在 discriminator 的学习使用中，经常会见到这个 Lipschitz Condition，在此处做一个学习。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="neural-network" scheme="https://blog.superui.cc/tags/neural-network/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="theory" scheme="https://blog.superui.cc/tags/theory/"/>
    
  </entry>
  
  <entry>
    <title>LSTM</title>
    <link href="https://blog.superui.cc/machine-learning/lstm/"/>
    <id>https://blog.superui.cc/machine-learning/lstm/</id>
    <published>2022-10-27T13:00:00.000Z</published>
    <updated>2022-10-27T13:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>最近用到的 ASP-MTL 模型中使用 LSTM 作为特征提取器。自己对于 RNN 的认知很不成体系，在此进行一个梳理。对 LSTM 来做一个学习，主要针对结构和预测两方面。</p><span id="more"></span><h2 id="RNN">RNN</h2><p>Recurrent Neural Networks（RNN）指循环神经网络，用来处理序列数据。每一个时刻的输出或中间信息会被传递到下一个时刻作为一部分输入，以保留时序信息。具体模式如下图所示。</p><div style="width:80%;margin:auto"><img src="/machine-learning/lstm/RNN-unrolled.png" class="" title="一个 RNN 示例"></div><p>其中处理以往和当前信息的结构十分简单，以一个 tanh 来合并。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/simpleRNN.png" class="" title="简单 RNN 内部结构示例"></div><h2 id="LSTM">LSTM</h2><p>经典的 RNN 存在难以解决长距离依赖（long-term dependency）的问题，即时序上距离过远的相关信息难以被学到。于是 LSTM 模型被提出，其包含了一个记录长效信息的模块。LSTM 的结构如下图所示。最主要的核心观点是维护一个 cell state（细胞状态），以使得信息跨时序传输。当然这里个人认为翻译成“牢房”更为贴切。不同于简单的 RNN 中只有一个神经网络，LSTM 中含有四个主要的神经网络（门结构）。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/lstm.png" class="" title="LSTM 内部结构示例"></div><p>遗忘门决定要从细胞状态中舍弃什么信息。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/LSTM3-focus-f.png" class="" title="遗忘门"></div><p>输入门决定保存哪些新信息进入细胞状态。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/LSTM3-focus-i.png" class="" title="输入门"></div><p>旧的状态 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">C_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 先 forget 再 input 得到新的状态 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">C_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/LSTM3-focus-C.png" class="" title="细胞状态更新"></div><p>输出一个“过滤”后的细胞状态。</p><div style="width:60%;margin:auto"><img src="/machine-learning/lstm/LSTM3-focus-o.png" class="" title="输出门"></div><h3 id="模型训练">模型训练</h3><p>先由正向传播，算出最终的损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span>，再反向计算梯度即可。详细的正向过程可见【2】。反向过程可见【3】。值得注意的是，反向过程的梯度更新需要考虑每一个时间步的输出。</p><h2 id="Reference">Reference</h2><ol><li><a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">Understanding LSTM Networks</a></li><li><a href="https://zhuanlan.zhihu.com/p/83496936">人人都能看懂的LSTM介绍及反向传播算法推导 - 陈楠的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/54775438">RNN之随时间反向传播BPTT推导细节，从公式中理解RNN梯度消失与梯度爆炸原因 - 塞巴斯万隆的文章</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;最近用到的 ASP-MTL 模型中使用 LSTM 作为特征提取器。
自己对于 RNN 的认知很不成体系，在此进行一个梳理。
对 LSTM 来做一个学习，主要针对结构和预测两方面。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="neural-network" scheme="https://blog.superui.cc/tags/neural-network/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="rnn" scheme="https://blog.superui.cc/tags/rnn/"/>
    
    <category term="lstm" scheme="https://blog.superui.cc/tags/lstm/"/>
    
  </entry>
  
  <entry>
    <title>深度神经网络模型复杂度</title>
    <link href="https://blog.superui.cc/machine-learning/computational-complexity/"/>
    <id>https://blog.superui.cc/machine-learning/computational-complexity/</id>
    <published>2022-10-20T05:00:00.000Z</published>
    <updated>2022-10-20T05:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>深度学习计算量/复杂度相关知识。个人在此方面的知识较少，导致上周高性能计算的讲座好多都没有听懂，在此做一个学习。</p><span id="more"></span><h2 id="一些基础概念">一些基础概念</h2><p>首先介绍一些概念：</p><ul><li>FLOPS：floating point operations per second 的缩写，意指每秒浮点运算次数，理解为计算速度，是衡量硬件性能的指标。（常与 FLOPs 混淆）</li><li>FLOPs：floating point operations 的缩写，意指浮点运算数，理解为计算量，可以用来衡量算法/模型的复杂度。</li><li>MACs：multiply–accumulate operations，意为乘加计算数，通常与 FLOPs 存在一个两倍的关系。</li></ul><p>关于什么是浮点数可以看这篇文章【2】，个人觉得深入浅出写的比较清晰。</p><h2 id="如何计算">如何计算</h2><p>其实就是计算有多少次运算，对于不同的模型结构计算数目不同。此处不涉及具体公式，仅介绍 FLOPs 计算思路，MACs（又乘又加）的话通常为 FLOPs 的两倍左右。</p><ol><li>卷积层：在卷积层参数数目的基础上乘以输出的 feature map 大小（输出的每一个 feature 都是通过一次卷积层得到的）。</li><li>全联接层：即为全联接层参数数目。</li><li>激活层：不同激活函数的计算量不同。通常来说不重点计算。</li></ol><h2 id="Reference">Reference</h2><ol><li><a href="https://www.zhihu.com/question/65305385/answer/451060549">CNN 模型所需的计算力（flops）和参数（parameters）数量是怎么计算的？ - 泓宇的回答</a></li><li><a href="https://www.zhihu.com/question/425741425/answer/2584045783">浮点数浮点型到底是什么，能说的简单一点吗，就是用高中生能理解的语言。它们的作用是什么？ - 木木的回答</a></li><li><a href="https://blog.csdn.net/weixin_39833897/article/details/105807172">CNN的参数量、计算量（FLOPs、MACs）与运行速度</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;深度学习计算量/复杂度相关知识。
个人在此方面的知识较少，导致上周高性能计算的讲座好多都没有听懂，在此做一个学习。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="deep-learning" scheme="https://blog.superui.cc/tags/deep-learning/"/>
    
    <category term="high-performance-computing" scheme="https://blog.superui.cc/tags/high-performance-computing/"/>
    
  </entry>
  
  <entry>
    <title>再次学习强化学习的笔记</title>
    <link href="https://blog.superui.cc/machine-learning/re-learn-RL/"/>
    <id>https://blog.superui.cc/machine-learning/re-learn-RL/</id>
    <published>2022-10-14T06:00:00.000Z</published>
    <updated>2022-10-14T06:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>距离上一次学习强化学习已经很久了。最近由于 learning to optimize 用到了很多强化学习的知识，猛的一看发现又不太懂，于是这里进行对于强化学习的再学习。上一次对强化学习的学习见<a href="/machine-learning/reinforcement-learning/" title="这一篇帖子">这一篇帖子</a>。</p><span id="more"></span><p>总的来说，上次对于强化学习的理解过于浅薄，而且并没有从一个系统性和直观的角度进行理解，导致抄了一堆公式也是白抄。本文主要以一个直观的角度来对一个重要算法在整个体系中存在的位置做一个定位，不会过多陷入数学计算。</p><h2 id="什么是强化学习？（一些基础知识）">什么是强化学习？（一些基础知识）</h2><p>强化学习目标是学到一个对于目标任务的策略 policy (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span>)，给定一个当前的状态 state (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>)，策略可以给出当前应该执行的策略 action (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>) 以获得最大收益。</p><p>此外还有以下一些概念：</p><ul><li>Value 价值：一般单独提到时指的是当前状态的价值。</li><li>Q-value 动作价值：指在某一个状态 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 下实施动作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> 所能收获的收益。</li><li>Model 模型：指状态转移的模式，即环境对于特定的动作如何反应。</li><li>Return 回报：指在整个交互结束之后能收到的总奖励。</li></ul><h2 id="最初的方法：-Q-Leaning-Policy-Gradient">最初的方法： Q-Leaning &amp; Policy Gradient</h2><p>我们这里还是更多的介绍一下 model-free 的场景。具体来说，我们对环境提供的状态转移无知，并且我们不对其进行建模。在这种情况下，我们想要学习一个策略，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>→</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">\pi(s)\rightarrow a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>，可以有两种方式：</p><ol><li>学习不同状态下的 Q-value，并对其进行建模。建模成功之后即可选取在当前 state 下 Q-value 最大的 action 实施。</li><li>直接学习策略 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span>，则可直接输入 state，得到 action。</li></ol><p>那么两者各有什么特点呢？</p><ol><li>Q-learning 以值为基础，可以使用时序差分（temporal-difference）的思路，使效用估计朝着理想均衡方向调整，可以进行单步更新。但是由于其离散化的特点，如果在连续空间中进行选择，则会瘫痪。</li><li>Policy gradient 可以在毫不费力地在连续空间中进行选择，但是因为其是基于 Monte-Carlo 采样得到的评估，必须等一个回合结束后才可以更新，学习效率低。</li></ol><div style="width:90%;margin:auto"><img src="/machine-learning/re-learn-RL/TD_MC_backups.png" class=""></div><h2 id="结合两者的优点-Actor-Critic">结合两者的优点 Actor-Critic</h2><p>Policy gradient 使用现实中的奖惩来更新 actor。此时的梯度可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><msub><mi>E</mi><mrow><mi>τ</mi><mo>∼</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo fence="true">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla \bar{R}_\theta=E_{\tau \sim p_\theta(\tau)}\left[R(\tau) \nabla \log p_\theta(\tau)\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701em;vertical-align:-0.15em;"></span><span class="mord">∇</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mord">∇</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span></span></p><p>这个 reward 奖惩信息 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 可以被学出来，作为一个 critic 来来指导 actor 训练。Critic 可以看到当前所处状态动作的潜在奖励，所以可以使得 actor 每一步都在更新，而不是到回合结束才能更新。AC 中的梯度可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>n</mi></msub></munderover><msup><mi>Q</mi><msub><mi>π</mi><mi>θ</mi></msub></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo>∣</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla \bar{R}_\theta=\frac{1}{N} \sum_{n-1}^N \sum_{t=1}^{T_n} Q^{\pi_\theta}\left(s_t^n, a_t^n\right) \nabla \log p_\theta\left(a_t^n \mid s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701em;vertical-align:-0.15em;"></span><span class="mord">∇</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1649em;vertical-align:-1.3254em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3254em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><h2 id="A2C-和-A3C">A2C 和 A3C</h2><h3 id="Advantage-Actor-Critic-A2C">Advantage Actor-Critic (A2C)</h3><p>AC 中使用 Q-value，方差大，梯度差异较大训练不稳定。PG 中同样有这种问题，它的解决方式是引入一个 baseline，用累计奖励 Gain 减去 baseline，可以使梯度减小，训练平缓。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>n</mi></msub></munderover><mrow><mo fence="true">(</mo><mi>G</mi><mi>a</mi><mi>i</mi><msub><mi>n</mi><mi>t</mi></msub><mo>−</mo><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo>∣</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla \bar{R}_\theta=\frac{1}{N} \sum_{n=1}^N \sum_{t=1}^{T_n}\left(Gain_t - baseline(s_t)\right) \nabla \log p_\theta\left(a_t^n \mid s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701em;vertical-align:-0.15em;"></span><span class="mord">∇</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1065em;vertical-align:-1.2671em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">G</span><span class="mord mathnormal">ai</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">ba</span><span class="mord mathnormal">se</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">in</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>A2C 中，认为对于 Q-value $Q^{\pi_\theta}\left(s_t^n, a_t^n\right) $ 一个自然的 baseline 选择是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><msub><mi>π</mi><mi>θ</mi></msub></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">V^{\pi_\theta}\left(s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>。于是可以构造优势函数 advantage function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A(s_t,a_t) = Q(s_t,a_t)-V(s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。其可以通过近似计算得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>r</mi><mi>t</mi><mi>n</mi></msubsup><mo>+</mo><msup><mi>V</mi><mi>π</mi></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo fence="true">)</mo></mrow><mo>−</mo><msup><mi>V</mi><mi>π</mi></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">A(s_t,a_t) = r_t^n+V^\pi\left(s_{t+1}^n\right)-V^\pi\left(s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9114em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3064em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>。所以可以仅用一个网络来估计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 值而不用评估 Q-value。可以说 A2C 解决的是梯度方差大，训练不稳定的问题。</p><p>A2C 中的梯度可以写作：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>n</mi></msub></munderover><msup><mi>A</mi><msub><mi>π</mi><mi>θ</mi></msub></msup><mrow><mo fence="true">(</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mo>∣</mo><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla \bar{R}_\theta=\frac{1}{N} \sum_{n=1}^N \sum_{t=1}^{T_n} A^{\pi_\theta}\left(s_t^n, a_t^n\right) \nabla \log p_\theta\left(a_t^n \mid s_t^n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701em;vertical-align:-0.15em;"></span><span class="mord">∇</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1065em;vertical-align:-1.2671em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>除了方差大，AC 还存在的问题：两个网络交替训练，critic 和 action 强相关，有着很强的时序关联，只能探索到有限的状态和动作空间。为了打破经验耦合，需要采用 experience replay，使得 agent 在后续训练可以访问到以前知识（例如 DQN 和 DDPG（DQN+AC）这类基于值的方法）。但是策略类的方法，经验都是以 episode 形式获得，用完即弃。</p><p>在此情况下使用并行架构，不同的 worker 与环境进行交互，得到独立的采样经验。即每轮训练中，Global network 都会等待每个 worker 各自完成当前的 episode，然后把这些 worker 上传的梯度进行汇总并求平均，得到一个统一的梯度并用其更新主网络的参数，最后用这个参数同时更新所有的 worker。可以说 A2C 也解决了经验耦合的问题。</p><h3 id="Asynchronous-Advantage-Actor-Critic-A3C">Asynchronous Advantage Actor-Critic (A3C)</h3><p>A3C 相对于 A2C 使用了异步经验更新。没有等待所有 worker 完成当前 episode 并汇总的过程。</p><blockquote><p><strong>各个 worker 都分别使用着一套不同的策略</strong>，独立的跟自己的环境交互。而主网络保持着最新的策略，各 worker 跟主网络同步的时间也是不一样的，只要有一个 worker 完成当前episode，主网络就会根据它的梯度进行更新，并不影响其它仍旧在使用旧策略的 worker。这就是异步并行的核心思想。</p></blockquote><p>但是研究者们逐渐发现A3C主要优势在于采用了“并行训练”的思想，而不一定要“异步地并行训练”。异步更新并没有使训练效率和性能取得显著提高【3】，A2C 表现更好（A2C 是在 A3C 后面出现的）。</p><h2 id="结语">结语</h2><p>本文并没有深入技术细节，而是从强化学习（在这几个方法上）的演变角度，简单的记录了不同方法的 intuition。比之前的学习笔记或许在问题定义上清晰了一些。</p><h2 id="Reference">Reference</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/25831658">什么是 Actor-Critic (强化学习) - 莫烦的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/478709774">深入理解强化学习（七）- Actor-Critic - 莫冉的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/148492887">深度强化学习 – 进击的 Actor-Critic（A2C 和A3C） - Quantum cheese的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/51645768">强化学习AC、A2C、A3C算法原理与实现！ - 梁勇的文章</a></li><li><a href="https://zhuanlan.zhihu.com/p/161839383">Actor-Critic的变体 - heaven的文章</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;距离上一次学习强化学习已经很久了。
最近由于 learning to optimize 用到了很多强化学习的知识，猛的一看发现又不太懂，于是这里进行对于强化学习的再学习。
上一次对强化学习的学习见&lt;a href=&quot;/machine-learning/reinforcement-learning/&quot; title=&quot;这一篇帖子&quot;&gt;这一篇帖子&lt;/a&gt;。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="reinforcement-learning" scheme="https://blog.superui.cc/tags/reinforcement-learning/"/>
    
  </entry>
  
  <entry>
    <title>Attention 和 Transformer</title>
    <link href="https://blog.superui.cc/machine-learning/attention/"/>
    <id>https://blog.superui.cc/machine-learning/attention/</id>
    <published>2022-09-30T08:00:00.000Z</published>
    <updated>2022-09-30T08:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>注意力机制和 Transformer 在神经网络中已经取得了良好的表现，此处做一个简要的学习。因为在自己的工作中并不会用到，所以此处可能更注重一些逻辑上的思路，以加强直观上的理解，具体细节有需要的时候再进行补充。</p><span id="more"></span><h2 id="Attention-机制是什么？">Attention 机制是什么？</h2><p>Attention 最初面对的是长程梯度消失以及中间隐变量信息含量有限的问题。其通过将输入中的样本信息指导输出过程，来解决这一问题。其有着参数少速度快效果好的优点。</p><p>Attention 做的事情简单来说就是“加权求和”：</p><ul><li>对什么加权？对 feature 或者一系列输入信息加权。</li><li>权重是多少？权重为一个函数，而不是固定值。（若为固定值的话则可视为全连接层了。）一般来说这个权重即为 attention 分布，基于输入位置和输出位置的关联性。</li><li>求和得到什么？所需的输出。</li></ul><div style="width:80%;margin:auto"><img src="/machine-learning/attention/knowledge_is_power.gif" class="" title="一个翻译任务的例子"></div><h2 id="Attention-定义">Attention 定义</h2><p>以下是 “Attention Is All You Need”【4】这篇重磅论文中给出的定义。这个定义虽说是针对于他们的 scaled dot-product attention，但是整体来说整个 attention 都是一个思路，所以可以拿来作为定义。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Attention</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">softmax</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">\operatorname{Attention}(Q, K, V)=\operatorname{softmax}\left(\frac{Q K^T}{\sqrt{d_k}}\right) V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">Attention</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4684em;vertical-align:-0.95em;"></span><span class="mop"><span class="mord mathrm">softmax</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em;"><span style="top:-2.2528em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8572em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8172em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1828em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span></p><p>即通过关系矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">Q K^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> 归一化得到的概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">softmax</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{softmax}\left(\frac{Q K^T}{\sqrt{d_k}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span class="mord mathrm">softmax</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0895em;"><span style="top:-2.5864em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1778em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Q</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9191em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span> 对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 进行重采样。当然这个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi>K</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">QKV</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 在不同场景下可能有着不同的具体含义。</p><h2 id="Multi-head-attention">Multi-head attention</h2><p>如下图所示。简单来说就是将多个 scaled dot-product attention 的值拼接，再通过线形结合输出。</p><div style="width:80%;margin:auto"><img src="/machine-learning/attention/multi-head-attention.png" class="" title="multi-head attention"></div><p>具体的，</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">MultiHead</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Concat</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mrow><mi mathvariant="normal">head</mi><mo>⁡</mo></mrow><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo></mrow><mo separator="true">,</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mrow><msub><mrow></mrow><mi mathvariant="normal">h</mi></msub><mo fence="true">)</mo></mrow><msup><mi>W</mi><mi>O</mi></msup><mspace linebreak="newline"></mspace><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mspace width="1em"/><msub><mtext>head</mtext><mi>i</mi></msub><mo>=</mo><mi mathvariant="normal">Attention</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mi>Q</mi><msubsup><mi>W</mi><mi>i</mi><mi>Q</mi></msubsup><mo separator="true">,</mo><mi>K</mi><msubsup><mi>W</mi><mi>i</mi><mi>K</mi></msubsup><mo separator="true">,</mo><mi>V</mi><msubsup><mi>W</mi><mi>i</mi><mi>V</mi></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{MultiHead}(Q, K, V)=\operatorname{Concat}\left(\operatorname{head}_1, \ldots\right., head \left._{\mathrm{h}}\right) W^O \\where \quad \text{head}_i=\operatorname{Attention}\left(Q W_i^Q, K W_i^K, V W_i^V\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">MultiHead</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">Concat</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mop"><span class="mop"><span class="mord mathrm">head</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">h</span><span class="mord mathnormal">ere</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord text"><span class="mord">head</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span class="mord mathrm">Attention</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9592em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p><h2 id="Transformer">Transformer</h2><p>其模型结构如下图所示。Multi-head attention 是其主要组成部分。在 attention 之外，样本的位置（顺序）信息使用 positional encoding 嵌入（因为不像 RNN 有顺序结构）。</p><div style="width:50%;margin:auto"><img src="/machine-learning/attention/transformer.png" class="" title="transformer"></div><h2 id="Reference">Reference</h2><ol><li><a href="https://www.zhihu.com/question/320174043/answer/651998472">深度学习中Attention与全连接层的区别何在？ - SleepyBag的回答 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/47063917">Attention机制详解（一）——Seq2Seq中的Attention</a></li><li><a href="https://www.zhihu.com/question/68482809/answer/1876764572">目前主流的attention方法都有哪些？ - 电光幻影炼金术的回答 - 知乎</a></li><li>Vaswani, Ashish, et al. “Attention is all you need.” Advances in neural information processing systems 30 (2017).</li></ol>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;注意力机制和 Transformer 在神经网络中已经取得了良好的表现，此处做一个简要的学习。
因为在自己的工作中并不会用到，所以此处可能更注重一些逻辑上的思路，以加强直观上的理解，具体细节有需要的时候再进行补充。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="neural-network" scheme="https://blog.superui.cc/tags/neural-network/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="attention" scheme="https://blog.superui.cc/tags/attention/"/>
    
  </entry>
  
  <entry>
    <title>Focal Loss</title>
    <link href="https://blog.superui.cc/machine-learning/focal-loss/"/>
    <id>https://blog.superui.cc/machine-learning/focal-loss/</id>
    <published>2022-09-21T07:00:00.000Z</published>
    <updated>2022-09-21T07:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>前几天听到一个关于元学习的报告，里面提到了一下 Focal Loss，意识到总是听人讲起却没有好好看过它到底是什么，于是这里做一个简短的学习。</p><span id="more"></span><h2 id="类别不平衡问题">类别不平衡问题</h2><p>Focal loss 是何恺明大神提出的，面向类别不平衡性能损失问题的一个思路。</p><p>通常情况下，面对类别不平衡，如果不加干预，模型则更倾向于对优势类有着更好表现。通常大家的解决思路是对不同类别的样本损失函数加权，降低优势类损失的权重，增强劣势类损失的权重，比例约为不同类别（正负样本）的数量比。</p><p>此处 focal loss 本质上也是一个对于 CEloss 的加权，但是它入手的角度是学习样本的难易程度。</p><h2 id="Focal-loss-具体形式">Focal loss 具体形式</h2><p>首先我们给出 focal loss 的表达式：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>f</mi><mi>l</mi></mrow></msub><mo>=</mo><mo>−</mo><msup><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mi>γ</mi></msup><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mspace linebreak="newline"></mspace><msub><mi>p</mi><mi>t</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mover accent="true"><mi>p</mi><mo>^</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi mathvariant="normal">y</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo>−</mo><mover accent="true"><mi>p</mi><mo>^</mo></mover></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext> otherwise </mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">L_{f l} =-\left(1-p_t\right)^\gamma \log \left(p_t\right)\\p_t = \begin{cases}\hat{p} &amp; \text { if } \mathrm{y}=1 \\ 1-\hat{p} &amp; \text { otherwise }\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0543em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathrm" style="margin-right:0.01389em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> otherwise </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>同理也有交叉墒损失函数的表达式:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>c</mi><mi>e</mi></mrow></msub><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">L_{ce}=- \log \left(p_t\right)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ce</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span><span class="mspace newline"></span></span></span></span></p><p>两者的主要区别在于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">log</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> 项之前的权重。直观上理解，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> 反应了分类的难易程度，分类的置信度越高，代表样本越易分；分类的置信度越低，代表样本越难分。因此focal loss相当于增加了难分样本在损失函数的权重，使得损失函数倾向于难分的样本，有助于提高难分样本的准确度。而通常情况下，样本较少的类别天然会难分一些。</p><h2 id="Reference">Reference</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/32423092">何恺明大神的「Focal Loss」，如何更好地理解？</a></li><li><a href="https://zhuanlan.zhihu.com/p/266023273">focal loss 通俗讲解</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;前几天听到一个关于元学习的报告，里面提到了一下 Focal Loss，意识到总是听人讲起却没有好好看过它到底是什么，于是这里做一个简短的学习。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="neural-network" scheme="https://blog.superui.cc/tags/neural-network/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
    <category term="loss-function" scheme="https://blog.superui.cc/tags/loss-function/"/>
    
  </entry>
  
  <entry>
    <title>《世界简史》读书笔记</title>
    <link href="https://blog.superui.cc/reading-note/brief-world-history/"/>
    <id>https://blog.superui.cc/reading-note/brief-world-history/</id>
    <published>2022-07-24T08:30:00.000Z</published>
    <updated>2022-07-24T08:30:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>通俗历史的高度概括，从空间时间的起源到世界政治与社会的重建。</p><span id="more"></span><h2 id="作者">作者</h2><p>H•G·韦尔斯（1866-1946），英国著名作家。早年在一家布店当过学徒，后毕业于英国皇家学院。曾尝试以教书为生，却以新闻和文学创作闻名于世。其所著《时间机器》、《隐身人》为现代科幻小说开山之作。一生涉猎甚广，虽不是历史学家，却以《世界史纲》跻身于史学大家之列。（摘自豆瓣）</p><h2 id="内容简介">内容简介</h2><p>《世界史纲》乃鸿篇巨制，煌煌近百万字，非一般读者所能吸纳。韦尔斯于1923年出版的这本包含着“崭新立意和写法”的《韦尔斯世界简史》，作为前者的普及版。作者以无比开阔的视界、轻快简洁的笔调将自生物起源以来的生物及人类历史，有条不紊地展现在读者面前，作者的目的不拘泥于考据，而在于给读者提供一个宏伟、宽广的大视野。（摘自豆瓣）</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>惊讶于二十世纪初作者对世界历史的了解。史实之外，作者还加入了很多对事件发展变迁的认识。帝国的此起彼伏、潮起潮落，在作者的笔下以平实的语言叙述出来，并且能直接地指出变迁的关键事件（原因），对于帮助认识历史有着极大的好处。本书跨度极大，从宇宙地球讲起，直到一战前的世界格局，从原始的部落社会，到后来的资本主义和社会主义，可以说是一本极好的科普书籍。</p><h3 id="感想看法">感想看法</h3><ul><li>这本书讲了很多生命起源，原始人什么的。对我而言很无趣且冗长。</li><li>讲了很多公元前的埃及巴比伦那边的人种，包含大量的地名人名，没有配合图片难以阅读。</li><li>发现对熟悉领域的扩展阅读似乎总是比不熟悉的领域要看得舒服一些。大量的欧洲史个人就觉得有点晦涩难懂。</li><li>有点感叹，在写成这本书的无互联网的年代，搜集到如此多的历史信息并成文是一件很不容易的事情。</li><li>一个国家的灭亡根本的原因会是什么呢？不得人心吗？还是经济无力支撑？</li><li>教皇原来曾经有这么大的影响力。十字军东征原来是教会扫除异教徒的行为。</li><li>蒙古人的西进并非人多势众野蛮暴烈，他们的行军很有战略规划和情报刺探。而基督教诸国却对自己的敌人一无所知。这对自己原来对蒙古领土横跨亚欧大陆的认识相差甚远，以前只是觉得可能蒙古人太骁勇了。</li><li>元朝看起来只是蒙古统治的一个分支。</li><li>教会压制了人们对自由科学的追求，教会发达的时候自然科学完完全全被压制。就让人想到中国的这些儒家文化道家文化，从来都是三纲五常，可能有着对人探索精神的压制，或许这也是中国自然科学没发展起来的原因之一。</li><li>原来是蒙古人把枪炮和火药带到的西方。</li><li>工业革命开始的这段科技发展的时间在历史长河中实在是过于的短暂，或许可以说这个是需求推动的科技发展？</li><li>其实对中华文明的概念越来越模糊，元朝算吗？清朝算吗？如果算的话，如果日本占领了全中国建立了满洲国，那满洲国算吗？感觉值得思考。</li><li>交通真的对稳定统治起到了极其重要的作用。</li><li>历史上撕毁协议的事情真的是屡见不鲜。</li></ul><h1>内容摘录</h1><p>本就是简史，此处不会详细记录，仅仅记录自己认为有趣的描述和事实。</p><ul><li>这本被后世基督徒称为《旧约》的，正是希伯来《圣经》，他大约成书于公元前400年或公元前500年。</li><li>《奥德赛》，这是一部历险记，主要内容说的是，希腊人英明的首领奥德赛从特洛伊返回自己的国家时，在漫长旅途中的冒险故事。</li><li>公元前六世纪，在人类历史上具有非同凡响的意义。当时，在希腊，哲学家们开始探讨人类在宇宙中的地位，在印度，释迦摩尼开始布道解惑，在中国，孔子和老子的学说广为流传。</li><li>一种盛行于雅典的高尚死法是苏格拉底的最终选择：在众目睽睽之下，喝下用有毒草类炮制而成的毒酒。</li><li>柏拉图是第一个向我们描绘“乌托邦”的人，那是一种不同于现有社会、比任何时代的社会更加美好的社会蓝图。《理想国》这本柏拉图早起的著作，讲述了一个共和主义贵族的梦想。</li><li>罗马和汉朝这两个处于同一时代的庞然大国，却对彼此一无所知。</li><li>罗马帝国之所以能崛起，主要是依仗着早期民权的意识团结了人民。罗马帝国之所以灭亡就在于他失去了意志。</li><li>公元751年中国人曾袭击撒马尔罕的阿拉伯人，然后被击败被俘获的中国人中有一批熟练的造纸行家，于是造纸的技术就这样传过来。</li><li>蒙古人对欧洲征服活动，极大的刺激了欧洲人的地理想象力。</li><li>等欧洲步入16世纪以后历史的兴趣，已经从王朝的更迭，转到了<strong>政治和社会组织实验的广泛性与多样性</strong>上。</li><li>枪炮和火药打破了住在城堡中的贵族和有城墙防护的城市的安全感，也彻彻底底地埋葬了封建制度。</li><li>一种对抗力量出现了，他避免了联邦的分裂，并在世界各地发挥着重要作用。这就是蒸汽轮船的发明以及铁路和电报的相继出现。他们拯救了美国，把分散的居民结合起来，使美国成为第一个现代化的国家。</li><li>从本质上来说，<strong>世界上任何政治协议都是暂时性的</strong>。</li><li>到了，19世纪的后半期德国科学领域的进展已经遥遥领先，每一位科研人员要是不想落伍，就一定得掌握德语，以便去进行学习。</li><li>到了19世纪以后，那些有头脑的人越来越清楚地意识到比起劳役苦工，一般平民更加可贵，必须要让他们接受教育，因为他们起码要知道自己在干什么，这样才能确保工作效率。</li><li>现在我们所说的社会主义实际上等同于一种集体主义，他允许私人占有相当数量的财产，但是教育运输矿山土地所有权重要物质的生产，则主张控制在具有高度组织性的国家手中。</li><li>为促进世界范围的繁荣十分有必要在全世界进行通畅的自由贸易，个人主义者对国家的敌意实际上就是对关税和国界设定的不满，就是对法定关税和国界限制了国际自由行为和运动的不满。</li><li>个人主义和社会主义这两个理论虽然立场完全相反，但他们共同探索着同一个问题，即为人们如何才能共同劳动这一问题找出建立在更广泛的社会和政治基础上的解决方案。</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;通俗历史的高度概括，从空间时间的起源到世界政治与社会的重建。&lt;/p&gt;</summary>
    
    
    
    <category term="Reading Note" scheme="https://blog.superui.cc/categories/reading-note/"/>
    
    
    <category term="读书" scheme="https://blog.superui.cc/tags/%E8%AF%BB%E4%B9%A6/"/>
    
    <category term="历史" scheme="https://blog.superui.cc/tags/%E5%8E%86%E5%8F%B2/"/>
    
  </entry>
  
  <entry>
    <title>Awesome Active Learning</title>
    <link href="https://blog.superui.cc/machine-learning/awesome-active-learning/"/>
    <id>https://blog.superui.cc/machine-learning/awesome-active-learning/</id>
    <published>2022-07-19T05:45:00.000Z</published>
    <updated>2022-07-19T05:45:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>This is the introduction for the <a href="https://github.com/SupeRuier/awesome-active-learning">Awesome-Active-Learning</a> project.<strong>Hope you can find everything you need about active learning (AL) in this repository.</strong></p><p>这篇博文同样有一份<strong>中文版本</strong>: <strong><a href="/machine-learning/al-all-in-one/" title="主动学习，看这一篇就够了">主动学习，看这一篇就够了</a></strong>。</p><span id="more"></span><p>This is not only a curated list, but also a well-structured library for active learning.The whole repository is constructed in a <strong>problem-orientated</strong> approach, which is easy for users to locate and track the problem.At the mean time, the techniques are discussed under the corresponding problem settings.</p><p>Specifically, this repository includes:</p><ul><li><a href="#1-what-is-al">1. What is AL?</a></li><li><a href="#2-reviewssurveysbenchmarks">2. Reviews/Surveys/Benchmarks</a></li><li><a href="#3-problem-settings">3. Problem Settings</a><ul><li><a href="#31-basic-problem-settings-three-basic-scenarios">3.1. Basic Problem Settings (Three basic scenarios)</a></li><li><a href="#32-advanced-problem-settings">3.2. Advanced Problem Settings</a></li><li><a href="#33-tasks-in-other-ai-research-fields">3.3. Tasks in other AI Research Fields</a></li></ul></li><li><a href="#4-theoretical-support-for-active-learning">4. Theoretical Support for Active Learning</a></li><li><a href="#5-practical-considerations-to-apply-al">5. Practical Considerations to Apply AL</a></li><li><a href="#6-real-world-applications-of-al">6. Real-World Applications of AL</a></li><li><a href="#7-resources">7. Resources</a><ul><li><a href="#71-software-packageslibraries">7.1. Software Packages/Libraries</a></li><li><a href="#72-tutorials">7.2. Tutorials</a></li></ul></li><li><a href="#8-groupsscholars">8. Groups/Scholars</a></li></ul><p>The hierarchical structure of this repository is shown in the following figure, and <strong>you can find the paper-list in the corresponding sub-pages</strong>:</p><p><img src="repo-structure.png" alt="Repo Structure"></p><h3 id="Shortcuts"><strong>Shortcuts</strong></h3><p>These shortcuts could quickly lead you to the information you want.</p><table><thead><tr><th>Link</th><th>Note</th></tr></thead><tbody><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/pb_classification.md">Taxonomy of Strategies</a></td><td>The types of AL strategies, in general pool-based scenario.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md">AL Aids AI</a></td><td>Use AL under other AI research problems.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_applications.md">AL Applications</a></td><td>The scientific and industrial applications of AL.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/practical_considerations.md">Practical Considerations</a></td><td>The practical issues in applying AL when the assumptions change.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/intrinsic_issues.md">Intrinsic Issues in AL</a></td><td>The intrinsic issues of AL.</td></tr><tr><td><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/deep_AL.md">Deep AL</a></td><td>AL with deep neural networks.</td></tr></tbody></table><h3 id="Contributing"><strong>Contributing</strong></h3><p>If you find any valuable researches, please feel free to <a href="https://github.com/SupeRuier/awesome-active-learning/pulls">pull request</a> or contact <a href="ruihe.cs@gmail.com">ruihe.cs@gmail.com</a> to update this repository.Comments and suggestions are also very welcome!</p><h1>1. What is AL?</h1><p>High labeling cost is common in machine learning community.Acquiring a heavy number of annotations hindering the application of machine learning methods.Active learning is one approach to relief this annotation burden.The intuition is that not all the instances are equally important to the desired task, so only labeling the more important instances might bring cost reduction.</p><p>It is very hard to find a formal definition of general AL within a single optimization function.It would be better to define specific AL under specific problem settings.Hence, we only point out the essences of AL in this section.<strong>When we talk about active learning, we talk about</strong>:</p><ul><li>an approach to reduce the annotation cost in machine learning.</li><li>the ways to select the most important instances for the corresponding tasks.</li><li>(in most cases) an interactive labeling manner between algorithms and oracles.</li><li>a machine learning setting where human experts could be involved.</li></ul><h1>2. Reviews/Surveys/Benchmarks</h1><p>There have been several reviews/surveys/benchmarks for this topic.They provided a good overview for the field.</p><p><strong>Reviews/Surveys</strong>:</p><ul><li>Active learning: theory and applications <a href="https://ai.stanford.edu/~koller/Papers/Tong:2001.pdf.gz">[2001]</a></li><li>Active Learning Literature Survey <strong>(Recommend to read)</strong><a href="https://minds.wisconsin.edu/handle/1793/60660">[2009]</a></li><li>A survey on instance selection for active learning <a href="https://link.springer.com/article/10.1007/s10115-012-0507-8">[2012]</a></li><li>Active Learning: A Survey <a href="https://www.taylorfrancis.com/books/e/9780429102639/chapters/10.1201/b17320-27">[2014]</a></li><li>Active Learning Query Strategies for Classification, Regression, and Clustering: A Survey <a href="https://link.springer.com/article/10.1007/s11390-020-9487-4">[2020]</a>[Journal of Computer Science and Technology]</li><li>A Survey of Active Learning for Text Classification using Deep Neural Networks <a href="https://arxiv.org/pdf/2008.07267.pdf">[2020]</a></li><li>A Survey of Deep Active Learning <a href="https://arxiv.org/pdf/2009.00236.pdf">[2020]</a></li><li>Active Learning: Problem Settings and Recent Developments <a href="https://arxiv.org/pdf/2012.04225.pdf">[2020]</a></li><li>From Model-driven to Data-driven: A Survey on Active Deep Learning <a href="https://arxiv.org/pdf/2101.09933.pdf">[2021]</a></li><li>Understanding the Relationship between Interactions and Outcomes in Human-in-the-Loop Machine Learning <a href="http://harp.ri.cmu.edu/assets/pubs/hil_ml_survey_ijcai_2021.pdf">[2021]</a>: HIL, a wider framework.</li><li>A Survey on Cost Types, Interaction Schemes, and Annotator Performance Models in Selection Algorithms for Active Learning in Classification <a href="https://arxiv.org/pdf/2109.11301.pdf">[2021]</a></li><li>A Comparative Survey of Deep Active Learning <a href="https://arxiv.org/pdf/2203.13450.pdf">[2022]</a></li></ul><p><strong>Benchmarks</strong>:</p><ul><li>A Comparative Survey: Benchmarking for Pool-based Active Learning <a href="https://www.ijcai.org/proceedings/2021/0634.pdf">[2021]</a>[IJCAI]</li><li>A Framework and Benchmark for Deep Batch Active Learning for Regression <a href="https://arxiv.org/pdf/2203.09410.pdf">[2022]</a></li></ul><h1>3. Problem Settings</h1><p>In this section, <strong>the specific problems which active learning is trying to solve are described</strong>.The previous works are organized in a problem-oriented order.The methods are categorized for the corresponding settings in the subpage.</p><p><strong>Three levels of problem settings</strong>:</p><ol><li>Basic Problem Settings<ul><li>Under the basic scenarios: Pool-based/Stream-based/Query synthesis</li><li>Under the basic tasks: Classification/Regression</li></ul></li><li>Advanced Problem Settings<ul><li>Under many variants of machine learning problem settings</li></ul></li><li>Tasks from other Research Fields<ul><li>With more complex tasks from other research fields</li></ul></li></ol><h2 id="3-1-Basic-Problem-Settings-Three-basic-scenarios">3.1. Basic Problem Settings (Three basic scenarios)</h2><p>There are three basic types of scenarios, almost all the AL works are build on these scenarios.The scenarios are different in where the queried instances are from:</p><ul><li><strong>pool-based</strong>: select from a pre-collected data pool</li><li><strong>stream-based</strong>: select from a steam of incoming data</li><li><strong>query synthesis</strong>: generate query instead of selecting data</li></ul><p>For the most basic AL researches, they usually study on two basic tasks:</p><ul><li>classification</li><li>regression</li></ul><p>The details and the list of works could see <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_problem.md"><strong>here</strong></a>.</p><h2 id="3-2-Advanced-Problem-Settings">3.2. Advanced Problem Settings</h2><p>There are many variants of machine learning problem settings with <strong>more complex assumptions</strong>.Under these problem settings, AL could be further applied.</p><ul><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MCAL.md">Multi-class active learning</a>: In a classification task, each instance has one label from multiple classes (more than 2).</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MLAL.md">Multi-label active learning</a>: In a classification task, each instance has multiple labels.</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MTAL.md">Multi-task active learning</a>: The model or set of models handles multiple different tasks simultaneously. For instance, handle two classification tasks at the same time, or one classification and one regression.</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MDAL.md">Multi-domain active learning</a>: Similar to multi-task, but the data are from different datasets(domains). The model or set of models handles multiple datasets simultaneously.</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MVAL.md">Multi-view/modal active learning</a>: The instances might have different views (different sets of features). The model or set of models handles different views simultaneously.</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MIAL.md">Multi-instance active learning</a>: The instances are organized into bags and training labels are assigned at the bag level.</li></ul><h2 id="3-3-Tasks-in-other-AI-Research-Fields">3.3. Tasks in other AI Research Fields</h2><p>In many AI research fields, the tasks can’t be simply marked as classification or regression.They either acquire different types of outputs or assume a unusual learning process.So AL algorithms should be revised/developed for these problem settings.Here we summarized the works which <strong>use AL to reduce the cost of annotation in many other AI research fields</strong>.</p><ul><li>Computer Vision (CV)</li><li>Natural Language Processing (NLP)</li><li>Transfer learning/Domain adaptation</li><li>Metric learning/Pairwise comparison/Similarity learning</li><li>One/Few/Zero-shot learning</li><li>Graph Processing</li><li>etc.(The full list of fields could see <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md"><strong>here</strong></a>)</li></ul><h1>4. Theoretical Support for Active Learning</h1><p>There have been many theoretical supports for AL.Most of them are focus on finding a performance guarantee or the weakness of AL selection.(This section has not finished yet.)</p><h1>5. Practical Considerations to Apply AL</h1><p>Many researches of AL are built on very idealized experimental setting.When AL is used to real life scenarios, the practical situations usually do not perfectly match the assumptions in the experiments.These <strong>changes of assumptions</strong> lead issues which hinders the application of AL.In this section, the practical considerations are reviewed under different assumptions.The details and the list of works could see <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/practical_considerations.md"><strong>here</strong></a>.</p><table><thead><tr><th>Assumption Type</th><th>Practical Considerations</th></tr></thead><tbody><tr><td>Data</td><td>Imbalanced data</td></tr><tr><td></td><td>Cost-sensitive case</td></tr><tr><td></td><td>Logged data</td></tr><tr><td></td><td>Feature missing data</td></tr><tr><td></td><td>Multiple Correct Outputs</td></tr><tr><td></td><td>Unknown input classes</td></tr><tr><td></td><td>Different data types</td></tr><tr><td></td><td>Data with Perturbation</td></tr><tr><td>Oracle</td><td>The assumption change on single oracle (Noise/Special behaviors)</td></tr><tr><td></td><td>Multiple/Diverse labeler (ability/price)</td></tr><tr><td>Workflow</td><td>Cold start</td></tr><tr><td></td><td>Stop criteria</td></tr><tr><td>Scale</td><td>Large-scale</td></tr><tr><td>Training cost</td><td>Take into account the training cost</td></tr><tr><td></td><td>Incrementally Train</td></tr><tr><td>Query types</td><td>Provide other feedbacks other than just labels</td></tr><tr><td>Performance metric</td><td>Other than the learning curves</td></tr></tbody></table><h1>6. Real-World Applications of AL</h1><p>We have introduced that AL could be used in many <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md">other AI research fields</a>.In addition, AL has already been used in many real-world applications.For some reasons, the implementations in many companies are confidential.But we can still find many applications from several published papers and websites.</p><p>Basically, there are two types of applications: <strong>scientific applications</strong> &amp; <strong>industrial applications</strong>.We summarized a list of works <a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_applications.md"><strong>here</strong></a>.</p><h1>7. Resources</h1><h2 id="7-1-Software-Packages-Libraries">7.1. Software Packages/Libraries</h2><table><thead><tr><th>Name</th><th>Languages</th><th>Author</th><th>Notes</th></tr></thead><tbody><tr><td><a href="https://github.com/google/active-learning">AL playground</a></td><td>Python(scikit-learn, keras)</td><td>Google</td><td>Abandoned</td></tr><tr><td><a href="https://github.com/modAL-python/modAL">modAL</a></td><td>Python(scikit-learn)</td><td>Tivadar Danka</td><td>Keep updating</td></tr><tr><td><a href="https://github.com/ntucllab/libact">libact</a></td><td>Python(scikit-learn)</td><td>NTU(Hsuan-Tien Lin group)</td><td></td></tr><tr><td><a href="https://github.com/NUAA-AL/ALiPy">ALiPy</a></td><td>Python(scikit-learn)</td><td>NUAA(Shengjun Huang)</td><td>Include MLAL</td></tr><tr><td><a href="https://github.com/rmunro/pytorch_active_learning">pytorch_active_learning</a></td><td>Python(pytorch)</td><td>Robert Monarch</td><td>Keep updating &amp; include active transfer learning</td></tr><tr><td><a href="https://github.com/ej0cl6/deep-active-learning">DeepAL</a></td><td>Python(scikit-learn, pytorch)</td><td>Kuan-Hao Huang</td><td>Keep updating &amp; deep neural networks</td></tr><tr><td><a href="https://github.com/ElementAI/baal/">BaaL</a></td><td>Python(scikit-learn, pytorch)</td><td>ElementAI</td><td>Keep updating &amp; bayesian active learning</td></tr><tr><td><a href="https://github.com/IBM/low-resource-text-classification-framework">lrtc</a></td><td>Python(scikit-learn, tensorflow)</td><td>IBM</td><td>Text classification</td></tr><tr><td><a href="https://github.com/webis-de/small-text">Small-text</a></td><td>Python(scikit-learn, pytorch)</td><td>Christopher Schröder</td><td>Text classification</td></tr><tr><td><a href="https://github.com/PatrickZH/DeepCore">DeepCore</a></td><td>Python(scikit-learn, pytorch)</td><td>Guo et al.</td><td>In the coreset selection formulation</td></tr><tr><td><a href="https://github.com/RelationRx/pyrelational">PyRelationAL: A Library for Active Learning Research and Development</a></td><td>Python(scikit-learn, pytorch)</td><td>Scherer et al.</td><td></td></tr><tr><td><a href="https://github.com/SineZHAN/deepALplus/"> DeepAL+</a></td><td>Python(scikit-learn, pytorch)</td><td>Zhan</td><td>An extension for DeepAL</td></tr></tbody></table><h2 id="7-2-Tutorials">7.2. Tutorials</h2><table><thead><tr><th>Title</th><th>Year</th><th style="text-align:center">Lecturer</th><th>Occasion</th><th>Notes</th></tr></thead><tbody><tr><td><a href="https://github.com/Azure/active-learning-workshop">Active learning and transfer learning at scale with R and Python</a></td><td>2018</td><td style="text-align:center">-</td><td>KDD</td><td></td></tr><tr><td><a href="https://www.youtube.com/watch?v=_Ql5vfOPxZU">Active Learning from Theory to Practice</a></td><td>2019</td><td style="text-align:center">Robert Nowak &amp; Steve Hanneke</td><td>ICML</td><td></td></tr><tr><td><a href="https://jacobgil.github.io/deeplearning/activelearning">Overview of Active Learning for Deep Learning</a></td><td>2021</td><td style="text-align:center">Jacob Gildenblat</td><td>Personal Blog</td><td></td></tr></tbody></table><h1>8. Groups/Scholars</h1><p>We also list several scholars who are currently heavily contributing to this research direction.</p><ol><li><a href="https://www.csie.ntu.edu.tw/~htlin/">Hsuan-Tien Lin</a></li><li><a href="http://parnec.nuaa.edu.cn/huangsj/">Shengjun Huang</a> (NUAA)</li><li><a href="https://sites.google.com/site/drwuHUST/publications/completepubs">Dongrui Wu</a> (Active Learning for Regression)</li><li>Raymond Mooney</li><li><a href="http://ise.thss.tsinghua.edu.cn/MIG/gyc.html">Yuchen Guo</a></li><li><a href="https://scholar.google.com/citations?hl=zh-CN&amp;user=fEhNO7YAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">Steve Hanneke</a></li></ol><p>Several young researchers who provides valuable insights for AL:</p><ul><li>Jamshid Sourati [University of Chicago]: Deep neural networks.</li><li>Stefano Teso [University of Trento]: Interactive learning &amp; Human-in-the-loops.</li><li>Xueyin Zhan [City University of Hong Kong]: Provide several invaluable comparative surveys.</li></ul>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;This is the introduction for the &lt;a href=&quot;https://github.com/SupeRuier/awesome-active-learning&quot;&gt;Awesome-Active-Learning&lt;/a&gt; project.
&lt;strong&gt;Hope you can find everything you need about active learning (AL) in this repository.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这篇博文同样有一份&lt;strong&gt;中文版本&lt;/strong&gt;: &lt;strong&gt;&lt;a href=&quot;/machine-learning/al-all-in-one/&quot; title=&quot;主动学习，看这一篇就够了&quot;&gt;主动学习，看这一篇就够了&lt;/a&gt;&lt;/strong&gt;。&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="active-learning" scheme="https://blog.superui.cc/tags/active-learning/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
  </entry>
  
  <entry>
    <title>主动学习(Active Learning)，看这一篇就够了</title>
    <link href="https://blog.superui.cc/machine-learning/al-all-in-one/"/>
    <id>https://blog.superui.cc/machine-learning/al-all-in-one/</id>
    <published>2022-07-19T04:00:00.000Z</published>
    <updated>2022-07-19T04:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<!-- omit in toc --><p>本文是对自己 <a href="https://github.com/SupeRuier/awesome-active-learning">Awesome-Active-Learning</a> 项目的一个宣传及简要介绍，不定期更新。</p><p>An <strong>English Version</strong> Of This Post: <strong><a href="/machine-learning/awesome-active-learning/" title="Awesome Active Learning">Awesome Active Learning</a></strong>.</p><span id="more"></span><h2 id="0-写在最前">0. 写在最前</h2><p>在自己对主动学习（Active Learning）的学习和研究过程中，一直断断续续收集整理了很多不同方向的文章和研究进展，日积月累，整理的内容开始完善和系统化，于是将其开源成 <a href="https://github.com/SupeRuier/awesome-active-learning">awesome active learning</a> 项目。</p><p>对于该项目，我的初衷是：维护一个<strong>包含主动学习方方面面的知识库</strong>，这样研究者和工程师可以较快锁定相关工作并展开科研。 同时，也由于个人的力量有限，希望大家可以一起对主动学习的相关进展进行追踪梳理和总结。如发现遗漏或错误，或想要增补一些新的内容，欢迎大家在该项目下 pull request 或者通过邮件 <a href="mailto:ruihe.cs@gmail.com">ruihe.cs@gmail.com</a> 联系我。知识库的整体结构如下图所示，希望大家能在这个知识库项目中找到你需要的关于主动学习的一切信息。</p><div style="width:100%;margin:auto"><img src="/machine-learning/al-all-in-one/repo-structure.png" class=""></div><p>​</p><h3 id="0-1-关于本文">0.1. 关于本文</h3><p>本文旨在对主动学习（AL）领域从一个<strong>以问题为导向</strong>的角度，展开阐述当前主动学习的研究和应用。 此处的以问题为导向包含两个方面，一是指主动学习期望解决的实际问题，二是指主动学习应用中的技术问题。 本文的重点是对这些问题进行基本的描述和文献总结，从而让大家对主动学习的适用场景有一定的认识。 一些关于理论和技术上的分类也会有所提及，但是详细内容不会在本文中展开。此外，本文不涉及列举具体场景下具体算法的文献，若阁下对所描述的问题场景有兴趣，可以移步 github 项目并查阅相关文献列表。</p><h3 id="0-2-推荐阅读的-Survey-Review">0.2. 推荐阅读的 Survey/Review</h3><p>作为一个相对成熟的领域，目前已有不少相关的文献综述和领域调研。 此处推荐以下两篇，其余的可以去我们的项目中查看完整的列表：</p><ul><li>Active Learning Literature Survey [<a href="https://minds.wisconsin.edu/handle/1793/60660">2012</a>]：作者为 Burr Settles。这是最著名也是相对较早的一篇调研，至今已有数千次引用，初步了解可以看这一篇。</li><li>A Survey on Active Deep Learning: From Model-Driven to Data-Driven [<a href="https://arxiv.org/pdf/2101.09933.pdf">2020</a>]：较新的一篇文章，主要是在技术角度对主动学习的方法进行分类，个人认为这篇文章需要在对具体问题有足够清晰地了解之后再看，否则过早陷入对技术的纠结其实不利于对领域的认知。</li></ul><h3 id="0-3-项目关键章节传送门">0.3. 项目关键章节传送门</h3><p>对于一些 <strong>AL 的关键方向</strong>，我们在此设立传送门，可以直达我们项目中的相关章节（英文版）。</p><ul><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/pb_classification.md">主动学习策略分类</a>：在 Pool-based 场景下的主要方法分类。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md">AI 中的 AL</a>：用主动学习来尝试解决 AI 各问题下的标注/查询成本昂贵问题。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_applications.md">AL 的应用方向</a>：<strong>科学研究应用</strong>和<strong>工业界应用</strong>两个方面。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/practical_considerations.md">AL 使用中的实际考虑</a>：当 AL 假设不完全成立时，或者遇到新的问题场景时如何解决。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/intrinsic_issues.md">AL 内在的问题</a>：AL 这种选取模式带来的不可避免的问题。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/deep_AL.md">深度主动学习</a>：如何在深度神经网络上使用主动学习。</li></ul><h2 id="1-什么是主动学习？（若已有背景知识可跳过）">1. 什么是主动学习？（若已有背景知识可跳过）</h2><p>监督学习问题中，存在标记成本较为昂贵且标记难以大量获取的问题。 针对一些特定任务，只有行业专家才能为样本做上准确标记。在此问题背景下，主动学习（Active Learning, AL）尝试通过选择性的标记较少数据而训练出表现较好的模型。下面是从 Burr 的 Survey 中选取的一个简单的例子，图©中使用主动学习策略仅选取30个样本作为训练集训练出的逻辑回归模型即可达到90%的准确率，而图(b)中随机选取的30个样本训练出的模型却相对表现较差。</p><div style="width:100%;margin:auto"><img src="/machine-learning/al-all-in-one/toy_example.jpg" class="" title="在一个人造数据集上主动学习策略与随机选取的对比"></div><p>从整个学习过程来看，在相同数目的标记样本下，主动学习选取的表现要好于随机选取的表现。这种可以描绘出整个学习过程的曲线也一般用于对主动学习方法进行评估。​</p><div style="width:80%;margin:auto"><img src="/machine-learning/al-all-in-one/learning_curve.jpg" class="" title="主动学习的学习曲线"></div><p>主动学习最重要的假设是不同样本对于特定任务的重要程度不同，所以带来的表现提升也不全相同。选取较为重要的样本可以使当前模型以较少的标记样本数得到较好的表现。在这一过程中，主动学习的本质是对样本的重要性（/信息度/期望带来的表现等）等进行评估。绝大多数的工作都是围绕如何评估样本来展开。</p><p>但是随着领域的发展，相关文献的增多，主动学习一词可能在强调不同的东西。<strong>总的来说，当我们谈起主动学习的时候，我们指的是</strong>：</p><ul><li>从<strong>问题</strong>的角度：通过以某种主动策略构建较小训练集来<strong>减少标记成本</strong>的机器学习方式。</li><li>从<strong>策略</strong>的角度：以某种方式对未标记<strong>样本重要性的评估</strong>。</li><li>从<strong>训练</strong>的角度：一种<strong>交互式</strong>的标记、训练、评估流程。</li></ul><h2 id="2-主动学习的问题-任务场景">2. 主动学习的问题/任务场景</h2><p>标记成本高昂的情况在很多任务下都存在，所以主动学习的潜在应用问题还是比较广泛的。本节，我们会对大部分主动学习涉及到的问题和任务场景进行简要介绍。</p><h3 id="2-1-基础问题场景">2.1 基础问题场景</h3><p>这里我们只讨论最基础的分类和回归问题。在这两类问题下，有着三种不同的主动学习场景：</p><ul><li>Pool-based scenario：此类场景通常提供一个未标记的数据池，主动学习策略在数据池中选取相应样本进行标记。</li><li>Stream-based scenario：此类场景中，数据以数据流的形式输入，主动学习策略需要确定对当前数据进行标记还是直接用现有模型预测。</li><li>Query synthesis scenario：此类场景较为少见，一个未标记的数据池通常也被提供，但是主动学习策略并不是在数据池中挑选样本进行查询，而是自行生成新样本进行查询。</li></ul><p>所以我们就有了如下几个子问题：</p><table><thead><tr><th></th><th>Pool-based</th><th>Stream-based</th><th>Query synthesis</th></tr></thead><tbody><tr><td>Classification</td><td>PB-classification (most works)</td><td>SB-classification</td><td>(rare)</td></tr><tr><td>Regression</td><td>PB-regression</td><td>SB-regression (rare)</td><td>(rare)</td></tr></tbody></table><p>其中目前据大多数的基础研究都是基于 pool-based classification，目前大多数的文献分类也是基于此问题而分类的。 此处我们以介绍清楚问题场景为主，具体对于每一个问题的具体方法，请参考：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_problem.md">Basic AL Problem Settings</a></p><h3 id="2-2-复杂问题场景">2.2 复杂问题场景</h3><p>此处的复杂主要是指任务相较于简单的分类回归任务复杂。在机器学习的领域中，有不少衍生问题，包括但不限于多分类问题，多标签问题，多任务问题。作为监督学习问题，这些问题同样可以使用主动学习来缓解标记压力：</p><ul><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MCAL.md">Multi-class active learning</a>: 在分类任务中，每个样本的标签取值可以从多种取值里选取（不小于两种）。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MLAL.md">Multi-label active learning</a>: 在分类任务中，每个样本可以同时存在多个标签。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MTAL.md">Multi-task active learning</a>: 多个任务需要被同时处理，比如同时进行两个分类任务，或同时进行一个分类和一个回归任务。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MDAL.md">Multi-domain active learning</a>: 与多任务学习较为相似，多领域学习则是在不同的领域（数据分布/数据集）上学习相同的任务。</li><li><a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/MVAL.md">Multi-view/modal active learning</a>: 多视角或多模态学习中的样本可能会有不同形式的表征。比如不同角度拍摄的同一个物品，来源于同一视频的音轨和视轨等。</li></ul><p>针对这些问题，主动学习方法一般都会有特定的适配和修改，仅仅使用简单场景上的方法可能不会有较好的表现。</p><h3 id="2-3-与其他-AI-领域结合的问题场景">2.3 与其他 AI 领域结合的问题场景</h3><p>由于篇幅限制，主动学习与 AI 结合的领域和工作可以参见以下链接：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_combinations.md">AL Aids AI</a>。</p><p>相较于之前提到的场景，AI 领域其实有不少更加复杂的问题。这些问题可能不能简单的用分类回归来表述，更多的时候是多种问题的结合。此类问题一般较为细致，定义也相对狭隘。针对这些具体问题，主动学习也有很多结合。 这些问题包括但不限于：</p><ul><li>Computer Vision (CV)<ul><li>Image Segmentation</li><li>Object Detection</li></ul></li><li>Natural Language Processing (NLP)<ul><li>Sentence Classification</li><li>Named Entity Recognition</li></ul></li><li>Domain adaptation/Transfer learning</li><li>Metric learning/Pairwise comparison/Similarity learning</li><li>One/Few/Zero-shot learning - Graph Processing</li><li>etc.</li></ul><h2 id="3-主动学习的技术角度的分类">3. 主动学习的技术角度的分类</h2><p>在上一节中我们以问题为导向介绍了绝大多数可以使用主动学习来解决的问题，可以说涵盖了大部分最重要的主动学习的相关工作。这一节的介绍并不是以问题为导向，而是从技术角度对现有方法进行分类。我们选用了两个角度：</p><ul><li>设计原理角度：希望读者对不同种策略有一定的认识。</li><li>适用模型角度：希望读者可以直接找到适用于自己模型的策略。</li></ul><h3 id="3-1-从设计原理上分类">3.1 从设计原理上分类</h3><p>这个角度是目前大部分 review/survey 的分类角度。由于很多小问题中的相关文献较少，在我们的项目中，我们在对应的问题介绍下直接对相应方法作了简要分类。本文中，我们的分类主要作用于最常见和最广泛的 Pool-based Classification 场景。绝大多数著名的主动学习工作都是在此场景下进行的。同样的，这里我们只简述设计原理，具体的文献列表参见我们项目中的<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/pb_classification.md">这一章节</a>。在这里，我们把主动学习的设计原理（i.e.主动学习对样本的评估方法）分为五大类：</p><table><thead><tr><th style="text-align:left">评估方法</th><th style="text-align:left">简述</th><th style="text-align:left">评论</th></tr></thead><tbody><tr><td style="text-align:left">Informativeness</td><td style="text-align:left">一般来说指模型对选取样本取值的不确信程度</td><td style="text-align:left">忽略了数据分布的影响</td></tr><tr><td style="text-align:left">Representativeness-impart</td><td style="text-align:left">考虑了选取样本是否可以对数据分布起到代表作用</td><td style="text-align:left">通常来说和informativeness一起使用，此类方法和批选取方法可能会有重叠</td></tr><tr><td style="text-align:left">Expected Improvements</td><td style="text-align:left">考虑选取样本能为当前模型带来多少性能提升</td><td style="text-align:left">此类评估通常较为耗时</td></tr><tr><td style="text-align:left">Learn to score</td><td style="text-align:left">不人为启发式地设计选取策略，而是学习一个选取策略</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">Others</td><td style="text-align:left">有一些工作较难分类到上述的类别中</td><td style="text-align:left"></td></tr></tbody></table><p>此处我们也列出这几类方法之下的小类：</p><ul><li>Informativeness<ul><li>Uncertainty-based sampling</li><li>Disagreement-based sampling</li></ul></li><li>Expected Improvements</li><li>Representativeness-impart sampling<ul><li>Cluster-based sampling</li><li>Density-based sampling</li><li>Alignment-based sampling</li><li>Expected loss on unlabeled data</li></ul></li><li>Learn to Score</li><li>Others</li></ul><p>此外，批选取的方法（batch active learning）也有众多研究，其与 representativeness-impart sampling 有一定的交叉，具体可以参阅以下链接：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/batch_mode.md">Batch mode</a></p><h3 id="3-2-从适用模型上分类">3.2 从适用模型上分类</h3><p>很多种主动学习选取策略都标榜自己是全模型通用（model-free）的，但是实际使用中，他们可能仅仅适用于一个或一类模型（model-dependent）。此处我们总结了一些 model-dependent 的策略在特定模型上的工作。由于业界的模型实在是过于多样，此处我们仅归纳了几类常用模型，且工作并不一定很全，之后这个章节也会更新。具体的文献列表请查阅我们项目中的<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_technique_models.md">这一章节</a>。</p><p>这里我们仅列出一些我们总结到的模型：</p><ul><li>SVM/LR</li><li>Bayesian/Probabilistic Models</li><li>Gaussian Progress</li><li>Decision Trees</li><li>Neural Network</li></ul><p>此外，如何设计适用于神经网络的主动学习策略和框架也是一个比较重要的问题。我们也对相关的深度主动学习进行了调研，详情请查阅以下链接：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/deep_AL.md">AL with Models</a></p><h2 id="4-将-AL-应用时的实际考虑">4. 将 AL 应用时的实际考虑</h2><p>我们之前讨论的是主动学习可以应用于什么问题场景，本节我们讨论的是实际应用主动学习的时候可能会遇到什么技术问题。具体的内容列表请查阅我们项目中的这一章节：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/practical_considerations.md">Practical Considerations</a></p><p>简要来说，大部分的主动学习工作对数据，标注专家，问题规模等都是有着一般性的假设。比如“在一个几千样本上的平衡分类问题中，可以通过询问一个准确率百分之百的标注专家来获得标注数据”。但是这些假设在实际运用中可能并不总能保真，所以本节我们纳入了很多对实际问题的考虑。</p><p>具体的考虑如下：</p><ul><li>Data (imbalanced, biased, feature missing, etc.</li><li>Oracles (multiple labeler, diverse labeler, etc.)</li><li>Scale (large-scale)</li><li>Workflow (cold start problem, stop criteria, etc.)</li><li>Model training cost</li><li>Query/feedback types</li><li>Performance metric</li><li>Robustness</li><li>More assumptions</li></ul><p>可以说在这些问题上的研究拉近了主动学习到实际运用的距离。</p><h2 id="5-AL-的实际应用">5. AL 的实际应用</h2><p>主动学习已经是一个较为成熟的技术，已经有很多研究工作将其应用于不同学科和领域。 这里我们将其分为两部分：科学研究应用和工业界应用。 具体的文献列表请查阅以下链接：<a href="https://github.com/SupeRuier/awesome-active-learning/blob/master/contents/AL_applications.md">AL Applications</a></p><h3 id="5-1-科学研究应用">5.1 科学研究应用</h3><p>目前的工作主要聚焦于以下几个学科：</p><ul><li>Biology</li><li>Materials</li><li>Astronomy</li><li>Chemistry</li><li>Math and Statistics</li><li>Geology</li><li>Experiment Design / Experimental Condition Selection</li></ul><h3 id="5-2-工业界应用">5.2 工业界应用</h3><p>工业界应用相对较广泛，此处列举几个较为常用的领域，其他内容请参阅我们的项目。</p><ul><li>Remote Sensing</li><li>Medical Research</li><li>Drug Discovery</li><li>Labeling System</li><li>Spam Detection</li><li>etc.</li></ul><h2 id="6-相关资料">6. 相关资料</h2><h3 id="6-1-软件包">6.1 软件包</h3><p>在github上已经有不少基于Python的主动学习软件包：</p><table><thead><tr><th>Name</th><th>Languages</th><th>Author</th><th>Notes</th></tr></thead><tbody><tr><td><a href="https://github.com/google/active-learning">AL playground</a></td><td>Python(scikit-learn, keras)</td><td>Google</td><td>Abandoned</td></tr><tr><td><a href="https://github.com/modAL-python/modAL">modAL</a></td><td>Python(scikit-learn)</td><td>Tivadar Danka</td><td>Keep updating</td></tr><tr><td><a href="https://github.com/ntucllab/libact">libact</a></td><td>Python(scikit-learn)</td><td>NTU(Hsuan-Tien Lin group)</td><td></td></tr><tr><td><a href="https://github.com/NUAA-AL/ALiPy">ALiPy</a></td><td>Python(scikit-learn)</td><td>NUAA(Shengjun Huang)</td><td>Include MLAL</td></tr><tr><td><a href="https://github.com/rmunro/pytorch_active_learning">pytorch_active_learning</a></td><td>Python(pytorch)</td><td>Robert Monarch</td><td>Keep updating &amp; include active transfer learning</td></tr><tr><td><a href="https://github.com/ej0cl6/deep-active-learning">DeepAL</a></td><td>Python(scikit-learn, pytorch)</td><td>Kuan-Hao Huang</td><td>Keep updating &amp; deep neural networks</td></tr><tr><td><a href="https://github.com/ElementAI/baal/">BaaL</a></td><td>Python(scikit-learn, pytorch)</td><td>ElementAI</td><td>Keep updating &amp; bayesian active learning</td></tr><tr><td><a href="https://github.com/IBM/low-resource-text-classification-framework">lrtc</a></td><td>Python(scikit-learn, tensorflow)</td><td>IBM</td><td>Text classification</td></tr><tr><td><a href="https://github.com/webis-de/small-text">Small-text</a></td><td>Python(scikit-learn, pytorch)</td><td>Christopher Schröder</td><td>Text classification</td></tr><tr><td><a href="https://github.com/PatrickZH/DeepCore">DeepCore</a></td><td>Python(scikit-learn, pytorch)</td><td>Guo et al.</td><td>In the coreset selection formulation</td></tr><tr><td><a href="https://github.com/RelationRx/pyrelational">PyRelationAL: A Library for Active Learning Research and Development</a></td><td>Python(scikit-learn, pytorch)</td><td>Scherer et al.</td><td></td></tr><tr><td><a href="https://github.com/SineZHAN/deepALplus/"> DeepAL+</a></td><td>Python(scikit-learn, pytorch)</td><td>Zhan</td><td>An extension for DeepAL</td></tr></tbody></table><h3 id="6-2-Tutorials">6.2 Tutorials</h3><p>之前也有一些关于主动学习的研讨班内容：</p><ul><li><a href="https://github.com/Azure/active-learning-workshop">active-learning-workshop</a>: KDD 2018 Hands-on Tutorial: Active learning and transfer learning at scale with R and Python</li><li><a href="https://www.youtube.com/watch?v=_Ql5vfOPxZU">Active Learning from Theory to Practice</a>: ICML 2019 Tutorial.</li><li><a href="https://jacobgil.github.io/deeplearning/activelearning">Overview of Active Learning for Deep Learning</a>: Jacob Gildenblat.</li></ul><h3 id="6-3-领域内研究学者">6.3 领域内研究学者</h3><p>参见我们的<a href="https://github.com/SupeRuier/awesome-active-learning#8-groupsscholars">项目</a>，排名不分先后（有待补充）</p>]]></content>
    
    
    <summary type="html">&lt;!-- omit in toc --&gt;
&lt;p&gt;本文是对自己 &lt;a href=&quot;https://github.com/SupeRuier/awesome-active-learning&quot;&gt;Awesome-Active-Learning&lt;/a&gt; 项目的一个宣传及简要介绍，不定期更新。&lt;/p&gt;
&lt;p&gt;An &lt;strong&gt;English Version&lt;/strong&gt; Of This Post: &lt;strong&gt;&lt;a href=&quot;/machine-learning/awesome-active-learning/&quot; title=&quot;Awesome Active Learning&quot;&gt;Awesome Active Learning&lt;/a&gt;&lt;/strong&gt;.&lt;/p&gt;</summary>
    
    
    
    <category term="Machine Learning" scheme="https://blog.superui.cc/categories/Machine-Learning/"/>
    
    
    <category term="active-learning" scheme="https://blog.superui.cc/tags/active-learning/"/>
    
    <category term="machine-learning" scheme="https://blog.superui.cc/tags/machine-learning/"/>
    
  </entry>
  
  <entry>
    <title>浪潮之巅</title>
    <link href="https://blog.superui.cc/reading-note/top-of-the-wave/"/>
    <id>https://blog.superui.cc/reading-note/top-of-the-wave/</id>
    <published>2022-06-14T15:10:00.000Z</published>
    <updated>2022-06-14T15:10:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>一本介绍大型科技公司浪潮起落的书。</p><span id="more"></span><h2 id="作者">作者</h2><p>吴军</p><h2 id="内容简介">内容简介</h2><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>一本了解世界互联网产业发展的必读书籍。以浪潮反应产业的起伏，对于个人择业或者行业研究有着一定的参考价值。</p><h3 id="感想看法">感想看法</h3><ol><li>这本书还是有些过时，很多内容需要更新。比如微软和苹果公司的关系。</li><li>竟然还写了红杉资本的联系方式，有趣。</li><li>由于Google 很明智地没有在互联网泡沫高峰期疯狂地扩展，而是实实在在地、低调地做好自己的搜索引擎，因此它早期烧钱的速度非常之慢。2000 年的时候它没有急着上市，避免了绝大多数互联网公司大起大落并且最终关门的厄运，同时最早期的优秀人才没有拿了钱就走掉，因此Google 的骨干完好无损。感觉这个可以用来研究没来得及上市的蚂蚁金服的发展上。</li><li>制定规则的重要性一次次体现。</li><li>让人思考商业模式和技术的权衡，或许商业模式更加重要。</li><li>一个巨大的公司拓展新生代业务看起来还是比较难的。</li><li>与大学的合作研发看起来性价比极高，远高于自建独立实验室。</li><li>对于商业来说，技术并不是最重要的。</li><li>“存在即合理”，的确能不断的找到这句话的印证。</li><li>创业公司的员工或许都能以一当十？</li><li>其中有很多华为公司的部分，当时华为并不像现在一样人尽皆知，但是业内已经是名声响亮了。华为的成功有其必然性，其创办之初就剑指最先进的技术而不是二流技术。</li><li>流量并不是一切，很多中国的公司证明了这一点，无数次的烧钱没有转化为实际收入，都只是抱薪救火。所以说商业模式，预期产值或许更重要。</li><li>公司的掌舵人决策者实在是太为重要了。</li><li>技术并不是无敌的。</li><li>身体真的是创业者最大的本钱。今日孙剑博士去世，不由得重新感慨这一点。R.I.P.</li><li>业绩下滑时，裁员是很明智的决策。</li><li>革命是创业的重要部分，而不紧紧是“进化”。风投，或者说创业者（创业其实是在风投自己），要能准确的评估技术及其前景。</li><li>当公司已经足够大的时候，其市场占有率（增长前景）就难以翻番了。</li><li>斯坦福的校友组织的确比较有趣。</li><li>投资人对于公司的影响极大，公司总是要对股东负责。</li><li>2B 产品受经济大环境的影响太大，收入相对不如 2C 产品来得稳定。这个可能在经济周期中有一定的指导意义。</li><li>资金利用率&amp;自动化程度对企业的经济效益影响极大。</li><li>近期吹嘘了很多 web3.0 的概念，个人并不太知道这是什么。目测是一种元宇宙+数字货币+vr的一种缝合怪结合体？我们回顾 web2.0（打造通用平台，再由社会上的开发力量和广大用户补充内容），web3.0 的口号目前仍是以技术为导向还不是以问题和需求为导向，似乎就有一点像 web2.0 真正意义出现之前的那一波噱头了。那到底什么是 web3.0 呢？</li><li>个人一向推崇经济和金融的意义，因为他们对于实体经济起到了不可替代的资源调度作用。虽然还有很多逐利的资金追求泡沫和杀猪盘，但是仍然不能因此忽略它的绝大多数的积极意义。</li><li>当总有什么新词新指标来为新东西背书的时候，可能要留心这是不是一个泡沫了。</li><li>危机之下，求生或许是所有公司的本能，成功断臂求生可能才有未来的发展。</li><li>很多看似无关的技术都或许会因为一个产业结合在一起，整体还是要看产业对社会的效率有多大的提升。</li><li>有一些东西对用户而言的沉没成本极高，即使有更好用的新东西，也不会轻易转换。</li><li>有意思的是，作者指出“阿里巴巴只要它不犯大的错误，现在找不出一家公司可以挑战它的商业地位”。然后我们都知道，他犯了大的错误。然而这个错误真的是错误吗？见仁见智，只能说他过于自大却忘记了国内的监管环境，所以才有了后来的制裁。</li><li>“因果倒置”这种事情有时候还真的不一定能分辨出。所以马云的电子商务是因还是果呢？或许互为因果，但是很多时候要追究事物发生的原因。</li><li>不靠泡沫挣钱的时候，经济体才能繁荣发展。</li></ol><h1>内容摘录</h1><h2 id="ATT">ATT</h2><ul><li>ATT 不紧不慢地向上走过了百年，才爬到顶点，走下坡路却只要十年时间。（注：今天的 ATT 是由当年小贝尔公司之一的西南贝尔公司几次以小吃大合并出的类似于水电公司的设施服务公司，这类公司在美国统统称为 utility 公司，毫无技术可言。）</li><li>在很长的时间里，美国国际长途电话的价钱不是由市场决定的，而是由 ATT 和美国联邦通信委员会（FCC）谈判决定的</li><li>ATT 的总裁们并不真正拥有公司。他们之中不乏有远见者，但是根本左右不了董事会。</li><li>一般来讲，一个公司当前的股价，已经反映了当前和几年后的盈利能力。如果想让股价快速增长，公司的盈利就必须高于大家的预期</li><li>在工业史上，一种新技术代替旧的技术是不以人的意志为转移的。人生最幸运之事就是发现和顺应这个潮流。</li></ul><h2 id="IBM">IBM</h2><ul><li>IBM 公司可能是世界上为数不多的成功地逃过历次经济危机，并且在历次技术革命中成功转型的公司。</li><li>IBM 能成为科技界的常青树，要归功于它的二字秘诀——保守。毫无疑问，保守使得 IBM 失去了无数发展机会，但是也让它能专注于最重要的事，并因此而立于不败之地。</li><li>我们可以将第二次世界大战作为机械时代和电子时代的分水岭。</li><li>社会的需求对科技进步的作用要超过十所大学。计算机就是在这个背景下被发明的。美国研制计算机的直接目的是在第二次世界大战时为军方计算弹道的轨迹。在流体力学中，计算量常常大到手工的计算尺无法计算的地步，因此，对通用计算机的需求就产生了。</li><li>在我个人看来，小华生对世界最大的贡献不是将 IBM 变成一个非常成功的公司，而是将计算机从政府部门和军方推广到民间，将它的功能由科学计算变成商用。</li><li>IBM PC 第一年的营业额大约是两亿美元，只相当于 IBM 当时营业额的 1% 左右，而利润还不如谈下一个大合同。要知道，卖掉十万台 PC 可比谈一个大型机合同费劲儿多了。因此，IBM 不可能把 PC 事业上升到公司的战略高度来考虑。</li><li>因为 IBM PC 的主要部件，如处理器芯片、磁盘驱动器、显示器和键盘等等，或者本身是第三家公司提供的、或者很容易制造，而它的操作系统 DOS 又是微软的。因此，IBM PC 很容易仿制。IBM PC 唯一一个操作系统的内核 BIOS 是自己的，但是很容易地就被破解了。在短短地几年间， IBM PC 的兼容机入雨后春笋般地冒了出来。</li><li>盖茨可不是一般的人，他的心志非常高远，他不会允许别人动微机软件这块大蛋糕，虽然此时的微软的规模远没法和 IBM 相比。盖茨明修栈道，暗渡陈仓，一方面和 IBM 合作开发 OS/2 ，挣了一点短期的钱，另一方面下大力气开发视窗操作系统（Windows）</li><li>到八十年代末，由于微机性能每十八个月就翻一番，微机慢慢开始胜任以前一些必须要大型机才能做的工作。这样，微机开始危及到大型机的市场。 IBM 出现了严重的亏损，有史以来第一次开始大规模裁员。</li><li>1993 年，从未在 IBM 工作过的郭士纳受命危难，出任 IBM 的首席执行官。他成功地完成了 IBM 从一个计算机硬件制造公司到一个以服务和软件为核心的服务性公司的转变，复兴了这个百年老店，并开创了 IBM 的十年持续发展。他的第一招用他自己的话讲是将 IBM 溶解掉，通俗地讲，就是开源节流。他首先裁掉了一些冗余的部门和一些毫无前途的项目。</li><li>对比几乎同时代 ATT 将公司拆分的做法，郭士纳完全是反其道而行之。他的目的是打造一只 IT 服务业的航空母舰。在公司内部，它引入竞争机制，一个项目可能有多个组背靠背地开发。为了防止互相拆台、加强合作，郭士纳将每个人的退休金和全公司的、而不是以前的各部门的效益挂钩。</li><li>郭士纳砍掉了一些偏重于理论而没有效益的研究，并且将研究和开发结合起来。一旦一个研究项目可以实用了，他就将整个研究组从实验室挪到产品部门。到后期，他甚至要求 IBM 的所有的研究员必须从产品项目中挣一定的工资。这种做法无疑很快地将研究转化成产品。但是这样做无疑会影响 IBM 长线研究和基础研究，为了弥补这方面的损失，IBM 加强了和大学的合作，在几十所大学开展了科研合作或者是设立了奖学金。</li><li>今天，IBM 成为了世界上最大的开源操作系统 Linux 服务器的生产商。</li><li>IBM 就是这样，时不时地调整内部结构，将一些非核心的、长期效益不好的部门卖掉，同时扩大核心的利润高的生意。</li><li>今天，它仍然是世界上人数最多、营业额和利润最高的技术公司。在可以预见的未来，它会随着科技发展的浪潮顺顺当当地发展，直到下一次大的技术革命。</li></ul><h2 id="Apple">Apple</h2><ul><li>麦金托什是世界上第一种可以买得到的、拥有交互式图形界面并且使用鼠标的个人电脑。它的硬件部分性能略优于同期的 IBM PC 机，而它的操作系统领先当时 IBM-PC 的操作系统 DOS 整整一代。</li><li>苹果的股票九十年代开始是上升的，这就是电影中的阿甘觉得持有了苹果的股票就不用为钱发愁的原因。如果那个电影晚拍几年，导演就不得不找另一家公司的股票给阿甘了。</li><li>我和硅谷很多创业者聊过，发现他们对自己的公司，哪怕再小的公司，在感情上也象对自己的孩子一样亲。</li><li>他已经认识到了苹果封闭式的软硬件，从成本上讲，无法和微软加兼容机竞争，也无法为用户提供丰富的应用软件。乔布斯做了两件事，他在苹果的微机中逐渐采用了英特尔的通用处理器，同时采用 Free BSD 作新的苹果操作系统的内核。这样相对开放的体系使得全社会大量有兴趣的开源工程师很容易地为苹果开发软件。</li><li>乔布斯看到了两点最重要的事实，第一，虽然已经有了不少播放器，但是做的都不好，尤其是当音乐数量多了以后，查找和管理都很难。要知道，从一千首歌里面顺序找到自己想听的可能要花几分钟时间。另外，要把自己以前买的几十张 CD 上的歌倒到播放器上更是麻烦；第二，广大用户已经习惯戴着耳机从播放器中听歌而不是随身带着便携的 CD 唱机和几十张光盘。因此，它不需要花钱和时间培养出一个市场。基于这两点的考虑，乔布斯决定开发被称为 iPod 的音乐和录像播放器。</li><li>虽然它六百美元的价格实在贵了点，但是根据电器十八个月降一半价钱的规律，iPhone 很有可能成为今后普及的手机，成为苹果即 iPod 以后新的成长点，它甚至会冲击传统的手机行业。</li></ul><h2 id="计算机工业的生态链">计算机工业的生态链</h2><ul><li>现在，每十八个月，计算机等 IT 产品的性能会翻一番；或者说相同性能的计算机等 IT 产品，每十八个月价钱会降一半。虽然，这个发展速度令人难以置信，但几十年来 IT 行业的发展始终遵循着摩尔定理预测的速度。</li><li>个人电脑工业整个的生态链是这样的：以微软为首的软件开发商吃掉硬件提升带来的全部好处，迫使用户更新机器让惠普和戴尔等公司收益，而这些整机生产厂再向英特尔这样的半导体厂订货购买新的芯片、同时向 Seagate 等外设厂购买新的外设。在这中间，各家的利润先后得到相应的提升，股票也随着增长。各个硬件半导体和外设公司再将利润投入研发，按照摩尔定理制定的速度，提升硬件性能，为微软下一步更新软件、吃掉硬件性能做准备。华尔街的投资者都知道，如果微软的开发速度比预期的慢，软件的业绩不好，那么就一定不能买英特尔等公司的股票了。</li><li>反摩尔定理使得 IT 行业不可能像石油工业或者是飞机制造业那样只追求量变，而必须不断寻找革命性的创造发明。因为任何一个技术发展赶不上摩尔定理要求的公司，用不了几年就会被淘汰。</li><li>有些愿意冒风险而追求高回报的投资家将钱凑在一起，交给既懂得理财又懂得技术的专业人士打理，投给有希望的公司和个人，这就渐渐形成了美国的风险投资机制。办好一个高科技公司还需要有既志同道合又愿意承担风险的专业人才，他们对部分拥有一个公司比相对高的工资更感兴趣，因此就有了高科技公司员工的期权制度。</li></ul><h2 id="奔腾的芯：英特尔－Intel">奔腾的芯：英特尔－Intel</h2><ul><li>1981 年，IBM 为了短平快地搞出 PC，也懒得自己设计处理器，拿来英特尔的 8086 就直接用上了。这一下子，英特尔一举成名。</li><li>美国历史频道（History Channel）在节目中评论了中日甲午战争。美国的历史学家认为，这是两个不同时代军队之间的战争，虽然双方武器相差不多，战争的结果不会有任何悬念，因为一个在专制的农业时代后期的军队很难打赢一个兴起的工业化国家的军队。英特尔和摩托罗拉之间的竞争也是如此。</li><li>市场的倾向说明了用户对兼容性的要求比性能更重要。因此，英特尔在精简指令上推出 80960 后，就停止了这方面的工作，而专心做&quot;技术落后&quot;的复杂指令系列。在整个九十年代，工业界只有英特尔一家坚持开发复杂指令集的处理器，对抗着整个处理器工业。</li><li>总的来讲，英特尔并没有想彻底把 AMD 打死。因为留着 AMD 对它利大于弊。首先，它避免了反垄断的很多麻烦。</li><li>个人认为，在个人微机以外，今后最重要的市场是游戏机市场。现在的游戏机早已不单单是为玩游戏设计的了，它们成为每个家庭的娱乐中心。IBM 等公司至少在目前在这个领域是领先的。IBM 已经垄断了任天堂、Sony 和微软三大游戏机的处理器市场。</li><li>英特尔对世界最大的贡献在于，它证明了处理器公司可以独立于计算机整机公司而存在。在英特尔以前，所有计算机公司都必须自己设计处理器，这使得计算机成本很高，而且无法普及。</li></ul><h2 id="IT业的罗马帝国：微软－Microsoft">IT业的罗马帝国：微软－Microsoft</h2><ul><li>我在学校的老板贾里尼克院士以前在IBM当任要职，因此我们经常去IBM作报告，每次去以前贾里尼克都要确认我们报告的每一页内容是已经公开发表过的。原因很简单，IBM有世界上最好的科学家和工程师，他们可以用比你还快的速度将你没有发表的想法实现、申请专利并发表。</li><li>在这次双雄会上，乔布斯犯下的错误有两方面，首先，他自己没有意识到操作系统在今后整个微机工业中的重要性，否则他不会过早地给别人看他还没上市的设计；第二，也是更重要的，他给谁看都可以，就是不该给盖茨这个人看。</li><li>完成了在研发上的布局，盖茨要在市场上尽可能用它落后的DOS坚持到微软新一代操作系统开发出来。微软的做法概括起来是两句话，薄利多销和来者不拒。</li><li>但是，领先下的苹果犯了一个致命的错误–走封闭式道路和纯技术路线。当IBM因为反垄断的限制，不得不容忍兼容机厂家克隆自己的产品并抢走越来越多市场时，苹果正在为自己没有遇到同样的麻烦而高兴。</li><li>苹果既做硬件又做软件，很难平衡两者的速度。软件做得太快了硬件就跟不上，硬件做的太快了有没有合适的软件可用。在历史上，苹果有几款计算机一推出来时速度就已经落后了；还有几款比如早期PowerPC推出来时速度奇快但没有什么应用软件可用。</li><li>网景选择了和微软一拼，因为它觉得至少目前它还有技术和市场上的优势。后来证明这种技术上的优势根本不可靠，这也是我将技术排在形成垄断的三个条件之外的原因。</li><li>如果说乔布斯是锋芒毕露，聪明写在脸上；盖茨就是一个平衡木冠军，聪明藏在肚子里。</li><li>微软打败网景和Real Network等公司的绝招是免费提供和对手竞争的产品。但是这一招对雅虎不灵，因为雅虎的服务本身就是免费的。</li><li>公司增发期权不计入成本。因此，雅虎不断地增发期权给员工，而只需付给员工很少的现金工资。员工手中的股票期权，在华尔街的炒作下，以火箭速度往上涨</li><li>我非常喜欢黑格尔地一句话：凡是现实的都是合理的，凡是合理的都是现实的。(All that is real is rational; and all that is rational is real.)虽然这句话常常被误解成为当今不合理的现实来开脱，其实，如果我们动态地看待现实性和合理性，可以把这句话理解成，现在存在的现象，当初产生它的时候必然有产生它的原因和理由。如果这个理由将来不存在了，终究有一天它也会消亡。</li><li>进入新的世纪以来，微软的行动明显放慢，它的扩张一再受阻。但是，个人微机的这次浪潮还没有过去，处在其浪潮之巅的微软即使不做任何事，仍然是世界上最赚钱的公司。它始终是所有公司最可怕的竞争对手。它能否成功地第二次创业，很大程度上取决于客厅信息化是否能形成下一次技术革命的浪潮，而它又是否能在客厅争夺战中最终胜出。</li></ul><h2 id="互联网的金门大桥：思科">互联网的金门大桥：思科</h2><ul><li>一个成功的公司的早期员工是非常宝贵的财富。他们一般是一些非常爱冒险的人，否则他们不会选择加入新开办的甚至是还没有投资的小公司，他们技术和能力非常强，常常每个人可以独挡一面，因为早期的公司要求员工什么都得能干。</li><li>但是，他们也有他们的弱点。他们虽然善于开创，但不善于或者不愿意守成，而后者对于一个大公司发展至关重要。他们做事快，但是不够精细，因为在公司很小时，抢时间比什么都重要。</li><li>如何留住早期员工，并且调动他们的积极性，便成为了每一个上市的科技公司的难题。</li><li>华为公司比思科成立晚四年，早于 Juniper 八年。华为创办时起点就很高，当时邮电部下面的一些研究所还在和 ATT 等跨国公司谈二流技术的转让和合作，任正非直接就定位当时国际上最先进的技术，并且短短几年就开发出了当时具有国际先进水平的 08 程控交换机。</li><li>一旦一项产品可以由中国制造，那么它的利润空间就会薄到让美欧公司退出市场。现在，思科和华为的竞争就是在这种阴影笼罩下。</li></ul><h2 id="英名不朽：杨致远、菲洛和雅虎公司">英名不朽：杨致远、菲洛和雅虎公司</h2><ul><li>雅虎及其追随者们，不仅把互联网办成了开放、免费和盈利的，而且刺激了电子商务的诞生。</li><li>但是大多数创业者连产值都不考虑，觉得只有有了流量就有了一切，今天仍然有人持这种观点。</li><li>雅虎对网络泡沫的形成起到了推波助澜的作用。虽然它自己没有直接烧投资者的钱，但是无数小网络公司都是靠烧钱在维持，这如同抱薪救火，薪不尽火不灭。</li><li>到2000年大选后，终于没有新的投入进来了，互联网泡沫应声而灭。</li><li>一个技术公司，无论是过去的ATT，还是现在的Google，都会尽可能地采用技术而不是人工来解决问题，当然所有的技术都有自己的局限性和不足，一个崇尚技术的公司的态度是解决这些问题而不是倒退到手工操作。至今，雅虎仍然会手工地调整搜索结果，和Google完全用计算机排名不同。</li></ul><h2 id="硅谷的见证人：惠普公司">硅谷的见证人：惠普公司</h2><ul><li>虽然惠普从来没有领导过哪次技术革命的浪潮，但是作为硅谷最早的公司，惠普见证了硅谷发展的全过程，从无到有，从硬件到软件，惠普的历史从某种程度上讲就是硅谷历史的缩影。</li><li>这种现象在投资大师巴菲特看来是很荒唐的，安捷伦疯涨，说明惠普卖赔了，惠普应该跌才是。</li><li>惠普的墨盒和吉列的刀片有个很大的区别。刮胡子刀片是一分价钱一分货，吉列的刀片比廉价低质量的确实好不少，而且刮胡子刀片是一种特殊的商品，对它的马虎不得，用一个劣质刀片刮破脸可不是件好玩的事。</li><li>如果一个公司不能挑选好掌舵人，以后替换掉他成本也是很高的。</li></ul><h2 id="没落的贵族：摩托罗拉">没落的贵族：摩托罗拉</h2><ul><li>过分注重技术和品质使得摩托罗拉在商业上的灵活性远不如诺基亚和三星等竞争对手。</li><li>摩托罗拉对世界最大的贡献是它在八十年代初发明的民用蜂窝式移动电话，也就是早期说的大哥大，现在说的手机。</li><li>美国在标准之争上的失败间接影响的摩托罗拉手机今后的竞争力。</li><li>摩托罗拉长期以来都是一个了不起的技术公司，它长于技术，但是过分相信技术的作用。铱星计划在技术上是无与伦比的，但是，过于超前市场的技术不仅导致成本过高，而且维护费用也是巨大的。</li><li>摩托罗拉试图打造一个通用的操作系统作为它今后手机开发的统一的平台。这个想法本来不错，但是摩托罗拉选错了平台，选中了 Java 。</li></ul><h2 id="硅谷的另一面">硅谷的另一面</h2><ul><li>坦率地讲，我对这些沉溺于创业梦想的人泼凉水的时候多于鼓励的时候。虽然我知道他们更需要鼓励，但是在硅谷这个环境中，他们已经得到了无数的鼓励。</li><li>创业者还必须精力过人，因为他们必须能熬得住几年每天在简陋的车库里工作 16-20 小时的苦日子。他们又必须是多面手，因为在创业初期他们必须干所有的脏活。</li><li>但是光有好的团体和技术又远远不够，他们有商业头脑而且必须找到一个能盈利的商业模型（Business Model）</li><li>硅谷几十年经验证明，那些初出茅庐能干具体事情的年轻人，可能比一个经验丰富但是已经眼高手低的权威对公司更有用。</li><li>由于 FDA 的保护，创业的小公司要打破原有制药公司的垄断是件很难的是。这就是我们很难看到小的生物公司成功的原因。</li></ul><h2 id="短暂的春秋：与机会失之交臂的公司">短暂的春秋：与机会失之交臂的公司</h2><ul><li>太阳和微软之争，其实就是企业级的操作系统之争。对太阳来讲，取胜的关键在于是否能将它在 Unix 上的技术优势转换为市场优势。</li><li>太阳公司当时不自觉地满足于捏 SGI、DEC 和 HP 这些软柿子、并沉溺于在硬件市场上的胜利，忽视了来自微软的威胁。但当 2000 年互联网泡沫破碎时，它以服务器和工作站为主的硬件业务便急转直下。</li><li>施密特当时是太阳公司主管软件的副总裁，他从太阳失败的教训中总结出了反摩尔定理，我们已经介绍过。施密特认识到依靠硬件的利润是不断下降的，而 IT 服务业的利润则是恒定的（并随着通货膨胀而略有增加）。</li><li>当大量杰出人才离开、同时公司业绩大幅下滑时，马可尼里没有果断地大量裁员。他总给自己一个借口，我们好不容易招到这么多人（在网络泡沫时代，找工程师是很难的），如果现在裁掉冗员，万一市场好起来，我从哪里去招人。</li><li>这正应了茨威格的话，在命运降临的伟大瞬间，市民的一切美德——小心、顺从、勤勉、谨慎，都无济于事，它始终只要求天才人物，并且将他造就成不朽的形象。命运鄙视地把畏首畏尾的人拒之门外。命运——这世上的另一位神，只愿意用热烈的双臂把勇敢者高高举起，送上英雄们的天堂。</li><li>网景选择了和微软一拼，因为它觉得至少目前它还有技术和市场上的优势。后来证明这种技术上的优势根本不可靠，这也是我将技术排在形成垄断的三个条件之外的原因。在微软方面，它也正式向网景公司宣战。</li><li>网景公司在它的浏览器畅销到网络用户时，没有居安思危，它没有注意去控制互联网的内容，这样一来它失去了保护自己和反击微软的可能性。本来它最有可能成为雅虎。</li><li>即使最初网景看不到索引和组织互联网内容的重要性，但是到 1994 年底，当雅虎的流量首次达到一百万次访问时，网景也应该意识到这一点了。如果那时候网景公司走门户网站（Portal）之路，没有人能阻挡它成为后来的雅虎。</li></ul><h2 id="幕后的英雄：风险投资">幕后的英雄：风险投资</h2><ul><li>高回报的投资一定伴随着高风险，但反过来高风险常常并不能带来高回报。任何一种长期赚大钱的金融投资必须有它内在的动力做保证。风险投资也是一样，它内在的推动力就是科技的不断发展进步。</li><li>风险投资的关键是能够准确评估一项技术，并预见未来科技的发展趋势。</li><li>我通常把科技进步和新的商业模式分成进化（Evolution）和革命（Revolution）两种，虽然它们的英文单词只差一个字母，意义可差远了。创业必须要有革命性的技术或者革命性的商业模式。</li><li>风投公司介入一个新兴公司后的第一个角色就是做顾问。这个顾问不仅需要在大方向比如商业上给予建议，而且还要在很多小的方面帮助创始人少走弯路。</li><li>一个风投公司要想成功，光有钱，有眼光还很不够，还要储备许多能代表自己出去管理公司的人才。这也是著名风险投资公司比小投资公司容易成功的原因之一，前者手中攥着更多更好的管理人才。</li><li>越是成功的风投公司，投资成功上市的越多，它们以后投资的公司相对越容易上市、再不济也容易被收购。因此，大多数想去小公司发财的人，选择公司很重要的一个原则就是看它幕后的风投公司的知名度。</li></ul><h2 id="信息产业的规律性">信息产业的规律性</h2><ul><li>当某个领域发展成熟后（而不是群雄争霸时期），一般在全球容不下三个以上的主要竞争者。虽然每个领域的领头羊占得市场份额不尽相同，但是通常都是比其他所有公司的总和还多。</li><li>当市场上一旦诞生了一个新的猴王，它就成为了这个市场规则的制定者和解释者，这时，市场就不可逆转地向着有利于这个主导者的方向发展。其它公司即使在技术上、管理上或者其它方面有一点优势，都不足以抵消主导者在规则制定和解释方面的优势。靠着制定和解释规则，在很短的时间里这个王者就占了这个领域在全世界的大部分市场。</li><li>在通信领域，规则比技术更有利于一个公司占领市场。</li><li>为什么在信息产业的公司比传统工业的容易形成主导优势呢？这里面有两个关键的原因。首先是不同的成本在这两种工业中占得比例相差太大。传统行业研发成本低，但各种制造成本和销售成本是非常高的。研发成本可以通过规模经济来抵消，而制造成本则不能。</li><li>科技领域则大不相同，制造的成本只占营业额的很小一部分而研发成本占大多数。对微软和甲骨文来讲，制造一份软件拷贝的成本和一百万份没有什么区别。</li><li>虽然生物制药公司和信息科技公司一样有着低制造成本的特点，但是世界上没有一种万灵药能治所有的病，甚至对于同一种病也不存在一种药能医治所有的人，因此就有很多大的生物制药公司并存。它们每个公司专门研制针对不同疾病的药物。因此前面所讲的主导性的公司在生物制药领域并不存在。</li><li>一个主导者愿意强调自己是行业的领导者，这样可以给投资者和用户信心，但是永远会否认自己有垄断地位，以免给自己找麻烦。它们在提交到证监会和其它政府部门的官方文件中甚至会列举一些小的不能再小的竞争对手，表示自己在公平竞争。</li><li>诺威格定理：当一个公司的市场占有率超过 50% 后，就无法再使市场占有率翻番了。这几乎是任何人都懂的大白话，但是却道出了许多跨国公司兴衰的根源。</li><li>当它占领了大部分市场时，它的成长就受制于整个行业的发展了。而华尔街依然期望着这个新兴公司不断创造奇迹。这时候，该公司就必须寻找新的成长点，才能不断超越华尔街的预期，公司就不得不天天为营收忙碌</li><li>通用汽车失败的根源在它根深蒂固的思维方式：它一直认定自己是个汽车公司，一定就要以汽车公司为主。这好比在围棋盘上，通用汽车有一条经营了很长时间却已经没有气的大龙，和一片布局完美可扩展空间大的实空，通用汽车总是舍不得牺牲掉自己经营多年的大龙而错误地放弃前景看好的实空，最后满盘皆输。</li><li>严格地讲，苹果其实不能算是一个计算机公司，而是一个注重创新的消费电子公司。在苹果眼中，计算机不过是新的电子产品的一种，当然苹果要把它做得越新、越酷越好。</li><li>红杉风投认为一个公司的基因在创办的一个月内就定型了，这也许有些夸张，但是一个成型的公司改变基因的可能却是非常小。越是以前成功的公司越是容易相信自己固有的基因是最优秀的。</li></ul><h2 id="高科技公司的摇篮：斯坦福大学">高科技公司的摇篮：斯坦福大学</h2><ul><li>从斯坦福夫人身上我们看到一位真正慈善家的美德。慈善不是在富有以后拿出自己的闲钱来沽名钓誉，更不是以此来为自己做软广告，慈善是在自己哪怕也很困难的时候都在帮助社会的一种善行。</li><li>一旦某个项目有了商业价值，并且可以由公司资助时，政府会渐渐减少并且最终停止对这些课题的资助，因为政府（纳税人的代表）认为没有必要和工业界做重复的事，更没有必要和工业界竞争。在这一点上，美国政府和中国政府与日本政府有很大的不同。</li><li>只要一个教授能完成教学任务，并且发表足够多像样的论文，斯坦福并不限制它的教授到外面的公司兼职，甚至在一段时间里全时离开学校创办公司或者在公司里担任要职。</li><li>可以想象如果佩奇和布林不是斯坦福的研究生而是什么其它学校的，他们很难有机会直接向一位工业界领袖推销自己的发明。大家可以试想一下，在中国，一位普通的清华大学或者北京大学的研究生有没有可能通过学校直接见到华为的创始人任正非，斯坦福能做到这件事是它了不起的地方。</li></ul><h2 id="科技公司的吹鼓手：投资银行">科技公司的吹鼓手：投资银行</h2><ul><li>罗斯柴尔德家族十九世纪中后叶达到高峰，但是犯了几次致命的错误，又遇到几次灭顶之灾，便从此一蹶不振的。该家族犯的第一个错误就是低估了美国的发展。十九世纪后半叶，美国因为种族矛盾尖锐，后来又爆发了内战，罗斯柴尔德家族对美国不看好，撤走了在美国的大部分业务，失去了追随美国发展的大好时机。（我常常和别人讲，错过现在中国发展的快车，就像一百五十年前错过美国发展一样可惜。）</li><li>由于美国银行业的基础是私有银行，抵抗金融危机的能力就很有限，在 1907 年的金融危机中，美国的银行业几乎崩溃。这时，由著名银行家摩根发起，联合了各大银行，在总统威尔逊的支持下，美国建立了联邦储备银行系统（Federal Reserve System），简称美联储。</li><li>投资公司，虽然他们又称投资银行（Investment Bank），但是直到 2008 年 10 月，它们都不是真正意义上的银行，因为他们既不能接受存款，也不能向联邦储备银行借钱，它们是替别人买卖有价证券、期货、不动产和任何有价值的商品。</li><li>有人觉得雷曼和美林只要再坚持五天就可以逃过一劫，其实，只要它们两家公司一天不死，这个计划就不会从保尔森的口袋里拿出来。</li><li>摩根斯坦利是银行业中计算机化的先驱。早在 1962 年，它就通过计算机来分析股市并且建立了很多用于金融的数学模型（Quantitative Financial Analysis Model），并且获得了很大的成功。由于摩根斯坦利在金融界的影响力，其它金融公司也纷纷效仿，从此开创了一种用数学模型分析市场的新领域。这对八十年代后对冲基金的兴起起了先导作用。</li><li>和百度相反，中石油在香港的上市堪称败笔。首先它作为全球最大的融资行动，却选择了一家二流的承包商瑞士联合银行和不入流的中信。这两家承包商为中石油作出了天价的融资股价，以至于长期持有它的巴菲特马上套现。</li><li>融资过多和过少都是有危害的。过度的融资不仅导致原有股东的利益被压缩，而且由于在短时间里流入市场的股票太多，股价很难稳定。融资过少的危害也很明显，很多公司就是因为融资不足而在经济进入低谷时无资金摆脱困境而关门。</li><li>对于那些价值不大的科技公司，一旦它们未能达到预期，华尔街则会毫不留情的打压到底，以起到杀鸡示猴的作用。</li><li>要想不受华尔街的影响，唯一的办法就是不上市。这就是 Google 在盈利很久以后迟迟不肯上市的原因</li><li>金融业在整个经济活动中起着血液的作用。健康的金融环境和秩序可以帮助科技公司的成长。但是由于金融业和巨大的利益联系在一起，因此贪婪、投机甚至非法的欺骗行为是金融业永远也摆脱不了的阴影。</li></ul><h2 id="挑战者：Google-公司">挑战者：Google 公司</h2><ul><li>我们问佩奇是如何想到Page Rank算法的。他说&quot;当时我们觉得整个互联网就像一张大的图( Graph ) ,每个网站就像一个节点，而每个网页的链接就像一个弧。我想，互联网可以用一个图或矩阵描述， 我也许可以用这个发现做个博士论文。</li><li>虽然今天的Google 和其他搜索引擎相比当初的Google 已有了长足的进步，但是这种进步基本上属于量变。搜索引擎领域迄今为止的质变只有 Google 取代AltaVista 那一次。</li><li>佩奇知道，只有把互联网的内容送到千家万户就行了，至于互联网的内容是谁的并不重要。</li><li>巴菲特有一个最简单有效的选择股票的办法，就是到大小百货店、加油站和食品店看一看老百姓都在买什么，这比听华尔街分析师瞎掰乎要准确得多。巴菲特因此而选择了可口可乐、宝洁、强生、百威啤酒、沃尔玛和卡夫食品等公司技资，都获得了极高的回报。在巴菲特看来，广大消费者才是一切商业的衣食父母。佩奇和布林也深深体会到，广大最终的用户(网民和广告商)才是为Google 带来生意的人，因此， Google 的产品一直是针对广大用户，既非像IBM 那样针对企业，又非像苹果那样针对精英。</li><li>Google 在早期并没有刻意追求营业额和利润，而是想方设法扩大自己的用户群。除了在技术上要比对手做得好以外，还将自己的网页做得特别干净，这样在到处是铺天盖地的横幅广告和弹出式广告的互联网上，显得非常超凡脱俗，便吸引了很多用户。</li><li>由于Google 很明智地没有在互联网泡沫高峰期疯狂地扩展，而是实实在在地、低调地做好自己的搜索引擎，因此它早期烧钱的速度非常之慢。2000 年的时候它没有急着上市，避免了绝大多数互联网公司大起大落并且最终关门的厄运，同时最早期的优秀人才没有拿了钱就走掉，因此Google 的骨干完好无损。</li><li>他解释 Google 的人才战略时说，好的博士生不仅有创造力，而且有最高的自觉性。硕士生同样的聪明，但是主动性要差一些。硕士能把你领到别人到过的地方，而博士可以把你带到以前无人去过的地方。</li><li>Google 是一家思维方式与众不同的公司，它认为，杀鸡一定要用牛刀。一个本科生能完成的事，如果我能找到一个硕士生来做，那么一定比同类公司做得好! 在Google 里面实际上是贯彻一种&quot;瑞士制造&quot;的指导思想， Google 自己把它称为&quot;Google 的品质&quot; 。</li><li>随着自由派总统奥巴马的当选和任职，美国和中国的蜜月期终于过去了。自由派人士占主导的Google总部对中国的互联网管制方式一直难于接受，这中间的矛盾全压在李开复身上。终于有一天，他不堪重负，选择了离开。缺少了李开复这个润滑剂， Google 和中国的关系变得很难调和，最终导致了2010 年初Google 退出中国的事件。</li></ul><h2 id="成功的转基因：诺基亚、3M、GE">成功的转基因：诺基亚、3M、GE</h2><ul><li>芬兰政府给诺基亚的支持是在人才上的支持。芬兰在欧洲近乎于一个社会主义国家，它为民众提供从小学到大学全部的免费教育。这就为诺基亚提供了人才保障。同时，作为一个小国，芬兰政府知道它不可能在世界经济的方方面面都领先，因此全国只专注几个产业，当然，移动通信是一个。而在芬兰的大学和研究所里，也就很少看到跟它产业结构不太相关的专业。</li><li>到了数字手机时代，不同手机的话音质量相差不像以前那么大，这时手机的功能就变得非常重要了，再到后来手机的外观都变得重要起来。</li><li>诺基亚由一个地区性的木工厂发展到全球最大的手机厂商，原因可以简单概括为长期探索、抓住机遇和制定规则几个字。</li><li>3M 允许员工用 15% 的时间干任何自己喜欢做的事，后来这个做法被 Google 学去了，变成了 Google 的百分之二十项目。</li><li>3M 公司在适当的时候强制淘汰一些看似还在挣钱但是前景不是很好的产品。</li><li>因为企业级的产品和服务受经济大环境的影响太大，收入相对不如消费者产品来得稳定。</li><li>了解 GE 公司历史的人都知道这个充满传奇色彩的公司是由著名发明家爱迪生创立的，是将电最早介绍和普及到世界上的公司。</li><li>3M 是靠硬性的制度维持其创新，而 GE 是靠自己不断开创新的产业。</li></ul><h2 id="印钞机：最佳的商业模式">印钞机：最佳的商业模式</h2><ul><li>所有成功的大公司都有好的商业模式，很多大公司的兴起，不是靠技术的革新而是商业模式的转变。</li><li>在这台印钞机中，自动化程度必须到达一个阈值，它才能自动运转起来。而当它的自动化越高，成本就越低。</li><li>长城公司自己开发微机全部软硬件，自己在广东建厂，自己采购元器件，有自己的仓储，最后还发展了一大批批发和零售代理商。大家不难看到，长城公司处处走的是和戴尔公司相反的路线。当长城计算机公司很自豪地拥有了这一切时候，它的资金利用率已经比戴尔低了很多，而它的产品的价格却高了很多。</li></ul><h2 id="互联网-2-0">互联网 2.0</h2><ul><li>到2000年世界上流量最大的网站全部是门户网站，在美国是雅虎、MSN 和Excite 等在中国则是新浪、搜狐和网易三大门户网站。</li><li>互联网2.0的公司不应该过多主导内容和服务，不应该参与和用户的竞争。以YouTube 为例，它host 的内容是用户（包括个人和专业的传媒公司）提供，它自己并不制作和拥有内容， 与其他提供内容的用户竞争。</li><li>互联网2.0公司的一个普遍特点就是专注于打造通用的平台，而由社会上的开发力量和广大用户补充成完整的服务，从Wikipedia 到Facebook 都是如此，它们相当于软件时代的甲骨文和微软。</li></ul><h2 id="金融风暴的冲击">金融风暴的冲击</h2><ul><li>科技像是我们这个社会的大脑，而金融则是血液。没有了科技，这个社会就会是混混沌沌的，就像中世纪的欧洲；而没有了金融，这个社会就停止了运转。</li><li>金融危机的直接和表层的原因是次贷（Subprime Loan） 及与之相关的金融衍生物CDS ，而间接和深层的原因则是违反经济规律地只消费不创造，从而坐吃山空。</li><li>当人们为格林斯潘神奇的控制经济的能力叹服时， 实际上他是用一个更大的房市泡沫解决了相对小得多的互联网泡沫的问题。</li><li>金融危机首先将淘汰掉这些无法适应新环境的恐龙级的公司，因为这些长期部借新的贷款来偿还旧的贷款利息过活的跨国公司，现在已无法贷到新款，或者贷款的成本太高。</li><li>大量不健康的公司会使得整个社会的投资效率低下， 经济生活变得死气沉沉。这些公司的消失，为健康的公司腾出了宝贵的市场，健康而有活力的公司将成为未来直接的收益者。</li><li>金融危机使得以前一些不可能的兼并成为可能，并因此打造出一些竞争力更强的大型公司。</li><li>经济危机时，风险投资家们不得不主动收缩战线，弃卒保车。它们通常的做法是迅速关闭成活可能性小的公司，把资金集中投入给可以生存下去的公司中，保住一些重点投资。对于那些运营不错的公司，反而可能得到比宏观经济好的时期更多的资金，虽然它们日子也颇为艰难，却无疑是遇到了一个非常好的发展机会。</li><li>我的建议是，不求大的发展，但求生存。必须要保证12到18个月后还有资金，还活着。现在看来，能坚持一到两年的小公司，发展得都比金融危机前要好。</li><li>这些公司因为没有利润，甚至没有营业额，根本无法按照传统的市盈率（ P／E ） 比来估价，于是他们伙同华尔街发明了用股价／ 流量比来对这些网络垃圾估价。</li></ul><h2 id="云计算">云计算</h2><ul><li>在甲骨文的Network Computer 失败后， 第一次互联网的泡沫也破灭了，大家对互联网的作用也产生了怀疑，一切基于客户端的想法又占了上风，因此很长时间这种基于Web 应用的概念没有人提了。</li><li>亚马逊发现，它不仅仅可以为商家提供网站托管服务，还可以为任何需要建立网站的公司提供。这样，任何一个想通过互联网提供服务（包括电子商务） 的公司和个人都不需要自己建网站，而只要租用亚马逊的计算资源即可。这就是亚马逊理解的云计算，它和IBM 的理解完全不同，但是没有矛盾。</li><li>云计算本身是一个非常复杂的系统工程。它的普及首先离不开巨型数据中心的建设和全球高速光纤主干网的铺设，这就好比电的普及离不开发电厂和输电网一样。在Google，这些工程称为全球基础架构，它本身也需要很多关键技术，甚至一些看上去IT无关的技术，比如制冷技术。全球基础架构设计和实施的好坏可能会导致运营成本上成倍的差别。</li><li>云计算要想得到充分的发展和全世界计算机产业的认可，不是单凭任何一家公司的力量就能做到的.</li></ul><h2 id="下一个Google">下一个Google</h2><ul><li>很多公司靠炒作概念，而利润平平，在一段时间里，股价炒得很高，他们依靠发行新股获得了充足资金，然后盲目扩大业务。虽然风光一时，但光环迅速消失。</li><li>即使今天出现了一个比微软Windows 好一倍的操作系统，用户也没有要换操作系统的欲望，因为微软的够用了 。够用了这条很消极而枯燥的原则，让所有想通过做一个操作系统取代微软的努力都变得无效。</li><li>云计算不仅是今后最有希望的产业， 而且是上面很多产业，比如3G 移动通信的支柱。</li><li>可以毫不夸张地讲，阿里巴巴已经完全占领中同电子市场的制高点，而且只要它不犯大的错误，现在找不出一家公司可以挑战它的商业地位。</li><li>马云自己都认为是阿里巴巴开创了中同的电子商务市场。从效果上看这一点并不错，但是有些因果倒置。事实上是，中同非常糟糕的批发和零售商业环境，要求必须出现一家阿里巴巴这样让商业变得容易的公司。</li><li>腾讯的做法和Google 非常类似，通过一款产品抓住终端用户，然后通过一些服务从每一个用户身上挣钱。</li><li>美国取代英国成为世界第一强国的时候，依靠的不是任何资本泡沫，而是爱迪生和西屋（发明电和交流供电）、贝尔（发明电话）、福特（发明汽车）、怀特兄弟（发明飞机）等这样一大批在世界文明史上占有重要位置的发明家，以及洛克菲勒（石油）、卡内基（钢铁）、杜邦（ 化工）等搞实业的工业巨子。</li><li>当人们不再把房市、股市作为最快的挣钱手段时，就是中国可以诞生下一个Google 的时候了。</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;一本介绍大型科技公司浪潮起落的书。&lt;/p&gt;</summary>
    
    
    
    <category term="Reading Note" scheme="https://blog.superui.cc/categories/reading-note/"/>
    
    
    <category term="读书" scheme="https://blog.superui.cc/tags/%E8%AF%BB%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>富可敌国</title>
    <link href="https://blog.superui.cc/reading-note/more-money-than-god/"/>
    <id>https://blog.superui.cc/reading-note/more-money-than-god/</id>
    <published>2022-05-15T09:00:00.000Z</published>
    <updated>2022-05-15T09:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>一本介绍对冲基金发展的书。</p><span id="more"></span><h2 id="作者">作者</h2><p>塞巴斯蒂安-马拉比，保罗•沃尔克时期对外关系委员会国际经济高级研究员，《华盛顿邮报》的专栏作家。他在《经济学人》杂志工作了13年，在《华盛顿邮报》编委会工作了8年，主要专注于经济全球化和政治经济领域。</p><h2 id="极简简介">极简简介</h2><p>一本权威的对冲基金发展史。本书作者对该行业进行了包括300个小时访谈和无数内部文件在内的深入调查，并在此基础上，讲述了关于对冲基金鲜为人知的故事。</p><h2 id="个人看法">个人看法</h2><h3 id="极简评价">极简评价</h3><p>首先作为一本纪实介绍类的书，人名太多了，对于不明所以的人来说有点难以阅读。但是讲述较为生动全面，个人认为还是比较有启发。当然全书的立意还是针对于对冲基金，说实话离大部分人都很遥远，当成故事书来说更为合适。作为一本故事书，其中的很多成功和失败案例能为自己的投资提到警示作用。</p><h3 id="感想看法">感想看法</h3><ol><li>人名儿太多了，难以阅读。</li><li>量子基金做空英镑的故事的确有趣，不像是那些鸡汤文或者财经文里面介绍的那么浅显，本书将前因后果和细节交代的十分到位。给我的感想就是，了解宏观经济十分重要，了解政治也十分重要。这并不只是一场经济游戏，里面也暗含了很多政客的小心思。各种基金一起做空英镑的场景让我联想到了翟老师讲的华尔街做空雷亚尔的故事，书中也写到“亚洲和拉丁美洲的新兴经济体卡在了盯住汇率政策上，这在未来十年给对冲基金创造了巨大的机会”。</li><li>很多无风险套利的机会是要通过大规模资金才能实现。比如影子银行，借入短期资金，贷出长期资金，例如最开始的支付宝。（原来支付宝之前玩的都是美国90年代玩剩下的）。</li><li>一方面，对冲基金可能会加快金融市场的传导机制（例如长短期利率），另一方面，对冲基金可能也被政府纳入了政策制定的考虑当中。</li><li>虽然都叫对冲基金，很多是很不一样的。当然也有很多名称不一样，但做的事情本质是一样的。</li><li>原来索罗斯在做空泰铢的8亿美元收益在做多印尼盾中几乎赔了进去，interesting。</li><li>机构投资者的高仓位可能暗示着强烈的抛压，而不是暗示着还将继续上涨。记住，继续买入才会引发上涨。</li><li>其实自己在买基金和股票的时候要考虑一下流动性风险，不是自己的流动性，而是机构的流动性，他们有没有对手盘来操作。</li><li>再次重复，人名儿太多了，难以阅读，有一种看外国小说的感觉。</li><li>你可以对冲价格风险，但是你无法对冲流动性风险。</li><li>其实不认为小到可以随便倒闭就是对冲基金适合去吸收风险的理由。因为可能多个基金加总，体量也会变大，这样总风险也会变大。</li><li>”这就意味着资本价格对于脚踏实地的公司来说过高，而对于华而不实的公司来说过低。成长的概念被滥用“不敢更赞同。</li><li>过早的正确就等于错误，择时！</li><li>流动性真的太重要了，参见近期的房地产，和一些远离成交价的期权。</li></ol><h1>内容摘录</h1><ul><li>有时CAPM模型不能解释市场异象，就是单纯考虑市场风险因素是有欠缺的。于是三因素，四因素，多因素模型提出，异象不复存在。</li><li>一方面有人认为有效市场的均衡状态永远不可能出现。另一方面，有人认为有效市场是一直存在的，只是没有找到正确的衡量风险的方法。</li><li>短期来看，市场中存在着大量的无效情况，这些无效情况可以提供无风险的套利机会。</li><li>货币会波动，利率会波动，越来越多的公司会发发行股票和债券。债务会被证券化。弄清楚什么样的金融机构能最吸收这些类型的风险将变得至关重要。这本书提供的答案是对冲基金会最好的完成这个任务。因为他们优越的激励机制，因为它们小到可以随意倒闭。因为他们可以比任何对手都更负责任的管理风险。</li><li>对冲基金并没有精确的定义，也不是所有的故事都和套期保值和杠杆效应有关。</li><li>天才并不是时刻都知道自己在干什么。</li><li>那些看上去不怎么样的价值型股票，相对于吹得天花乱坠的成长型股票来说，价值被低估。这就意味着资本价格对于脚踏实地的公司来说过高，而对于华而不实的公司来说过低。成长的概念被滥用。</li><li>他们时而被当作尽力是无效价格回归正常的稳定器而加以赞扬，时而又因其自身的不稳定性被视为威胁全球经济的因素而加以批判。</li><li>问题在于杠杆交易。杠杆效应使大额交易成为可能，因此使价格更有效，更稳定。但是杠杆效应也使得对冲基金在面对冲击时更加脆弱。</li><li>到底谁能比较好的管理风险，是那些我破产，要么靠政府埋单的商业银行和投资银行。还是一位兜售货币市场产品迫使政府支持的共同基金公司。是风险集中，使得纳税人也深陷其中的大银行，还是风险分散到从不指望政府救援的小规模对冲基金。</li><li>如果投资者是风险厌恶型，它就应该买最好的股票，但只用它继续的一部分。如果投资者是风险偏爱型，他应该购买完全一样的股票，并借钱了，卖更多。</li><li>所有新的市场首先都是低效的。这种效率，对最早顺应市场的人来说，则意味着利润。</li><li>当一种商品价格突破其一贯的价格区间，压错赌注的投资者就会出现大幅亏损，因为恐慌，他们将匆匆平仓使价格更加远离之前的价格区间。</li><li>索罗斯认识到了均衡理论无法解释实际中的货币波动，当热钱流入美国美元升值，而美元的升值又吸引了更多的投机者，使汇率更加远离均衡点。如果投机者是决定汇率水平的真正力量，那就意味着货币永远会出现先繁荣后萧条的过程。</li><li>索罗斯的投资决策往往是险中取胜，事实是，市场至少在一定程度上是有效的，所以大多数信息已经反映在价格中，投机的艺术就是看到其他人忽略的一个点，然后利用那一点小小的优势大量交易。</li><li>经验丰富的投资者也不是总能成功地纠正错误定价。</li><li>如果大交易商们已经满仓，这种消息几乎不会影响价格，但如果他们在等着进入，市场就会迅速上涨。</li><li>下跌的股票将引发投资组合保险人的抛售，而这种抛售将导致股票下跌更多。</li><li>市场可以脱离其基本价值，因为投资者缺乏挑战共识的实力，而这种趋势能持续到远远超出一个理性的点，但如果你比其他人更具备实力和勇气，你可以突然袭击，在市场毫无准备的情况下将其扰乱，因为你导致了一个新的趋势，你会是最先受益的。</li><li>进行基本面分析得知股票或债券的价值被高估了是一回事，知道什么时候市场会回归正常是另一回事，而图表则能暗示答案。</li><li>如果你了解市场上的其他玩家，你就可以找出那些非常吸引人的风险回报比的交易。</li><li>自从由于恶性通货膨胀帮助了希特勒崛起的那个时候起，德国人就十分注重货币的稳定。</li><li>当你确定自己是对的，就没有什么投注太多这样的说法，你会尽可能多的买入。</li><li>如果市场主要由追求最大利润的理性投资者控制，那么效率有可能会占上风；但如果市场由其他人驱动，那就没有理由期望有效定价。</li><li>当对冲基金通过积极购买较长期的国库券来响应美联储的低短期利率时，短期和长期利率之前的联系会更紧密。</li><li>不确定性意味着风险。</li><li>在一个券商的追加保证金就可能迫使杠杆式基金火速卖出的情况下，关键是要小心高负债的人集中的市场。</li><li>如果投机起到预警的作用而不是打击的作用的话，是让贫穷社会受益的。</li><li>当市场出现恐慌时，流动性溢价可能会增加：怯弱的投资者希望自己能迅速卖出债券，他们愿意为此付出代价。</li><li>自我纠正的趋势只是一种趋势，一个极端的事件可能会改变价格的惯常走势，这种改变可能会持续很长一段时间，甚至永远。</li><li>长期资本管理公司失败的真正教训不在于它衡量风险的方法过于简单，而是想要对风险准确衡量，这不可避免地要失败。</li><li>长期资本管理公司的失败表明没有后备资金而赌整个世界的稳定性是不理智的。</li><li>市场保持非理性的时间可能比你可持续的时间更长。过早但正确就等于错误，就像投资者多次发现的那样。</li><li>当市场价格不再具有指南作用时，你得根据一个资产所能产生的现金流量来决定购买该资产的投入。</li><li>对于一个资产以每4-5年增长一倍的基金来说，其内部专业知识的增长速度很难和拥入的资金增长同步。</li><li>在普通的具有流动性的市场，价格通常有效，预测他们是困难的。相比之下，在流动性不充分的市场会有大量便宜货，但是因为错误所付出的代价可能也会非常惨重。</li><li>对于流动性不充分资产的买家来说，最大的危险是在危机中这些资产崩溃的幅度会最大。</li><li>正是因为缺乏保密性，才使得一旦市场对他不利，它就容易成为被攻击的目标。</li><li>波动率低是因为世界上充斥着冒险资金，但充分的流动性让人误以为稳定是由金融体系的结构得到改善而带来的。</li><li>由于对冲基金习惯了自己做决定，不受监管和评级机构的干扰，他们往往表现较佳。</li><li>当交易员盲目降低负债率的时候，资本结构套利的原因就不再重要了。</li><li>政府的行动降低了“大而不倒”的机构冒险的代价，其结果就是更加冒险。</li><li>政府该如何促进能够很好的管理风险的“小到可以随意倒闭”的公司的发展呢？这是金融业未来的关键所在，而且部分答案是显而易见的：政府必须鼓励对冲基金发展。</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;一本介绍对冲基金发展的书。&lt;/p&gt;</summary>
    
    
    
    <category term="Reading Note" scheme="https://blog.superui.cc/categories/reading-note/"/>
    
    
    <category term="读书" scheme="https://blog.superui.cc/tags/%E8%AF%BB%E4%B9%A6/"/>
    
  </entry>
  
</feed>
